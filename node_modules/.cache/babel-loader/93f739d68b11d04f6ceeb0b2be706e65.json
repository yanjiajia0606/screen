{"remainingRequest":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js!/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/base/browser/ui/tree/indexTreeModel.js","dependencies":[{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/base/browser/ui/tree/indexTreeModel.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/babel.config.js","mtime":1668271197000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0FycmF5IGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9BcnJheS5qcyI7CmltcG9ydCBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciBmcm9tICIvVXNlcnMveWFuamlhamlhL0Rlc2t0b3Avd29ya3NwYWNlL2F2dWUtZGF0YS1uZXcvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIuanMiOwppbXBvcnQgX3RvQ29uc3VtYWJsZUFycmF5IGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkuanMiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2suanMiOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MuanMiOwppbXBvcnQgX3R5cGVvZiBmcm9tICIvVXNlcnMveWFuamlhamlhL0Rlc2t0b3Avd29ya3NwYWNlL2F2dWUtZGF0YS1uZXcvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3R5cGVvZi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIubWF4LXNhZmUtaW50ZWdlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm51bWJlci5jb25zdHJ1Y3Rvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNvcnQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5yZWR1Y2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7Ci8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAqICBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uCiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwppbXBvcnQgeyBUcmVlRXJyb3IgfSBmcm9tICcuL3RyZWUuanMnOwppbXBvcnQgeyBzcGxpY2UsIHRhaWwyIH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL2FycmF5cy5qcyc7CmltcG9ydCB7IERlbGF5ZXIsIE1pY3JvdGFza0RlbGF5IH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL2FzeW5jLmpzJzsKaW1wb3J0IHsgTGNzRGlmZiB9IGZyb20gJy4uLy4uLy4uL2NvbW1vbi9kaWZmL2RpZmYuanMnOwppbXBvcnQgeyBFbWl0dGVyLCBFdmVudEJ1ZmZlcmVyIH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL2V2ZW50LmpzJzsKaW1wb3J0IHsgSXRlcmFibGUgfSBmcm9tICcuLi8uLi8uLi9jb21tb24vaXRlcmF0b3IuanMnOwpleHBvcnQgZnVuY3Rpb24gaXNGaWx0ZXJSZXN1bHQob2JqKSB7CiAgcmV0dXJuIF90eXBlb2Yob2JqKSA9PT0gJ29iamVjdCcgJiYgJ3Zpc2liaWxpdHknIGluIG9iaiAmJiAnZGF0YScgaW4gb2JqOwp9CmV4cG9ydCBmdW5jdGlvbiBnZXRWaXNpYmxlU3RhdGUodmlzaWJpbGl0eSkgewogIHN3aXRjaCAodmlzaWJpbGl0eSkgewogICAgY2FzZSB0cnVlOgogICAgICByZXR1cm4gMSAvKiBUcmVlVmlzaWJpbGl0eS5WaXNpYmxlICovOwogICAgY2FzZSBmYWxzZToKICAgICAgcmV0dXJuIDAgLyogVHJlZVZpc2liaWxpdHkuSGlkZGVuICovOwogICAgZGVmYXVsdDoKICAgICAgcmV0dXJuIHZpc2liaWxpdHk7CiAgfQp9CmZ1bmN0aW9uIGlzQ29sbGFwc2libGVTdGF0ZVVwZGF0ZSh1cGRhdGUpIHsKICByZXR1cm4gdHlwZW9mIHVwZGF0ZS5jb2xsYXBzaWJsZSA9PT0gJ2Jvb2xlYW4nOwp9CmV4cG9ydCB2YXIgSW5kZXhUcmVlTW9kZWwgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEluZGV4VHJlZU1vZGVsKHVzZXIsIGxpc3QsIHJvb3RFbGVtZW50KSB7CiAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDoge307CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSW5kZXhUcmVlTW9kZWwpOwogICAgdGhpcy51c2VyID0gdXNlcjsKICAgIHRoaXMubGlzdCA9IGxpc3Q7CiAgICB0aGlzLnJvb3RSZWYgPSBbXTsKICAgIHRoaXMuZXZlbnRCdWZmZXJlciA9IG5ldyBFdmVudEJ1ZmZlcmVyKCk7CiAgICB0aGlzLl9vbkRpZENoYW5nZUNvbGxhcHNlU3RhdGUgPSBuZXcgRW1pdHRlcigpOwogICAgdGhpcy5vbkRpZENoYW5nZUNvbGxhcHNlU3RhdGUgPSB0aGlzLmV2ZW50QnVmZmVyZXIud3JhcEV2ZW50KHRoaXMuX29uRGlkQ2hhbmdlQ29sbGFwc2VTdGF0ZS5ldmVudCk7CiAgICB0aGlzLl9vbkRpZENoYW5nZVJlbmRlck5vZGVDb3VudCA9IG5ldyBFbWl0dGVyKCk7CiAgICB0aGlzLm9uRGlkQ2hhbmdlUmVuZGVyTm9kZUNvdW50ID0gdGhpcy5ldmVudEJ1ZmZlcmVyLndyYXBFdmVudCh0aGlzLl9vbkRpZENoYW5nZVJlbmRlck5vZGVDb3VudC5ldmVudCk7CiAgICB0aGlzLl9vbkRpZFNwbGljZSA9IG5ldyBFbWl0dGVyKCk7CiAgICB0aGlzLm9uRGlkU3BsaWNlID0gdGhpcy5fb25EaWRTcGxpY2UuZXZlbnQ7CiAgICB0aGlzLnJlZmlsdGVyRGVsYXllciA9IG5ldyBEZWxheWVyKE1pY3JvdGFza0RlbGF5KTsKICAgIHRoaXMuY29sbGFwc2VCeURlZmF1bHQgPSB0eXBlb2Ygb3B0aW9ucy5jb2xsYXBzZUJ5RGVmYXVsdCA9PT0gJ3VuZGVmaW5lZCcgPyBmYWxzZSA6IG9wdGlvbnMuY29sbGFwc2VCeURlZmF1bHQ7CiAgICB0aGlzLmZpbHRlciA9IG9wdGlvbnMuZmlsdGVyOwogICAgdGhpcy5hdXRvRXhwYW5kU2luZ2xlQ2hpbGRyZW4gPSB0eXBlb2Ygb3B0aW9ucy5hdXRvRXhwYW5kU2luZ2xlQ2hpbGRyZW4gPT09ICd1bmRlZmluZWQnID8gZmFsc2UgOiBvcHRpb25zLmF1dG9FeHBhbmRTaW5nbGVDaGlsZHJlbjsKICAgIHRoaXMucm9vdCA9IHsKICAgICAgcGFyZW50OiB1bmRlZmluZWQsCiAgICAgIGVsZW1lbnQ6IHJvb3RFbGVtZW50LAogICAgICBjaGlsZHJlbjogW10sCiAgICAgIGRlcHRoOiAwLAogICAgICB2aXNpYmxlQ2hpbGRyZW5Db3VudDogMCwKICAgICAgdmlzaWJsZUNoaWxkSW5kZXg6IC0xLAogICAgICBjb2xsYXBzaWJsZTogZmFsc2UsCiAgICAgIGNvbGxhcHNlZDogZmFsc2UsCiAgICAgIHJlbmRlck5vZGVDb3VudDogMCwKICAgICAgdmlzaWJpbGl0eTogMSAvKiBUcmVlVmlzaWJpbGl0eS5WaXNpYmxlICovLAogICAgICB2aXNpYmxlOiB0cnVlLAogICAgICBmaWx0ZXJEYXRhOiB1bmRlZmluZWQKICAgIH07CiAgfQogIF9jcmVhdGVDbGFzcyhJbmRleFRyZWVNb2RlbCwgW3sKICAgIGtleTogInNwbGljZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaWNlKGxvY2F0aW9uLCBkZWxldGVDb3VudCkgewogICAgICB2YXIgdG9JbnNlcnQgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IEl0ZXJhYmxlLmVtcHR5KCk7CiAgICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiB7fTsKICAgICAgaWYgKGxvY2F0aW9uLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHRocm93IG5ldyBUcmVlRXJyb3IodGhpcy51c2VyLCAnSW52YWxpZCB0cmVlIGxvY2F0aW9uJyk7CiAgICAgIH0KICAgICAgaWYgKG9wdGlvbnMuZGlmZklkZW50aXR5UHJvdmlkZXIpIHsKICAgICAgICB0aGlzLnNwbGljZVNtYXJ0KG9wdGlvbnMuZGlmZklkZW50aXR5UHJvdmlkZXIsIGxvY2F0aW9uLCBkZWxldGVDb3VudCwgdG9JbnNlcnQsIG9wdGlvbnMpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc3BsaWNlU2ltcGxlKGxvY2F0aW9uLCBkZWxldGVDb3VudCwgdG9JbnNlcnQsIG9wdGlvbnMpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAic3BsaWNlU21hcnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNwbGljZVNtYXJ0KGlkZW50aXR5LCBsb2NhdGlvbiwgZGVsZXRlQ291bnQsIHRvSW5zZXJ0SXRlcmFibGUsIG9wdGlvbnMsIHJlY3Vyc2VMZXZlbHMpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIF9hOwogICAgICBpZiAodG9JbnNlcnRJdGVyYWJsZSA9PT0gdm9pZCAwKSB7CiAgICAgICAgdG9JbnNlcnRJdGVyYWJsZSA9IEl0ZXJhYmxlLmVtcHR5KCk7CiAgICAgIH0KICAgICAgaWYgKHJlY3Vyc2VMZXZlbHMgPT09IHZvaWQgMCkgewogICAgICAgIHJlY3Vyc2VMZXZlbHMgPSAoX2EgPSBvcHRpb25zLmRpZmZEZXB0aCkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogMDsKICAgICAgfQogICAgICB2YXIgX3RoaXMkZ2V0UGFyZW50Tm9kZVdpID0gdGhpcy5nZXRQYXJlbnROb2RlV2l0aExpc3RJbmRleChsb2NhdGlvbiksCiAgICAgICAgcGFyZW50Tm9kZSA9IF90aGlzJGdldFBhcmVudE5vZGVXaS5wYXJlbnROb2RlOwogICAgICBpZiAoIXBhcmVudE5vZGUubGFzdERpZmZJZHMpIHsKICAgICAgICByZXR1cm4gdGhpcy5zcGxpY2VTaW1wbGUobG9jYXRpb24sIGRlbGV0ZUNvdW50LCB0b0luc2VydEl0ZXJhYmxlLCBvcHRpb25zKTsKICAgICAgfQogICAgICB2YXIgdG9JbnNlcnQgPSBfdG9Db25zdW1hYmxlQXJyYXkodG9JbnNlcnRJdGVyYWJsZSk7CiAgICAgIHZhciBpbmRleCA9IGxvY2F0aW9uW2xvY2F0aW9uLmxlbmd0aCAtIDFdOwogICAgICB2YXIgZGlmZiA9IG5ldyBMY3NEaWZmKHsKICAgICAgICBnZXRFbGVtZW50czogZnVuY3Rpb24gZ2V0RWxlbWVudHMoKSB7CiAgICAgICAgICByZXR1cm4gcGFyZW50Tm9kZS5sYXN0RGlmZklkczsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICBnZXRFbGVtZW50czogZnVuY3Rpb24gZ2V0RWxlbWVudHMoKSB7CiAgICAgICAgICByZXR1cm4gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShwYXJlbnROb2RlLmNoaWxkcmVuLnNsaWNlKDAsIGluZGV4KSksIF90b0NvbnN1bWFibGVBcnJheSh0b0luc2VydCksIF90b0NvbnN1bWFibGVBcnJheShwYXJlbnROb2RlLmNoaWxkcmVuLnNsaWNlKGluZGV4ICsgZGVsZXRlQ291bnQpKSkubWFwKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIHJldHVybiBpZGVudGl0eS5nZXRJZChlLmVsZW1lbnQpLnRvU3RyaW5nKCk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pLkNvbXB1dGVEaWZmKGZhbHNlKTsKICAgICAgLy8gaWYgd2Ugd2VyZSBnaXZlbiBhICdiZXN0IGVmZm9ydCcgZGlmZiwgdXNlIGRlZmF1bHQgYmVoYXZpb3IKICAgICAgaWYgKGRpZmYucXVpdEVhcmx5KSB7CiAgICAgICAgcGFyZW50Tm9kZS5sYXN0RGlmZklkcyA9IHVuZGVmaW5lZDsKICAgICAgICByZXR1cm4gdGhpcy5zcGxpY2VTaW1wbGUobG9jYXRpb24sIGRlbGV0ZUNvdW50LCB0b0luc2VydCwgb3B0aW9ucyk7CiAgICAgIH0KICAgICAgdmFyIGxvY2F0aW9uUHJlZml4ID0gbG9jYXRpb24uc2xpY2UoMCwgLTEpOwogICAgICB2YXIgcmVjdXJzZVNwbGljZSA9IGZ1bmN0aW9uIHJlY3Vyc2VTcGxpY2UoZnJvbU9yaWdpbmFsLCBmcm9tTW9kaWZpZWQsIGNvdW50KSB7CiAgICAgICAgaWYgKHJlY3Vyc2VMZXZlbHMgPiAwKSB7CiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICAgICAgZnJvbU9yaWdpbmFsLS07CiAgICAgICAgICAgIGZyb21Nb2RpZmllZC0tOwogICAgICAgICAgICBfdGhpcy5zcGxpY2VTbWFydChpZGVudGl0eSwgW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShsb2NhdGlvblByZWZpeCksIFtmcm9tT3JpZ2luYWwsIDBdKSwgTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIsIHRvSW5zZXJ0W2Zyb21Nb2RpZmllZF0uY2hpbGRyZW4sIG9wdGlvbnMsIHJlY3Vyc2VMZXZlbHMgLSAxKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07CiAgICAgIHZhciBsYXN0U3RhcnRPID0gTWF0aC5taW4ocGFyZW50Tm9kZS5jaGlsZHJlbi5sZW5ndGgsIGluZGV4ICsgZGVsZXRlQ291bnQpOwogICAgICB2YXIgbGFzdFN0YXJ0TSA9IHRvSW5zZXJ0Lmxlbmd0aDsKICAgICAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKGRpZmYuY2hhbmdlcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgICByZXR1cm4gYi5vcmlnaW5hbFN0YXJ0IC0gYS5vcmlnaW5hbFN0YXJ0OwogICAgICAgIH0pKSwKICAgICAgICBfc3RlcDsKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvci5zKCk7ICEoX3N0ZXAgPSBfaXRlcmF0b3IubigpKS5kb25lOykgewogICAgICAgICAgdmFyIGNoYW5nZSA9IF9zdGVwLnZhbHVlOwogICAgICAgICAgcmVjdXJzZVNwbGljZShsYXN0U3RhcnRPLCBsYXN0U3RhcnRNLCBsYXN0U3RhcnRPIC0gKGNoYW5nZS5vcmlnaW5hbFN0YXJ0ICsgY2hhbmdlLm9yaWdpbmFsTGVuZ3RoKSk7CiAgICAgICAgICBsYXN0U3RhcnRPID0gY2hhbmdlLm9yaWdpbmFsU3RhcnQ7CiAgICAgICAgICBsYXN0U3RhcnRNID0gY2hhbmdlLm1vZGlmaWVkU3RhcnQgLSBpbmRleDsKICAgICAgICAgIHRoaXMuc3BsaWNlU2ltcGxlKFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkobG9jYXRpb25QcmVmaXgpLCBbbGFzdFN0YXJ0T10pLCBjaGFuZ2Uub3JpZ2luYWxMZW5ndGgsIEl0ZXJhYmxlLnNsaWNlKHRvSW5zZXJ0LCBsYXN0U3RhcnRNLCBsYXN0U3RhcnRNICsgY2hhbmdlLm1vZGlmaWVkTGVuZ3RoKSwgb3B0aW9ucyk7CiAgICAgICAgfQogICAgICAgIC8vIGF0IHRoaXMgcG9pbnQsIHN0YXJ0TyA9PT0gc3RhcnRNID09PSBjb3VudCBzaW5jZSBhbnkgcmVtYWluaW5nIHByZWZpeCBzaG91bGQgbWF0Y2gKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yLmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3IuZigpOwogICAgICB9CiAgICAgIHJlY3Vyc2VTcGxpY2UobGFzdFN0YXJ0TywgbGFzdFN0YXJ0TSwgbGFzdFN0YXJ0Tyk7CiAgICB9CiAgfSwgewogICAga2V5OiAic3BsaWNlU2ltcGxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzcGxpY2VTaW1wbGUobG9jYXRpb24sIGRlbGV0ZUNvdW50KSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwogICAgICB2YXIgdG9JbnNlcnQgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IEl0ZXJhYmxlLmVtcHR5KCk7CiAgICAgIHZhciBfcmVmID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgPyBhcmd1bWVudHNbM10gOiB1bmRlZmluZWQsCiAgICAgICAgb25EaWRDcmVhdGVOb2RlID0gX3JlZi5vbkRpZENyZWF0ZU5vZGUsCiAgICAgICAgb25EaWREZWxldGVOb2RlID0gX3JlZi5vbkRpZERlbGV0ZU5vZGUsCiAgICAgICAgZGlmZklkZW50aXR5UHJvdmlkZXIgPSBfcmVmLmRpZmZJZGVudGl0eVByb3ZpZGVyOwogICAgICB2YXIgX3RoaXMkZ2V0UGFyZW50Tm9kZVdpMiA9IHRoaXMuZ2V0UGFyZW50Tm9kZVdpdGhMaXN0SW5kZXgobG9jYXRpb24pLAogICAgICAgIHBhcmVudE5vZGUgPSBfdGhpcyRnZXRQYXJlbnROb2RlV2kyLnBhcmVudE5vZGUsCiAgICAgICAgbGlzdEluZGV4ID0gX3RoaXMkZ2V0UGFyZW50Tm9kZVdpMi5saXN0SW5kZXgsCiAgICAgICAgcmV2ZWFsZWQgPSBfdGhpcyRnZXRQYXJlbnROb2RlV2kyLnJldmVhbGVkLAogICAgICAgIHZpc2libGUgPSBfdGhpcyRnZXRQYXJlbnROb2RlV2kyLnZpc2libGU7CiAgICAgIHZhciB0cmVlTGlzdEVsZW1lbnRzVG9JbnNlcnQgPSBbXTsKICAgICAgdmFyIG5vZGVzVG9JbnNlcnRJdGVyYXRvciA9IEl0ZXJhYmxlLm1hcCh0b0luc2VydCwgZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMi5jcmVhdGVUcmVlTm9kZShlbCwgcGFyZW50Tm9kZSwgcGFyZW50Tm9kZS52aXNpYmxlID8gMSAvKiBUcmVlVmlzaWJpbGl0eS5WaXNpYmxlICovIDogMCAvKiBUcmVlVmlzaWJpbGl0eS5IaWRkZW4gKi8sIHJldmVhbGVkLCB0cmVlTGlzdEVsZW1lbnRzVG9JbnNlcnQsIG9uRGlkQ3JlYXRlTm9kZSk7CiAgICAgIH0pOwogICAgICB2YXIgbGFzdEluZGV4ID0gbG9jYXRpb25bbG9jYXRpb24ubGVuZ3RoIC0gMV07CiAgICAgIHZhciBsYXN0SGFkQ2hpbGRyZW4gPSBwYXJlbnROb2RlLmNoaWxkcmVuLmxlbmd0aCA+IDA7CiAgICAgIC8vIGZpZ3VyZSBvdXQgd2hhdCdzIHRoZSB2aXNpYmxlIGNoaWxkIHN0YXJ0IGluZGV4IHJpZ2h0IGJlZm9yZSB0aGUKICAgICAgLy8gc3BsaWNlIHBvaW50CiAgICAgIHZhciB2aXNpYmxlQ2hpbGRTdGFydEluZGV4ID0gMDsKICAgICAgZm9yICh2YXIgaSA9IGxhc3RJbmRleDsgaSA+PSAwICYmIGkgPCBwYXJlbnROb2RlLmNoaWxkcmVuLmxlbmd0aDsgaS0tKSB7CiAgICAgICAgdmFyIGNoaWxkID0gcGFyZW50Tm9kZS5jaGlsZHJlbltpXTsKICAgICAgICBpZiAoY2hpbGQudmlzaWJsZSkgewogICAgICAgICAgdmlzaWJsZUNoaWxkU3RhcnRJbmRleCA9IGNoaWxkLnZpc2libGVDaGlsZEluZGV4OwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICAgIHZhciBub2Rlc1RvSW5zZXJ0ID0gW107CiAgICAgIHZhciBpbnNlcnRlZFZpc2libGVDaGlsZHJlbkNvdW50ID0gMDsKICAgICAgdmFyIHJlbmRlck5vZGVDb3VudCA9IDA7CiAgICAgIHZhciBfaXRlcmF0b3IyID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIobm9kZXNUb0luc2VydEl0ZXJhdG9yKSwKICAgICAgICBfc3RlcDI7CiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3IyLnMoKTsgIShfc3RlcDIgPSBfaXRlcmF0b3IyLm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciBfY2hpbGQyID0gX3N0ZXAyLnZhbHVlOwogICAgICAgICAgbm9kZXNUb0luc2VydC5wdXNoKF9jaGlsZDIpOwogICAgICAgICAgcmVuZGVyTm9kZUNvdW50ICs9IF9jaGlsZDIucmVuZGVyTm9kZUNvdW50OwogICAgICAgICAgaWYgKF9jaGlsZDIudmlzaWJsZSkgewogICAgICAgICAgICBfY2hpbGQyLnZpc2libGVDaGlsZEluZGV4ID0gdmlzaWJsZUNoaWxkU3RhcnRJbmRleCArIGluc2VydGVkVmlzaWJsZUNoaWxkcmVuQ291bnQrKzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvcjIuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvcjIuZigpOwogICAgICB9CiAgICAgIHZhciBkZWxldGVkTm9kZXMgPSBzcGxpY2UocGFyZW50Tm9kZS5jaGlsZHJlbiwgbGFzdEluZGV4LCBkZWxldGVDb3VudCwgbm9kZXNUb0luc2VydCk7CiAgICAgIGlmICghZGlmZklkZW50aXR5UHJvdmlkZXIpIHsKICAgICAgICBwYXJlbnROb2RlLmxhc3REaWZmSWRzID0gdW5kZWZpbmVkOwogICAgICB9IGVsc2UgaWYgKHBhcmVudE5vZGUubGFzdERpZmZJZHMpIHsKICAgICAgICBzcGxpY2UocGFyZW50Tm9kZS5sYXN0RGlmZklkcywgbGFzdEluZGV4LCBkZWxldGVDb3VudCwgbm9kZXNUb0luc2VydC5tYXAoZnVuY3Rpb24gKG4pIHsKICAgICAgICAgIHJldHVybiBkaWZmSWRlbnRpdHlQcm92aWRlci5nZXRJZChuLmVsZW1lbnQpLnRvU3RyaW5nKCk7CiAgICAgICAgfSkpOwogICAgICB9IGVsc2UgewogICAgICAgIHBhcmVudE5vZGUubGFzdERpZmZJZHMgPSBwYXJlbnROb2RlLmNoaWxkcmVuLm1hcChmdW5jdGlvbiAobikgewogICAgICAgICAgcmV0dXJuIGRpZmZJZGVudGl0eVByb3ZpZGVyLmdldElkKG4uZWxlbWVudCkudG9TdHJpbmcoKTsKICAgICAgICB9KTsKICAgICAgfQogICAgICAvLyBmaWd1cmUgb3V0IHdoYXQgaXMgdGhlIGNvdW50IG9mIGRlbGV0ZWQgdmlzaWJsZSBjaGlsZHJlbgogICAgICB2YXIgZGVsZXRlZFZpc2libGVDaGlsZHJlbkNvdW50ID0gMDsKICAgICAgdmFyIF9pdGVyYXRvcjMgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihkZWxldGVkTm9kZXMpLAogICAgICAgIF9zdGVwMzsKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjMucygpOyAhKF9zdGVwMyA9IF9pdGVyYXRvcjMubigpKS5kb25lOykgewogICAgICAgICAgdmFyIF9jaGlsZDMgPSBfc3RlcDMudmFsdWU7CiAgICAgICAgICBpZiAoX2NoaWxkMy52aXNpYmxlKSB7CiAgICAgICAgICAgIGRlbGV0ZWRWaXNpYmxlQ2hpbGRyZW5Db3VudCsrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAvLyBhbmQgYWRqdXN0IGZvciBhbGwgdmlzaWJsZSBjaGlsZHJlbiBhZnRlciB0aGUgc3BsaWNlIHBvaW50CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvcjMuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvcjMuZigpOwogICAgICB9CiAgICAgIGlmIChkZWxldGVkVmlzaWJsZUNoaWxkcmVuQ291bnQgIT09IDApIHsKICAgICAgICBmb3IgKHZhciBfaSA9IGxhc3RJbmRleCArIG5vZGVzVG9JbnNlcnQubGVuZ3RoOyBfaSA8IHBhcmVudE5vZGUuY2hpbGRyZW4ubGVuZ3RoOyBfaSsrKSB7CiAgICAgICAgICB2YXIgX2NoaWxkID0gcGFyZW50Tm9kZS5jaGlsZHJlbltfaV07CiAgICAgICAgICBpZiAoX2NoaWxkLnZpc2libGUpIHsKICAgICAgICAgICAgX2NoaWxkLnZpc2libGVDaGlsZEluZGV4IC09IGRlbGV0ZWRWaXNpYmxlQ2hpbGRyZW5Db3VudDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgLy8gdXBkYXRlIHBhcmVudCdzIHZpc2libGUgY2hpbGRyZW4gY291bnQKICAgICAgcGFyZW50Tm9kZS52aXNpYmxlQ2hpbGRyZW5Db3VudCArPSBpbnNlcnRlZFZpc2libGVDaGlsZHJlbkNvdW50IC0gZGVsZXRlZFZpc2libGVDaGlsZHJlbkNvdW50OwogICAgICBpZiAocmV2ZWFsZWQgJiYgdmlzaWJsZSkgewogICAgICAgIHZhciB2aXNpYmxlRGVsZXRlQ291bnQgPSBkZWxldGVkTm9kZXMucmVkdWNlKGZ1bmN0aW9uIChyLCBub2RlKSB7CiAgICAgICAgICByZXR1cm4gciArIChub2RlLnZpc2libGUgPyBub2RlLnJlbmRlck5vZGVDb3VudCA6IDApOwogICAgICAgIH0sIDApOwogICAgICAgIHRoaXMuX3VwZGF0ZUFuY2VzdG9yc1JlbmRlck5vZGVDb3VudChwYXJlbnROb2RlLCByZW5kZXJOb2RlQ291bnQgLSB2aXNpYmxlRGVsZXRlQ291bnQpOwogICAgICAgIHRoaXMubGlzdC5zcGxpY2UobGlzdEluZGV4LCB2aXNpYmxlRGVsZXRlQ291bnQsIHRyZWVMaXN0RWxlbWVudHNUb0luc2VydCk7CiAgICAgIH0KICAgICAgaWYgKGRlbGV0ZWROb2Rlcy5sZW5ndGggPiAwICYmIG9uRGlkRGVsZXRlTm9kZSkgewogICAgICAgIHZhciB2aXNpdCA9IGZ1bmN0aW9uIHZpc2l0KG5vZGUpIHsKICAgICAgICAgIG9uRGlkRGVsZXRlTm9kZShub2RlKTsKICAgICAgICAgIG5vZGUuY2hpbGRyZW4uZm9yRWFjaCh2aXNpdCk7CiAgICAgICAgfTsKICAgICAgICBkZWxldGVkTm9kZXMuZm9yRWFjaCh2aXNpdCk7CiAgICAgIH0KICAgICAgdGhpcy5fb25EaWRTcGxpY2UuZmlyZSh7CiAgICAgICAgaW5zZXJ0ZWROb2Rlczogbm9kZXNUb0luc2VydCwKICAgICAgICBkZWxldGVkTm9kZXM6IGRlbGV0ZWROb2RlcwogICAgICB9KTsKICAgICAgdmFyIGN1cnJlbnRseUhhc0NoaWxkcmVuID0gcGFyZW50Tm9kZS5jaGlsZHJlbi5sZW5ndGggPiAwOwogICAgICBpZiAobGFzdEhhZENoaWxkcmVuICE9PSBjdXJyZW50bHlIYXNDaGlsZHJlbikgewogICAgICAgIHRoaXMuc2V0Q29sbGFwc2libGUobG9jYXRpb24uc2xpY2UoMCwgLTEpLCBjdXJyZW50bHlIYXNDaGlsZHJlbik7CiAgICAgIH0KICAgICAgdmFyIG5vZGUgPSBwYXJlbnROb2RlOwogICAgICB3aGlsZSAobm9kZSkgewogICAgICAgIGlmIChub2RlLnZpc2liaWxpdHkgPT09IDIgLyogVHJlZVZpc2liaWxpdHkuUmVjdXJzZSAqLykgewogICAgICAgICAgLy8gZGVsYXllZCB0byBhdm9pZCBleGNlc3NpdmUgcmVmaWx0ZXJpbmcsIHNlZSAjMTM1OTQxCiAgICAgICAgICB0aGlzLnJlZmlsdGVyRGVsYXllci50cmlnZ2VyKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzMi5yZWZpbHRlcigpOwogICAgICAgICAgfSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgbm9kZSA9IG5vZGUucGFyZW50OwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAicmVyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlcmVuZGVyKGxvY2F0aW9uKSB7CiAgICAgIGlmIChsb2NhdGlvbi5sZW5ndGggPT09IDApIHsKICAgICAgICB0aHJvdyBuZXcgVHJlZUVycm9yKHRoaXMudXNlciwgJ0ludmFsaWQgdHJlZSBsb2NhdGlvbicpOwogICAgICB9CiAgICAgIHZhciBfdGhpcyRnZXRUcmVlTm9kZVdpdGggPSB0aGlzLmdldFRyZWVOb2RlV2l0aExpc3RJbmRleChsb2NhdGlvbiksCiAgICAgICAgbm9kZSA9IF90aGlzJGdldFRyZWVOb2RlV2l0aC5ub2RlLAogICAgICAgIGxpc3RJbmRleCA9IF90aGlzJGdldFRyZWVOb2RlV2l0aC5saXN0SW5kZXgsCiAgICAgICAgcmV2ZWFsZWQgPSBfdGhpcyRnZXRUcmVlTm9kZVdpdGgucmV2ZWFsZWQ7CiAgICAgIGlmIChub2RlLnZpc2libGUgJiYgcmV2ZWFsZWQpIHsKICAgICAgICB0aGlzLmxpc3Quc3BsaWNlKGxpc3RJbmRleCwgMSwgW25vZGVdKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImhhcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFzKGxvY2F0aW9uKSB7CiAgICAgIHJldHVybiB0aGlzLmhhc1RyZWVOb2RlKGxvY2F0aW9uKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRMaXN0SW5kZXgiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldExpc3RJbmRleChsb2NhdGlvbikgewogICAgICB2YXIgX3RoaXMkZ2V0VHJlZU5vZGVXaXRoMiA9IHRoaXMuZ2V0VHJlZU5vZGVXaXRoTGlzdEluZGV4KGxvY2F0aW9uKSwKICAgICAgICBsaXN0SW5kZXggPSBfdGhpcyRnZXRUcmVlTm9kZVdpdGgyLmxpc3RJbmRleCwKICAgICAgICB2aXNpYmxlID0gX3RoaXMkZ2V0VHJlZU5vZGVXaXRoMi52aXNpYmxlLAogICAgICAgIHJldmVhbGVkID0gX3RoaXMkZ2V0VHJlZU5vZGVXaXRoMi5yZXZlYWxlZDsKICAgICAgcmV0dXJuIHZpc2libGUgJiYgcmV2ZWFsZWQgPyBsaXN0SW5kZXggOiAtMTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRMaXN0UmVuZGVyQ291bnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldExpc3RSZW5kZXJDb3VudChsb2NhdGlvbikgewogICAgICByZXR1cm4gdGhpcy5nZXRUcmVlTm9kZShsb2NhdGlvbikucmVuZGVyTm9kZUNvdW50OwogICAgfQogIH0sIHsKICAgIGtleTogImlzQ29sbGFwc2libGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlzQ29sbGFwc2libGUobG9jYXRpb24pIHsKICAgICAgcmV0dXJuIHRoaXMuZ2V0VHJlZU5vZGUobG9jYXRpb24pLmNvbGxhcHNpYmxlOwogICAgfQogIH0sIHsKICAgIGtleTogInNldENvbGxhcHNpYmxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRDb2xsYXBzaWJsZShsb2NhdGlvbiwgY29sbGFwc2libGUpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIHZhciBub2RlID0gdGhpcy5nZXRUcmVlTm9kZShsb2NhdGlvbik7CiAgICAgIGlmICh0eXBlb2YgY29sbGFwc2libGUgPT09ICd1bmRlZmluZWQnKSB7CiAgICAgICAgY29sbGFwc2libGUgPSAhbm9kZS5jb2xsYXBzaWJsZTsKICAgICAgfQogICAgICB2YXIgdXBkYXRlID0gewogICAgICAgIGNvbGxhcHNpYmxlOiBjb2xsYXBzaWJsZQogICAgICB9OwogICAgICByZXR1cm4gdGhpcy5ldmVudEJ1ZmZlcmVyLmJ1ZmZlckV2ZW50cyhmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMy5fc2V0Q29sbGFwc2VTdGF0ZShsb2NhdGlvbiwgdXBkYXRlKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNDb2xsYXBzZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlzQ29sbGFwc2VkKGxvY2F0aW9uKSB7CiAgICAgIHJldHVybiB0aGlzLmdldFRyZWVOb2RlKGxvY2F0aW9uKS5jb2xsYXBzZWQ7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0Q29sbGFwc2VkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRDb2xsYXBzZWQobG9jYXRpb24sIGNvbGxhcHNlZCwgcmVjdXJzaXZlKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwogICAgICB2YXIgbm9kZSA9IHRoaXMuZ2V0VHJlZU5vZGUobG9jYXRpb24pOwogICAgICBpZiAodHlwZW9mIGNvbGxhcHNlZCA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICBjb2xsYXBzZWQgPSAhbm9kZS5jb2xsYXBzZWQ7CiAgICAgIH0KICAgICAgdmFyIHVwZGF0ZSA9IHsKICAgICAgICBjb2xsYXBzZWQ6IGNvbGxhcHNlZCwKICAgICAgICByZWN1cnNpdmU6IHJlY3Vyc2l2ZSB8fCBmYWxzZQogICAgICB9OwogICAgICByZXR1cm4gdGhpcy5ldmVudEJ1ZmZlcmVyLmJ1ZmZlckV2ZW50cyhmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF90aGlzNC5fc2V0Q29sbGFwc2VTdGF0ZShsb2NhdGlvbiwgdXBkYXRlKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3NldENvbGxhcHNlU3RhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZXRDb2xsYXBzZVN0YXRlKGxvY2F0aW9uLCB1cGRhdGUpIHsKICAgICAgdmFyIF90aGlzJGdldFRyZWVOb2RlV2l0aDMgPSB0aGlzLmdldFRyZWVOb2RlV2l0aExpc3RJbmRleChsb2NhdGlvbiksCiAgICAgICAgbm9kZSA9IF90aGlzJGdldFRyZWVOb2RlV2l0aDMubm9kZSwKICAgICAgICBsaXN0SW5kZXggPSBfdGhpcyRnZXRUcmVlTm9kZVdpdGgzLmxpc3RJbmRleCwKICAgICAgICByZXZlYWxlZCA9IF90aGlzJGdldFRyZWVOb2RlV2l0aDMucmV2ZWFsZWQ7CiAgICAgIHZhciByZXN1bHQgPSB0aGlzLl9zZXRMaXN0Tm9kZUNvbGxhcHNlU3RhdGUobm9kZSwgbGlzdEluZGV4LCByZXZlYWxlZCwgdXBkYXRlKTsKICAgICAgaWYgKG5vZGUgIT09IHRoaXMucm9vdCAmJiB0aGlzLmF1dG9FeHBhbmRTaW5nbGVDaGlsZHJlbiAmJiByZXN1bHQgJiYgIWlzQ29sbGFwc2libGVTdGF0ZVVwZGF0ZSh1cGRhdGUpICYmIG5vZGUuY29sbGFwc2libGUgJiYgIW5vZGUuY29sbGFwc2VkICYmICF1cGRhdGUucmVjdXJzaXZlKSB7CiAgICAgICAgdmFyIG9ubHlWaXNpYmxlQ2hpbGRJbmRleCA9IC0xOwogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZS5jaGlsZHJlbi5sZW5ndGg7IGkrKykgewogICAgICAgICAgdmFyIGNoaWxkID0gbm9kZS5jaGlsZHJlbltpXTsKICAgICAgICAgIGlmIChjaGlsZC52aXNpYmxlKSB7CiAgICAgICAgICAgIGlmIChvbmx5VmlzaWJsZUNoaWxkSW5kZXggPiAtMSkgewogICAgICAgICAgICAgIG9ubHlWaXNpYmxlQ2hpbGRJbmRleCA9IC0xOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIG9ubHlWaXNpYmxlQ2hpbGRJbmRleCA9IGk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKG9ubHlWaXNpYmxlQ2hpbGRJbmRleCA+IC0xKSB7CiAgICAgICAgICB0aGlzLl9zZXRDb2xsYXBzZVN0YXRlKFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkobG9jYXRpb24pLCBbb25seVZpc2libGVDaGlsZEluZGV4XSksIHVwZGF0ZSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3NldExpc3ROb2RlQ29sbGFwc2VTdGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3NldExpc3ROb2RlQ29sbGFwc2VTdGF0ZShub2RlLCBsaXN0SW5kZXgsIHJldmVhbGVkLCB1cGRhdGUpIHsKICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuX3NldE5vZGVDb2xsYXBzZVN0YXRlKG5vZGUsIHVwZGF0ZSwgZmFsc2UpOwogICAgICBpZiAoIXJldmVhbGVkIHx8ICFub2RlLnZpc2libGUgfHwgIXJlc3VsdCkgewogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgIH0KICAgICAgdmFyIHByZXZpb3VzUmVuZGVyTm9kZUNvdW50ID0gbm9kZS5yZW5kZXJOb2RlQ291bnQ7CiAgICAgIHZhciB0b0luc2VydCA9IHRoaXMudXBkYXRlTm9kZUFmdGVyQ29sbGFwc2VDaGFuZ2Uobm9kZSk7CiAgICAgIHZhciBkZWxldGVDb3VudCA9IHByZXZpb3VzUmVuZGVyTm9kZUNvdW50IC0gKGxpc3RJbmRleCA9PT0gLTEgPyAwIDogMSk7CiAgICAgIHRoaXMubGlzdC5zcGxpY2UobGlzdEluZGV4ICsgMSwgZGVsZXRlQ291bnQsIHRvSW5zZXJ0LnNsaWNlKDEpKTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfc2V0Tm9kZUNvbGxhcHNlU3RhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9zZXROb2RlQ29sbGFwc2VTdGF0ZShub2RlLCB1cGRhdGUsIGRlZXApIHsKICAgICAgdmFyIHJlc3VsdDsKICAgICAgaWYgKG5vZGUgPT09IHRoaXMucm9vdCkgewogICAgICAgIHJlc3VsdCA9IGZhbHNlOwogICAgICB9IGVsc2UgewogICAgICAgIGlmIChpc0NvbGxhcHNpYmxlU3RhdGVVcGRhdGUodXBkYXRlKSkgewogICAgICAgICAgcmVzdWx0ID0gbm9kZS5jb2xsYXBzaWJsZSAhPT0gdXBkYXRlLmNvbGxhcHNpYmxlOwogICAgICAgICAgbm9kZS5jb2xsYXBzaWJsZSA9IHVwZGF0ZS5jb2xsYXBzaWJsZTsKICAgICAgICB9IGVsc2UgaWYgKCFub2RlLmNvbGxhcHNpYmxlKSB7CiAgICAgICAgICByZXN1bHQgPSBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVzdWx0ID0gbm9kZS5jb2xsYXBzZWQgIT09IHVwZGF0ZS5jb2xsYXBzZWQ7CiAgICAgICAgICBub2RlLmNvbGxhcHNlZCA9IHVwZGF0ZS5jb2xsYXBzZWQ7CiAgICAgICAgfQogICAgICAgIGlmIChyZXN1bHQpIHsKICAgICAgICAgIHRoaXMuX29uRGlkQ2hhbmdlQ29sbGFwc2VTdGF0ZS5maXJlKHsKICAgICAgICAgICAgbm9kZTogbm9kZSwKICAgICAgICAgICAgZGVlcDogZGVlcAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICghaXNDb2xsYXBzaWJsZVN0YXRlVXBkYXRlKHVwZGF0ZSkgJiYgdXBkYXRlLnJlY3Vyc2l2ZSkgewogICAgICAgIHZhciBfaXRlcmF0b3I0ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIobm9kZS5jaGlsZHJlbiksCiAgICAgICAgICBfc3RlcDQ7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGZvciAoX2l0ZXJhdG9yNC5zKCk7ICEoX3N0ZXA0ID0gX2l0ZXJhdG9yNC5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgIHZhciBjaGlsZCA9IF9zdGVwNC52YWx1ZTsKICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5fc2V0Tm9kZUNvbGxhcHNlU3RhdGUoY2hpbGQsIHVwZGF0ZSwgdHJ1ZSkgfHwgcmVzdWx0OwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgX2l0ZXJhdG9yNC5lKGVycik7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIF9pdGVyYXRvcjQuZigpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH0sIHsKICAgIGtleTogImV4cGFuZFRvIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBleHBhbmRUbyhsb2NhdGlvbikgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKICAgICAgdGhpcy5ldmVudEJ1ZmZlcmVyLmJ1ZmZlckV2ZW50cyhmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIG5vZGUgPSBfdGhpczUuZ2V0VHJlZU5vZGUobG9jYXRpb24pOwogICAgICAgIHdoaWxlIChub2RlLnBhcmVudCkgewogICAgICAgICAgbm9kZSA9IG5vZGUucGFyZW50OwogICAgICAgICAgbG9jYXRpb24gPSBsb2NhdGlvbi5zbGljZSgwLCBsb2NhdGlvbi5sZW5ndGggLSAxKTsKICAgICAgICAgIGlmIChub2RlLmNvbGxhcHNlZCkgewogICAgICAgICAgICBfdGhpczUuX3NldENvbGxhcHNlU3RhdGUobG9jYXRpb24sIHsKICAgICAgICAgICAgICBjb2xsYXBzZWQ6IGZhbHNlLAogICAgICAgICAgICAgIHJlY3Vyc2l2ZTogZmFsc2UKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZWZpbHRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVmaWx0ZXIoKSB7CiAgICAgIHZhciBwcmV2aW91c1JlbmRlck5vZGVDb3VudCA9IHRoaXMucm9vdC5yZW5kZXJOb2RlQ291bnQ7CiAgICAgIHZhciB0b0luc2VydCA9IHRoaXMudXBkYXRlTm9kZUFmdGVyRmlsdGVyQ2hhbmdlKHRoaXMucm9vdCk7CiAgICAgIHRoaXMubGlzdC5zcGxpY2UoMCwgcHJldmlvdXNSZW5kZXJOb2RlQ291bnQsIHRvSW5zZXJ0KTsKICAgICAgdGhpcy5yZWZpbHRlckRlbGF5ZXIuY2FuY2VsKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY3JlYXRlVHJlZU5vZGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZVRyZWVOb2RlKHRyZWVFbGVtZW50LCBwYXJlbnQsIHBhcmVudFZpc2liaWxpdHksIHJldmVhbGVkLCB0cmVlTGlzdEVsZW1lbnRzLCBvbkRpZENyZWF0ZU5vZGUpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CiAgICAgIHZhciBub2RlID0gewogICAgICAgIHBhcmVudDogcGFyZW50LAogICAgICAgIGVsZW1lbnQ6IHRyZWVFbGVtZW50LmVsZW1lbnQsCiAgICAgICAgY2hpbGRyZW46IFtdLAogICAgICAgIGRlcHRoOiBwYXJlbnQuZGVwdGggKyAxLAogICAgICAgIHZpc2libGVDaGlsZHJlbkNvdW50OiAwLAogICAgICAgIHZpc2libGVDaGlsZEluZGV4OiAtMSwKICAgICAgICBjb2xsYXBzaWJsZTogdHlwZW9mIHRyZWVFbGVtZW50LmNvbGxhcHNpYmxlID09PSAnYm9vbGVhbicgPyB0cmVlRWxlbWVudC5jb2xsYXBzaWJsZSA6IHR5cGVvZiB0cmVlRWxlbWVudC5jb2xsYXBzZWQgIT09ICd1bmRlZmluZWQnLAogICAgICAgIGNvbGxhcHNlZDogdHlwZW9mIHRyZWVFbGVtZW50LmNvbGxhcHNlZCA9PT0gJ3VuZGVmaW5lZCcgPyB0aGlzLmNvbGxhcHNlQnlEZWZhdWx0IDogdHJlZUVsZW1lbnQuY29sbGFwc2VkLAogICAgICAgIHJlbmRlck5vZGVDb3VudDogMSwKICAgICAgICB2aXNpYmlsaXR5OiAxIC8qIFRyZWVWaXNpYmlsaXR5LlZpc2libGUgKi8sCiAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICBmaWx0ZXJEYXRhOiB1bmRlZmluZWQKICAgICAgfTsKICAgICAgdmFyIHZpc2liaWxpdHkgPSB0aGlzLl9maWx0ZXJOb2RlKG5vZGUsIHBhcmVudFZpc2liaWxpdHkpOwogICAgICBub2RlLnZpc2liaWxpdHkgPSB2aXNpYmlsaXR5OwogICAgICBpZiAocmV2ZWFsZWQpIHsKICAgICAgICB0cmVlTGlzdEVsZW1lbnRzLnB1c2gobm9kZSk7CiAgICAgIH0KICAgICAgdmFyIGNoaWxkRWxlbWVudHMgPSB0cmVlRWxlbWVudC5jaGlsZHJlbiB8fCBJdGVyYWJsZS5lbXB0eSgpOwogICAgICB2YXIgY2hpbGRSZXZlYWxlZCA9IHJldmVhbGVkICYmIHZpc2liaWxpdHkgIT09IDAgLyogVHJlZVZpc2liaWxpdHkuSGlkZGVuICovICYmICFub2RlLmNvbGxhcHNlZDsKICAgICAgdmFyIGNoaWxkTm9kZXMgPSBJdGVyYWJsZS5tYXAoY2hpbGRFbGVtZW50cywgZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgcmV0dXJuIF90aGlzNi5jcmVhdGVUcmVlTm9kZShlbCwgbm9kZSwgdmlzaWJpbGl0eSwgY2hpbGRSZXZlYWxlZCwgdHJlZUxpc3RFbGVtZW50cywgb25EaWRDcmVhdGVOb2RlKTsKICAgICAgfSk7CiAgICAgIHZhciB2aXNpYmxlQ2hpbGRyZW5Db3VudCA9IDA7CiAgICAgIHZhciByZW5kZXJOb2RlQ291bnQgPSAxOwogICAgICB2YXIgX2l0ZXJhdG9yNSA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKGNoaWxkTm9kZXMpLAogICAgICAgIF9zdGVwNTsKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjUucygpOyAhKF9zdGVwNSA9IF9pdGVyYXRvcjUubigpKS5kb25lOykgewogICAgICAgICAgdmFyIGNoaWxkID0gX3N0ZXA1LnZhbHVlOwogICAgICAgICAgbm9kZS5jaGlsZHJlbi5wdXNoKGNoaWxkKTsKICAgICAgICAgIHJlbmRlck5vZGVDb3VudCArPSBjaGlsZC5yZW5kZXJOb2RlQ291bnQ7CiAgICAgICAgICBpZiAoY2hpbGQudmlzaWJsZSkgewogICAgICAgICAgICBjaGlsZC52aXNpYmxlQ2hpbGRJbmRleCA9IHZpc2libGVDaGlsZHJlbkNvdW50Kys7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3I1LmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3I1LmYoKTsKICAgICAgfQogICAgICBub2RlLmNvbGxhcHNpYmxlID0gbm9kZS5jb2xsYXBzaWJsZSB8fCBub2RlLmNoaWxkcmVuLmxlbmd0aCA+IDA7CiAgICAgIG5vZGUudmlzaWJsZUNoaWxkcmVuQ291bnQgPSB2aXNpYmxlQ2hpbGRyZW5Db3VudDsKICAgICAgbm9kZS52aXNpYmxlID0gdmlzaWJpbGl0eSA9PT0gMiAvKiBUcmVlVmlzaWJpbGl0eS5SZWN1cnNlICovID8gdmlzaWJsZUNoaWxkcmVuQ291bnQgPiAwIDogdmlzaWJpbGl0eSA9PT0gMSAvKiBUcmVlVmlzaWJpbGl0eS5WaXNpYmxlICovOwogICAgICBpZiAoIW5vZGUudmlzaWJsZSkgewogICAgICAgIG5vZGUucmVuZGVyTm9kZUNvdW50ID0gMDsKICAgICAgICBpZiAocmV2ZWFsZWQpIHsKICAgICAgICAgIHRyZWVMaXN0RWxlbWVudHMucG9wKCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKCFub2RlLmNvbGxhcHNlZCkgewogICAgICAgIG5vZGUucmVuZGVyTm9kZUNvdW50ID0gcmVuZGVyTm9kZUNvdW50OwogICAgICB9CiAgICAgIG9uRGlkQ3JlYXRlTm9kZSA9PT0gbnVsbCB8fCBvbkRpZENyZWF0ZU5vZGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9uRGlkQ3JlYXRlTm9kZShub2RlKTsKICAgICAgcmV0dXJuIG5vZGU7CiAgICB9CiAgfSwgewogICAga2V5OiAidXBkYXRlTm9kZUFmdGVyQ29sbGFwc2VDaGFuZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZU5vZGVBZnRlckNvbGxhcHNlQ2hhbmdlKG5vZGUpIHsKICAgICAgdmFyIHByZXZpb3VzUmVuZGVyTm9kZUNvdW50ID0gbm9kZS5yZW5kZXJOb2RlQ291bnQ7CiAgICAgIHZhciByZXN1bHQgPSBbXTsKICAgICAgdGhpcy5fdXBkYXRlTm9kZUFmdGVyQ29sbGFwc2VDaGFuZ2Uobm9kZSwgcmVzdWx0KTsKICAgICAgdGhpcy5fdXBkYXRlQW5jZXN0b3JzUmVuZGVyTm9kZUNvdW50KG5vZGUucGFyZW50LCByZXN1bHQubGVuZ3RoIC0gcHJldmlvdXNSZW5kZXJOb2RlQ291bnQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogIH0sIHsKICAgIGtleTogIl91cGRhdGVOb2RlQWZ0ZXJDb2xsYXBzZUNoYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3VwZGF0ZU5vZGVBZnRlckNvbGxhcHNlQ2hhbmdlKG5vZGUsIHJlc3VsdCkgewogICAgICBpZiAobm9kZS52aXNpYmxlID09PSBmYWxzZSkgewogICAgICAgIHJldHVybiAwOwogICAgICB9CiAgICAgIHJlc3VsdC5wdXNoKG5vZGUpOwogICAgICBub2RlLnJlbmRlck5vZGVDb3VudCA9IDE7CiAgICAgIGlmICghbm9kZS5jb2xsYXBzZWQpIHsKICAgICAgICB2YXIgX2l0ZXJhdG9yNiA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKG5vZGUuY2hpbGRyZW4pLAogICAgICAgICAgX3N0ZXA2OwogICAgICAgIHRyeSB7CiAgICAgICAgICBmb3IgKF9pdGVyYXRvcjYucygpOyAhKF9zdGVwNiA9IF9pdGVyYXRvcjYubigpKS5kb25lOykgewogICAgICAgICAgICB2YXIgY2hpbGQgPSBfc3RlcDYudmFsdWU7CiAgICAgICAgICAgIG5vZGUucmVuZGVyTm9kZUNvdW50ICs9IHRoaXMuX3VwZGF0ZU5vZGVBZnRlckNvbGxhcHNlQ2hhbmdlKGNoaWxkLCByZXN1bHQpOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgX2l0ZXJhdG9yNi5lKGVycik7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIF9pdGVyYXRvcjYuZigpOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLl9vbkRpZENoYW5nZVJlbmRlck5vZGVDb3VudC5maXJlKG5vZGUpOwogICAgICByZXR1cm4gbm9kZS5yZW5kZXJOb2RlQ291bnQ7CiAgICB9CiAgfSwgewogICAga2V5OiAidXBkYXRlTm9kZUFmdGVyRmlsdGVyQ2hhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVOb2RlQWZ0ZXJGaWx0ZXJDaGFuZ2Uobm9kZSkgewogICAgICB2YXIgcHJldmlvdXNSZW5kZXJOb2RlQ291bnQgPSBub2RlLnJlbmRlck5vZGVDb3VudDsKICAgICAgdmFyIHJlc3VsdCA9IFtdOwogICAgICB0aGlzLl91cGRhdGVOb2RlQWZ0ZXJGaWx0ZXJDaGFuZ2Uobm9kZSwgbm9kZS52aXNpYmxlID8gMSAvKiBUcmVlVmlzaWJpbGl0eS5WaXNpYmxlICovIDogMCAvKiBUcmVlVmlzaWJpbGl0eS5IaWRkZW4gKi8sIHJlc3VsdCk7CiAgICAgIHRoaXMuX3VwZGF0ZUFuY2VzdG9yc1JlbmRlck5vZGVDb3VudChub2RlLnBhcmVudCwgcmVzdWx0Lmxlbmd0aCAtIHByZXZpb3VzUmVuZGVyTm9kZUNvdW50KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfdXBkYXRlTm9kZUFmdGVyRmlsdGVyQ2hhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfdXBkYXRlTm9kZUFmdGVyRmlsdGVyQ2hhbmdlKG5vZGUsIHBhcmVudFZpc2liaWxpdHksIHJlc3VsdCkgewogICAgICB2YXIgcmV2ZWFsZWQgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IHRydWU7CiAgICAgIHZhciB2aXNpYmlsaXR5OwogICAgICBpZiAobm9kZSAhPT0gdGhpcy5yb290KSB7CiAgICAgICAgdmlzaWJpbGl0eSA9IHRoaXMuX2ZpbHRlck5vZGUobm9kZSwgcGFyZW50VmlzaWJpbGl0eSk7CiAgICAgICAgaWYgKHZpc2liaWxpdHkgPT09IDAgLyogVHJlZVZpc2liaWxpdHkuSGlkZGVuICovKSB7CiAgICAgICAgICBub2RlLnZpc2libGUgPSBmYWxzZTsKICAgICAgICAgIG5vZGUucmVuZGVyTm9kZUNvdW50ID0gMDsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgaWYgKHJldmVhbGVkKSB7CiAgICAgICAgICByZXN1bHQucHVzaChub2RlKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgdmFyIHJlc3VsdFN0YXJ0TGVuZ3RoID0gcmVzdWx0Lmxlbmd0aDsKICAgICAgbm9kZS5yZW5kZXJOb2RlQ291bnQgPSBub2RlID09PSB0aGlzLnJvb3QgPyAwIDogMTsKICAgICAgdmFyIGhhc1Zpc2libGVEZXNjZW5kYW50cyA9IGZhbHNlOwogICAgICBpZiAoIW5vZGUuY29sbGFwc2VkIHx8IHZpc2liaWxpdHkgIT09IDAgLyogVHJlZVZpc2liaWxpdHkuSGlkZGVuICovKSB7CiAgICAgICAgdmFyIHZpc2libGVDaGlsZEluZGV4ID0gMDsKICAgICAgICB2YXIgX2l0ZXJhdG9yNyA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKG5vZGUuY2hpbGRyZW4pLAogICAgICAgICAgX3N0ZXA3OwogICAgICAgIHRyeSB7CiAgICAgICAgICBmb3IgKF9pdGVyYXRvcjcucygpOyAhKF9zdGVwNyA9IF9pdGVyYXRvcjcubigpKS5kb25lOykgewogICAgICAgICAgICB2YXIgY2hpbGQgPSBfc3RlcDcudmFsdWU7CiAgICAgICAgICAgIGhhc1Zpc2libGVEZXNjZW5kYW50cyA9IHRoaXMuX3VwZGF0ZU5vZGVBZnRlckZpbHRlckNoYW5nZShjaGlsZCwgdmlzaWJpbGl0eSwgcmVzdWx0LCByZXZlYWxlZCAmJiAhbm9kZS5jb2xsYXBzZWQpIHx8IGhhc1Zpc2libGVEZXNjZW5kYW50czsKICAgICAgICAgICAgaWYgKGNoaWxkLnZpc2libGUpIHsKICAgICAgICAgICAgICBjaGlsZC52aXNpYmxlQ2hpbGRJbmRleCA9IHZpc2libGVDaGlsZEluZGV4Kys7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIF9pdGVyYXRvcjcuZShlcnIpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBfaXRlcmF0b3I3LmYoKTsKICAgICAgICB9CiAgICAgICAgbm9kZS52aXNpYmxlQ2hpbGRyZW5Db3VudCA9IHZpc2libGVDaGlsZEluZGV4OwogICAgICB9IGVsc2UgewogICAgICAgIG5vZGUudmlzaWJsZUNoaWxkcmVuQ291bnQgPSAwOwogICAgICB9CiAgICAgIGlmIChub2RlICE9PSB0aGlzLnJvb3QpIHsKICAgICAgICBub2RlLnZpc2libGUgPSB2aXNpYmlsaXR5ID09PSAyIC8qIFRyZWVWaXNpYmlsaXR5LlJlY3Vyc2UgKi8gPyBoYXNWaXNpYmxlRGVzY2VuZGFudHMgOiB2aXNpYmlsaXR5ID09PSAxIC8qIFRyZWVWaXNpYmlsaXR5LlZpc2libGUgKi87CiAgICAgICAgbm9kZS52aXNpYmlsaXR5ID0gdmlzaWJpbGl0eTsKICAgICAgfQogICAgICBpZiAoIW5vZGUudmlzaWJsZSkgewogICAgICAgIG5vZGUucmVuZGVyTm9kZUNvdW50ID0gMDsKICAgICAgICBpZiAocmV2ZWFsZWQpIHsKICAgICAgICAgIHJlc3VsdC5wb3AoKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoIW5vZGUuY29sbGFwc2VkKSB7CiAgICAgICAgbm9kZS5yZW5kZXJOb2RlQ291bnQgKz0gcmVzdWx0Lmxlbmd0aCAtIHJlc3VsdFN0YXJ0TGVuZ3RoOwogICAgICB9CiAgICAgIHRoaXMuX29uRGlkQ2hhbmdlUmVuZGVyTm9kZUNvdW50LmZpcmUobm9kZSk7CiAgICAgIHJldHVybiBub2RlLnZpc2libGU7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3VwZGF0ZUFuY2VzdG9yc1JlbmRlck5vZGVDb3VudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3VwZGF0ZUFuY2VzdG9yc1JlbmRlck5vZGVDb3VudChub2RlLCBkaWZmKSB7CiAgICAgIGlmIChkaWZmID09PSAwKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHdoaWxlIChub2RlKSB7CiAgICAgICAgbm9kZS5yZW5kZXJOb2RlQ291bnQgKz0gZGlmZjsKICAgICAgICB0aGlzLl9vbkRpZENoYW5nZVJlbmRlck5vZGVDb3VudC5maXJlKG5vZGUpOwogICAgICAgIG5vZGUgPSBub2RlLnBhcmVudDsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogIl9maWx0ZXJOb2RlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZmlsdGVyTm9kZShub2RlLCBwYXJlbnRWaXNpYmlsaXR5KSB7CiAgICAgIHZhciByZXN1bHQgPSB0aGlzLmZpbHRlciA/IHRoaXMuZmlsdGVyLmZpbHRlcihub2RlLmVsZW1lbnQsIHBhcmVudFZpc2liaWxpdHkpIDogMSAvKiBUcmVlVmlzaWJpbGl0eS5WaXNpYmxlICovOwogICAgICBpZiAodHlwZW9mIHJlc3VsdCA9PT0gJ2Jvb2xlYW4nKSB7CiAgICAgICAgbm9kZS5maWx0ZXJEYXRhID0gdW5kZWZpbmVkOwogICAgICAgIHJldHVybiByZXN1bHQgPyAxIC8qIFRyZWVWaXNpYmlsaXR5LlZpc2libGUgKi8gOiAwIC8qIFRyZWVWaXNpYmlsaXR5LkhpZGRlbiAqLzsKICAgICAgfSBlbHNlIGlmIChpc0ZpbHRlclJlc3VsdChyZXN1bHQpKSB7CiAgICAgICAgbm9kZS5maWx0ZXJEYXRhID0gcmVzdWx0LmRhdGE7CiAgICAgICAgcmV0dXJuIGdldFZpc2libGVTdGF0ZShyZXN1bHQudmlzaWJpbGl0eSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbm9kZS5maWx0ZXJEYXRhID0gdW5kZWZpbmVkOwogICAgICAgIHJldHVybiBnZXRWaXNpYmxlU3RhdGUocmVzdWx0KTsKICAgICAgfQogICAgfQogICAgLy8gY2hlYXAKICB9LCB7CiAgICBrZXk6ICJoYXNUcmVlTm9kZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFzVHJlZU5vZGUobG9jYXRpb24pIHsKICAgICAgdmFyIG5vZGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHRoaXMucm9vdDsKICAgICAgaWYgKCFsb2NhdGlvbiB8fCBsb2NhdGlvbi5sZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgICB2YXIgX2xvY2F0aW9uID0gX3RvQXJyYXkobG9jYXRpb24pLAogICAgICAgIGluZGV4ID0gX2xvY2F0aW9uWzBdLAogICAgICAgIHJlc3QgPSBfbG9jYXRpb24uc2xpY2UoMSk7CiAgICAgIGlmIChpbmRleCA8IDAgfHwgaW5kZXggPiBub2RlLmNoaWxkcmVuLmxlbmd0aCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5oYXNUcmVlTm9kZShyZXN0LCBub2RlLmNoaWxkcmVuW2luZGV4XSk7CiAgICB9CiAgICAvLyBjaGVhcAogIH0sIHsKICAgIGtleTogImdldFRyZWVOb2RlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRUcmVlTm9kZShsb2NhdGlvbikgewogICAgICB2YXIgbm9kZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogdGhpcy5yb290OwogICAgICBpZiAoIWxvY2F0aW9uIHx8IGxvY2F0aW9uLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybiBub2RlOwogICAgICB9CiAgICAgIHZhciBfbG9jYXRpb24yID0gX3RvQXJyYXkobG9jYXRpb24pLAogICAgICAgIGluZGV4ID0gX2xvY2F0aW9uMlswXSwKICAgICAgICByZXN0ID0gX2xvY2F0aW9uMi5zbGljZSgxKTsKICAgICAgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+IG5vZGUuY2hpbGRyZW4ubGVuZ3RoKSB7CiAgICAgICAgdGhyb3cgbmV3IFRyZWVFcnJvcih0aGlzLnVzZXIsICdJbnZhbGlkIHRyZWUgbG9jYXRpb24nKTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5nZXRUcmVlTm9kZShyZXN0LCBub2RlLmNoaWxkcmVuW2luZGV4XSk7CiAgICB9CiAgICAvLyBleHBlbnNpdmUKICB9LCB7CiAgICBrZXk6ICJnZXRUcmVlTm9kZVdpdGhMaXN0SW5kZXgiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFRyZWVOb2RlV2l0aExpc3RJbmRleChsb2NhdGlvbikgewogICAgICBpZiAobG9jYXRpb24ubGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIG5vZGU6IHRoaXMucm9vdCwKICAgICAgICAgIGxpc3RJbmRleDogLTEsCiAgICAgICAgICByZXZlYWxlZDogdHJ1ZSwKICAgICAgICAgIHZpc2libGU6IGZhbHNlCiAgICAgICAgfTsKICAgICAgfQogICAgICB2YXIgX3RoaXMkZ2V0UGFyZW50Tm9kZVdpMyA9IHRoaXMuZ2V0UGFyZW50Tm9kZVdpdGhMaXN0SW5kZXgobG9jYXRpb24pLAogICAgICAgIHBhcmVudE5vZGUgPSBfdGhpcyRnZXRQYXJlbnROb2RlV2kzLnBhcmVudE5vZGUsCiAgICAgICAgbGlzdEluZGV4ID0gX3RoaXMkZ2V0UGFyZW50Tm9kZVdpMy5saXN0SW5kZXgsCiAgICAgICAgcmV2ZWFsZWQgPSBfdGhpcyRnZXRQYXJlbnROb2RlV2kzLnJldmVhbGVkLAogICAgICAgIHZpc2libGUgPSBfdGhpcyRnZXRQYXJlbnROb2RlV2kzLnZpc2libGU7CiAgICAgIHZhciBpbmRleCA9IGxvY2F0aW9uW2xvY2F0aW9uLmxlbmd0aCAtIDFdOwogICAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID4gcGFyZW50Tm9kZS5jaGlsZHJlbi5sZW5ndGgpIHsKICAgICAgICB0aHJvdyBuZXcgVHJlZUVycm9yKHRoaXMudXNlciwgJ0ludmFsaWQgdHJlZSBsb2NhdGlvbicpOwogICAgICB9CiAgICAgIHZhciBub2RlID0gcGFyZW50Tm9kZS5jaGlsZHJlbltpbmRleF07CiAgICAgIHJldHVybiB7CiAgICAgICAgbm9kZTogbm9kZSwKICAgICAgICBsaXN0SW5kZXg6IGxpc3RJbmRleCwKICAgICAgICByZXZlYWxlZDogcmV2ZWFsZWQsCiAgICAgICAgdmlzaWJsZTogdmlzaWJsZSAmJiBub2RlLnZpc2libGUKICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRQYXJlbnROb2RlV2l0aExpc3RJbmRleCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UGFyZW50Tm9kZVdpdGhMaXN0SW5kZXgobG9jYXRpb24pIHsKICAgICAgdmFyIG5vZGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHRoaXMucm9vdDsKICAgICAgdmFyIGxpc3RJbmRleCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogMDsKICAgICAgdmFyIHJldmVhbGVkID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiB0cnVlOwogICAgICB2YXIgdmlzaWJsZSA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ICYmIGFyZ3VtZW50c1s0XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzRdIDogdHJ1ZTsKICAgICAgdmFyIF9sb2NhdGlvbjMgPSBfdG9BcnJheShsb2NhdGlvbiksCiAgICAgICAgaW5kZXggPSBfbG9jYXRpb24zWzBdLAogICAgICAgIHJlc3QgPSBfbG9jYXRpb24zLnNsaWNlKDEpOwogICAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID4gbm9kZS5jaGlsZHJlbi5sZW5ndGgpIHsKICAgICAgICB0aHJvdyBuZXcgVHJlZUVycm9yKHRoaXMudXNlciwgJ0ludmFsaWQgdHJlZSBsb2NhdGlvbicpOwogICAgICB9CiAgICAgIC8vIFRPRE9Aam9hbyBwZXJmIQogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGluZGV4OyBpKyspIHsKICAgICAgICBsaXN0SW5kZXggKz0gbm9kZS5jaGlsZHJlbltpXS5yZW5kZXJOb2RlQ291bnQ7CiAgICAgIH0KICAgICAgcmV2ZWFsZWQgPSByZXZlYWxlZCAmJiAhbm9kZS5jb2xsYXBzZWQ7CiAgICAgIHZpc2libGUgPSB2aXNpYmxlICYmIG5vZGUudmlzaWJsZTsKICAgICAgaWYgKHJlc3QubGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHBhcmVudE5vZGU6IG5vZGUsCiAgICAgICAgICBsaXN0SW5kZXg6IGxpc3RJbmRleCwKICAgICAgICAgIHJldmVhbGVkOiByZXZlYWxlZCwKICAgICAgICAgIHZpc2libGU6IHZpc2libGUKICAgICAgICB9OwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLmdldFBhcmVudE5vZGVXaXRoTGlzdEluZGV4KHJlc3QsIG5vZGUuY2hpbGRyZW5baW5kZXhdLCBsaXN0SW5kZXggKyAxLCByZXZlYWxlZCwgdmlzaWJsZSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0Tm9kZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Tm9kZSgpIHsKICAgICAgdmFyIGxvY2F0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBbXTsKICAgICAgcmV0dXJuIHRoaXMuZ2V0VHJlZU5vZGUobG9jYXRpb24pOwogICAgfQogICAgLy8gVE9ET0Bqb2FvIHBlcmYhCiAgfSwgewogICAga2V5OiAiZ2V0Tm9kZUxvY2F0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXROb2RlTG9jYXRpb24obm9kZSkgewogICAgICB2YXIgbG9jYXRpb24gPSBbXTsKICAgICAgdmFyIGluZGV4VHJlZU5vZGUgPSBub2RlOyAvLyB0eXBpbmcgd29lcwogICAgICB3aGlsZSAoaW5kZXhUcmVlTm9kZS5wYXJlbnQpIHsKICAgICAgICBsb2NhdGlvbi5wdXNoKGluZGV4VHJlZU5vZGUucGFyZW50LmNoaWxkcmVuLmluZGV4T2YoaW5kZXhUcmVlTm9kZSkpOwogICAgICAgIGluZGV4VHJlZU5vZGUgPSBpbmRleFRyZWVOb2RlLnBhcmVudDsKICAgICAgfQogICAgICByZXR1cm4gbG9jYXRpb24ucmV2ZXJzZSgpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFBhcmVudE5vZGVMb2NhdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UGFyZW50Tm9kZUxvY2F0aW9uKGxvY2F0aW9uKSB7CiAgICAgIGlmIChsb2NhdGlvbi5sZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICB9IGVsc2UgaWYgKGxvY2F0aW9uLmxlbmd0aCA9PT0gMSkgewogICAgICAgIHJldHVybiBbXTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdGFpbDIobG9jYXRpb24pWzBdOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0Rmlyc3RFbGVtZW50Q2hpbGQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEZpcnN0RWxlbWVudENoaWxkKGxvY2F0aW9uKSB7CiAgICAgIHZhciBub2RlID0gdGhpcy5nZXRUcmVlTm9kZShsb2NhdGlvbik7CiAgICAgIGlmIChub2RlLmNoaWxkcmVuLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgIH0KICAgICAgcmV0dXJuIG5vZGUuY2hpbGRyZW5bMF0uZWxlbWVudDsKICAgIH0KICB9XSk7CiAgcmV0dXJuIEluZGV4VHJlZU1vZGVsOwp9KCk7"},{"version":3,"names":["TreeError","splice","tail2","Delayer","MicrotaskDelay","LcsDiff","Emitter","EventBufferer","Iterable","isFilterResult","obj","getVisibleState","visibility","isCollapsibleStateUpdate","update","collapsible","IndexTreeModel","user","list","rootElement","options","rootRef","eventBufferer","_onDidChangeCollapseState","onDidChangeCollapseState","wrapEvent","event","_onDidChangeRenderNodeCount","onDidChangeRenderNodeCount","_onDidSplice","onDidSplice","refilterDelayer","collapseByDefault","filter","autoExpandSingleChildren","root","parent","undefined","element","children","depth","visibleChildrenCount","visibleChildIndex","collapsed","renderNodeCount","visible","filterData","location","deleteCount","toInsert","empty","length","diffIdentityProvider","spliceSmart","spliceSimple","identity","toInsertIterable","recurseLevels","_a","diffDepth","getParentNodeWithListIndex","parentNode","lastDiffIds","index","diff","getElements","slice","map","e","getId","toString","ComputeDiff","quitEarly","locationPrefix","recurseSplice","fromOriginal","fromModified","count","i","Number","MAX_SAFE_INTEGER","lastStartO","Math","min","lastStartM","changes","sort","a","b","originalStart","change","originalLength","modifiedStart","modifiedLength","onDidCreateNode","onDidDeleteNode","listIndex","revealed","treeListElementsToInsert","nodesToInsertIterator","el","createTreeNode","lastIndex","lastHadChildren","visibleChildStartIndex","child","nodesToInsert","insertedVisibleChildrenCount","push","deletedNodes","n","deletedVisibleChildrenCount","visibleDeleteCount","reduce","r","node","_updateAncestorsRenderNodeCount","visit","forEach","fire","insertedNodes","currentlyHasChildren","setCollapsible","trigger","refilter","getTreeNodeWithListIndex","hasTreeNode","getTreeNode","bufferEvents","_setCollapseState","recursive","result","_setListNodeCollapseState","onlyVisibleChildIndex","_setNodeCollapseState","previousRenderNodeCount","updateNodeAfterCollapseChange","deep","updateNodeAfterFilterChange","cancel","treeElement","parentVisibility","treeListElements","_filterNode","childElements","childRevealed","childNodes","pop","_updateNodeAfterCollapseChange","_updateNodeAfterFilterChange","resultStartLength","hasVisibleDescendants","data","rest","indexTreeNode","indexOf","reverse"],"sources":["/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/base/browser/ui/tree/indexTreeModel.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { TreeError } from './tree.js';\nimport { splice, tail2 } from '../../../common/arrays.js';\nimport { Delayer, MicrotaskDelay } from '../../../common/async.js';\nimport { LcsDiff } from '../../../common/diff/diff.js';\nimport { Emitter, EventBufferer } from '../../../common/event.js';\nimport { Iterable } from '../../../common/iterator.js';\nexport function isFilterResult(obj) {\n    return typeof obj === 'object' && 'visibility' in obj && 'data' in obj;\n}\nexport function getVisibleState(visibility) {\n    switch (visibility) {\n        case true: return 1 /* TreeVisibility.Visible */;\n        case false: return 0 /* TreeVisibility.Hidden */;\n        default: return visibility;\n    }\n}\nfunction isCollapsibleStateUpdate(update) {\n    return typeof update.collapsible === 'boolean';\n}\nexport class IndexTreeModel {\n    constructor(user, list, rootElement, options = {}) {\n        this.user = user;\n        this.list = list;\n        this.rootRef = [];\n        this.eventBufferer = new EventBufferer();\n        this._onDidChangeCollapseState = new Emitter();\n        this.onDidChangeCollapseState = this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event);\n        this._onDidChangeRenderNodeCount = new Emitter();\n        this.onDidChangeRenderNodeCount = this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event);\n        this._onDidSplice = new Emitter();\n        this.onDidSplice = this._onDidSplice.event;\n        this.refilterDelayer = new Delayer(MicrotaskDelay);\n        this.collapseByDefault = typeof options.collapseByDefault === 'undefined' ? false : options.collapseByDefault;\n        this.filter = options.filter;\n        this.autoExpandSingleChildren = typeof options.autoExpandSingleChildren === 'undefined' ? false : options.autoExpandSingleChildren;\n        this.root = {\n            parent: undefined,\n            element: rootElement,\n            children: [],\n            depth: 0,\n            visibleChildrenCount: 0,\n            visibleChildIndex: -1,\n            collapsible: false,\n            collapsed: false,\n            renderNodeCount: 0,\n            visibility: 1 /* TreeVisibility.Visible */,\n            visible: true,\n            filterData: undefined\n        };\n    }\n    splice(location, deleteCount, toInsert = Iterable.empty(), options = {}) {\n        if (location.length === 0) {\n            throw new TreeError(this.user, 'Invalid tree location');\n        }\n        if (options.diffIdentityProvider) {\n            this.spliceSmart(options.diffIdentityProvider, location, deleteCount, toInsert, options);\n        }\n        else {\n            this.spliceSimple(location, deleteCount, toInsert, options);\n        }\n    }\n    spliceSmart(identity, location, deleteCount, toInsertIterable, options, recurseLevels) {\n        var _a;\n        if (toInsertIterable === void 0) { toInsertIterable = Iterable.empty(); }\n        if (recurseLevels === void 0) { recurseLevels = (_a = options.diffDepth) !== null && _a !== void 0 ? _a : 0; }\n        const { parentNode } = this.getParentNodeWithListIndex(location);\n        if (!parentNode.lastDiffIds) {\n            return this.spliceSimple(location, deleteCount, toInsertIterable, options);\n        }\n        const toInsert = [...toInsertIterable];\n        const index = location[location.length - 1];\n        const diff = new LcsDiff({ getElements: () => parentNode.lastDiffIds }, {\n            getElements: () => [\n                ...parentNode.children.slice(0, index),\n                ...toInsert,\n                ...parentNode.children.slice(index + deleteCount),\n            ].map(e => identity.getId(e.element).toString())\n        }).ComputeDiff(false);\n        // if we were given a 'best effort' diff, use default behavior\n        if (diff.quitEarly) {\n            parentNode.lastDiffIds = undefined;\n            return this.spliceSimple(location, deleteCount, toInsert, options);\n        }\n        const locationPrefix = location.slice(0, -1);\n        const recurseSplice = (fromOriginal, fromModified, count) => {\n            if (recurseLevels > 0) {\n                for (let i = 0; i < count; i++) {\n                    fromOriginal--;\n                    fromModified--;\n                    this.spliceSmart(identity, [...locationPrefix, fromOriginal, 0], Number.MAX_SAFE_INTEGER, toInsert[fromModified].children, options, recurseLevels - 1);\n                }\n            }\n        };\n        let lastStartO = Math.min(parentNode.children.length, index + deleteCount);\n        let lastStartM = toInsert.length;\n        for (const change of diff.changes.sort((a, b) => b.originalStart - a.originalStart)) {\n            recurseSplice(lastStartO, lastStartM, lastStartO - (change.originalStart + change.originalLength));\n            lastStartO = change.originalStart;\n            lastStartM = change.modifiedStart - index;\n            this.spliceSimple([...locationPrefix, lastStartO], change.originalLength, Iterable.slice(toInsert, lastStartM, lastStartM + change.modifiedLength), options);\n        }\n        // at this point, startO === startM === count since any remaining prefix should match\n        recurseSplice(lastStartO, lastStartM, lastStartO);\n    }\n    spliceSimple(location, deleteCount, toInsert = Iterable.empty(), { onDidCreateNode, onDidDeleteNode, diffIdentityProvider }) {\n        const { parentNode, listIndex, revealed, visible } = this.getParentNodeWithListIndex(location);\n        const treeListElementsToInsert = [];\n        const nodesToInsertIterator = Iterable.map(toInsert, el => this.createTreeNode(el, parentNode, parentNode.visible ? 1 /* TreeVisibility.Visible */ : 0 /* TreeVisibility.Hidden */, revealed, treeListElementsToInsert, onDidCreateNode));\n        const lastIndex = location[location.length - 1];\n        const lastHadChildren = parentNode.children.length > 0;\n        // figure out what's the visible child start index right before the\n        // splice point\n        let visibleChildStartIndex = 0;\n        for (let i = lastIndex; i >= 0 && i < parentNode.children.length; i--) {\n            const child = parentNode.children[i];\n            if (child.visible) {\n                visibleChildStartIndex = child.visibleChildIndex;\n                break;\n            }\n        }\n        const nodesToInsert = [];\n        let insertedVisibleChildrenCount = 0;\n        let renderNodeCount = 0;\n        for (const child of nodesToInsertIterator) {\n            nodesToInsert.push(child);\n            renderNodeCount += child.renderNodeCount;\n            if (child.visible) {\n                child.visibleChildIndex = visibleChildStartIndex + insertedVisibleChildrenCount++;\n            }\n        }\n        const deletedNodes = splice(parentNode.children, lastIndex, deleteCount, nodesToInsert);\n        if (!diffIdentityProvider) {\n            parentNode.lastDiffIds = undefined;\n        }\n        else if (parentNode.lastDiffIds) {\n            splice(parentNode.lastDiffIds, lastIndex, deleteCount, nodesToInsert.map(n => diffIdentityProvider.getId(n.element).toString()));\n        }\n        else {\n            parentNode.lastDiffIds = parentNode.children.map(n => diffIdentityProvider.getId(n.element).toString());\n        }\n        // figure out what is the count of deleted visible children\n        let deletedVisibleChildrenCount = 0;\n        for (const child of deletedNodes) {\n            if (child.visible) {\n                deletedVisibleChildrenCount++;\n            }\n        }\n        // and adjust for all visible children after the splice point\n        if (deletedVisibleChildrenCount !== 0) {\n            for (let i = lastIndex + nodesToInsert.length; i < parentNode.children.length; i++) {\n                const child = parentNode.children[i];\n                if (child.visible) {\n                    child.visibleChildIndex -= deletedVisibleChildrenCount;\n                }\n            }\n        }\n        // update parent's visible children count\n        parentNode.visibleChildrenCount += insertedVisibleChildrenCount - deletedVisibleChildrenCount;\n        if (revealed && visible) {\n            const visibleDeleteCount = deletedNodes.reduce((r, node) => r + (node.visible ? node.renderNodeCount : 0), 0);\n            this._updateAncestorsRenderNodeCount(parentNode, renderNodeCount - visibleDeleteCount);\n            this.list.splice(listIndex, visibleDeleteCount, treeListElementsToInsert);\n        }\n        if (deletedNodes.length > 0 && onDidDeleteNode) {\n            const visit = (node) => {\n                onDidDeleteNode(node);\n                node.children.forEach(visit);\n            };\n            deletedNodes.forEach(visit);\n        }\n        this._onDidSplice.fire({ insertedNodes: nodesToInsert, deletedNodes });\n        const currentlyHasChildren = parentNode.children.length > 0;\n        if (lastHadChildren !== currentlyHasChildren) {\n            this.setCollapsible(location.slice(0, -1), currentlyHasChildren);\n        }\n        let node = parentNode;\n        while (node) {\n            if (node.visibility === 2 /* TreeVisibility.Recurse */) {\n                // delayed to avoid excessive refiltering, see #135941\n                this.refilterDelayer.trigger(() => this.refilter());\n                break;\n            }\n            node = node.parent;\n        }\n    }\n    rerender(location) {\n        if (location.length === 0) {\n            throw new TreeError(this.user, 'Invalid tree location');\n        }\n        const { node, listIndex, revealed } = this.getTreeNodeWithListIndex(location);\n        if (node.visible && revealed) {\n            this.list.splice(listIndex, 1, [node]);\n        }\n    }\n    has(location) {\n        return this.hasTreeNode(location);\n    }\n    getListIndex(location) {\n        const { listIndex, visible, revealed } = this.getTreeNodeWithListIndex(location);\n        return visible && revealed ? listIndex : -1;\n    }\n    getListRenderCount(location) {\n        return this.getTreeNode(location).renderNodeCount;\n    }\n    isCollapsible(location) {\n        return this.getTreeNode(location).collapsible;\n    }\n    setCollapsible(location, collapsible) {\n        const node = this.getTreeNode(location);\n        if (typeof collapsible === 'undefined') {\n            collapsible = !node.collapsible;\n        }\n        const update = { collapsible };\n        return this.eventBufferer.bufferEvents(() => this._setCollapseState(location, update));\n    }\n    isCollapsed(location) {\n        return this.getTreeNode(location).collapsed;\n    }\n    setCollapsed(location, collapsed, recursive) {\n        const node = this.getTreeNode(location);\n        if (typeof collapsed === 'undefined') {\n            collapsed = !node.collapsed;\n        }\n        const update = { collapsed, recursive: recursive || false };\n        return this.eventBufferer.bufferEvents(() => this._setCollapseState(location, update));\n    }\n    _setCollapseState(location, update) {\n        const { node, listIndex, revealed } = this.getTreeNodeWithListIndex(location);\n        const result = this._setListNodeCollapseState(node, listIndex, revealed, update);\n        if (node !== this.root && this.autoExpandSingleChildren && result && !isCollapsibleStateUpdate(update) && node.collapsible && !node.collapsed && !update.recursive) {\n            let onlyVisibleChildIndex = -1;\n            for (let i = 0; i < node.children.length; i++) {\n                const child = node.children[i];\n                if (child.visible) {\n                    if (onlyVisibleChildIndex > -1) {\n                        onlyVisibleChildIndex = -1;\n                        break;\n                    }\n                    else {\n                        onlyVisibleChildIndex = i;\n                    }\n                }\n            }\n            if (onlyVisibleChildIndex > -1) {\n                this._setCollapseState([...location, onlyVisibleChildIndex], update);\n            }\n        }\n        return result;\n    }\n    _setListNodeCollapseState(node, listIndex, revealed, update) {\n        const result = this._setNodeCollapseState(node, update, false);\n        if (!revealed || !node.visible || !result) {\n            return result;\n        }\n        const previousRenderNodeCount = node.renderNodeCount;\n        const toInsert = this.updateNodeAfterCollapseChange(node);\n        const deleteCount = previousRenderNodeCount - (listIndex === -1 ? 0 : 1);\n        this.list.splice(listIndex + 1, deleteCount, toInsert.slice(1));\n        return result;\n    }\n    _setNodeCollapseState(node, update, deep) {\n        let result;\n        if (node === this.root) {\n            result = false;\n        }\n        else {\n            if (isCollapsibleStateUpdate(update)) {\n                result = node.collapsible !== update.collapsible;\n                node.collapsible = update.collapsible;\n            }\n            else if (!node.collapsible) {\n                result = false;\n            }\n            else {\n                result = node.collapsed !== update.collapsed;\n                node.collapsed = update.collapsed;\n            }\n            if (result) {\n                this._onDidChangeCollapseState.fire({ node, deep });\n            }\n        }\n        if (!isCollapsibleStateUpdate(update) && update.recursive) {\n            for (const child of node.children) {\n                result = this._setNodeCollapseState(child, update, true) || result;\n            }\n        }\n        return result;\n    }\n    expandTo(location) {\n        this.eventBufferer.bufferEvents(() => {\n            let node = this.getTreeNode(location);\n            while (node.parent) {\n                node = node.parent;\n                location = location.slice(0, location.length - 1);\n                if (node.collapsed) {\n                    this._setCollapseState(location, { collapsed: false, recursive: false });\n                }\n            }\n        });\n    }\n    refilter() {\n        const previousRenderNodeCount = this.root.renderNodeCount;\n        const toInsert = this.updateNodeAfterFilterChange(this.root);\n        this.list.splice(0, previousRenderNodeCount, toInsert);\n        this.refilterDelayer.cancel();\n    }\n    createTreeNode(treeElement, parent, parentVisibility, revealed, treeListElements, onDidCreateNode) {\n        const node = {\n            parent,\n            element: treeElement.element,\n            children: [],\n            depth: parent.depth + 1,\n            visibleChildrenCount: 0,\n            visibleChildIndex: -1,\n            collapsible: typeof treeElement.collapsible === 'boolean' ? treeElement.collapsible : (typeof treeElement.collapsed !== 'undefined'),\n            collapsed: typeof treeElement.collapsed === 'undefined' ? this.collapseByDefault : treeElement.collapsed,\n            renderNodeCount: 1,\n            visibility: 1 /* TreeVisibility.Visible */,\n            visible: true,\n            filterData: undefined\n        };\n        const visibility = this._filterNode(node, parentVisibility);\n        node.visibility = visibility;\n        if (revealed) {\n            treeListElements.push(node);\n        }\n        const childElements = treeElement.children || Iterable.empty();\n        const childRevealed = revealed && visibility !== 0 /* TreeVisibility.Hidden */ && !node.collapsed;\n        const childNodes = Iterable.map(childElements, el => this.createTreeNode(el, node, visibility, childRevealed, treeListElements, onDidCreateNode));\n        let visibleChildrenCount = 0;\n        let renderNodeCount = 1;\n        for (const child of childNodes) {\n            node.children.push(child);\n            renderNodeCount += child.renderNodeCount;\n            if (child.visible) {\n                child.visibleChildIndex = visibleChildrenCount++;\n            }\n        }\n        node.collapsible = node.collapsible || node.children.length > 0;\n        node.visibleChildrenCount = visibleChildrenCount;\n        node.visible = visibility === 2 /* TreeVisibility.Recurse */ ? visibleChildrenCount > 0 : (visibility === 1 /* TreeVisibility.Visible */);\n        if (!node.visible) {\n            node.renderNodeCount = 0;\n            if (revealed) {\n                treeListElements.pop();\n            }\n        }\n        else if (!node.collapsed) {\n            node.renderNodeCount = renderNodeCount;\n        }\n        onDidCreateNode === null || onDidCreateNode === void 0 ? void 0 : onDidCreateNode(node);\n        return node;\n    }\n    updateNodeAfterCollapseChange(node) {\n        const previousRenderNodeCount = node.renderNodeCount;\n        const result = [];\n        this._updateNodeAfterCollapseChange(node, result);\n        this._updateAncestorsRenderNodeCount(node.parent, result.length - previousRenderNodeCount);\n        return result;\n    }\n    _updateNodeAfterCollapseChange(node, result) {\n        if (node.visible === false) {\n            return 0;\n        }\n        result.push(node);\n        node.renderNodeCount = 1;\n        if (!node.collapsed) {\n            for (const child of node.children) {\n                node.renderNodeCount += this._updateNodeAfterCollapseChange(child, result);\n            }\n        }\n        this._onDidChangeRenderNodeCount.fire(node);\n        return node.renderNodeCount;\n    }\n    updateNodeAfterFilterChange(node) {\n        const previousRenderNodeCount = node.renderNodeCount;\n        const result = [];\n        this._updateNodeAfterFilterChange(node, node.visible ? 1 /* TreeVisibility.Visible */ : 0 /* TreeVisibility.Hidden */, result);\n        this._updateAncestorsRenderNodeCount(node.parent, result.length - previousRenderNodeCount);\n        return result;\n    }\n    _updateNodeAfterFilterChange(node, parentVisibility, result, revealed = true) {\n        let visibility;\n        if (node !== this.root) {\n            visibility = this._filterNode(node, parentVisibility);\n            if (visibility === 0 /* TreeVisibility.Hidden */) {\n                node.visible = false;\n                node.renderNodeCount = 0;\n                return false;\n            }\n            if (revealed) {\n                result.push(node);\n            }\n        }\n        const resultStartLength = result.length;\n        node.renderNodeCount = node === this.root ? 0 : 1;\n        let hasVisibleDescendants = false;\n        if (!node.collapsed || visibility !== 0 /* TreeVisibility.Hidden */) {\n            let visibleChildIndex = 0;\n            for (const child of node.children) {\n                hasVisibleDescendants = this._updateNodeAfterFilterChange(child, visibility, result, revealed && !node.collapsed) || hasVisibleDescendants;\n                if (child.visible) {\n                    child.visibleChildIndex = visibleChildIndex++;\n                }\n            }\n            node.visibleChildrenCount = visibleChildIndex;\n        }\n        else {\n            node.visibleChildrenCount = 0;\n        }\n        if (node !== this.root) {\n            node.visible = visibility === 2 /* TreeVisibility.Recurse */ ? hasVisibleDescendants : (visibility === 1 /* TreeVisibility.Visible */);\n            node.visibility = visibility;\n        }\n        if (!node.visible) {\n            node.renderNodeCount = 0;\n            if (revealed) {\n                result.pop();\n            }\n        }\n        else if (!node.collapsed) {\n            node.renderNodeCount += result.length - resultStartLength;\n        }\n        this._onDidChangeRenderNodeCount.fire(node);\n        return node.visible;\n    }\n    _updateAncestorsRenderNodeCount(node, diff) {\n        if (diff === 0) {\n            return;\n        }\n        while (node) {\n            node.renderNodeCount += diff;\n            this._onDidChangeRenderNodeCount.fire(node);\n            node = node.parent;\n        }\n    }\n    _filterNode(node, parentVisibility) {\n        const result = this.filter ? this.filter.filter(node.element, parentVisibility) : 1 /* TreeVisibility.Visible */;\n        if (typeof result === 'boolean') {\n            node.filterData = undefined;\n            return result ? 1 /* TreeVisibility.Visible */ : 0 /* TreeVisibility.Hidden */;\n        }\n        else if (isFilterResult(result)) {\n            node.filterData = result.data;\n            return getVisibleState(result.visibility);\n        }\n        else {\n            node.filterData = undefined;\n            return getVisibleState(result);\n        }\n    }\n    // cheap\n    hasTreeNode(location, node = this.root) {\n        if (!location || location.length === 0) {\n            return true;\n        }\n        const [index, ...rest] = location;\n        if (index < 0 || index > node.children.length) {\n            return false;\n        }\n        return this.hasTreeNode(rest, node.children[index]);\n    }\n    // cheap\n    getTreeNode(location, node = this.root) {\n        if (!location || location.length === 0) {\n            return node;\n        }\n        const [index, ...rest] = location;\n        if (index < 0 || index > node.children.length) {\n            throw new TreeError(this.user, 'Invalid tree location');\n        }\n        return this.getTreeNode(rest, node.children[index]);\n    }\n    // expensive\n    getTreeNodeWithListIndex(location) {\n        if (location.length === 0) {\n            return { node: this.root, listIndex: -1, revealed: true, visible: false };\n        }\n        const { parentNode, listIndex, revealed, visible } = this.getParentNodeWithListIndex(location);\n        const index = location[location.length - 1];\n        if (index < 0 || index > parentNode.children.length) {\n            throw new TreeError(this.user, 'Invalid tree location');\n        }\n        const node = parentNode.children[index];\n        return { node, listIndex, revealed, visible: visible && node.visible };\n    }\n    getParentNodeWithListIndex(location, node = this.root, listIndex = 0, revealed = true, visible = true) {\n        const [index, ...rest] = location;\n        if (index < 0 || index > node.children.length) {\n            throw new TreeError(this.user, 'Invalid tree location');\n        }\n        // TODO@joao perf!\n        for (let i = 0; i < index; i++) {\n            listIndex += node.children[i].renderNodeCount;\n        }\n        revealed = revealed && !node.collapsed;\n        visible = visible && node.visible;\n        if (rest.length === 0) {\n            return { parentNode: node, listIndex, revealed, visible };\n        }\n        return this.getParentNodeWithListIndex(rest, node.children[index], listIndex + 1, revealed, visible);\n    }\n    getNode(location = []) {\n        return this.getTreeNode(location);\n    }\n    // TODO@joao perf!\n    getNodeLocation(node) {\n        const location = [];\n        let indexTreeNode = node; // typing woes\n        while (indexTreeNode.parent) {\n            location.push(indexTreeNode.parent.children.indexOf(indexTreeNode));\n            indexTreeNode = indexTreeNode.parent;\n        }\n        return location.reverse();\n    }\n    getParentNodeLocation(location) {\n        if (location.length === 0) {\n            return undefined;\n        }\n        else if (location.length === 1) {\n            return [];\n        }\n        else {\n            return tail2(location)[0];\n        }\n    }\n    getFirstElementChild(location) {\n        const node = this.getTreeNode(location);\n        if (node.children.length === 0) {\n            return undefined;\n        }\n        return node.children[0].element;\n    }\n}\n"],"mappings":"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"}]}