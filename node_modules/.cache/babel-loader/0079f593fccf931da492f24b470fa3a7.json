{"remainingRequest":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js!/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/base/browser/ui/list/listWidget.js","dependencies":[{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/base/browser/ui/list/listWidget.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/babel.config.js","mtime":1668271197000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9yZWdlbmVyYXRvclJ1bnRpbWUuanMiOwppbXBvcnQgX2dldCBmcm9tICIvVXNlcnMveWFuamlhamlhL0Rlc2t0b3Avd29ya3NwYWNlL2F2dWUtZGF0YS1uZXcvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2dldC5qcyI7CmltcG9ydCBfZ2V0UHJvdG90eXBlT2YgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9nZXRQcm90b3R5cGVPZi5qcyI7CmltcG9ydCBfaW5oZXJpdHMgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9pbmhlcml0cy5qcyI7CmltcG9ydCBfY3JlYXRlU3VwZXIgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVTdXBlci5qcyI7CmltcG9ydCBfdG9Db25zdW1hYmxlQXJyYXkgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheS5qcyI7CmltcG9ydCBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciBmcm9tICIvVXNlcnMveWFuamlhamlhL0Rlc2t0b3Avd29ya3NwYWNlL2F2dWUtZGF0YS1uZXcvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIuanMiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2suanMiOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MuanMiOwppbXBvcnQgX3R5cGVvZiBmcm9tICIvVXNlcnMveWFuamlhamlhL0Rlc2t0b3Avd29ya3NwYWNlL2F2dWUtZGF0YS1uZXcvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3R5cGVvZi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVmbGVjdC50by1zdHJpbmctdGFnLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQtaW5kZXguanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc3BsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNvcnQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnJlZHVjZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuYW5jaG9yLmpzIjsKLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLgogKiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi4KICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCnZhciBfX2RlY29yYXRlID0gdGhpcyAmJiB0aGlzLl9fZGVjb3JhdGUgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7CiAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLAogICAgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsCiAgICBkOwogIGlmICgodHlwZW9mIFJlZmxlY3QgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKFJlZmxlY3QpKSA9PT0gIm9iamVjdCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09ICJmdW5jdGlvbiIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByOwogIH0KICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByOwp9Owp2YXIgX19hd2FpdGVyID0gdGhpcyAmJiB0aGlzLl9fYXdhaXRlciB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7CiAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsKICAgIHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgIHJlc29sdmUodmFsdWUpOwogICAgfSk7CiAgfQogIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7CiAgICAgIHRyeSB7CiAgICAgICAgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgcmVqZWN0KGUpOwogICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgewogICAgICB0cnkgewogICAgICAgIHN0ZXAoZ2VuZXJhdG9yWyJ0aHJvdyJdKHZhbHVlKSk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICByZWplY3QoZSk7CiAgICAgIH0KICAgIH0KICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7CiAgICAgIHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOwogICAgfQogICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpOwogIH0pOwp9OwppbXBvcnQgeyBjcmVhdGVTdHlsZVNoZWV0IH0gZnJvbSAnLi4vLi4vZG9tLmpzJzsKaW1wb3J0IHsgRG9tRW1pdHRlciwgc3RvcEV2ZW50IH0gZnJvbSAnLi4vLi4vZXZlbnQuanMnOwppbXBvcnQgeyBTdGFuZGFyZEtleWJvYXJkRXZlbnQgfSBmcm9tICcuLi8uLi9rZXlib2FyZEV2ZW50LmpzJzsKaW1wb3J0IHsgR2VzdHVyZSB9IGZyb20gJy4uLy4uL3RvdWNoLmpzJzsKaW1wb3J0IHsgYWxlcnQgfSBmcm9tICcuLi9hcmlhL2FyaWEuanMnOwppbXBvcnQgeyBDb21iaW5lZFNwbGljZWFibGUgfSBmcm9tICcuL3NwbGljZS5qcyc7CmltcG9ydCB7IGJpbmFyeVNlYXJjaCwgZmlyc3RPckRlZmF1bHQsIHJhbmdlIH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL2FycmF5cy5qcyc7CmltcG9ydCB7IHRpbWVvdXQgfSBmcm9tICcuLi8uLi8uLi9jb21tb24vYXN5bmMuanMnOwppbXBvcnQgeyBDb2xvciB9IGZyb20gJy4uLy4uLy4uL2NvbW1vbi9jb2xvci5qcyc7CmltcG9ydCB7IG1lbW9pemUgfSBmcm9tICcuLi8uLi8uLi9jb21tb24vZGVjb3JhdG9ycy5qcyc7CmltcG9ydCB7IEVtaXR0ZXIsIEV2ZW50LCBFdmVudEJ1ZmZlcmVyIH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL2V2ZW50LmpzJzsKaW1wb3J0IHsgbWF0Y2hlc1ByZWZpeCB9IGZyb20gJy4uLy4uLy4uL2NvbW1vbi9maWx0ZXJzLmpzJzsKaW1wb3J0IHsgRGlzcG9zYWJsZVN0b3JlLCBkaXNwb3NlIGFzIF9kaXNwb3NlIH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL2xpZmVjeWNsZS5qcyc7CmltcG9ydCB7IGNsYW1wIH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL251bWJlcnMuanMnOwppbXBvcnQgeyBtaXhpbiB9IGZyb20gJy4uLy4uLy4uL2NvbW1vbi9vYmplY3RzLmpzJzsKaW1wb3J0ICogYXMgcGxhdGZvcm0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL3BsYXRmb3JtLmpzJzsKaW1wb3J0IHsgaXNOdW1iZXIgfSBmcm9tICcuLi8uLi8uLi9jb21tb24vdHlwZXMuanMnOwppbXBvcnQgJy4vbGlzdC5jc3MnOwppbXBvcnQgeyBMaXN0RXJyb3IgfSBmcm9tICcuL2xpc3QuanMnOwppbXBvcnQgeyBMaXN0VmlldyB9IGZyb20gJy4vbGlzdFZpZXcuanMnOwp2YXIgVHJhaXRSZW5kZXJlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gVHJhaXRSZW5kZXJlcih0cmFpdCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRyYWl0UmVuZGVyZXIpOwogICAgdGhpcy50cmFpdCA9IHRyYWl0OwogICAgdGhpcy5yZW5kZXJlZEVsZW1lbnRzID0gW107CiAgfQogIF9jcmVhdGVDbGFzcyhUcmFpdFJlbmRlcmVyLCBbewogICAga2V5OiAidGVtcGxhdGVJZCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuICJ0ZW1wbGF0ZToiLmNvbmNhdCh0aGlzLnRyYWl0Lm5hbWUpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlclRlbXBsYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJUZW1wbGF0ZShjb250YWluZXIpIHsKICAgICAgcmV0dXJuIGNvbnRhaW5lcjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJFbGVtZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJFbGVtZW50KGVsZW1lbnQsIGluZGV4LCB0ZW1wbGF0ZURhdGEpIHsKICAgICAgdmFyIHJlbmRlcmVkRWxlbWVudEluZGV4ID0gdGhpcy5yZW5kZXJlZEVsZW1lbnRzLmZpbmRJbmRleChmdW5jdGlvbiAoZWwpIHsKICAgICAgICByZXR1cm4gZWwudGVtcGxhdGVEYXRhID09PSB0ZW1wbGF0ZURhdGE7CiAgICAgIH0pOwogICAgICBpZiAocmVuZGVyZWRFbGVtZW50SW5kZXggPj0gMCkgewogICAgICAgIHZhciByZW5kZXJlZCA9IHRoaXMucmVuZGVyZWRFbGVtZW50c1tyZW5kZXJlZEVsZW1lbnRJbmRleF07CiAgICAgICAgdGhpcy50cmFpdC51bnJlbmRlcih0ZW1wbGF0ZURhdGEpOwogICAgICAgIHJlbmRlcmVkLmluZGV4ID0gaW5kZXg7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIF9yZW5kZXJlZCA9IHsKICAgICAgICAgIGluZGV4OiBpbmRleCwKICAgICAgICAgIHRlbXBsYXRlRGF0YTogdGVtcGxhdGVEYXRhCiAgICAgICAgfTsKICAgICAgICB0aGlzLnJlbmRlcmVkRWxlbWVudHMucHVzaChfcmVuZGVyZWQpOwogICAgICB9CiAgICAgIHRoaXMudHJhaXQucmVuZGVySW5kZXgoaW5kZXgsIHRlbXBsYXRlRGF0YSk7CiAgICB9CiAgfSwgewogICAga2V5OiAic3BsaWNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzcGxpY2Uoc3RhcnQsIGRlbGV0ZUNvdW50LCBpbnNlcnRDb3VudCkgewogICAgICB2YXIgcmVuZGVyZWQgPSBbXTsKICAgICAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHRoaXMucmVuZGVyZWRFbGVtZW50cyksCiAgICAgICAgX3N0ZXA7CiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3IucygpOyAhKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciByZW5kZXJlZEVsZW1lbnQgPSBfc3RlcC52YWx1ZTsKICAgICAgICAgIGlmIChyZW5kZXJlZEVsZW1lbnQuaW5kZXggPCBzdGFydCkgewogICAgICAgICAgICByZW5kZXJlZC5wdXNoKHJlbmRlcmVkRWxlbWVudCk7CiAgICAgICAgICB9IGVsc2UgaWYgKHJlbmRlcmVkRWxlbWVudC5pbmRleCA+PSBzdGFydCArIGRlbGV0ZUNvdW50KSB7CiAgICAgICAgICAgIHJlbmRlcmVkLnB1c2goewogICAgICAgICAgICAgIGluZGV4OiByZW5kZXJlZEVsZW1lbnQuaW5kZXggKyBpbnNlcnRDb3VudCAtIGRlbGV0ZUNvdW50LAogICAgICAgICAgICAgIHRlbXBsYXRlRGF0YTogcmVuZGVyZWRFbGVtZW50LnRlbXBsYXRlRGF0YQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvci5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yLmYoKTsKICAgICAgfQogICAgICB0aGlzLnJlbmRlcmVkRWxlbWVudHMgPSByZW5kZXJlZDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJJbmRleGVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJJbmRleGVzKGluZGV4ZXMpIHsKICAgICAgdmFyIF9pdGVyYXRvcjIgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih0aGlzLnJlbmRlcmVkRWxlbWVudHMpLAogICAgICAgIF9zdGVwMjsKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjIucygpOyAhKF9zdGVwMiA9IF9pdGVyYXRvcjIubigpKS5kb25lOykgewogICAgICAgICAgdmFyIF9zdGVwMiR2YWx1ZSA9IF9zdGVwMi52YWx1ZSwKICAgICAgICAgICAgaW5kZXggPSBfc3RlcDIkdmFsdWUuaW5kZXgsCiAgICAgICAgICAgIHRlbXBsYXRlRGF0YSA9IF9zdGVwMiR2YWx1ZS50ZW1wbGF0ZURhdGE7CiAgICAgICAgICBpZiAoaW5kZXhlcy5pbmRleE9mKGluZGV4KSA+IC0xKSB7CiAgICAgICAgICAgIHRoaXMudHJhaXQucmVuZGVySW5kZXgoaW5kZXgsIHRlbXBsYXRlRGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3IyLmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3IyLmYoKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImRpc3Bvc2VUZW1wbGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzcG9zZVRlbXBsYXRlKHRlbXBsYXRlRGF0YSkgewogICAgICB2YXIgaW5kZXggPSB0aGlzLnJlbmRlcmVkRWxlbWVudHMuZmluZEluZGV4KGZ1bmN0aW9uIChlbCkgewogICAgICAgIHJldHVybiBlbC50ZW1wbGF0ZURhdGEgPT09IHRlbXBsYXRlRGF0YTsKICAgICAgfSk7CiAgICAgIGlmIChpbmRleCA8IDApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy5yZW5kZXJlZEVsZW1lbnRzLnNwbGljZShpbmRleCwgMSk7CiAgICB9CiAgfV0pOwogIHJldHVybiBUcmFpdFJlbmRlcmVyOwp9KCk7CnZhciBUcmFpdCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gVHJhaXQoX3RyYWl0KSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVHJhaXQpOwogICAgdGhpcy5fdHJhaXQgPSBfdHJhaXQ7CiAgICB0aGlzLmxlbmd0aCA9IDA7CiAgICB0aGlzLmluZGV4ZXMgPSBbXTsKICAgIHRoaXMuc29ydGVkSW5kZXhlcyA9IFtdOwogICAgdGhpcy5fb25DaGFuZ2UgPSBuZXcgRW1pdHRlcigpOwogICAgdGhpcy5vbkNoYW5nZSA9IHRoaXMuX29uQ2hhbmdlLmV2ZW50OwogIH0KICBfY3JlYXRlQ2xhc3MoVHJhaXQsIFt7CiAgICBrZXk6ICJuYW1lIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fdHJhaXQ7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyZXIiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiBuZXcgVHJhaXRSZW5kZXJlcih0aGlzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzcGxpY2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNwbGljZShzdGFydCwgZGVsZXRlQ291bnQsIGVsZW1lbnRzKSB7CiAgICAgIHZhciBfYTsKICAgICAgZGVsZXRlQ291bnQgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihkZWxldGVDb3VudCwgdGhpcy5sZW5ndGggLSBzdGFydCkpOwogICAgICB2YXIgZGlmZiA9IGVsZW1lbnRzLmxlbmd0aCAtIGRlbGV0ZUNvdW50OwogICAgICB2YXIgZW5kID0gc3RhcnQgKyBkZWxldGVDb3VudDsKICAgICAgdmFyIHNvcnRlZEluZGV4ZXMgPSBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHRoaXMuc29ydGVkSW5kZXhlcy5maWx0ZXIoZnVuY3Rpb24gKGkpIHsKICAgICAgICByZXR1cm4gaSA8IHN0YXJ0OwogICAgICB9KSksIF90b0NvbnN1bWFibGVBcnJheShlbGVtZW50cy5tYXAoZnVuY3Rpb24gKGhhc1RyYWl0LCBpKSB7CiAgICAgICAgcmV0dXJuIGhhc1RyYWl0ID8gaSArIHN0YXJ0IDogLTE7CiAgICAgIH0pLmZpbHRlcihmdW5jdGlvbiAoaSkgewogICAgICAgIHJldHVybiBpICE9PSAtMTsKICAgICAgfSkpLCBfdG9Db25zdW1hYmxlQXJyYXkodGhpcy5zb3J0ZWRJbmRleGVzLmZpbHRlcihmdW5jdGlvbiAoaSkgewogICAgICAgIHJldHVybiBpID49IGVuZDsKICAgICAgfSkubWFwKGZ1bmN0aW9uIChpKSB7CiAgICAgICAgcmV0dXJuIGkgKyBkaWZmOwogICAgICB9KSkpOwogICAgICB2YXIgbGVuZ3RoID0gdGhpcy5sZW5ndGggKyBkaWZmOwogICAgICBpZiAodGhpcy5zb3J0ZWRJbmRleGVzLmxlbmd0aCA+IDAgJiYgc29ydGVkSW5kZXhlcy5sZW5ndGggPT09IDAgJiYgbGVuZ3RoID4gMCkgewogICAgICAgIHZhciBmaXJzdCA9IChfYSA9IHRoaXMuc29ydGVkSW5kZXhlcy5maW5kKGZ1bmN0aW9uIChpbmRleCkgewogICAgICAgICAgcmV0dXJuIGluZGV4ID49IHN0YXJ0OwogICAgICAgIH0pKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBsZW5ndGggLSAxOwogICAgICAgIHNvcnRlZEluZGV4ZXMucHVzaChNYXRoLm1pbihmaXJzdCwgbGVuZ3RoIC0gMSkpOwogICAgICB9CiAgICAgIHRoaXMucmVuZGVyZXIuc3BsaWNlKHN0YXJ0LCBkZWxldGVDb3VudCwgZWxlbWVudHMubGVuZ3RoKTsKICAgICAgdGhpcy5fc2V0KHNvcnRlZEluZGV4ZXMsIHNvcnRlZEluZGV4ZXMpOwogICAgICB0aGlzLmxlbmd0aCA9IGxlbmd0aDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJJbmRleCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVySW5kZXgoaW5kZXgsIGNvbnRhaW5lcikgewogICAgICBjb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSh0aGlzLl90cmFpdCwgdGhpcy5jb250YWlucyhpbmRleCkpOwogICAgfQogIH0sIHsKICAgIGtleTogInVucmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1bnJlbmRlcihjb250YWluZXIpIHsKICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fdHJhaXQpOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIHRoZSBpbmRleGVzIHdoaWNoIHNob3VsZCBoYXZlIHRoaXMgdHJhaXQuCiAgICAgKgogICAgICogQHBhcmFtIGluZGV4ZXMgSW5kZXhlcyB3aGljaCBzaG91bGQgaGF2ZSB0aGlzIHRyYWl0LgogICAgICogQHJldHVybiBUaGUgb2xkIGluZGV4ZXMgd2hpY2ggaGFkIHRoaXMgdHJhaXQuCiAgICAgKi8KICB9LCB7CiAgICBrZXk6ICJzZXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldChpbmRleGVzLCBicm93c2VyRXZlbnQpIHsKICAgICAgcmV0dXJuIHRoaXMuX3NldChpbmRleGVzLCBfdG9Db25zdW1hYmxlQXJyYXkoaW5kZXhlcykuc29ydChudW1lcmljU29ydCksIGJyb3dzZXJFdmVudCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3NldCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3NldChpbmRleGVzLCBzb3J0ZWRJbmRleGVzLCBicm93c2VyRXZlbnQpIHsKICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuaW5kZXhlczsKICAgICAgdmFyIHNvcnRlZFJlc3VsdCA9IHRoaXMuc29ydGVkSW5kZXhlczsKICAgICAgdGhpcy5pbmRleGVzID0gaW5kZXhlczsKICAgICAgdGhpcy5zb3J0ZWRJbmRleGVzID0gc29ydGVkSW5kZXhlczsKICAgICAgdmFyIHRvUmVuZGVyID0gZGlzanVuY3Rpb24oc29ydGVkUmVzdWx0LCBpbmRleGVzKTsKICAgICAgdGhpcy5yZW5kZXJlci5yZW5kZXJJbmRleGVzKHRvUmVuZGVyKTsKICAgICAgdGhpcy5fb25DaGFuZ2UuZmlyZSh7CiAgICAgICAgaW5kZXhlczogaW5kZXhlcywKICAgICAgICBicm93c2VyRXZlbnQ6IGJyb3dzZXJFdmVudAogICAgICB9KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuaW5kZXhlczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb250YWlucyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY29udGFpbnMoaW5kZXgpIHsKICAgICAgcmV0dXJuIGJpbmFyeVNlYXJjaCh0aGlzLnNvcnRlZEluZGV4ZXMsIGluZGV4LCBudW1lcmljU29ydCkgPj0gMDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkaXNwb3NlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNwb3NlKCkgewogICAgICBfZGlzcG9zZSh0aGlzLl9vbkNoYW5nZSk7CiAgICB9CiAgfV0pOwogIHJldHVybiBUcmFpdDsKfSgpOwpfX2RlY29yYXRlKFttZW1vaXplXSwgVHJhaXQucHJvdG90eXBlLCAicmVuZGVyZXIiLCBudWxsKTsKdmFyIFNlbGVjdGlvblRyYWl0ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfVHJhaXQpIHsKICBfaW5oZXJpdHMoU2VsZWN0aW9uVHJhaXQsIF9UcmFpdCk7CiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihTZWxlY3Rpb25UcmFpdCk7CiAgZnVuY3Rpb24gU2VsZWN0aW9uVHJhaXQoc2V0QXJpYVNlbGVjdGVkKSB7CiAgICB2YXIgX3RoaXM7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU2VsZWN0aW9uVHJhaXQpOwogICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCAnc2VsZWN0ZWQnKTsKICAgIF90aGlzLnNldEFyaWFTZWxlY3RlZCA9IHNldEFyaWFTZWxlY3RlZDsKICAgIHJldHVybiBfdGhpczsKICB9CiAgX2NyZWF0ZUNsYXNzKFNlbGVjdGlvblRyYWl0LCBbewogICAga2V5OiAicmVuZGVySW5kZXgiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlckluZGV4KGluZGV4LCBjb250YWluZXIpIHsKICAgICAgX2dldChfZ2V0UHJvdG90eXBlT2YoU2VsZWN0aW9uVHJhaXQucHJvdG90eXBlKSwgInJlbmRlckluZGV4IiwgdGhpcykuY2FsbCh0aGlzLCBpbmRleCwgY29udGFpbmVyKTsKICAgICAgaWYgKHRoaXMuc2V0QXJpYVNlbGVjdGVkKSB7CiAgICAgICAgaWYgKHRoaXMuY29udGFpbnMoaW5kZXgpKSB7CiAgICAgICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgJ3RydWUnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsICdmYWxzZScpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH1dKTsKICByZXR1cm4gU2VsZWN0aW9uVHJhaXQ7Cn0oVHJhaXQpOwovKioKICogVGhlIFRyYWl0U3BsaWNlYWJsZSBpcyB1c2VkIGFzIGEgdXRpbCBjbGFzcyB0byBiZSBhYmxlCiAqIHRvIHByZXNlcnZlIHRyYWl0cyBhY3Jvc3Mgc3BsaWNlIGNhbGxzLCBnaXZlbiBhbiBpZGVudGl0eQogKiBwcm92aWRlci4KICovCnZhciBUcmFpdFNwbGljZWFibGUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFRyYWl0U3BsaWNlYWJsZSh0cmFpdCwgdmlldywgaWRlbnRpdHlQcm92aWRlcikgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRyYWl0U3BsaWNlYWJsZSk7CiAgICB0aGlzLnRyYWl0ID0gdHJhaXQ7CiAgICB0aGlzLnZpZXcgPSB2aWV3OwogICAgdGhpcy5pZGVudGl0eVByb3ZpZGVyID0gaWRlbnRpdHlQcm92aWRlcjsKICB9CiAgX2NyZWF0ZUNsYXNzKFRyYWl0U3BsaWNlYWJsZSwgW3sKICAgIGtleTogInNwbGljZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3BsaWNlKHN0YXJ0LCBkZWxldGVDb3VudCwgZWxlbWVudHMpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIGlmICghdGhpcy5pZGVudGl0eVByb3ZpZGVyKSB7CiAgICAgICAgcmV0dXJuIHRoaXMudHJhaXQuc3BsaWNlKHN0YXJ0LCBkZWxldGVDb3VudCwgZWxlbWVudHMubWFwKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9KSk7CiAgICAgIH0KICAgICAgdmFyIHBhc3RFbGVtZW50c1dpdGhUcmFpdCA9IHRoaXMudHJhaXQuZ2V0KCkubWFwKGZ1bmN0aW9uIChpKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMi5pZGVudGl0eVByb3ZpZGVyLmdldElkKF90aGlzMi52aWV3LmVsZW1lbnQoaSkpLnRvU3RyaW5nKCk7CiAgICAgIH0pOwogICAgICB2YXIgZWxlbWVudHNXaXRoVHJhaXQgPSBlbGVtZW50cy5tYXAoZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gcGFzdEVsZW1lbnRzV2l0aFRyYWl0LmluZGV4T2YoX3RoaXMyLmlkZW50aXR5UHJvdmlkZXIuZ2V0SWQoZSkudG9TdHJpbmcoKSkgPiAtMTsKICAgICAgfSk7CiAgICAgIHRoaXMudHJhaXQuc3BsaWNlKHN0YXJ0LCBkZWxldGVDb3VudCwgZWxlbWVudHNXaXRoVHJhaXQpOwogICAgfQogIH1dKTsKICByZXR1cm4gVHJhaXRTcGxpY2VhYmxlOwp9KCk7CmV4cG9ydCBmdW5jdGlvbiBpc0lucHV0RWxlbWVudChlKSB7CiAgcmV0dXJuIGUudGFnTmFtZSA9PT0gJ0lOUFVUJyB8fCBlLnRhZ05hbWUgPT09ICdURVhUQVJFQSc7Cn0KZXhwb3J0IGZ1bmN0aW9uIGlzTW9uYWNvRWRpdG9yKGUpIHsKICBpZiAoZS5jbGFzc0xpc3QuY29udGFpbnMoJ21vbmFjby1lZGl0b3InKSkgewogICAgcmV0dXJuIHRydWU7CiAgfQogIGlmIChlLmNsYXNzTGlzdC5jb250YWlucygnbW9uYWNvLWxpc3QnKSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KICBpZiAoIWUucGFyZW50RWxlbWVudCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KICByZXR1cm4gaXNNb25hY29FZGl0b3IoZS5wYXJlbnRFbGVtZW50KTsKfQpleHBvcnQgZnVuY3Rpb24gaXNCdXR0b24oZSkgewogIGlmIChlLnRhZ05hbWUgPT09ICdBJyAmJiBlLmNsYXNzTGlzdC5jb250YWlucygnbW9uYWNvLWJ1dHRvbicpIHx8IGUudGFnTmFtZSA9PT0gJ0RJVicgJiYgZS5jbGFzc0xpc3QuY29udGFpbnMoJ21vbmFjby1idXR0b24tZHJvcGRvd24nKSkgewogICAgcmV0dXJuIHRydWU7CiAgfQogIGlmIChlLmNsYXNzTGlzdC5jb250YWlucygnbW9uYWNvLWxpc3QnKSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KICBpZiAoIWUucGFyZW50RWxlbWVudCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KICByZXR1cm4gaXNCdXR0b24oZS5wYXJlbnRFbGVtZW50KTsKfQp2YXIgS2V5Ym9hcmRDb250cm9sbGVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBLZXlib2FyZENvbnRyb2xsZXIobGlzdCwgdmlldywgb3B0aW9ucykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEtleWJvYXJkQ29udHJvbGxlcik7CiAgICB0aGlzLmxpc3QgPSBsaXN0OwogICAgdGhpcy52aWV3ID0gdmlldzsKICAgIHRoaXMuZGlzcG9zYWJsZXMgPSBuZXcgRGlzcG9zYWJsZVN0b3JlKCk7CiAgICB0aGlzLm11bHRpcGxlU2VsZWN0aW9uRGlzcG9zYWJsZXMgPSBuZXcgRGlzcG9zYWJsZVN0b3JlKCk7CiAgICB0aGlzLm9uS2V5RG93bi5maWx0ZXIoZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuIGUua2V5Q29kZSA9PT0gMzsKICAgIH0gLyogS2V5Q29kZS5FbnRlciAqLykub24odGhpcy5vbkVudGVyLCB0aGlzLCB0aGlzLmRpc3Bvc2FibGVzKTsKICAgIHRoaXMub25LZXlEb3duLmZpbHRlcihmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gZS5rZXlDb2RlID09PSAxNjsKICAgIH0gLyogS2V5Q29kZS5VcEFycm93ICovKS5vbih0aGlzLm9uVXBBcnJvdywgdGhpcywgdGhpcy5kaXNwb3NhYmxlcyk7CiAgICB0aGlzLm9uS2V5RG93bi5maWx0ZXIoZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuIGUua2V5Q29kZSA9PT0gMTg7CiAgICB9IC8qIEtleUNvZGUuRG93bkFycm93ICovKS5vbih0aGlzLm9uRG93bkFycm93LCB0aGlzLCB0aGlzLmRpc3Bvc2FibGVzKTsKICAgIHRoaXMub25LZXlEb3duLmZpbHRlcihmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gZS5rZXlDb2RlID09PSAxMTsKICAgIH0gLyogS2V5Q29kZS5QYWdlVXAgKi8pLm9uKHRoaXMub25QYWdlVXBBcnJvdywgdGhpcywgdGhpcy5kaXNwb3NhYmxlcyk7CiAgICB0aGlzLm9uS2V5RG93bi5maWx0ZXIoZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuIGUua2V5Q29kZSA9PT0gMTI7CiAgICB9IC8qIEtleUNvZGUuUGFnZURvd24gKi8pLm9uKHRoaXMub25QYWdlRG93bkFycm93LCB0aGlzLCB0aGlzLmRpc3Bvc2FibGVzKTsKICAgIHRoaXMub25LZXlEb3duLmZpbHRlcihmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gZS5rZXlDb2RlID09PSA5OwogICAgfSAvKiBLZXlDb2RlLkVzY2FwZSAqLykub24odGhpcy5vbkVzY2FwZSwgdGhpcywgdGhpcy5kaXNwb3NhYmxlcyk7CiAgICBpZiAob3B0aW9ucy5tdWx0aXBsZVNlbGVjdGlvblN1cHBvcnQgIT09IGZhbHNlKSB7CiAgICAgIHRoaXMub25LZXlEb3duLmZpbHRlcihmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiAocGxhdGZvcm0uaXNNYWNpbnRvc2ggPyBlLm1ldGFLZXkgOiBlLmN0cmxLZXkpICYmIGUua2V5Q29kZSA9PT0gMzE7CiAgICAgIH0gLyogS2V5Q29kZS5LZXlBICovKS5vbih0aGlzLm9uQ3RybEEsIHRoaXMsIHRoaXMubXVsdGlwbGVTZWxlY3Rpb25EaXNwb3NhYmxlcyk7CiAgICB9CiAgfQogIF9jcmVhdGVDbGFzcyhLZXlib2FyZENvbnRyb2xsZXIsIFt7CiAgICBrZXk6ICJvbktleURvd24iLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLmRpc3Bvc2FibGVzLmFkZChFdmVudC5jaGFpbih0aGlzLmRpc3Bvc2FibGVzLmFkZChuZXcgRG9tRW1pdHRlcih0aGlzLnZpZXcuZG9tTm9kZSwgJ2tleWRvd24nKSkuZXZlbnQpLmZpbHRlcihmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiAhaXNJbnB1dEVsZW1lbnQoZS50YXJnZXQpOwogICAgICB9KS5tYXAoZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gbmV3IFN0YW5kYXJkS2V5Ym9hcmRFdmVudChlKTsKICAgICAgfSkpOwogICAgfQogIH0sIHsKICAgIGtleTogInVwZGF0ZU9wdGlvbnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZU9wdGlvbnMob3B0aW9uc1VwZGF0ZSkgewogICAgICBpZiAob3B0aW9uc1VwZGF0ZS5tdWx0aXBsZVNlbGVjdGlvblN1cHBvcnQgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHRoaXMubXVsdGlwbGVTZWxlY3Rpb25EaXNwb3NhYmxlcy5jbGVhcigpOwogICAgICAgIGlmIChvcHRpb25zVXBkYXRlLm11bHRpcGxlU2VsZWN0aW9uU3VwcG9ydCkgewogICAgICAgICAgdGhpcy5vbktleURvd24uZmlsdGVyKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIHJldHVybiAocGxhdGZvcm0uaXNNYWNpbnRvc2ggPyBlLm1ldGFLZXkgOiBlLmN0cmxLZXkpICYmIGUua2V5Q29kZSA9PT0gMzE7CiAgICAgICAgICB9IC8qIEtleUNvZGUuS2V5QSAqLykub24odGhpcy5vbkN0cmxBLCB0aGlzLCB0aGlzLm11bHRpcGxlU2VsZWN0aW9uRGlzcG9zYWJsZXMpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogIm9uRW50ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uRW50ZXIoZSkgewogICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgIHRoaXMubGlzdC5zZXRTZWxlY3Rpb24odGhpcy5saXN0LmdldEZvY3VzKCksIGUuYnJvd3NlckV2ZW50KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvblVwQXJyb3ciLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uVXBBcnJvdyhlKSB7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgdGhpcy5saXN0LmZvY3VzUHJldmlvdXMoMSwgZmFsc2UsIGUuYnJvd3NlckV2ZW50KTsKICAgICAgdmFyIGVsID0gdGhpcy5saXN0LmdldEZvY3VzKClbMF07CiAgICAgIHRoaXMubGlzdC5zZXRBbmNob3IoZWwpOwogICAgICB0aGlzLmxpc3QucmV2ZWFsKGVsKTsKICAgICAgdGhpcy52aWV3LmRvbU5vZGUuZm9jdXMoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvbkRvd25BcnJvdyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25Eb3duQXJyb3coZSkgewogICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgIHRoaXMubGlzdC5mb2N1c05leHQoMSwgZmFsc2UsIGUuYnJvd3NlckV2ZW50KTsKICAgICAgdmFyIGVsID0gdGhpcy5saXN0LmdldEZvY3VzKClbMF07CiAgICAgIHRoaXMubGlzdC5zZXRBbmNob3IoZWwpOwogICAgICB0aGlzLmxpc3QucmV2ZWFsKGVsKTsKICAgICAgdGhpcy52aWV3LmRvbU5vZGUuZm9jdXMoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvblBhZ2VVcEFycm93IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvblBhZ2VVcEFycm93KGUpIHsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICB0aGlzLmxpc3QuZm9jdXNQcmV2aW91c1BhZ2UoZS5icm93c2VyRXZlbnQpOwogICAgICB2YXIgZWwgPSB0aGlzLmxpc3QuZ2V0Rm9jdXMoKVswXTsKICAgICAgdGhpcy5saXN0LnNldEFuY2hvcihlbCk7CiAgICAgIHRoaXMubGlzdC5yZXZlYWwoZWwpOwogICAgICB0aGlzLnZpZXcuZG9tTm9kZS5mb2N1cygpOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uUGFnZURvd25BcnJvdyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25QYWdlRG93bkFycm93KGUpIHsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICB0aGlzLmxpc3QuZm9jdXNOZXh0UGFnZShlLmJyb3dzZXJFdmVudCk7CiAgICAgIHZhciBlbCA9IHRoaXMubGlzdC5nZXRGb2N1cygpWzBdOwogICAgICB0aGlzLmxpc3Quc2V0QW5jaG9yKGVsKTsKICAgICAgdGhpcy5saXN0LnJldmVhbChlbCk7CiAgICAgIHRoaXMudmlldy5kb21Ob2RlLmZvY3VzKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAib25DdHJsQSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25DdHJsQShlKSB7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgdGhpcy5saXN0LnNldFNlbGVjdGlvbihyYW5nZSh0aGlzLmxpc3QubGVuZ3RoKSwgZS5icm93c2VyRXZlbnQpOwogICAgICB0aGlzLmxpc3Quc2V0QW5jaG9yKHVuZGVmaW5lZCk7CiAgICAgIHRoaXMudmlldy5kb21Ob2RlLmZvY3VzKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAib25Fc2NhcGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uRXNjYXBlKGUpIHsKICAgICAgaWYgKHRoaXMubGlzdC5nZXRTZWxlY3Rpb24oKS5sZW5ndGgpIHsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICB0aGlzLmxpc3Quc2V0U2VsZWN0aW9uKFtdLCBlLmJyb3dzZXJFdmVudCk7CiAgICAgICAgdGhpcy5saXN0LnNldEFuY2hvcih1bmRlZmluZWQpOwogICAgICAgIHRoaXMudmlldy5kb21Ob2RlLmZvY3VzKCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJkaXNwb3NlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNwb3NlKCkgewogICAgICB0aGlzLmRpc3Bvc2FibGVzLmRpc3Bvc2UoKTsKICAgICAgdGhpcy5tdWx0aXBsZVNlbGVjdGlvbkRpc3Bvc2FibGVzLmRpc3Bvc2UoKTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIEtleWJvYXJkQ29udHJvbGxlcjsKfSgpOwpfX2RlY29yYXRlKFttZW1vaXplXSwgS2V5Ym9hcmRDb250cm9sbGVyLnByb3RvdHlwZSwgIm9uS2V5RG93biIsIG51bGwpOwpleHBvcnQgdmFyIFR5cGVOYXZpZ2F0aW9uTW9kZTsKKGZ1bmN0aW9uIChUeXBlTmF2aWdhdGlvbk1vZGUpIHsKICBUeXBlTmF2aWdhdGlvbk1vZGVbVHlwZU5hdmlnYXRpb25Nb2RlWyJBdXRvbWF0aWMiXSA9IDBdID0gIkF1dG9tYXRpYyI7CiAgVHlwZU5hdmlnYXRpb25Nb2RlW1R5cGVOYXZpZ2F0aW9uTW9kZVsiVHJpZ2dlciJdID0gMV0gPSAiVHJpZ2dlciI7Cn0pKFR5cGVOYXZpZ2F0aW9uTW9kZSB8fCAoVHlwZU5hdmlnYXRpb25Nb2RlID0ge30pKTsKdmFyIFR5cGVOYXZpZ2F0aW9uQ29udHJvbGxlclN0YXRlOwooZnVuY3Rpb24gKFR5cGVOYXZpZ2F0aW9uQ29udHJvbGxlclN0YXRlKSB7CiAgVHlwZU5hdmlnYXRpb25Db250cm9sbGVyU3RhdGVbVHlwZU5hdmlnYXRpb25Db250cm9sbGVyU3RhdGVbIklkbGUiXSA9IDBdID0gIklkbGUiOwogIFR5cGVOYXZpZ2F0aW9uQ29udHJvbGxlclN0YXRlW1R5cGVOYXZpZ2F0aW9uQ29udHJvbGxlclN0YXRlWyJUeXBpbmciXSA9IDFdID0gIlR5cGluZyI7Cn0pKFR5cGVOYXZpZ2F0aW9uQ29udHJvbGxlclN0YXRlIHx8IChUeXBlTmF2aWdhdGlvbkNvbnRyb2xsZXJTdGF0ZSA9IHt9KSk7CmV4cG9ydCB2YXIgRGVmYXVsdEtleWJvYXJkTmF2aWdhdGlvbkRlbGVnYXRlID0gbmV3ICggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBfY2xhc3MoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgX2NsYXNzKTsKICB9CiAgX2NyZWF0ZUNsYXNzKF9jbGFzcywgW3sKICAgIGtleTogIm1pZ2h0UHJvZHVjZVByaW50YWJsZUNoYXJhY3RlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbWlnaHRQcm9kdWNlUHJpbnRhYmxlQ2hhcmFjdGVyKGV2ZW50KSB7CiAgICAgIGlmIChldmVudC5jdHJsS2V5IHx8IGV2ZW50Lm1ldGFLZXkgfHwgZXZlbnQuYWx0S2V5KSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIHJldHVybiBldmVudC5rZXlDb2RlID49IDMxIC8qIEtleUNvZGUuS2V5QSAqLyAmJiBldmVudC5rZXlDb2RlIDw9IDU2IC8qIEtleUNvZGUuS2V5WiAqLyB8fCBldmVudC5rZXlDb2RlID49IDIxIC8qIEtleUNvZGUuRGlnaXQwICovICYmIGV2ZW50LmtleUNvZGUgPD0gMzAgLyogS2V5Q29kZS5EaWdpdDkgKi8gfHwgZXZlbnQua2V5Q29kZSA+PSA5MyAvKiBLZXlDb2RlLk51bXBhZDAgKi8gJiYgZXZlbnQua2V5Q29kZSA8PSAxMDIgLyogS2V5Q29kZS5OdW1wYWQ5ICovIHx8IGV2ZW50LmtleUNvZGUgPj0gODAgLyogS2V5Q29kZS5TZW1pY29sb24gKi8gJiYgZXZlbnQua2V5Q29kZSA8PSA5MCAvKiBLZXlDb2RlLlF1b3RlICovOwogICAgfQogIH1dKTsKICByZXR1cm4gX2NsYXNzOwp9KCkpKCk7CnZhciBUeXBlTmF2aWdhdGlvbkNvbnRyb2xsZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFR5cGVOYXZpZ2F0aW9uQ29udHJvbGxlcihsaXN0LCB2aWV3LCBrZXlib2FyZE5hdmlnYXRpb25MYWJlbFByb3ZpZGVyLCBrZXlib2FyZE5hdmlnYXRpb25FdmVudEZpbHRlciwgZGVsZWdhdGUpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUeXBlTmF2aWdhdGlvbkNvbnRyb2xsZXIpOwogICAgdGhpcy5saXN0ID0gbGlzdDsKICAgIHRoaXMudmlldyA9IHZpZXc7CiAgICB0aGlzLmtleWJvYXJkTmF2aWdhdGlvbkxhYmVsUHJvdmlkZXIgPSBrZXlib2FyZE5hdmlnYXRpb25MYWJlbFByb3ZpZGVyOwogICAgdGhpcy5rZXlib2FyZE5hdmlnYXRpb25FdmVudEZpbHRlciA9IGtleWJvYXJkTmF2aWdhdGlvbkV2ZW50RmlsdGVyOwogICAgdGhpcy5kZWxlZ2F0ZSA9IGRlbGVnYXRlOwogICAgdGhpcy5lbmFibGVkID0gZmFsc2U7CiAgICB0aGlzLnN0YXRlID0gVHlwZU5hdmlnYXRpb25Db250cm9sbGVyU3RhdGUuSWRsZTsKICAgIHRoaXMubW9kZSA9IFR5cGVOYXZpZ2F0aW9uTW9kZS5BdXRvbWF0aWM7CiAgICB0aGlzLnRyaWdnZXJlZCA9IGZhbHNlOwogICAgdGhpcy5wcmV2aW91c2x5Rm9jdXNlZCA9IC0xOwogICAgdGhpcy5lbmFibGVkRGlzcG9zYWJsZXMgPSBuZXcgRGlzcG9zYWJsZVN0b3JlKCk7CiAgICB0aGlzLmRpc3Bvc2FibGVzID0gbmV3IERpc3Bvc2FibGVTdG9yZSgpOwogICAgdGhpcy51cGRhdGVPcHRpb25zKGxpc3Qub3B0aW9ucyk7CiAgfQogIF9jcmVhdGVDbGFzcyhUeXBlTmF2aWdhdGlvbkNvbnRyb2xsZXIsIFt7CiAgICBrZXk6ICJ1cGRhdGVPcHRpb25zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVPcHRpb25zKG9wdGlvbnMpIHsKICAgICAgdmFyIF9hLCBfYjsKICAgICAgaWYgKChfYSA9IG9wdGlvbnMudHlwZU5hdmlnYXRpb25FbmFibGVkKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiB0cnVlKSB7CiAgICAgICAgdGhpcy5lbmFibGUoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmRpc2FibGUoKTsKICAgICAgfQogICAgICB0aGlzLm1vZGUgPSAoX2IgPSBvcHRpb25zLnR5cGVOYXZpZ2F0aW9uTW9kZSkgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogVHlwZU5hdmlnYXRpb25Nb2RlLkF1dG9tYXRpYzsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJlbmFibGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGVuYWJsZSgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIGlmICh0aGlzLmVuYWJsZWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdmFyIHR5cGluZyA9IGZhbHNlOwogICAgICB2YXIgb25DaGFyID0gdGhpcy5lbmFibGVkRGlzcG9zYWJsZXMuYWRkKEV2ZW50LmNoYWluKHRoaXMuZW5hYmxlZERpc3Bvc2FibGVzLmFkZChuZXcgRG9tRW1pdHRlcih0aGlzLnZpZXcuZG9tTm9kZSwgJ2tleWRvd24nKSkuZXZlbnQpKS5maWx0ZXIoZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gIWlzSW5wdXRFbGVtZW50KGUudGFyZ2V0KTsKICAgICAgfSkuZmlsdGVyKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gX3RoaXMzLm1vZGUgPT09IFR5cGVOYXZpZ2F0aW9uTW9kZS5BdXRvbWF0aWMgfHwgX3RoaXMzLnRyaWdnZXJlZDsKICAgICAgfSkubWFwKGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIHJldHVybiBuZXcgU3RhbmRhcmRLZXlib2FyZEV2ZW50KGV2ZW50KTsKICAgICAgfSkuZmlsdGVyKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIHR5cGluZyB8fCBfdGhpczMua2V5Ym9hcmROYXZpZ2F0aW9uRXZlbnRGaWx0ZXIoZSk7CiAgICAgIH0pLmZpbHRlcihmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBfdGhpczMuZGVsZWdhdGUubWlnaHRQcm9kdWNlUHJpbnRhYmxlQ2hhcmFjdGVyKGUpOwogICAgICB9KS5mb3JFYWNoKHN0b3BFdmVudCkubWFwKGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIHJldHVybiBldmVudC5icm93c2VyRXZlbnQua2V5OwogICAgICB9KS5ldmVudDsKICAgICAgdmFyIG9uQ2xlYXIgPSBFdmVudC5kZWJvdW5jZShvbkNoYXIsIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfSwgODAwLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdGhpcy5lbmFibGVkRGlzcG9zYWJsZXMpOwogICAgICB2YXIgb25JbnB1dCA9IEV2ZW50LnJlZHVjZShFdmVudC5hbnkob25DaGFyLCBvbkNsZWFyKSwgZnVuY3Rpb24gKHIsIGkpIHsKICAgICAgICByZXR1cm4gaSA9PT0gbnVsbCA/IG51bGwgOiAociB8fCAnJykgKyBpOwogICAgICB9LCB1bmRlZmluZWQsIHRoaXMuZW5hYmxlZERpc3Bvc2FibGVzKTsKICAgICAgb25JbnB1dCh0aGlzLm9uSW5wdXQsIHRoaXMsIHRoaXMuZW5hYmxlZERpc3Bvc2FibGVzKTsKICAgICAgb25DbGVhcih0aGlzLm9uQ2xlYXIsIHRoaXMsIHRoaXMuZW5hYmxlZERpc3Bvc2FibGVzKTsKICAgICAgb25DaGFyKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdHlwaW5nID0gdHJ1ZTsKICAgICAgfSwgdW5kZWZpbmVkLCB0aGlzLmVuYWJsZWREaXNwb3NhYmxlcyk7CiAgICAgIG9uQ2xlYXIoZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB0eXBpbmcgPSBmYWxzZTsKICAgICAgfSwgdW5kZWZpbmVkLCB0aGlzLmVuYWJsZWREaXNwb3NhYmxlcyk7CiAgICAgIHRoaXMuZW5hYmxlZCA9IHRydWU7CiAgICAgIHRoaXMudHJpZ2dlcmVkID0gZmFsc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGlzYWJsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzYWJsZSgpIHsKICAgICAgaWYgKCF0aGlzLmVuYWJsZWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy5lbmFibGVkRGlzcG9zYWJsZXMuY2xlYXIoKTsKICAgICAgdGhpcy5lbmFibGVkID0gZmFsc2U7CiAgICAgIHRoaXMudHJpZ2dlcmVkID0gZmFsc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAib25DbGVhciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25DbGVhcigpIHsKICAgICAgdmFyIF9hOwogICAgICB2YXIgZm9jdXMgPSB0aGlzLmxpc3QuZ2V0Rm9jdXMoKTsKICAgICAgaWYgKGZvY3VzLmxlbmd0aCA+IDAgJiYgZm9jdXNbMF0gPT09IHRoaXMucHJldmlvdXNseUZvY3VzZWQpIHsKICAgICAgICAvLyBMaXN0OiByZS1hbm5vdW5jZSBlbGVtZW50IG9uIHR5cGluZyBlbmQgc2luY2UgdHlwZWQga2V5cyB3aWxsIGludGVycnVwdCBhcmlhIGxhYmVsIG9mIGZvY3VzZWQgZWxlbWVudAogICAgICAgIC8vIERvIG5vdCBhbm5vdW5jZSBpZiB0aGVyZSB3YXMgYSBmb2N1cyBjaGFuZ2UgYXQgdGhlIGVuZCB0byBwcmV2ZW50IGR1cGxpY2F0aW9uIGh0dHBzOi8vZ2l0aHViLmNvbS9taWNyb3NvZnQvdnNjb2RlL2lzc3Vlcy85NTk2MQogICAgICAgIHZhciBhcmlhTGFiZWwgPSAoX2EgPSB0aGlzLmxpc3Qub3B0aW9ucy5hY2Nlc3NpYmlsaXR5UHJvdmlkZXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5nZXRBcmlhTGFiZWwodGhpcy5saXN0LmVsZW1lbnQoZm9jdXNbMF0pKTsKICAgICAgICBpZiAoYXJpYUxhYmVsKSB7CiAgICAgICAgICBhbGVydChhcmlhTGFiZWwpOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLnByZXZpb3VzbHlGb2N1c2VkID0gLTE7CiAgICB9CiAgfSwgewogICAga2V5OiAib25JbnB1dCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25JbnB1dCh3b3JkKSB7CiAgICAgIGlmICghd29yZCkgewogICAgICAgIHRoaXMuc3RhdGUgPSBUeXBlTmF2aWdhdGlvbkNvbnRyb2xsZXJTdGF0ZS5JZGxlOwogICAgICAgIHRoaXMudHJpZ2dlcmVkID0gZmFsc2U7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHZhciBmb2N1cyA9IHRoaXMubGlzdC5nZXRGb2N1cygpOwogICAgICB2YXIgc3RhcnQgPSBmb2N1cy5sZW5ndGggPiAwID8gZm9jdXNbMF0gOiAwOwogICAgICB2YXIgZGVsdGEgPSB0aGlzLnN0YXRlID09PSBUeXBlTmF2aWdhdGlvbkNvbnRyb2xsZXJTdGF0ZS5JZGxlID8gMSA6IDA7CiAgICAgIHRoaXMuc3RhdGUgPSBUeXBlTmF2aWdhdGlvbkNvbnRyb2xsZXJTdGF0ZS5UeXBpbmc7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5saXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIGluZGV4ID0gKHN0YXJ0ICsgaSArIGRlbHRhKSAlIHRoaXMubGlzdC5sZW5ndGg7CiAgICAgICAgdmFyIGxhYmVsID0gdGhpcy5rZXlib2FyZE5hdmlnYXRpb25MYWJlbFByb3ZpZGVyLmdldEtleWJvYXJkTmF2aWdhdGlvbkxhYmVsKHRoaXMudmlldy5lbGVtZW50KGluZGV4KSk7CiAgICAgICAgdmFyIGxhYmVsU3RyID0gbGFiZWwgJiYgbGFiZWwudG9TdHJpbmcoKTsKICAgICAgICBpZiAodHlwZW9mIGxhYmVsU3RyID09PSAndW5kZWZpbmVkJyB8fCBtYXRjaGVzUHJlZml4KHdvcmQsIGxhYmVsU3RyKSkgewogICAgICAgICAgdGhpcy5wcmV2aW91c2x5Rm9jdXNlZCA9IHN0YXJ0OwogICAgICAgICAgdGhpcy5saXN0LnNldEZvY3VzKFtpbmRleF0pOwogICAgICAgICAgdGhpcy5saXN0LnJldmVhbChpbmRleCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiZGlzcG9zZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzcG9zZSgpIHsKICAgICAgdGhpcy5kaXNhYmxlKCk7CiAgICAgIHRoaXMuZW5hYmxlZERpc3Bvc2FibGVzLmRpc3Bvc2UoKTsKICAgICAgdGhpcy5kaXNwb3NhYmxlcy5kaXNwb3NlKCk7CiAgICB9CiAgfV0pOwogIHJldHVybiBUeXBlTmF2aWdhdGlvbkNvbnRyb2xsZXI7Cn0oKTsKdmFyIERPTUZvY3VzQ29udHJvbGxlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gRE9NRm9jdXNDb250cm9sbGVyKGxpc3QsIHZpZXcpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBET01Gb2N1c0NvbnRyb2xsZXIpOwogICAgdGhpcy5saXN0ID0gbGlzdDsKICAgIHRoaXMudmlldyA9IHZpZXc7CiAgICB0aGlzLmRpc3Bvc2FibGVzID0gbmV3IERpc3Bvc2FibGVTdG9yZSgpOwogICAgdmFyIG9uS2V5RG93biA9IHRoaXMuZGlzcG9zYWJsZXMuYWRkKEV2ZW50LmNoYWluKHRoaXMuZGlzcG9zYWJsZXMuYWRkKG5ldyBEb21FbWl0dGVyKHZpZXcuZG9tTm9kZSwgJ2tleWRvd24nKSkuZXZlbnQpKS5maWx0ZXIoZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuICFpc0lucHV0RWxlbWVudChlLnRhcmdldCk7CiAgICB9KS5tYXAoZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuIG5ldyBTdGFuZGFyZEtleWJvYXJkRXZlbnQoZSk7CiAgICB9KTsKICAgIG9uS2V5RG93bi5maWx0ZXIoZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuIGUua2V5Q29kZSA9PT0gMiAvKiBLZXlDb2RlLlRhYiAqLyAmJiAhZS5jdHJsS2V5ICYmICFlLm1ldGFLZXkgJiYgIWUuc2hpZnRLZXkgJiYgIWUuYWx0S2V5OwogICAgfSkub24odGhpcy5vblRhYiwgdGhpcywgdGhpcy5kaXNwb3NhYmxlcyk7CiAgfQogIF9jcmVhdGVDbGFzcyhET01Gb2N1c0NvbnRyb2xsZXIsIFt7CiAgICBrZXk6ICJvblRhYiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25UYWIoZSkgewogICAgICBpZiAoZS50YXJnZXQgIT09IHRoaXMudmlldy5kb21Ob2RlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHZhciBmb2N1cyA9IHRoaXMubGlzdC5nZXRGb2N1cygpOwogICAgICBpZiAoZm9jdXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHZhciBmb2N1c2VkRG9tRWxlbWVudCA9IHRoaXMudmlldy5kb21FbGVtZW50KGZvY3VzWzBdKTsKICAgICAgaWYgKCFmb2N1c2VkRG9tRWxlbWVudCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB2YXIgdGFiSW5kZXhFbGVtZW50ID0gZm9jdXNlZERvbUVsZW1lbnQucXVlcnlTZWxlY3RvcignW3RhYkluZGV4XScpOwogICAgICBpZiAoIXRhYkluZGV4RWxlbWVudCB8fCAhKHRhYkluZGV4RWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB8fCB0YWJJbmRleEVsZW1lbnQudGFiSW5kZXggPT09IC0xKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHZhciBzdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRhYkluZGV4RWxlbWVudCk7CiAgICAgIGlmIChzdHlsZS52aXNpYmlsaXR5ID09PSAnaGlkZGVuJyB8fCBzdHlsZS5kaXNwbGF5ID09PSAnbm9uZScpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICB0YWJJbmRleEVsZW1lbnQuZm9jdXMoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkaXNwb3NlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNwb3NlKCkgewogICAgICB0aGlzLmRpc3Bvc2FibGVzLmRpc3Bvc2UoKTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIERPTUZvY3VzQ29udHJvbGxlcjsKfSgpOwpleHBvcnQgZnVuY3Rpb24gaXNTZWxlY3Rpb25TaW5nbGVDaGFuZ2VFdmVudChldmVudCkgewogIHJldHVybiBwbGF0Zm9ybS5pc01hY2ludG9zaCA/IGV2ZW50LmJyb3dzZXJFdmVudC5tZXRhS2V5IDogZXZlbnQuYnJvd3NlckV2ZW50LmN0cmxLZXk7Cn0KZXhwb3J0IGZ1bmN0aW9uIGlzU2VsZWN0aW9uUmFuZ2VDaGFuZ2VFdmVudChldmVudCkgewogIHJldHVybiBldmVudC5icm93c2VyRXZlbnQuc2hpZnRLZXk7Cn0KZnVuY3Rpb24gaXNNb3VzZVJpZ2h0Q2xpY2soZXZlbnQpIHsKICByZXR1cm4gZXZlbnQgaW5zdGFuY2VvZiBNb3VzZUV2ZW50ICYmIGV2ZW50LmJ1dHRvbiA9PT0gMjsKfQp2YXIgRGVmYXVsdE11bHRpcGxlU2VsZWN0aW9uQ29udHJvbGxlciA9IHsKICBpc1NlbGVjdGlvblNpbmdsZUNoYW5nZUV2ZW50OiBpc1NlbGVjdGlvblNpbmdsZUNoYW5nZUV2ZW50LAogIGlzU2VsZWN0aW9uUmFuZ2VDaGFuZ2VFdmVudDogaXNTZWxlY3Rpb25SYW5nZUNoYW5nZUV2ZW50Cn07CmV4cG9ydCB2YXIgTW91c2VDb250cm9sbGVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBNb3VzZUNvbnRyb2xsZXIobGlzdCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1vdXNlQ29udHJvbGxlcik7CiAgICB0aGlzLmxpc3QgPSBsaXN0OwogICAgdGhpcy5kaXNwb3NhYmxlcyA9IG5ldyBEaXNwb3NhYmxlU3RvcmUoKTsKICAgIHRoaXMuX29uUG9pbnRlciA9IG5ldyBFbWl0dGVyKCk7CiAgICB0aGlzLm9uUG9pbnRlciA9IHRoaXMuX29uUG9pbnRlci5ldmVudDsKICAgIGlmIChsaXN0Lm9wdGlvbnMubXVsdGlwbGVTZWxlY3Rpb25TdXBwb3J0ICE9PSBmYWxzZSkgewogICAgICB0aGlzLm11bHRpcGxlU2VsZWN0aW9uQ29udHJvbGxlciA9IHRoaXMubGlzdC5vcHRpb25zLm11bHRpcGxlU2VsZWN0aW9uQ29udHJvbGxlciB8fCBEZWZhdWx0TXVsdGlwbGVTZWxlY3Rpb25Db250cm9sbGVyOwogICAgfQogICAgdGhpcy5tb3VzZVN1cHBvcnQgPSB0eXBlb2YgbGlzdC5vcHRpb25zLm1vdXNlU3VwcG9ydCA9PT0gJ3VuZGVmaW5lZCcgfHwgISFsaXN0Lm9wdGlvbnMubW91c2VTdXBwb3J0OwogICAgaWYgKHRoaXMubW91c2VTdXBwb3J0KSB7CiAgICAgIGxpc3Qub25Nb3VzZURvd24odGhpcy5vbk1vdXNlRG93biwgdGhpcywgdGhpcy5kaXNwb3NhYmxlcyk7CiAgICAgIGxpc3Qub25Db250ZXh0TWVudSh0aGlzLm9uQ29udGV4dE1lbnUsIHRoaXMsIHRoaXMuZGlzcG9zYWJsZXMpOwogICAgICBsaXN0Lm9uTW91c2VEYmxDbGljayh0aGlzLm9uRG91YmxlQ2xpY2ssIHRoaXMsIHRoaXMuZGlzcG9zYWJsZXMpOwogICAgICBsaXN0Lm9uVG91Y2hTdGFydCh0aGlzLm9uTW91c2VEb3duLCB0aGlzLCB0aGlzLmRpc3Bvc2FibGVzKTsKICAgICAgdGhpcy5kaXNwb3NhYmxlcy5hZGQoR2VzdHVyZS5hZGRUYXJnZXQobGlzdC5nZXRIVE1MRWxlbWVudCgpKSk7CiAgICB9CiAgICBFdmVudC5hbnkobGlzdC5vbk1vdXNlQ2xpY2ssIGxpc3Qub25Nb3VzZU1pZGRsZUNsaWNrLCBsaXN0Lm9uVGFwKSh0aGlzLm9uVmlld1BvaW50ZXIsIHRoaXMsIHRoaXMuZGlzcG9zYWJsZXMpOwogIH0KICBfY3JlYXRlQ2xhc3MoTW91c2VDb250cm9sbGVyLCBbewogICAga2V5OiAidXBkYXRlT3B0aW9ucyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlT3B0aW9ucyhvcHRpb25zVXBkYXRlKSB7CiAgICAgIGlmIChvcHRpb25zVXBkYXRlLm11bHRpcGxlU2VsZWN0aW9uU3VwcG9ydCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdGhpcy5tdWx0aXBsZVNlbGVjdGlvbkNvbnRyb2xsZXIgPSB1bmRlZmluZWQ7CiAgICAgICAgaWYgKG9wdGlvbnNVcGRhdGUubXVsdGlwbGVTZWxlY3Rpb25TdXBwb3J0KSB7CiAgICAgICAgICB0aGlzLm11bHRpcGxlU2VsZWN0aW9uQ29udHJvbGxlciA9IHRoaXMubGlzdC5vcHRpb25zLm11bHRpcGxlU2VsZWN0aW9uQ29udHJvbGxlciB8fCBEZWZhdWx0TXVsdGlwbGVTZWxlY3Rpb25Db250cm9sbGVyOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImlzU2VsZWN0aW9uU2luZ2xlQ2hhbmdlRXZlbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlzU2VsZWN0aW9uU2luZ2xlQ2hhbmdlRXZlbnQoZXZlbnQpIHsKICAgICAgaWYgKCF0aGlzLm11bHRpcGxlU2VsZWN0aW9uQ29udHJvbGxlcikgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5tdWx0aXBsZVNlbGVjdGlvbkNvbnRyb2xsZXIuaXNTZWxlY3Rpb25TaW5nbGVDaGFuZ2VFdmVudChldmVudCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNTZWxlY3Rpb25SYW5nZUNoYW5nZUV2ZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpc1NlbGVjdGlvblJhbmdlQ2hhbmdlRXZlbnQoZXZlbnQpIHsKICAgICAgaWYgKCF0aGlzLm11bHRpcGxlU2VsZWN0aW9uQ29udHJvbGxlcikgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5tdWx0aXBsZVNlbGVjdGlvbkNvbnRyb2xsZXIuaXNTZWxlY3Rpb25SYW5nZUNoYW5nZUV2ZW50KGV2ZW50KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpc1NlbGVjdGlvbkNoYW5nZUV2ZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpc1NlbGVjdGlvbkNoYW5nZUV2ZW50KGV2ZW50KSB7CiAgICAgIHJldHVybiB0aGlzLmlzU2VsZWN0aW9uU2luZ2xlQ2hhbmdlRXZlbnQoZXZlbnQpIHx8IHRoaXMuaXNTZWxlY3Rpb25SYW5nZUNoYW5nZUV2ZW50KGV2ZW50KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvbk1vdXNlRG93biIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25Nb3VzZURvd24oZSkgewogICAgICBpZiAoaXNNb25hY29FZGl0b3IoZS5icm93c2VyRXZlbnQudGFyZ2V0KSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAhPT0gZS5icm93c2VyRXZlbnQudGFyZ2V0KSB7CiAgICAgICAgdGhpcy5saXN0LmRvbUZvY3VzKCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJvbkNvbnRleHRNZW51IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkNvbnRleHRNZW51KGUpIHsKICAgICAgaWYgKGlzTW9uYWNvRWRpdG9yKGUuYnJvd3NlckV2ZW50LnRhcmdldCkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdmFyIGZvY3VzID0gdHlwZW9mIGUuaW5kZXggPT09ICd1bmRlZmluZWQnID8gW10gOiBbZS5pbmRleF07CiAgICAgIHRoaXMubGlzdC5zZXRGb2N1cyhmb2N1cywgZS5icm93c2VyRXZlbnQpOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uVmlld1BvaW50ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uVmlld1BvaW50ZXIoZSkgewogICAgICBpZiAoIXRoaXMubW91c2VTdXBwb3J0KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmIChpc0lucHV0RWxlbWVudChlLmJyb3dzZXJFdmVudC50YXJnZXQpIHx8IGlzTW9uYWNvRWRpdG9yKGUuYnJvd3NlckV2ZW50LnRhcmdldCkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdmFyIGZvY3VzID0gZS5pbmRleDsKICAgICAgaWYgKHR5cGVvZiBmb2N1cyA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICB0aGlzLmxpc3Quc2V0Rm9jdXMoW10sIGUuYnJvd3NlckV2ZW50KTsKICAgICAgICB0aGlzLmxpc3Quc2V0U2VsZWN0aW9uKFtdLCBlLmJyb3dzZXJFdmVudCk7CiAgICAgICAgdGhpcy5saXN0LnNldEFuY2hvcih1bmRlZmluZWQpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAodGhpcy5pc1NlbGVjdGlvblJhbmdlQ2hhbmdlRXZlbnQoZSkpIHsKICAgICAgICByZXR1cm4gdGhpcy5jaGFuZ2VTZWxlY3Rpb24oZSk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuaXNTZWxlY3Rpb25DaGFuZ2VFdmVudChlKSkgewogICAgICAgIHJldHVybiB0aGlzLmNoYW5nZVNlbGVjdGlvbihlKTsKICAgICAgfQogICAgICB0aGlzLmxpc3Quc2V0Rm9jdXMoW2ZvY3VzXSwgZS5icm93c2VyRXZlbnQpOwogICAgICB0aGlzLmxpc3Quc2V0QW5jaG9yKGZvY3VzKTsKICAgICAgaWYgKCFpc01vdXNlUmlnaHRDbGljayhlLmJyb3dzZXJFdmVudCkpIHsKICAgICAgICB0aGlzLmxpc3Quc2V0U2VsZWN0aW9uKFtmb2N1c10sIGUuYnJvd3NlckV2ZW50KTsKICAgICAgfQogICAgICB0aGlzLl9vblBvaW50ZXIuZmlyZShlKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvbkRvdWJsZUNsaWNrIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkRvdWJsZUNsaWNrKGUpIHsKICAgICAgaWYgKGlzSW5wdXRFbGVtZW50KGUuYnJvd3NlckV2ZW50LnRhcmdldCkgfHwgaXNNb25hY29FZGl0b3IoZS5icm93c2VyRXZlbnQudGFyZ2V0KSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAodGhpcy5pc1NlbGVjdGlvbkNoYW5nZUV2ZW50KGUpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHZhciBmb2N1cyA9IHRoaXMubGlzdC5nZXRGb2N1cygpOwogICAgICB0aGlzLmxpc3Quc2V0U2VsZWN0aW9uKGZvY3VzLCBlLmJyb3dzZXJFdmVudCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY2hhbmdlU2VsZWN0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjaGFuZ2VTZWxlY3Rpb24oZSkgewogICAgICB2YXIgZm9jdXMgPSBlLmluZGV4OwogICAgICB2YXIgYW5jaG9yID0gdGhpcy5saXN0LmdldEFuY2hvcigpOwogICAgICBpZiAodGhpcy5pc1NlbGVjdGlvblJhbmdlQ2hhbmdlRXZlbnQoZSkpIHsKICAgICAgICBpZiAodHlwZW9mIGFuY2hvciA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgIHZhciBjdXJyZW50Rm9jdXMgPSB0aGlzLmxpc3QuZ2V0Rm9jdXMoKVswXTsKICAgICAgICAgIGFuY2hvciA9IGN1cnJlbnRGb2N1cyAhPT0gbnVsbCAmJiBjdXJyZW50Rm9jdXMgIT09IHZvaWQgMCA/IGN1cnJlbnRGb2N1cyA6IGZvY3VzOwogICAgICAgICAgdGhpcy5saXN0LnNldEFuY2hvcihhbmNob3IpOwogICAgICAgIH0KICAgICAgICB2YXIgbWluID0gTWF0aC5taW4oYW5jaG9yLCBmb2N1cyk7CiAgICAgICAgdmFyIG1heCA9IE1hdGgubWF4KGFuY2hvciwgZm9jdXMpOwogICAgICAgIHZhciByYW5nZVNlbGVjdGlvbiA9IHJhbmdlKG1pbiwgbWF4ICsgMSk7CiAgICAgICAgdmFyIHNlbGVjdGlvbiA9IHRoaXMubGlzdC5nZXRTZWxlY3Rpb24oKTsKICAgICAgICB2YXIgY29udGlndW91c1JhbmdlID0gZ2V0Q29udGlndW91c1JhbmdlQ29udGFpbmluZyhkaXNqdW5jdGlvbihzZWxlY3Rpb24sIFthbmNob3JdKSwgYW5jaG9yKTsKICAgICAgICBpZiAoY29udGlndW91c1JhbmdlLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB2YXIgbmV3U2VsZWN0aW9uID0gZGlzanVuY3Rpb24ocmFuZ2VTZWxlY3Rpb24sIHJlbGF0aXZlQ29tcGxlbWVudChzZWxlY3Rpb24sIGNvbnRpZ3VvdXNSYW5nZSkpOwogICAgICAgIHRoaXMubGlzdC5zZXRTZWxlY3Rpb24obmV3U2VsZWN0aW9uLCBlLmJyb3dzZXJFdmVudCk7CiAgICAgICAgdGhpcy5saXN0LnNldEZvY3VzKFtmb2N1c10sIGUuYnJvd3NlckV2ZW50KTsKICAgICAgfSBlbHNlIGlmICh0aGlzLmlzU2VsZWN0aW9uU2luZ2xlQ2hhbmdlRXZlbnQoZSkpIHsKICAgICAgICB2YXIgX3NlbGVjdGlvbiA9IHRoaXMubGlzdC5nZXRTZWxlY3Rpb24oKTsKICAgICAgICB2YXIgX25ld1NlbGVjdGlvbiA9IF9zZWxlY3Rpb24uZmlsdGVyKGZ1bmN0aW9uIChpKSB7CiAgICAgICAgICByZXR1cm4gaSAhPT0gZm9jdXM7CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5saXN0LnNldEZvY3VzKFtmb2N1c10pOwogICAgICAgIHRoaXMubGlzdC5zZXRBbmNob3IoZm9jdXMpOwogICAgICAgIGlmIChfc2VsZWN0aW9uLmxlbmd0aCA9PT0gX25ld1NlbGVjdGlvbi5sZW5ndGgpIHsKICAgICAgICAgIHRoaXMubGlzdC5zZXRTZWxlY3Rpb24oW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShfbmV3U2VsZWN0aW9uKSwgW2ZvY3VzXSksIGUuYnJvd3NlckV2ZW50KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5saXN0LnNldFNlbGVjdGlvbihfbmV3U2VsZWN0aW9uLCBlLmJyb3dzZXJFdmVudCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiZGlzcG9zZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzcG9zZSgpIHsKICAgICAgdGhpcy5kaXNwb3NhYmxlcy5kaXNwb3NlKCk7CiAgICB9CiAgfV0pOwogIHJldHVybiBNb3VzZUNvbnRyb2xsZXI7Cn0oKTsKZXhwb3J0IHZhciBEZWZhdWx0U3R5bGVDb250cm9sbGVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBEZWZhdWx0U3R5bGVDb250cm9sbGVyKHN0eWxlRWxlbWVudCwgc2VsZWN0b3JTdWZmaXgpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBEZWZhdWx0U3R5bGVDb250cm9sbGVyKTsKICAgIHRoaXMuc3R5bGVFbGVtZW50ID0gc3R5bGVFbGVtZW50OwogICAgdGhpcy5zZWxlY3RvclN1ZmZpeCA9IHNlbGVjdG9yU3VmZml4OwogIH0KICBfY3JlYXRlQ2xhc3MoRGVmYXVsdFN0eWxlQ29udHJvbGxlciwgW3sKICAgIGtleTogInN0eWxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzdHlsZShzdHlsZXMpIHsKICAgICAgdmFyIHN1ZmZpeCA9IHRoaXMuc2VsZWN0b3JTdWZmaXggJiYgIi4iLmNvbmNhdCh0aGlzLnNlbGVjdG9yU3VmZml4KTsKICAgICAgdmFyIGNvbnRlbnQgPSBbXTsKICAgICAgaWYgKHN0eWxlcy5saXN0QmFja2dyb3VuZCkgewogICAgICAgIGlmIChzdHlsZXMubGlzdEJhY2tncm91bmQuaXNPcGFxdWUoKSkgewogICAgICAgICAgY29udGVudC5wdXNoKCIubW9uYWNvLWxpc3QiLmNvbmNhdChzdWZmaXgsICIgLm1vbmFjby1saXN0LXJvd3MgeyBiYWNrZ3JvdW5kOiAiKS5jb25jYXQoc3R5bGVzLmxpc3RCYWNrZ3JvdW5kLCAiOyB9IikpOwogICAgICAgIH0gZWxzZSBpZiAoIXBsYXRmb3JtLmlzTWFjaW50b3NoKSB7CiAgICAgICAgICAvLyBzdWJwaXhlbCBBQSBkb2Vzbid0IGV4aXN0IGluIG1hY09TCiAgICAgICAgICBjb25zb2xlLndhcm4oIkxpc3Qgd2l0aCBpZCAnIi5jb25jYXQodGhpcy5zZWxlY3RvclN1ZmZpeCwgIicgd2FzIHN0eWxlZCB3aXRoIGEgbm9uLW9wYXF1ZSBiYWNrZ3JvdW5kIGNvbG9yLiBUaGlzIHdpbGwgYnJlYWsgc3ViLXBpeGVsIGFudGlhbGlhc2luZy4iKSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChzdHlsZXMubGlzdEZvY3VzQmFja2dyb3VuZCkgewogICAgICAgIGNvbnRlbnQucHVzaCgiLm1vbmFjby1saXN0Ii5jb25jYXQoc3VmZml4LCAiOmZvY3VzIC5tb25hY28tbGlzdC1yb3cuZm9jdXNlZCB7IGJhY2tncm91bmQtY29sb3I6ICIpLmNvbmNhdChzdHlsZXMubGlzdEZvY3VzQmFja2dyb3VuZCwgIjsgfSIpKTsKICAgICAgICBjb250ZW50LnB1c2goIi5tb25hY28tbGlzdCIuY29uY2F0KHN1ZmZpeCwgIjpmb2N1cyAubW9uYWNvLWxpc3Qtcm93LmZvY3VzZWQ6aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOiAiKS5jb25jYXQoc3R5bGVzLmxpc3RGb2N1c0JhY2tncm91bmQsICI7IH0iKSk7IC8vIG92ZXJ3cml0ZSA6aG92ZXIgc3R5bGUgaW4gdGhpcyBjYXNlIQogICAgICB9CgogICAgICBpZiAoc3R5bGVzLmxpc3RGb2N1c0ZvcmVncm91bmQpIHsKICAgICAgICBjb250ZW50LnB1c2goIi5tb25hY28tbGlzdCIuY29uY2F0KHN1ZmZpeCwgIjpmb2N1cyAubW9uYWNvLWxpc3Qtcm93LmZvY3VzZWQgeyBjb2xvcjogIikuY29uY2F0KHN0eWxlcy5saXN0Rm9jdXNGb3JlZ3JvdW5kLCAiOyB9IikpOwogICAgICB9CiAgICAgIGlmIChzdHlsZXMubGlzdEFjdGl2ZVNlbGVjdGlvbkJhY2tncm91bmQpIHsKICAgICAgICBjb250ZW50LnB1c2goIi5tb25hY28tbGlzdCIuY29uY2F0KHN1ZmZpeCwgIjpmb2N1cyAubW9uYWNvLWxpc3Qtcm93LnNlbGVjdGVkIHsgYmFja2dyb3VuZC1jb2xvcjogIikuY29uY2F0KHN0eWxlcy5saXN0QWN0aXZlU2VsZWN0aW9uQmFja2dyb3VuZCwgIjsgfSIpKTsKICAgICAgICBjb250ZW50LnB1c2goIi5tb25hY28tbGlzdCIuY29uY2F0KHN1ZmZpeCwgIjpmb2N1cyAubW9uYWNvLWxpc3Qtcm93LnNlbGVjdGVkOmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjogIikuY29uY2F0KHN0eWxlcy5saXN0QWN0aXZlU2VsZWN0aW9uQmFja2dyb3VuZCwgIjsgfSIpKTsgLy8gb3ZlcndyaXRlIDpob3ZlciBzdHlsZSBpbiB0aGlzIGNhc2UhCiAgICAgIH0KCiAgICAgIGlmIChzdHlsZXMubGlzdEFjdGl2ZVNlbGVjdGlvbkZvcmVncm91bmQpIHsKICAgICAgICBjb250ZW50LnB1c2goIi5tb25hY28tbGlzdCIuY29uY2F0KHN1ZmZpeCwgIjpmb2N1cyAubW9uYWNvLWxpc3Qtcm93LnNlbGVjdGVkIHsgY29sb3I6ICIpLmNvbmNhdChzdHlsZXMubGlzdEFjdGl2ZVNlbGVjdGlvbkZvcmVncm91bmQsICI7IH0iKSk7CiAgICAgIH0KICAgICAgaWYgKHN0eWxlcy5saXN0QWN0aXZlU2VsZWN0aW9uSWNvbkZvcmVncm91bmQpIHsKICAgICAgICBjb250ZW50LnB1c2goIi5tb25hY28tbGlzdCIuY29uY2F0KHN1ZmZpeCwgIjpmb2N1cyAubW9uYWNvLWxpc3Qtcm93LnNlbGVjdGVkIC5jb2RpY29uIHsgY29sb3I6ICIpLmNvbmNhdChzdHlsZXMubGlzdEFjdGl2ZVNlbGVjdGlvbkljb25Gb3JlZ3JvdW5kLCAiOyB9IikpOwogICAgICB9CiAgICAgIGlmIChzdHlsZXMubGlzdEZvY3VzQW5kU2VsZWN0aW9uT3V0bGluZSkgewogICAgICAgIGNvbnRlbnQucHVzaCgiLm1vbmFjby1saXN0Ii5jb25jYXQoc3VmZml4LCAiOmZvY3VzIC5tb25hY28tbGlzdC1yb3cuc2VsZWN0ZWQgeyBvdXRsaW5lLWNvbG9yOiAiKS5jb25jYXQoc3R5bGVzLmxpc3RGb2N1c0FuZFNlbGVjdGlvbk91dGxpbmUsICIgIWltcG9ydGFudDsgfSIpKTsKICAgICAgfQogICAgICBpZiAoc3R5bGVzLmxpc3RGb2N1c0FuZFNlbGVjdGlvbkJhY2tncm91bmQpIHsKICAgICAgICBjb250ZW50LnB1c2goIlxuXHRcdFx0XHQubW9uYWNvLWRyYWctaW1hZ2UsXG5cdFx0XHRcdC5tb25hY28tbGlzdCIuY29uY2F0KHN1ZmZpeCwgIjpmb2N1cyAubW9uYWNvLWxpc3Qtcm93LnNlbGVjdGVkLmZvY3VzZWQgeyBiYWNrZ3JvdW5kLWNvbG9yOiAiKS5jb25jYXQoc3R5bGVzLmxpc3RGb2N1c0FuZFNlbGVjdGlvbkJhY2tncm91bmQsICI7IH1cblx0XHRcdCIpKTsKICAgICAgfQogICAgICBpZiAoc3R5bGVzLmxpc3RGb2N1c0FuZFNlbGVjdGlvbkZvcmVncm91bmQpIHsKICAgICAgICBjb250ZW50LnB1c2goIlxuXHRcdFx0XHQubW9uYWNvLWRyYWctaW1hZ2UsXG5cdFx0XHRcdC5tb25hY28tbGlzdCIuY29uY2F0KHN1ZmZpeCwgIjpmb2N1cyAubW9uYWNvLWxpc3Qtcm93LnNlbGVjdGVkLmZvY3VzZWQgeyBjb2xvcjogIikuY29uY2F0KHN0eWxlcy5saXN0Rm9jdXNBbmRTZWxlY3Rpb25Gb3JlZ3JvdW5kLCAiOyB9XG5cdFx0XHQiKSk7CiAgICAgIH0KICAgICAgaWYgKHN0eWxlcy5saXN0SW5hY3RpdmVGb2N1c0ZvcmVncm91bmQpIHsKICAgICAgICBjb250ZW50LnB1c2goIi5tb25hY28tbGlzdCIuY29uY2F0KHN1ZmZpeCwgIiAubW9uYWNvLWxpc3Qtcm93LmZvY3VzZWQgeyBjb2xvcjogICIpLmNvbmNhdChzdHlsZXMubGlzdEluYWN0aXZlRm9jdXNGb3JlZ3JvdW5kLCAiOyB9IikpOwogICAgICAgIGNvbnRlbnQucHVzaCgiLm1vbmFjby1saXN0Ii5jb25jYXQoc3VmZml4LCAiIC5tb25hY28tbGlzdC1yb3cuZm9jdXNlZDpob3ZlciB7IGNvbG9yOiAgIikuY29uY2F0KHN0eWxlcy5saXN0SW5hY3RpdmVGb2N1c0ZvcmVncm91bmQsICI7IH0iKSk7IC8vIG92ZXJ3cml0ZSA6aG92ZXIgc3R5bGUgaW4gdGhpcyBjYXNlIQogICAgICB9CgogICAgICBpZiAoc3R5bGVzLmxpc3RJbmFjdGl2ZVNlbGVjdGlvbkljb25Gb3JlZ3JvdW5kKSB7CiAgICAgICAgY29udGVudC5wdXNoKCIubW9uYWNvLWxpc3QiLmNvbmNhdChzdWZmaXgsICIgLm1vbmFjby1saXN0LXJvdy5mb2N1c2VkIC5jb2RpY29uIHsgY29sb3I6ICAiKS5jb25jYXQoc3R5bGVzLmxpc3RJbmFjdGl2ZVNlbGVjdGlvbkljb25Gb3JlZ3JvdW5kLCAiOyB9IikpOwogICAgICB9CiAgICAgIGlmIChzdHlsZXMubGlzdEluYWN0aXZlRm9jdXNCYWNrZ3JvdW5kKSB7CiAgICAgICAgY29udGVudC5wdXNoKCIubW9uYWNvLWxpc3QiLmNvbmNhdChzdWZmaXgsICIgLm1vbmFjby1saXN0LXJvdy5mb2N1c2VkIHsgYmFja2dyb3VuZC1jb2xvcjogICIpLmNvbmNhdChzdHlsZXMubGlzdEluYWN0aXZlRm9jdXNCYWNrZ3JvdW5kLCAiOyB9IikpOwogICAgICAgIGNvbnRlbnQucHVzaCgiLm1vbmFjby1saXN0Ii5jb25jYXQoc3VmZml4LCAiIC5tb25hY28tbGlzdC1yb3cuZm9jdXNlZDpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6ICAiKS5jb25jYXQoc3R5bGVzLmxpc3RJbmFjdGl2ZUZvY3VzQmFja2dyb3VuZCwgIjsgfSIpKTsgLy8gb3ZlcndyaXRlIDpob3ZlciBzdHlsZSBpbiB0aGlzIGNhc2UhCiAgICAgIH0KCiAgICAgIGlmIChzdHlsZXMubGlzdEluYWN0aXZlU2VsZWN0aW9uQmFja2dyb3VuZCkgewogICAgICAgIGNvbnRlbnQucHVzaCgiLm1vbmFjby1saXN0Ii5jb25jYXQoc3VmZml4LCAiIC5tb25hY28tbGlzdC1yb3cuc2VsZWN0ZWQgeyBiYWNrZ3JvdW5kLWNvbG9yOiAgIikuY29uY2F0KHN0eWxlcy5saXN0SW5hY3RpdmVTZWxlY3Rpb25CYWNrZ3JvdW5kLCAiOyB9IikpOwogICAgICAgIGNvbnRlbnQucHVzaCgiLm1vbmFjby1saXN0Ii5jb25jYXQoc3VmZml4LCAiIC5tb25hY28tbGlzdC1yb3cuc2VsZWN0ZWQ6aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOiAgIikuY29uY2F0KHN0eWxlcy5saXN0SW5hY3RpdmVTZWxlY3Rpb25CYWNrZ3JvdW5kLCAiOyB9IikpOyAvLyBvdmVyd3JpdGUgOmhvdmVyIHN0eWxlIGluIHRoaXMgY2FzZSEKICAgICAgfQoKICAgICAgaWYgKHN0eWxlcy5saXN0SW5hY3RpdmVTZWxlY3Rpb25Gb3JlZ3JvdW5kKSB7CiAgICAgICAgY29udGVudC5wdXNoKCIubW9uYWNvLWxpc3QiLmNvbmNhdChzdWZmaXgsICIgLm1vbmFjby1saXN0LXJvdy5zZWxlY3RlZCB7IGNvbG9yOiAiKS5jb25jYXQoc3R5bGVzLmxpc3RJbmFjdGl2ZVNlbGVjdGlvbkZvcmVncm91bmQsICI7IH0iKSk7CiAgICAgIH0KICAgICAgaWYgKHN0eWxlcy5saXN0SG92ZXJCYWNrZ3JvdW5kKSB7CiAgICAgICAgY29udGVudC5wdXNoKCIubW9uYWNvLWxpc3QiLmNvbmNhdChzdWZmaXgsICI6bm90KC5kcm9wLXRhcmdldCkgLm1vbmFjby1saXN0LXJvdzpob3Zlcjpub3QoLnNlbGVjdGVkKTpub3QoLmZvY3VzZWQpIHsgYmFja2dyb3VuZC1jb2xvcjogIikuY29uY2F0KHN0eWxlcy5saXN0SG92ZXJCYWNrZ3JvdW5kLCAiOyB9IikpOwogICAgICB9CiAgICAgIGlmIChzdHlsZXMubGlzdEhvdmVyRm9yZWdyb3VuZCkgewogICAgICAgIGNvbnRlbnQucHVzaCgiLm1vbmFjby1saXN0Ii5jb25jYXQoc3VmZml4LCAiIC5tb25hY28tbGlzdC1yb3c6aG92ZXI6bm90KC5zZWxlY3RlZCk6bm90KC5mb2N1c2VkKSB7IGNvbG9yOiAgIikuY29uY2F0KHN0eWxlcy5saXN0SG92ZXJGb3JlZ3JvdW5kLCAiOyB9IikpOwogICAgICB9CiAgICAgIGlmIChzdHlsZXMubGlzdFNlbGVjdGlvbk91dGxpbmUpIHsKICAgICAgICBjb250ZW50LnB1c2goIi5tb25hY28tbGlzdCIuY29uY2F0KHN1ZmZpeCwgIiAubW9uYWNvLWxpc3Qtcm93LnNlbGVjdGVkIHsgb3V0bGluZTogMXB4IGRvdHRlZCAiKS5jb25jYXQoc3R5bGVzLmxpc3RTZWxlY3Rpb25PdXRsaW5lLCAiOyBvdXRsaW5lLW9mZnNldDogLTFweDsgfSIpKTsKICAgICAgfQogICAgICBpZiAoc3R5bGVzLmxpc3RGb2N1c091dGxpbmUpIHsKICAgICAgICBjb250ZW50LnB1c2goIlxuXHRcdFx0XHQubW9uYWNvLWRyYWctaW1hZ2UsXG5cdFx0XHRcdC5tb25hY28tbGlzdCIuY29uY2F0KHN1ZmZpeCwgIjpmb2N1cyAubW9uYWNvLWxpc3Qtcm93LmZvY3VzZWQgeyBvdXRsaW5lOiAxcHggc29saWQgIikuY29uY2F0KHN0eWxlcy5saXN0Rm9jdXNPdXRsaW5lLCAiOyBvdXRsaW5lLW9mZnNldDogLTFweDsgfVxuXHRcdFx0XHQubW9uYWNvLXdvcmtiZW5jaC5jb250ZXh0LW1lbnUtdmlzaWJsZSAubW9uYWNvLWxpc3QiKS5jb25jYXQoc3VmZml4LCAiLmxhc3QtZm9jdXNlZCAubW9uYWNvLWxpc3Qtcm93LmZvY3VzZWQgeyBvdXRsaW5lOiAxcHggc29saWQgIikuY29uY2F0KHN0eWxlcy5saXN0Rm9jdXNPdXRsaW5lLCAiOyBvdXRsaW5lLW9mZnNldDogLTFweDsgfVxuXHRcdFx0IikpOwogICAgICB9CiAgICAgIGlmIChzdHlsZXMubGlzdEluYWN0aXZlRm9jdXNPdXRsaW5lKSB7CiAgICAgICAgY29udGVudC5wdXNoKCIubW9uYWNvLWxpc3QiLmNvbmNhdChzdWZmaXgsICIgLm1vbmFjby1saXN0LXJvdy5mb2N1c2VkIHsgb3V0bGluZTogMXB4IGRvdHRlZCAiKS5jb25jYXQoc3R5bGVzLmxpc3RJbmFjdGl2ZUZvY3VzT3V0bGluZSwgIjsgb3V0bGluZS1vZmZzZXQ6IC0xcHg7IH0iKSk7CiAgICAgIH0KICAgICAgaWYgKHN0eWxlcy5saXN0SG92ZXJPdXRsaW5lKSB7CiAgICAgICAgY29udGVudC5wdXNoKCIubW9uYWNvLWxpc3QiLmNvbmNhdChzdWZmaXgsICIgLm1vbmFjby1saXN0LXJvdzpob3ZlciB7IG91dGxpbmU6IDFweCBkYXNoZWQgIikuY29uY2F0KHN0eWxlcy5saXN0SG92ZXJPdXRsaW5lLCAiOyBvdXRsaW5lLW9mZnNldDogLTFweDsgfSIpKTsKICAgICAgfQogICAgICBpZiAoc3R5bGVzLmxpc3REcm9wQmFja2dyb3VuZCkgewogICAgICAgIGNvbnRlbnQucHVzaCgiXG5cdFx0XHRcdC5tb25hY28tbGlzdCIuY29uY2F0KHN1ZmZpeCwgIi5kcm9wLXRhcmdldCxcblx0XHRcdFx0Lm1vbmFjby1saXN0IikuY29uY2F0KHN1ZmZpeCwgIiAubW9uYWNvLWxpc3Qtcm93cy5kcm9wLXRhcmdldCxcblx0XHRcdFx0Lm1vbmFjby1saXN0IikuY29uY2F0KHN1ZmZpeCwgIiAubW9uYWNvLWxpc3Qtcm93LmRyb3AtdGFyZ2V0IHsgYmFja2dyb3VuZC1jb2xvcjogIikuY29uY2F0KHN0eWxlcy5saXN0RHJvcEJhY2tncm91bmQsICIgIWltcG9ydGFudDsgY29sb3I6IGluaGVyaXQgIWltcG9ydGFudDsgfVxuXHRcdFx0IikpOwogICAgICB9CiAgICAgIGlmIChzdHlsZXMudGFibGVDb2x1bW5zQm9yZGVyKSB7CiAgICAgICAgY29udGVudC5wdXNoKCJcblx0XHRcdFx0Lm1vbmFjby10YWJsZTpob3ZlciA+IC5tb25hY28tc3BsaXQtdmlldzIsXG5cdFx0XHRcdC5tb25hY28tdGFibGU6aG92ZXIgPiAubW9uYWNvLXNwbGl0LXZpZXcyIC5tb25hY28tc2FzaC52ZXJ0aWNhbDo6YmVmb3JlIHtcblx0XHRcdFx0XHRib3JkZXItY29sb3I6ICIuY29uY2F0KHN0eWxlcy50YWJsZUNvbHVtbnNCb3JkZXIsICI7XG5cdFx0XHR9IikpOwogICAgICB9CiAgICAgIGlmIChzdHlsZXMudGFibGVPZGRSb3dzQmFja2dyb3VuZENvbG9yKSB7CiAgICAgICAgY29udGVudC5wdXNoKCJcblx0XHRcdFx0Lm1vbmFjby10YWJsZSAubW9uYWNvLWxpc3Qtcm93W2RhdGEtcGFyaXR5PW9kZF06bm90KC5mb2N1c2VkKTpub3QoLnNlbGVjdGVkKTpub3QoOmhvdmVyKSAubW9uYWNvLXRhYmxlLXRyLFxuXHRcdFx0XHQubW9uYWNvLXRhYmxlIC5tb25hY28tbGlzdDpub3QoOmZvY3VzKSAubW9uYWNvLWxpc3Qtcm93W2RhdGEtcGFyaXR5PW9kZF0uZm9jdXNlZDpub3QoLnNlbGVjdGVkKTpub3QoOmhvdmVyKSAubW9uYWNvLXRhYmxlLXRyLFxuXHRcdFx0XHQubW9uYWNvLXRhYmxlIC5tb25hY28tbGlzdDpub3QoLmZvY3VzZWQpIC5tb25hY28tbGlzdC1yb3dbZGF0YS1wYXJpdHk9b2RkXS5mb2N1c2VkOm5vdCguc2VsZWN0ZWQpOm5vdCg6aG92ZXIpIC5tb25hY28tdGFibGUtdHIge1xuXHRcdFx0XHRcdGJhY2tncm91bmQtY29sb3I6ICIuY29uY2F0KHN0eWxlcy50YWJsZU9kZFJvd3NCYWNrZ3JvdW5kQ29sb3IsICI7XG5cdFx0XHRcdH1cblx0XHRcdCIpKTsKICAgICAgfQogICAgICB0aGlzLnN0eWxlRWxlbWVudC50ZXh0Q29udGVudCA9IGNvbnRlbnQuam9pbignXG4nKTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIERlZmF1bHRTdHlsZUNvbnRyb2xsZXI7Cn0oKTsKdmFyIGRlZmF1bHRTdHlsZXMgPSB7CiAgbGlzdEZvY3VzQmFja2dyb3VuZDogQ29sb3IuZnJvbUhleCgnIzdGQjBEMCcpLAogIGxpc3RBY3RpdmVTZWxlY3Rpb25CYWNrZ3JvdW5kOiBDb2xvci5mcm9tSGV4KCcjMEU2MzlDJyksCiAgbGlzdEFjdGl2ZVNlbGVjdGlvbkZvcmVncm91bmQ6IENvbG9yLmZyb21IZXgoJyNGRkZGRkYnKSwKICBsaXN0QWN0aXZlU2VsZWN0aW9uSWNvbkZvcmVncm91bmQ6IENvbG9yLmZyb21IZXgoJyNGRkZGRkYnKSwKICBsaXN0Rm9jdXNBbmRTZWxlY3Rpb25PdXRsaW5lOiBDb2xvci5mcm9tSGV4KCcjOTBDMkY5JyksCiAgbGlzdEZvY3VzQW5kU2VsZWN0aW9uQmFja2dyb3VuZDogQ29sb3IuZnJvbUhleCgnIzA5NDc3MScpLAogIGxpc3RGb2N1c0FuZFNlbGVjdGlvbkZvcmVncm91bmQ6IENvbG9yLmZyb21IZXgoJyNGRkZGRkYnKSwKICBsaXN0SW5hY3RpdmVTZWxlY3Rpb25CYWNrZ3JvdW5kOiBDb2xvci5mcm9tSGV4KCcjM0YzRjQ2JyksCiAgbGlzdEluYWN0aXZlU2VsZWN0aW9uSWNvbkZvcmVncm91bmQ6IENvbG9yLmZyb21IZXgoJyNGRkZGRkYnKSwKICBsaXN0SG92ZXJCYWNrZ3JvdW5kOiBDb2xvci5mcm9tSGV4KCcjMkEyRDJFJyksCiAgbGlzdERyb3BCYWNrZ3JvdW5kOiBDb2xvci5mcm9tSGV4KCcjMzgzQjNEJyksCiAgdHJlZUluZGVudEd1aWRlc1N0cm9rZTogQ29sb3IuZnJvbUhleCgnI2E5YTlhOScpLAogIHRhYmxlQ29sdW1uc0JvcmRlcjogQ29sb3IuZnJvbUhleCgnI2NjY2NjYycpLnRyYW5zcGFyZW50KDAuMiksCiAgdGFibGVPZGRSb3dzQmFja2dyb3VuZENvbG9yOiBDb2xvci5mcm9tSGV4KCcjY2NjY2NjJykudHJhbnNwYXJlbnQoMC4wNCkKfTsKdmFyIERlZmF1bHRPcHRpb25zID0gewogIGtleWJvYXJkU3VwcG9ydDogdHJ1ZSwKICBtb3VzZVN1cHBvcnQ6IHRydWUsCiAgbXVsdGlwbGVTZWxlY3Rpb25TdXBwb3J0OiB0cnVlLAogIGRuZDogewogICAgZ2V0RHJhZ1VSSTogZnVuY3Rpb24gZ2V0RHJhZ1VSSSgpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9LAogICAgb25EcmFnU3RhcnQ6IGZ1bmN0aW9uIG9uRHJhZ1N0YXJ0KCkge30sCiAgICBvbkRyYWdPdmVyOiBmdW5jdGlvbiBvbkRyYWdPdmVyKCkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAogICAgZHJvcDogZnVuY3Rpb24gZHJvcCgpIHt9CiAgfQp9OwovLyBUT0RPQEpvYW86IG1vdmUgdGhlc2UgdXRpbHMgaW50byBhIFNvcnRlZEFycmF5IGNsYXNzCmZ1bmN0aW9uIGdldENvbnRpZ3VvdXNSYW5nZUNvbnRhaW5pbmcocmFuZ2UsIHZhbHVlKSB7CiAgdmFyIGluZGV4ID0gcmFuZ2UuaW5kZXhPZih2YWx1ZSk7CiAgaWYgKGluZGV4ID09PSAtMSkgewogICAgcmV0dXJuIFtdOwogIH0KICB2YXIgcmVzdWx0ID0gW107CiAgdmFyIGkgPSBpbmRleCAtIDE7CiAgd2hpbGUgKGkgPj0gMCAmJiByYW5nZVtpXSA9PT0gdmFsdWUgLSAoaW5kZXggLSBpKSkgewogICAgcmVzdWx0LnB1c2gocmFuZ2VbaS0tXSk7CiAgfQogIHJlc3VsdC5yZXZlcnNlKCk7CiAgaSA9IGluZGV4OwogIHdoaWxlIChpIDwgcmFuZ2UubGVuZ3RoICYmIHJhbmdlW2ldID09PSB2YWx1ZSArIChpIC0gaW5kZXgpKSB7CiAgICByZXN1bHQucHVzaChyYW5nZVtpKytdKTsKICB9CiAgcmV0dXJuIHJlc3VsdDsKfQovKioKICogR2l2ZW4gdHdvIHNvcnRlZCBjb2xsZWN0aW9ucyBvZiBudW1iZXJzLCByZXR1cm5zIHRoZSBpbnRlcnNlY3Rpb24KICogYmV0d2VlbiB0aGVtIChPUikuCiAqLwpmdW5jdGlvbiBkaXNqdW5jdGlvbihvbmUsIG90aGVyKSB7CiAgdmFyIHJlc3VsdCA9IFtdOwogIHZhciBpID0gMCwKICAgIGogPSAwOwogIHdoaWxlIChpIDwgb25lLmxlbmd0aCB8fCBqIDwgb3RoZXIubGVuZ3RoKSB7CiAgICBpZiAoaSA+PSBvbmUubGVuZ3RoKSB7CiAgICAgIHJlc3VsdC5wdXNoKG90aGVyW2orK10pOwogICAgfSBlbHNlIGlmIChqID49IG90aGVyLmxlbmd0aCkgewogICAgICByZXN1bHQucHVzaChvbmVbaSsrXSk7CiAgICB9IGVsc2UgaWYgKG9uZVtpXSA9PT0gb3RoZXJbal0pIHsKICAgICAgcmVzdWx0LnB1c2gob25lW2ldKTsKICAgICAgaSsrOwogICAgICBqKys7CiAgICAgIGNvbnRpbnVlOwogICAgfSBlbHNlIGlmIChvbmVbaV0gPCBvdGhlcltqXSkgewogICAgICByZXN1bHQucHVzaChvbmVbaSsrXSk7CiAgICB9IGVsc2UgewogICAgICByZXN1bHQucHVzaChvdGhlcltqKytdKTsKICAgIH0KICB9CiAgcmV0dXJuIHJlc3VsdDsKfQovKioKICogR2l2ZW4gdHdvIHNvcnRlZCBjb2xsZWN0aW9ucyBvZiBudW1iZXJzLCByZXR1cm5zIHRoZSByZWxhdGl2ZQogKiBjb21wbGVtZW50IGJldHdlZW4gdGhlbSAoWE9SKS4KICovCmZ1bmN0aW9uIHJlbGF0aXZlQ29tcGxlbWVudChvbmUsIG90aGVyKSB7CiAgdmFyIHJlc3VsdCA9IFtdOwogIHZhciBpID0gMCwKICAgIGogPSAwOwogIHdoaWxlIChpIDwgb25lLmxlbmd0aCB8fCBqIDwgb3RoZXIubGVuZ3RoKSB7CiAgICBpZiAoaSA+PSBvbmUubGVuZ3RoKSB7CiAgICAgIHJlc3VsdC5wdXNoKG90aGVyW2orK10pOwogICAgfSBlbHNlIGlmIChqID49IG90aGVyLmxlbmd0aCkgewogICAgICByZXN1bHQucHVzaChvbmVbaSsrXSk7CiAgICB9IGVsc2UgaWYgKG9uZVtpXSA9PT0gb3RoZXJbal0pIHsKICAgICAgaSsrOwogICAgICBqKys7CiAgICAgIGNvbnRpbnVlOwogICAgfSBlbHNlIGlmIChvbmVbaV0gPCBvdGhlcltqXSkgewogICAgICByZXN1bHQucHVzaChvbmVbaSsrXSk7CiAgICB9IGVsc2UgewogICAgICBqKys7CiAgICB9CiAgfQogIHJldHVybiByZXN1bHQ7Cn0KdmFyIG51bWVyaWNTb3J0ID0gZnVuY3Rpb24gbnVtZXJpY1NvcnQoYSwgYikgewogIHJldHVybiBhIC0gYjsKfTsKdmFyIFBpcGVsaW5lUmVuZGVyZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFBpcGVsaW5lUmVuZGVyZXIoX3RlbXBsYXRlSWQsIHJlbmRlcmVycykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBpcGVsaW5lUmVuZGVyZXIpOwogICAgdGhpcy5fdGVtcGxhdGVJZCA9IF90ZW1wbGF0ZUlkOwogICAgdGhpcy5yZW5kZXJlcnMgPSByZW5kZXJlcnM7CiAgfQogIF9jcmVhdGVDbGFzcyhQaXBlbGluZVJlbmRlcmVyLCBbewogICAga2V5OiAidGVtcGxhdGVJZCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3RlbXBsYXRlSWQ7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyVGVtcGxhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlclRlbXBsYXRlKGNvbnRhaW5lcikgewogICAgICByZXR1cm4gdGhpcy5yZW5kZXJlcnMubWFwKGZ1bmN0aW9uIChyKSB7CiAgICAgICAgcmV0dXJuIHIucmVuZGVyVGVtcGxhdGUoY29udGFpbmVyKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyRWxlbWVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyRWxlbWVudChlbGVtZW50LCBpbmRleCwgdGVtcGxhdGVEYXRhLCBoZWlnaHQpIHsKICAgICAgdmFyIGkgPSAwOwogICAgICB2YXIgX2l0ZXJhdG9yMyA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHRoaXMucmVuZGVyZXJzKSwKICAgICAgICBfc3RlcDM7CiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3IzLnMoKTsgIShfc3RlcDMgPSBfaXRlcmF0b3IzLm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciByZW5kZXJlciA9IF9zdGVwMy52YWx1ZTsKICAgICAgICAgIHJlbmRlcmVyLnJlbmRlckVsZW1lbnQoZWxlbWVudCwgaW5kZXgsIHRlbXBsYXRlRGF0YVtpKytdLCBoZWlnaHQpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yMy5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yMy5mKCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJkaXNwb3NlRWxlbWVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzcG9zZUVsZW1lbnQoZWxlbWVudCwgaW5kZXgsIHRlbXBsYXRlRGF0YSwgaGVpZ2h0KSB7CiAgICAgIHZhciBfYTsKICAgICAgdmFyIGkgPSAwOwogICAgICB2YXIgX2l0ZXJhdG9yNCA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHRoaXMucmVuZGVyZXJzKSwKICAgICAgICBfc3RlcDQ7CiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3I0LnMoKTsgIShfc3RlcDQgPSBfaXRlcmF0b3I0Lm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciByZW5kZXJlciA9IF9zdGVwNC52YWx1ZTsKICAgICAgICAgIChfYSA9IHJlbmRlcmVyLmRpc3Bvc2VFbGVtZW50KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuY2FsbChyZW5kZXJlciwgZWxlbWVudCwgaW5kZXgsIHRlbXBsYXRlRGF0YVtpXSwgaGVpZ2h0KTsKICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvcjQuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvcjQuZigpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiZGlzcG9zZVRlbXBsYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNwb3NlVGVtcGxhdGUodGVtcGxhdGVEYXRhKSB7CiAgICAgIHZhciBpID0gMDsKICAgICAgdmFyIF9pdGVyYXRvcjUgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih0aGlzLnJlbmRlcmVycyksCiAgICAgICAgX3N0ZXA1OwogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yNS5zKCk7ICEoX3N0ZXA1ID0gX2l0ZXJhdG9yNS5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgcmVuZGVyZXIgPSBfc3RlcDUudmFsdWU7CiAgICAgICAgICByZW5kZXJlci5kaXNwb3NlVGVtcGxhdGUodGVtcGxhdGVEYXRhW2krK10pOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yNS5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yNS5mKCk7CiAgICAgIH0KICAgIH0KICB9XSk7CiAgcmV0dXJuIFBpcGVsaW5lUmVuZGVyZXI7Cn0oKTsKdmFyIEFjY2Vzc2liaWx0eVJlbmRlcmVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBBY2Nlc3NpYmlsdHlSZW5kZXJlcihhY2Nlc3NpYmlsaXR5UHJvdmlkZXIpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBY2Nlc3NpYmlsdHlSZW5kZXJlcik7CiAgICB0aGlzLmFjY2Vzc2liaWxpdHlQcm92aWRlciA9IGFjY2Vzc2liaWxpdHlQcm92aWRlcjsKICAgIHRoaXMudGVtcGxhdGVJZCA9ICdhMThuJzsKICB9CiAgX2NyZWF0ZUNsYXNzKEFjY2Vzc2liaWx0eVJlbmRlcmVyLCBbewogICAga2V5OiAicmVuZGVyVGVtcGxhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlclRlbXBsYXRlKGNvbnRhaW5lcikgewogICAgICByZXR1cm4gY29udGFpbmVyOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlckVsZW1lbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlckVsZW1lbnQoZWxlbWVudCwgaW5kZXgsIGNvbnRhaW5lcikgewogICAgICB2YXIgYXJpYUxhYmVsID0gdGhpcy5hY2Nlc3NpYmlsaXR5UHJvdmlkZXIuZ2V0QXJpYUxhYmVsKGVsZW1lbnQpOwogICAgICBpZiAoYXJpYUxhYmVsKSB7CiAgICAgICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGFyaWFMYWJlbCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29udGFpbmVyLnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcpOwogICAgICB9CiAgICAgIHZhciBhcmlhTGV2ZWwgPSB0aGlzLmFjY2Vzc2liaWxpdHlQcm92aWRlci5nZXRBcmlhTGV2ZWwgJiYgdGhpcy5hY2Nlc3NpYmlsaXR5UHJvdmlkZXIuZ2V0QXJpYUxldmVsKGVsZW1lbnQpOwogICAgICBpZiAodHlwZW9mIGFyaWFMZXZlbCA9PT0gJ251bWJlcicpIHsKICAgICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKCdhcmlhLWxldmVsJywgIiIuY29uY2F0KGFyaWFMZXZlbCkpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnRhaW5lci5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtbGV2ZWwnKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImRpc3Bvc2VUZW1wbGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzcG9zZVRlbXBsYXRlKHRlbXBsYXRlRGF0YSkgewogICAgICAvLyBub29wCiAgICB9CiAgfV0pOwogIHJldHVybiBBY2Nlc3NpYmlsdHlSZW5kZXJlcjsKfSgpOwp2YXIgTGlzdFZpZXdEcmFnQW5kRHJvcCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gTGlzdFZpZXdEcmFnQW5kRHJvcChsaXN0LCBkbmQpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBMaXN0Vmlld0RyYWdBbmREcm9wKTsKICAgIHRoaXMubGlzdCA9IGxpc3Q7CiAgICB0aGlzLmRuZCA9IGRuZDsKICB9CiAgX2NyZWF0ZUNsYXNzKExpc3RWaWV3RHJhZ0FuZERyb3AsIFt7CiAgICBrZXk6ICJnZXREcmFnRWxlbWVudHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldERyYWdFbGVtZW50cyhlbGVtZW50KSB7CiAgICAgIHZhciBzZWxlY3Rpb24gPSB0aGlzLmxpc3QuZ2V0U2VsZWN0ZWRFbGVtZW50cygpOwogICAgICB2YXIgZWxlbWVudHMgPSBzZWxlY3Rpb24uaW5kZXhPZihlbGVtZW50KSA+IC0xID8gc2VsZWN0aW9uIDogW2VsZW1lbnRdOwogICAgICByZXR1cm4gZWxlbWVudHM7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0RHJhZ1VSSSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RHJhZ1VSSShlbGVtZW50KSB7CiAgICAgIHJldHVybiB0aGlzLmRuZC5nZXREcmFnVVJJKGVsZW1lbnQpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldERyYWdMYWJlbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RHJhZ0xhYmVsKGVsZW1lbnRzLCBvcmlnaW5hbEV2ZW50KSB7CiAgICAgIGlmICh0aGlzLmRuZC5nZXREcmFnTGFiZWwpIHsKICAgICAgICByZXR1cm4gdGhpcy5kbmQuZ2V0RHJhZ0xhYmVsKGVsZW1lbnRzLCBvcmlnaW5hbEV2ZW50KTsKICAgICAgfQogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uRHJhZ1N0YXJ0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkRyYWdTdGFydChkYXRhLCBvcmlnaW5hbEV2ZW50KSB7CiAgICAgIHZhciBfYSwgX2I7CiAgICAgIChfYiA9IChfYSA9IHRoaXMuZG5kKS5vbkRyYWdTdGFydCkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmNhbGwoX2EsIGRhdGEsIG9yaWdpbmFsRXZlbnQpOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uRHJhZ092ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uRHJhZ092ZXIoZGF0YSwgdGFyZ2V0RWxlbWVudCwgdGFyZ2V0SW5kZXgsIG9yaWdpbmFsRXZlbnQpIHsKICAgICAgcmV0dXJuIHRoaXMuZG5kLm9uRHJhZ092ZXIoZGF0YSwgdGFyZ2V0RWxlbWVudCwgdGFyZ2V0SW5kZXgsIG9yaWdpbmFsRXZlbnQpOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uRHJhZ0xlYXZlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkRyYWdMZWF2ZShkYXRhLCB0YXJnZXRFbGVtZW50LCB0YXJnZXRJbmRleCwgb3JpZ2luYWxFdmVudCkgewogICAgICB2YXIgX2EsIF9iOwogICAgICAoX2IgPSAoX2EgPSB0aGlzLmRuZCkub25EcmFnTGVhdmUpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5jYWxsKF9hLCBkYXRhLCB0YXJnZXRFbGVtZW50LCB0YXJnZXRJbmRleCwgb3JpZ2luYWxFdmVudCk7CiAgICB9CiAgfSwgewogICAga2V5OiAib25EcmFnRW5kIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkRyYWdFbmQob3JpZ2luYWxFdmVudCkgewogICAgICB2YXIgX2EsIF9iOwogICAgICAoX2IgPSAoX2EgPSB0aGlzLmRuZCkub25EcmFnRW5kKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuY2FsbChfYSwgb3JpZ2luYWxFdmVudCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZHJvcCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZHJvcChkYXRhLCB0YXJnZXRFbGVtZW50LCB0YXJnZXRJbmRleCwgb3JpZ2luYWxFdmVudCkgewogICAgICB0aGlzLmRuZC5kcm9wKGRhdGEsIHRhcmdldEVsZW1lbnQsIHRhcmdldEluZGV4LCBvcmlnaW5hbEV2ZW50KTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIExpc3RWaWV3RHJhZ0FuZERyb3A7Cn0oKTsKLyoqCiAqIFRoZSB7QGxpbmsgTGlzdH0gaXMgYSB2aXJ0dWFsIHNjcm9sbGluZyB3aWRnZXQsIGJ1aWx0IG9uIHRvcCBvZiB0aGUge0BsaW5rIExpc3RWaWV3fQogKiB3aWRnZXQuCiAqCiAqIEZlYXR1cmVzOgogKiAtIEN1c3RvbWl6YWJsZSBrZXlib2FyZCBhbmQgbW91c2Ugc3VwcG9ydAogKiAtIEVsZW1lbnQgdHJhaXRzOiBmb2N1cywgc2VsZWN0aW9uLCBhY2hvcgogKiAtIEFjY2Vzc2liaWxpdHkgc3VwcG9ydAogKiAtIFRvdWNoIHN1cHBvcnQKICogLSBQZXJmb3JtYW50IHRlbXBsYXRlLWJhc2VkIHJlbmRlcmluZwogKiAtIEhvcml6b250YWwgc2Nyb2xsaW5nCiAqIC0gVmFyaWFibGUgZWxlbWVudCBoZWlnaHQgc3VwcG9ydAogKiAtIER5bmFtaWMgZWxlbWVudCBoZWlnaHQgc3VwcG9ydAogKiAtIERyYWctYW5kLWRyb3Agc3VwcG9ydAogKi8KZXhwb3J0IHZhciBMaXN0ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBMaXN0KHVzZXIsIGNvbnRhaW5lciwgdmlydHVhbERlbGVnYXRlLCByZW5kZXJlcnMpIHsKICAgIHZhciBfb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ICYmIGFyZ3VtZW50c1s0XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzRdIDogRGVmYXVsdE9wdGlvbnM7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTGlzdCk7CiAgICB2YXIgX2EsIF9iLCBfYywgX2Q7CiAgICB0aGlzLnVzZXIgPSB1c2VyOwogICAgdGhpcy5fb3B0aW9ucyA9IF9vcHRpb25zOwogICAgdGhpcy5mb2N1cyA9IG5ldyBUcmFpdCgnZm9jdXNlZCcpOwogICAgdGhpcy5hbmNob3IgPSBuZXcgVHJhaXQoJ2FuY2hvcicpOwogICAgdGhpcy5ldmVudEJ1ZmZlcmVyID0gbmV3IEV2ZW50QnVmZmVyZXIoKTsKICAgIHRoaXMuX2FyaWFMYWJlbCA9ICcnOwogICAgdGhpcy5kaXNwb3NhYmxlcyA9IG5ldyBEaXNwb3NhYmxlU3RvcmUoKTsKICAgIHRoaXMuX29uRGlkRGlzcG9zZSA9IG5ldyBFbWl0dGVyKCk7CiAgICB0aGlzLm9uRGlkRGlzcG9zZSA9IHRoaXMuX29uRGlkRGlzcG9zZS5ldmVudDsKICAgIHZhciByb2xlID0gdGhpcy5fb3B0aW9ucy5hY2Nlc3NpYmlsaXR5UHJvdmlkZXIgJiYgdGhpcy5fb3B0aW9ucy5hY2Nlc3NpYmlsaXR5UHJvdmlkZXIuZ2V0V2lkZ2V0Um9sZSA/IChfYSA9IHRoaXMuX29wdGlvbnMuYWNjZXNzaWJpbGl0eVByb3ZpZGVyKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZ2V0V2lkZ2V0Um9sZSgpIDogJ2xpc3QnOwogICAgdGhpcy5zZWxlY3Rpb24gPSBuZXcgU2VsZWN0aW9uVHJhaXQocm9sZSAhPT0gJ2xpc3Rib3gnKTsKICAgIG1peGluKF9vcHRpb25zLCBkZWZhdWx0U3R5bGVzLCBmYWxzZSk7CiAgICB2YXIgYmFzZVJlbmRlcmVycyA9IFt0aGlzLmZvY3VzLnJlbmRlcmVyLCB0aGlzLnNlbGVjdGlvbi5yZW5kZXJlcl07CiAgICB0aGlzLmFjY2Vzc2liaWxpdHlQcm92aWRlciA9IF9vcHRpb25zLmFjY2Vzc2liaWxpdHlQcm92aWRlcjsKICAgIGlmICh0aGlzLmFjY2Vzc2liaWxpdHlQcm92aWRlcikgewogICAgICBiYXNlUmVuZGVyZXJzLnB1c2gobmV3IEFjY2Vzc2liaWx0eVJlbmRlcmVyKHRoaXMuYWNjZXNzaWJpbGl0eVByb3ZpZGVyKSk7CiAgICAgIChfYyA9IChfYiA9IHRoaXMuYWNjZXNzaWJpbGl0eVByb3ZpZGVyKS5vbkRpZENoYW5nZUFjdGl2ZURlc2NlbmRhbnQpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5jYWxsKF9iLCB0aGlzLm9uRGlkQ2hhbmdlQWN0aXZlRGVzY2VuZGFudCwgdGhpcywgdGhpcy5kaXNwb3NhYmxlcyk7CiAgICB9CiAgICByZW5kZXJlcnMgPSByZW5kZXJlcnMubWFwKGZ1bmN0aW9uIChyKSB7CiAgICAgIHJldHVybiBuZXcgUGlwZWxpbmVSZW5kZXJlcihyLnRlbXBsYXRlSWQsIFtdLmNvbmNhdChiYXNlUmVuZGVyZXJzLCBbcl0pKTsKICAgIH0pOwogICAgdmFyIHZpZXdPcHRpb25zID0gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBfb3B0aW9ucyksIHsKICAgICAgZG5kOiBfb3B0aW9ucy5kbmQgJiYgbmV3IExpc3RWaWV3RHJhZ0FuZERyb3AodGhpcywgX29wdGlvbnMuZG5kKQogICAgfSk7CiAgICB0aGlzLnZpZXcgPSBuZXcgTGlzdFZpZXcoY29udGFpbmVyLCB2aXJ0dWFsRGVsZWdhdGUsIHJlbmRlcmVycywgdmlld09wdGlvbnMpOwogICAgdGhpcy52aWV3LmRvbU5vZGUuc2V0QXR0cmlidXRlKCdyb2xlJywgcm9sZSk7CiAgICBpZiAoX29wdGlvbnMuc3R5bGVDb250cm9sbGVyKSB7CiAgICAgIHRoaXMuc3R5bGVDb250cm9sbGVyID0gX29wdGlvbnMuc3R5bGVDb250cm9sbGVyKHRoaXMudmlldy5kb21JZCk7CiAgICB9IGVsc2UgewogICAgICB2YXIgc3R5bGVFbGVtZW50ID0gY3JlYXRlU3R5bGVTaGVldCh0aGlzLnZpZXcuZG9tTm9kZSk7CiAgICAgIHRoaXMuc3R5bGVDb250cm9sbGVyID0gbmV3IERlZmF1bHRTdHlsZUNvbnRyb2xsZXIoc3R5bGVFbGVtZW50LCB0aGlzLnZpZXcuZG9tSWQpOwogICAgfQogICAgdGhpcy5zcGxpY2VhYmxlID0gbmV3IENvbWJpbmVkU3BsaWNlYWJsZShbbmV3IFRyYWl0U3BsaWNlYWJsZSh0aGlzLmZvY3VzLCB0aGlzLnZpZXcsIF9vcHRpb25zLmlkZW50aXR5UHJvdmlkZXIpLCBuZXcgVHJhaXRTcGxpY2VhYmxlKHRoaXMuc2VsZWN0aW9uLCB0aGlzLnZpZXcsIF9vcHRpb25zLmlkZW50aXR5UHJvdmlkZXIpLCBuZXcgVHJhaXRTcGxpY2VhYmxlKHRoaXMuYW5jaG9yLCB0aGlzLnZpZXcsIF9vcHRpb25zLmlkZW50aXR5UHJvdmlkZXIpLCB0aGlzLnZpZXddKTsKICAgIHRoaXMuZGlzcG9zYWJsZXMuYWRkKHRoaXMuZm9jdXMpOwogICAgdGhpcy5kaXNwb3NhYmxlcy5hZGQodGhpcy5zZWxlY3Rpb24pOwogICAgdGhpcy5kaXNwb3NhYmxlcy5hZGQodGhpcy5hbmNob3IpOwogICAgdGhpcy5kaXNwb3NhYmxlcy5hZGQodGhpcy52aWV3KTsKICAgIHRoaXMuZGlzcG9zYWJsZXMuYWRkKHRoaXMuX29uRGlkRGlzcG9zZSk7CiAgICB0aGlzLmRpc3Bvc2FibGVzLmFkZChuZXcgRE9NRm9jdXNDb250cm9sbGVyKHRoaXMsIHRoaXMudmlldykpOwogICAgaWYgKHR5cGVvZiBfb3B0aW9ucy5rZXlib2FyZFN1cHBvcnQgIT09ICdib29sZWFuJyB8fCBfb3B0aW9ucy5rZXlib2FyZFN1cHBvcnQpIHsKICAgICAgdGhpcy5rZXlib2FyZENvbnRyb2xsZXIgPSBuZXcgS2V5Ym9hcmRDb250cm9sbGVyKHRoaXMsIHRoaXMudmlldywgX29wdGlvbnMpOwogICAgICB0aGlzLmRpc3Bvc2FibGVzLmFkZCh0aGlzLmtleWJvYXJkQ29udHJvbGxlcik7CiAgICB9CiAgICBpZiAoX29wdGlvbnMua2V5Ym9hcmROYXZpZ2F0aW9uTGFiZWxQcm92aWRlcikgewogICAgICB2YXIgZGVsZWdhdGUgPSBfb3B0aW9ucy5rZXlib2FyZE5hdmlnYXRpb25EZWxlZ2F0ZSB8fCBEZWZhdWx0S2V5Ym9hcmROYXZpZ2F0aW9uRGVsZWdhdGU7CiAgICAgIHRoaXMudHlwZU5hdmlnYXRpb25Db250cm9sbGVyID0gbmV3IFR5cGVOYXZpZ2F0aW9uQ29udHJvbGxlcih0aGlzLCB0aGlzLnZpZXcsIF9vcHRpb25zLmtleWJvYXJkTmF2aWdhdGlvbkxhYmVsUHJvdmlkZXIsIChfZCA9IF9vcHRpb25zLmtleWJvYXJkTmF2aWdhdGlvbkV2ZW50RmlsdGVyKSAhPT0gbnVsbCAmJiBfZCAhPT0gdm9pZCAwID8gX2QgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0sIGRlbGVnYXRlKTsKICAgICAgdGhpcy5kaXNwb3NhYmxlcy5hZGQodGhpcy50eXBlTmF2aWdhdGlvbkNvbnRyb2xsZXIpOwogICAgfQogICAgdGhpcy5tb3VzZUNvbnRyb2xsZXIgPSB0aGlzLmNyZWF0ZU1vdXNlQ29udHJvbGxlcihfb3B0aW9ucyk7CiAgICB0aGlzLmRpc3Bvc2FibGVzLmFkZCh0aGlzLm1vdXNlQ29udHJvbGxlcik7CiAgICB0aGlzLm9uRGlkQ2hhbmdlRm9jdXModGhpcy5fb25Gb2N1c0NoYW5nZSwgdGhpcywgdGhpcy5kaXNwb3NhYmxlcyk7CiAgICB0aGlzLm9uRGlkQ2hhbmdlU2VsZWN0aW9uKHRoaXMuX29uU2VsZWN0aW9uQ2hhbmdlLCB0aGlzLCB0aGlzLmRpc3Bvc2FibGVzKTsKICAgIGlmICh0aGlzLmFjY2Vzc2liaWxpdHlQcm92aWRlcikgewogICAgICB0aGlzLmFyaWFMYWJlbCA9IHRoaXMuYWNjZXNzaWJpbGl0eVByb3ZpZGVyLmdldFdpZGdldEFyaWFMYWJlbCgpOwogICAgfQogICAgaWYgKHRoaXMuX29wdGlvbnMubXVsdGlwbGVTZWxlY3Rpb25TdXBwb3J0ICE9PSBmYWxzZSkgewogICAgICB0aGlzLnZpZXcuZG9tTm9kZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtbXVsdGlzZWxlY3RhYmxlJywgJ3RydWUnKTsKICAgIH0KICB9CiAgX2NyZWF0ZUNsYXNzKExpc3QsIFt7CiAgICBrZXk6ICJvbkRpZENoYW5nZUZvY3VzIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKICAgICAgcmV0dXJuIEV2ZW50Lm1hcCh0aGlzLmV2ZW50QnVmZmVyZXIud3JhcEV2ZW50KHRoaXMuZm9jdXMub25DaGFuZ2UpLCBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBfdGhpczQudG9MaXN0RXZlbnQoZSk7CiAgICAgIH0sIHRoaXMuZGlzcG9zYWJsZXMpOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uRGlkQ2hhbmdlU2VsZWN0aW9uIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKICAgICAgcmV0dXJuIEV2ZW50Lm1hcCh0aGlzLmV2ZW50QnVmZmVyZXIud3JhcEV2ZW50KHRoaXMuc2VsZWN0aW9uLm9uQ2hhbmdlKSwgZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gX3RoaXM1LnRvTGlzdEV2ZW50KGUpOwogICAgICB9LCB0aGlzLmRpc3Bvc2FibGVzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkb21JZCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMudmlldy5kb21JZDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvbk1vdXNlQ2xpY2siLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLnZpZXcub25Nb3VzZUNsaWNrOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uTW91c2VEYmxDbGljayIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMudmlldy5vbk1vdXNlRGJsQ2xpY2s7CiAgICB9CiAgfSwgewogICAga2V5OiAib25Nb3VzZU1pZGRsZUNsaWNrIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy52aWV3Lm9uTW91c2VNaWRkbGVDbGljazsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvblBvaW50ZXIiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLm1vdXNlQ29udHJvbGxlci5vblBvaW50ZXI7CiAgICB9CiAgfSwgewogICAga2V5OiAib25Nb3VzZURvd24iLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLnZpZXcub25Nb3VzZURvd247CiAgICB9CiAgfSwgewogICAga2V5OiAib25Nb3VzZU92ZXIiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLnZpZXcub25Nb3VzZU92ZXI7CiAgICB9CiAgfSwgewogICAga2V5OiAib25Ub3VjaFN0YXJ0IiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy52aWV3Lm9uVG91Y2hTdGFydDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvblRhcCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMudmlldy5vblRhcDsKICAgIH0KICAgIC8qKgogICAgICogUG9zc2libGUgY29udGV4dCBtZW51IHRyaWdnZXIgZXZlbnRzOgogICAgICogLSBDb250ZXh0TWVudSBrZXkKICAgICAqIC0gU2hpZnQgRjEwCiAgICAgKiAtIEN0cmwgT3B0aW9uIFNoaWZ0IE0gKG1hY09TIHdpdGggVm9pY2VPdmVyKQogICAgICogLSBNb3VzZSByaWdodCBjbGljawogICAgICovCiAgfSwgewogICAga2V5OiAib25Db250ZXh0TWVudSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CiAgICAgIHZhciBkaWRKdXN0UHJlc3NDb250ZXh0TWVudUtleSA9IGZhbHNlOwogICAgICB2YXIgZnJvbUtleURvd24gPSB0aGlzLmRpc3Bvc2FibGVzLmFkZChFdmVudC5jaGFpbih0aGlzLmRpc3Bvc2FibGVzLmFkZChuZXcgRG9tRW1pdHRlcih0aGlzLnZpZXcuZG9tTm9kZSwgJ2tleWRvd24nKSkuZXZlbnQpKS5tYXAoZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gbmV3IFN0YW5kYXJkS2V5Ym9hcmRFdmVudChlKTsKICAgICAgfSkuZmlsdGVyKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGRpZEp1c3RQcmVzc0NvbnRleHRNZW51S2V5ID0gZS5rZXlDb2RlID09PSA1OCAvKiBLZXlDb2RlLkNvbnRleHRNZW51ICovIHx8IGUuc2hpZnRLZXkgJiYgZS5rZXlDb2RlID09PSA2OCAvKiBLZXlDb2RlLkYxMCAqLzsKICAgICAgfSkubWFwKHN0b3BFdmVudCkuZmlsdGVyKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0pLmV2ZW50OwogICAgICB2YXIgZnJvbUtleVVwID0gdGhpcy5kaXNwb3NhYmxlcy5hZGQoRXZlbnQuY2hhaW4odGhpcy5kaXNwb3NhYmxlcy5hZGQobmV3IERvbUVtaXR0ZXIodGhpcy52aWV3LmRvbU5vZGUsICdrZXl1cCcpKS5ldmVudCkpLmZvckVhY2goZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBkaWRKdXN0UHJlc3NDb250ZXh0TWVudUtleSA9IGZhbHNlOwogICAgICB9KS5tYXAoZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gbmV3IFN0YW5kYXJkS2V5Ym9hcmRFdmVudChlKTsKICAgICAgfSkuZmlsdGVyKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGUua2V5Q29kZSA9PT0gNTggLyogS2V5Q29kZS5Db250ZXh0TWVudSAqLyB8fCBlLnNoaWZ0S2V5ICYmIGUua2V5Q29kZSA9PT0gNjggLyogS2V5Q29kZS5GMTAgKi87CiAgICAgIH0pLm1hcChzdG9wRXZlbnQpLm1hcChmdW5jdGlvbiAoX3JlZikgewogICAgICAgIHZhciBicm93c2VyRXZlbnQgPSBfcmVmLmJyb3dzZXJFdmVudDsKICAgICAgICB2YXIgZm9jdXMgPSBfdGhpczYuZ2V0Rm9jdXMoKTsKICAgICAgICB2YXIgaW5kZXggPSBmb2N1cy5sZW5ndGggPyBmb2N1c1swXSA6IHVuZGVmaW5lZDsKICAgICAgICB2YXIgZWxlbWVudCA9IHR5cGVvZiBpbmRleCAhPT0gJ3VuZGVmaW5lZCcgPyBfdGhpczYudmlldy5lbGVtZW50KGluZGV4KSA6IHVuZGVmaW5lZDsKICAgICAgICB2YXIgYW5jaG9yID0gdHlwZW9mIGluZGV4ICE9PSAndW5kZWZpbmVkJyA/IF90aGlzNi52aWV3LmRvbUVsZW1lbnQoaW5kZXgpIDogX3RoaXM2LnZpZXcuZG9tTm9kZTsKICAgICAgICByZXR1cm4gewogICAgICAgICAgaW5kZXg6IGluZGV4LAogICAgICAgICAgZWxlbWVudDogZWxlbWVudCwKICAgICAgICAgIGFuY2hvcjogYW5jaG9yLAogICAgICAgICAgYnJvd3NlckV2ZW50OiBicm93c2VyRXZlbnQKICAgICAgICB9OwogICAgICB9KS5ldmVudDsKICAgICAgdmFyIGZyb21Nb3VzZSA9IHRoaXMuZGlzcG9zYWJsZXMuYWRkKEV2ZW50LmNoYWluKHRoaXMudmlldy5vbkNvbnRleHRNZW51KSkuZmlsdGVyKGZ1bmN0aW9uIChfKSB7CiAgICAgICAgcmV0dXJuICFkaWRKdXN0UHJlc3NDb250ZXh0TWVudUtleTsKICAgICAgfSkubWFwKGZ1bmN0aW9uIChfcmVmMikgewogICAgICAgIHZhciBlbGVtZW50ID0gX3JlZjIuZWxlbWVudCwKICAgICAgICAgIGluZGV4ID0gX3JlZjIuaW5kZXgsCiAgICAgICAgICBicm93c2VyRXZlbnQgPSBfcmVmMi5icm93c2VyRXZlbnQ7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGVsZW1lbnQ6IGVsZW1lbnQsCiAgICAgICAgICBpbmRleDogaW5kZXgsCiAgICAgICAgICBhbmNob3I6IHsKICAgICAgICAgICAgeDogYnJvd3NlckV2ZW50LnBhZ2VYICsgMSwKICAgICAgICAgICAgeTogYnJvd3NlckV2ZW50LnBhZ2VZCiAgICAgICAgICB9LAogICAgICAgICAgYnJvd3NlckV2ZW50OiBicm93c2VyRXZlbnQKICAgICAgICB9OwogICAgICB9KS5ldmVudDsKICAgICAgcmV0dXJuIEV2ZW50LmFueShmcm9tS2V5RG93biwgZnJvbUtleVVwLCBmcm9tTW91c2UpOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uS2V5RG93biIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuZGlzcG9zYWJsZXMuYWRkKG5ldyBEb21FbWl0dGVyKHRoaXMudmlldy5kb21Ob2RlLCAna2V5ZG93bicpKS5ldmVudDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvbkRpZEZvY3VzIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gRXZlbnQuc2lnbmFsKHRoaXMuZGlzcG9zYWJsZXMuYWRkKG5ldyBEb21FbWl0dGVyKHRoaXMudmlldy5kb21Ob2RlLCAnZm9jdXMnLCB0cnVlKSkuZXZlbnQpOwogICAgfQogIH0sIHsKICAgIGtleTogImNyZWF0ZU1vdXNlQ29udHJvbGxlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlTW91c2VDb250cm9sbGVyKG9wdGlvbnMpIHsKICAgICAgcmV0dXJuIG5ldyBNb3VzZUNvbnRyb2xsZXIodGhpcyk7CiAgICB9CiAgfSwgewogICAga2V5OiAidXBkYXRlT3B0aW9ucyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlT3B0aW9ucygpIHsKICAgICAgdmFyIG9wdGlvbnNVcGRhdGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9OwogICAgICB2YXIgX2EsIF9iOwogICAgICB0aGlzLl9vcHRpb25zID0gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCB0aGlzLl9vcHRpb25zKSwgb3B0aW9uc1VwZGF0ZSk7CiAgICAgIChfYSA9IHRoaXMudHlwZU5hdmlnYXRpb25Db250cm9sbGVyKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EudXBkYXRlT3B0aW9ucyh0aGlzLl9vcHRpb25zKTsKICAgICAgaWYgKHRoaXMuX29wdGlvbnMubXVsdGlwbGVTZWxlY3Rpb25Db250cm9sbGVyICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBpZiAodGhpcy5fb3B0aW9ucy5tdWx0aXBsZVNlbGVjdGlvblN1cHBvcnQpIHsKICAgICAgICAgIHRoaXMudmlldy5kb21Ob2RlLnNldEF0dHJpYnV0ZSgnYXJpYS1tdWx0aXNlbGVjdGFibGUnLCAndHJ1ZScpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnZpZXcuZG9tTm9kZS5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtbXVsdGlzZWxlY3RhYmxlJyk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMubW91c2VDb250cm9sbGVyLnVwZGF0ZU9wdGlvbnMob3B0aW9uc1VwZGF0ZSk7CiAgICAgIChfYiA9IHRoaXMua2V5Ym9hcmRDb250cm9sbGVyKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IudXBkYXRlT3B0aW9ucyhvcHRpb25zVXBkYXRlKTsKICAgICAgdGhpcy52aWV3LnVwZGF0ZU9wdGlvbnMob3B0aW9uc1VwZGF0ZSk7CiAgICB9CiAgfSwgewogICAga2V5OiAib3B0aW9ucyIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX29wdGlvbnM7CiAgICB9CiAgfSwgewogICAga2V5OiAic3BsaWNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzcGxpY2Uoc3RhcnQsIGRlbGV0ZUNvdW50KSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwogICAgICB2YXIgZWxlbWVudHMgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IFtdOwogICAgICBpZiAoc3RhcnQgPCAwIHx8IHN0YXJ0ID4gdGhpcy52aWV3Lmxlbmd0aCkgewogICAgICAgIHRocm93IG5ldyBMaXN0RXJyb3IodGhpcy51c2VyLCAiSW52YWxpZCBzdGFydCBpbmRleDogIi5jb25jYXQoc3RhcnQpKTsKICAgICAgfQogICAgICBpZiAoZGVsZXRlQ291bnQgPCAwKSB7CiAgICAgICAgdGhyb3cgbmV3IExpc3RFcnJvcih0aGlzLnVzZXIsICJJbnZhbGlkIGRlbGV0ZSBjb3VudDogIi5jb25jYXQoZGVsZXRlQ291bnQpKTsKICAgICAgfQogICAgICBpZiAoZGVsZXRlQ291bnQgPT09IDAgJiYgZWxlbWVudHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMuZXZlbnRCdWZmZXJlci5idWZmZXJFdmVudHMoZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBfdGhpczcuc3BsaWNlYWJsZS5zcGxpY2Uoc3RhcnQsIGRlbGV0ZUNvdW50LCBlbGVtZW50cyk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInJlcmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZXJlbmRlcigpIHsKICAgICAgdGhpcy52aWV3LnJlcmVuZGVyKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZWxlbWVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZWxlbWVudChpbmRleCkgewogICAgICByZXR1cm4gdGhpcy52aWV3LmVsZW1lbnQoaW5kZXgpOwogICAgfQogIH0sIHsKICAgIGtleTogImxlbmd0aCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMudmlldy5sZW5ndGg7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29udGVudEhlaWdodCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMudmlldy5jb250ZW50SGVpZ2h0OwogICAgfQogIH0sIHsKICAgIGtleTogInNjcm9sbFRvcCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMudmlldy5nZXRTY3JvbGxUb3AoKTsKICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uIHNldChzY3JvbGxUb3ApIHsKICAgICAgdGhpcy52aWV3LnNldFNjcm9sbFRvcChzY3JvbGxUb3ApOwogICAgfQogIH0sIHsKICAgIGtleTogImFyaWFMYWJlbCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2FyaWFMYWJlbDsKICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkgewogICAgICB0aGlzLl9hcmlhTGFiZWwgPSB2YWx1ZTsKICAgICAgdGhpcy52aWV3LmRvbU5vZGUuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgdmFsdWUpOwogICAgfQogIH0sIHsKICAgIGtleTogImRvbUZvY3VzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkb21Gb2N1cygpIHsKICAgICAgdGhpcy52aWV3LmRvbU5vZGUuZm9jdXMoewogICAgICAgIHByZXZlbnRTY3JvbGw6IHRydWUKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAibGF5b3V0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBsYXlvdXQoaGVpZ2h0LCB3aWR0aCkgewogICAgICB0aGlzLnZpZXcubGF5b3V0KGhlaWdodCwgd2lkdGgpOwogICAgfQogIH0sIHsKICAgIGtleTogInNldFNlbGVjdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0U2VsZWN0aW9uKGluZGV4ZXMsIGJyb3dzZXJFdmVudCkgewogICAgICB2YXIgX2l0ZXJhdG9yNiA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKGluZGV4ZXMpLAogICAgICAgIF9zdGVwNjsKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjYucygpOyAhKF9zdGVwNiA9IF9pdGVyYXRvcjYubigpKS5kb25lOykgewogICAgICAgICAgdmFyIGluZGV4ID0gX3N0ZXA2LnZhbHVlOwogICAgICAgICAgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSB0aGlzLmxlbmd0aCkgewogICAgICAgICAgICB0aHJvdyBuZXcgTGlzdEVycm9yKHRoaXMudXNlciwgIkludmFsaWQgaW5kZXggIi5jb25jYXQoaW5kZXgpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvcjYuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvcjYuZigpOwogICAgICB9CiAgICAgIHRoaXMuc2VsZWN0aW9uLnNldChpbmRleGVzLCBicm93c2VyRXZlbnQpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldFNlbGVjdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0U2VsZWN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5zZWxlY3Rpb24uZ2V0KCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0U2VsZWN0ZWRFbGVtZW50cyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0U2VsZWN0ZWRFbGVtZW50cygpIHsKICAgICAgdmFyIF90aGlzOCA9IHRoaXM7CiAgICAgIHJldHVybiB0aGlzLmdldFNlbGVjdGlvbigpLm1hcChmdW5jdGlvbiAoaSkgewogICAgICAgIHJldHVybiBfdGhpczgudmlldy5lbGVtZW50KGkpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRBbmNob3IiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldEFuY2hvcihpbmRleCkgewogICAgICBpZiAodHlwZW9mIGluZGV4ID09PSAndW5kZWZpbmVkJykgewogICAgICAgIHRoaXMuYW5jaG9yLnNldChbXSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmIChpbmRleCA8IDAgfHwgaW5kZXggPj0gdGhpcy5sZW5ndGgpIHsKICAgICAgICB0aHJvdyBuZXcgTGlzdEVycm9yKHRoaXMudXNlciwgIkludmFsaWQgaW5kZXggIi5jb25jYXQoaW5kZXgpKTsKICAgICAgfQogICAgICB0aGlzLmFuY2hvci5zZXQoW2luZGV4XSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0QW5jaG9yIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRBbmNob3IoKSB7CiAgICAgIHJldHVybiBmaXJzdE9yRGVmYXVsdCh0aGlzLmFuY2hvci5nZXQoKSwgdW5kZWZpbmVkKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRBbmNob3JFbGVtZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRBbmNob3JFbGVtZW50KCkgewogICAgICB2YXIgYW5jaG9yID0gdGhpcy5nZXRBbmNob3IoKTsKICAgICAgcmV0dXJuIHR5cGVvZiBhbmNob3IgPT09ICd1bmRlZmluZWQnID8gdW5kZWZpbmVkIDogdGhpcy5lbGVtZW50KGFuY2hvcik7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0Rm9jdXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldEZvY3VzKGluZGV4ZXMsIGJyb3dzZXJFdmVudCkgewogICAgICB2YXIgX2l0ZXJhdG9yNyA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKGluZGV4ZXMpLAogICAgICAgIF9zdGVwNzsKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjcucygpOyAhKF9zdGVwNyA9IF9pdGVyYXRvcjcubigpKS5kb25lOykgewogICAgICAgICAgdmFyIGluZGV4ID0gX3N0ZXA3LnZhbHVlOwogICAgICAgICAgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSB0aGlzLmxlbmd0aCkgewogICAgICAgICAgICB0aHJvdyBuZXcgTGlzdEVycm9yKHRoaXMudXNlciwgIkludmFsaWQgaW5kZXggIi5jb25jYXQoaW5kZXgpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvcjcuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvcjcuZigpOwogICAgICB9CiAgICAgIHRoaXMuZm9jdXMuc2V0KGluZGV4ZXMsIGJyb3dzZXJFdmVudCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZm9jdXNOZXh0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmb2N1c05leHQoKSB7CiAgICAgIHZhciBuID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAxOwogICAgICB2YXIgbG9vcCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CiAgICAgIHZhciBicm93c2VyRXZlbnQgPSBhcmd1bWVudHMubGVuZ3RoID4gMiA/IGFyZ3VtZW50c1syXSA6IHVuZGVmaW5lZDsKICAgICAgdmFyIGZpbHRlciA9IGFyZ3VtZW50cy5sZW5ndGggPiAzID8gYXJndW1lbnRzWzNdIDogdW5kZWZpbmVkOwogICAgICBpZiAodGhpcy5sZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdmFyIGZvY3VzID0gdGhpcy5mb2N1cy5nZXQoKTsKICAgICAgdmFyIGluZGV4ID0gdGhpcy5maW5kTmV4dEluZGV4KGZvY3VzLmxlbmd0aCA+IDAgPyBmb2N1c1swXSArIG4gOiAwLCBsb29wLCBmaWx0ZXIpOwogICAgICBpZiAoaW5kZXggPiAtMSkgewogICAgICAgIHRoaXMuc2V0Rm9jdXMoW2luZGV4XSwgYnJvd3NlckV2ZW50KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImZvY3VzUHJldmlvdXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZvY3VzUHJldmlvdXMoKSB7CiAgICAgIHZhciBuID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAxOwogICAgICB2YXIgbG9vcCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CiAgICAgIHZhciBicm93c2VyRXZlbnQgPSBhcmd1bWVudHMubGVuZ3RoID4gMiA/IGFyZ3VtZW50c1syXSA6IHVuZGVmaW5lZDsKICAgICAgdmFyIGZpbHRlciA9IGFyZ3VtZW50cy5sZW5ndGggPiAzID8gYXJndW1lbnRzWzNdIDogdW5kZWZpbmVkOwogICAgICBpZiAodGhpcy5sZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdmFyIGZvY3VzID0gdGhpcy5mb2N1cy5nZXQoKTsKICAgICAgdmFyIGluZGV4ID0gdGhpcy5maW5kUHJldmlvdXNJbmRleChmb2N1cy5sZW5ndGggPiAwID8gZm9jdXNbMF0gLSBuIDogMCwgbG9vcCwgZmlsdGVyKTsKICAgICAgaWYgKGluZGV4ID4gLTEpIHsKICAgICAgICB0aGlzLnNldEZvY3VzKFtpbmRleF0sIGJyb3dzZXJFdmVudCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJmb2N1c05leHRQYWdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmb2N1c05leHRQYWdlKGJyb3dzZXJFdmVudCwgZmlsdGVyKSB7CiAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBsYXN0UGFnZUluZGV4LCBjdXJyZW50bHlGb2N1c2VkRWxlbWVudEluZGV4LCBsYXN0R29vZFBhZ2VJbmRleCwgcHJldmlvdXNTY3JvbGxUb3AsIG5leHRwYWdlU2Nyb2xsVG9wOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGxhc3RQYWdlSW5kZXggPSB0aGlzLnZpZXcuaW5kZXhBdCh0aGlzLnZpZXcuZ2V0U2Nyb2xsVG9wKCkgKyB0aGlzLnZpZXcucmVuZGVySGVpZ2h0KTsKICAgICAgICAgICAgICAgIGxhc3RQYWdlSW5kZXggPSBsYXN0UGFnZUluZGV4ID09PSAwID8gMCA6IGxhc3RQYWdlSW5kZXggLSAxOwogICAgICAgICAgICAgICAgY3VycmVudGx5Rm9jdXNlZEVsZW1lbnRJbmRleCA9IHRoaXMuZ2V0Rm9jdXMoKVswXTsKICAgICAgICAgICAgICAgIGlmICghKGN1cnJlbnRseUZvY3VzZWRFbGVtZW50SW5kZXggIT09IGxhc3RQYWdlSW5kZXggJiYgKGN1cnJlbnRseUZvY3VzZWRFbGVtZW50SW5kZXggPT09IHVuZGVmaW5lZCB8fCBsYXN0UGFnZUluZGV4ID4gY3VycmVudGx5Rm9jdXNlZEVsZW1lbnRJbmRleCkpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxhc3RHb29kUGFnZUluZGV4ID0gdGhpcy5maW5kUHJldmlvdXNJbmRleChsYXN0UGFnZUluZGV4LCBmYWxzZSwgZmlsdGVyKTsKICAgICAgICAgICAgICAgIGlmIChsYXN0R29vZFBhZ2VJbmRleCA+IC0xICYmIGN1cnJlbnRseUZvY3VzZWRFbGVtZW50SW5kZXggIT09IGxhc3RHb29kUGFnZUluZGV4KSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuc2V0Rm9jdXMoW2xhc3RHb29kUGFnZUluZGV4XSwgYnJvd3NlckV2ZW50KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuc2V0Rm9jdXMoW2xhc3RQYWdlSW5kZXhdLCBicm93c2VyRXZlbnQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE4OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgcHJldmlvdXNTY3JvbGxUb3AgPSB0aGlzLnZpZXcuZ2V0U2Nyb2xsVG9wKCk7CiAgICAgICAgICAgICAgICBuZXh0cGFnZVNjcm9sbFRvcCA9IHByZXZpb3VzU2Nyb2xsVG9wICsgdGhpcy52aWV3LnJlbmRlckhlaWdodDsKICAgICAgICAgICAgICAgIGlmIChsYXN0UGFnZUluZGV4ID4gY3VycmVudGx5Rm9jdXNlZEVsZW1lbnRJbmRleCkgewogICAgICAgICAgICAgICAgICAvLyBzY3JvbGwgbGFzdCBwYWdlIGVsZW1lbnQgdG8gdGhlIHRvcCBvbmx5IGlmIHRoZSBsYXN0IHBhZ2UgZWxlbWVudCBpcyBiZWxvdyB0aGUgZm9jdXNlZCBlbGVtZW50CiAgICAgICAgICAgICAgICAgIG5leHRwYWdlU2Nyb2xsVG9wIC09IHRoaXMudmlldy5lbGVtZW50SGVpZ2h0KGxhc3RQYWdlSW5kZXgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy52aWV3LnNldFNjcm9sbFRvcChuZXh0cGFnZVNjcm9sbFRvcCk7CiAgICAgICAgICAgICAgICBpZiAoISh0aGlzLnZpZXcuZ2V0U2Nyb2xsVG9wKCkgIT09IHByZXZpb3VzU2Nyb2xsVG9wKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTg7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5zZXRGb2N1cyhbXSk7CiAgICAgICAgICAgICAgICAvLyBMZXQgdGhlIHNjcm9sbCBldmVudCBsaXN0ZW5lciBydW4KICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNjsKICAgICAgICAgICAgICAgIHJldHVybiB0aW1lb3V0KDApOwogICAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTg7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5mb2N1c05leHRQYWdlKGJyb3dzZXJFdmVudCwgZmlsdGVyKTsKICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7CiAgICAgIH0pKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJmb2N1c1ByZXZpb3VzUGFnZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZm9jdXNQcmV2aW91c1BhZ2UoYnJvd3NlckV2ZW50LCBmaWx0ZXIpIHsKICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHZhciBmaXJzdFBhZ2VJbmRleCwgc2Nyb2xsVG9wLCBjdXJyZW50bHlGb2N1c2VkRWxlbWVudEluZGV4LCBmaXJzdEdvb2RQYWdlSW5kZXgsIHByZXZpb3VzU2Nyb2xsVG9wOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBzY3JvbGxUb3AgPSB0aGlzLnZpZXcuZ2V0U2Nyb2xsVG9wKCk7CiAgICAgICAgICAgICAgICBpZiAoc2Nyb2xsVG9wID09PSAwKSB7CiAgICAgICAgICAgICAgICAgIGZpcnN0UGFnZUluZGV4ID0gdGhpcy52aWV3LmluZGV4QXQoc2Nyb2xsVG9wKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGZpcnN0UGFnZUluZGV4ID0gdGhpcy52aWV3LmluZGV4QWZ0ZXIoc2Nyb2xsVG9wIC0gMSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjdXJyZW50bHlGb2N1c2VkRWxlbWVudEluZGV4ID0gdGhpcy5nZXRGb2N1cygpWzBdOwogICAgICAgICAgICAgICAgaWYgKCEoY3VycmVudGx5Rm9jdXNlZEVsZW1lbnRJbmRleCAhPT0gZmlyc3RQYWdlSW5kZXggJiYgKGN1cnJlbnRseUZvY3VzZWRFbGVtZW50SW5kZXggPT09IHVuZGVmaW5lZCB8fCBjdXJyZW50bHlGb2N1c2VkRWxlbWVudEluZGV4ID49IGZpcnN0UGFnZUluZGV4KSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA4OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGZpcnN0R29vZFBhZ2VJbmRleCA9IHRoaXMuZmluZE5leHRJbmRleChmaXJzdFBhZ2VJbmRleCwgZmFsc2UsIGZpbHRlcik7CiAgICAgICAgICAgICAgICBpZiAoZmlyc3RHb29kUGFnZUluZGV4ID4gLTEgJiYgY3VycmVudGx5Rm9jdXNlZEVsZW1lbnRJbmRleCAhPT0gZmlyc3RHb29kUGFnZUluZGV4KSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuc2V0Rm9jdXMoW2ZpcnN0R29vZFBhZ2VJbmRleF0sIGJyb3dzZXJFdmVudCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICB0aGlzLnNldEZvY3VzKFtmaXJzdFBhZ2VJbmRleF0sIGJyb3dzZXJFdmVudCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDE2OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgcHJldmlvdXNTY3JvbGxUb3AgPSBzY3JvbGxUb3A7CiAgICAgICAgICAgICAgICB0aGlzLnZpZXcuc2V0U2Nyb2xsVG9wKHNjcm9sbFRvcCAtIHRoaXMudmlldy5yZW5kZXJIZWlnaHQpOwogICAgICAgICAgICAgICAgaWYgKCEodGhpcy52aWV3LmdldFNjcm9sbFRvcCgpICE9PSBwcmV2aW91c1Njcm9sbFRvcCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0aGlzLnNldEZvY3VzKFtdKTsKICAgICAgICAgICAgICAgIC8vIExldCB0aGUgc2Nyb2xsIGV2ZW50IGxpc3RlbmVyIHJ1bgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxNDsKICAgICAgICAgICAgICAgIHJldHVybiB0aW1lb3V0KDApOwogICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDE2OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZm9jdXNQcmV2aW91c1BhZ2UoYnJvd3NlckV2ZW50LCBmaWx0ZXIpOwogICAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIsIHRoaXMpOwogICAgICB9KSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZm9jdXNMYXN0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmb2N1c0xhc3QoYnJvd3NlckV2ZW50LCBmaWx0ZXIpIHsKICAgICAgaWYgKHRoaXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHZhciBpbmRleCA9IHRoaXMuZmluZFByZXZpb3VzSW5kZXgodGhpcy5sZW5ndGggLSAxLCBmYWxzZSwgZmlsdGVyKTsKICAgICAgaWYgKGluZGV4ID4gLTEpIHsKICAgICAgICB0aGlzLnNldEZvY3VzKFtpbmRleF0sIGJyb3dzZXJFdmVudCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJmb2N1c0ZpcnN0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmb2N1c0ZpcnN0KGJyb3dzZXJFdmVudCwgZmlsdGVyKSB7CiAgICAgIHRoaXMuZm9jdXNOdGgoMCwgYnJvd3NlckV2ZW50LCBmaWx0ZXIpOwogICAgfQogIH0sIHsKICAgIGtleTogImZvY3VzTnRoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmb2N1c050aChuLCBicm93c2VyRXZlbnQsIGZpbHRlcikgewogICAgICBpZiAodGhpcy5sZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdmFyIGluZGV4ID0gdGhpcy5maW5kTmV4dEluZGV4KG4sIGZhbHNlLCBmaWx0ZXIpOwogICAgICBpZiAoaW5kZXggPiAtMSkgewogICAgICAgIHRoaXMuc2V0Rm9jdXMoW2luZGV4XSwgYnJvd3NlckV2ZW50KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImZpbmROZXh0SW5kZXgiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmROZXh0SW5kZXgoaW5kZXgpIHsKICAgICAgdmFyIGxvb3AgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlOwogICAgICB2YXIgZmlsdGVyID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgPyBhcmd1bWVudHNbMl0gOiB1bmRlZmluZWQ7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChpbmRleCA+PSB0aGlzLmxlbmd0aCAmJiAhbG9vcCkgewogICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIH0KICAgICAgICBpbmRleCA9IGluZGV4ICUgdGhpcy5sZW5ndGg7CiAgICAgICAgaWYgKCFmaWx0ZXIgfHwgZmlsdGVyKHRoaXMuZWxlbWVudChpbmRleCkpKSB7CiAgICAgICAgICByZXR1cm4gaW5kZXg7CiAgICAgICAgfQogICAgICAgIGluZGV4Kys7CiAgICAgIH0KICAgICAgcmV0dXJuIC0xOwogICAgfQogIH0sIHsKICAgIGtleTogImZpbmRQcmV2aW91c0luZGV4IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmaW5kUHJldmlvdXNJbmRleChpbmRleCkgewogICAgICB2YXIgbG9vcCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CiAgICAgIHZhciBmaWx0ZXIgPSBhcmd1bWVudHMubGVuZ3RoID4gMiA/IGFyZ3VtZW50c1syXSA6IHVuZGVmaW5lZDsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKGluZGV4IDwgMCAmJiAhbG9vcCkgewogICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIH0KICAgICAgICBpbmRleCA9ICh0aGlzLmxlbmd0aCArIGluZGV4ICUgdGhpcy5sZW5ndGgpICUgdGhpcy5sZW5ndGg7CiAgICAgICAgaWYgKCFmaWx0ZXIgfHwgZmlsdGVyKHRoaXMuZWxlbWVudChpbmRleCkpKSB7CiAgICAgICAgICByZXR1cm4gaW5kZXg7CiAgICAgICAgfQogICAgICAgIGluZGV4LS07CiAgICAgIH0KICAgICAgcmV0dXJuIC0xOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEZvY3VzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRGb2N1cygpIHsKICAgICAgcmV0dXJuIHRoaXMuZm9jdXMuZ2V0KCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0Rm9jdXNlZEVsZW1lbnRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRGb2N1c2VkRWxlbWVudHMoKSB7CiAgICAgIHZhciBfdGhpczkgPSB0aGlzOwogICAgICByZXR1cm4gdGhpcy5nZXRGb2N1cygpLm1hcChmdW5jdGlvbiAoaSkgewogICAgICAgIHJldHVybiBfdGhpczkudmlldy5lbGVtZW50KGkpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZXZlYWwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJldmVhbChpbmRleCwgcmVsYXRpdmVUb3ApIHsKICAgICAgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSB0aGlzLmxlbmd0aCkgewogICAgICAgIHRocm93IG5ldyBMaXN0RXJyb3IodGhpcy51c2VyLCAiSW52YWxpZCBpbmRleCAiLmNvbmNhdChpbmRleCkpOwogICAgICB9CiAgICAgIHZhciBzY3JvbGxUb3AgPSB0aGlzLnZpZXcuZ2V0U2Nyb2xsVG9wKCk7CiAgICAgIHZhciBlbGVtZW50VG9wID0gdGhpcy52aWV3LmVsZW1lbnRUb3AoaW5kZXgpOwogICAgICB2YXIgZWxlbWVudEhlaWdodCA9IHRoaXMudmlldy5lbGVtZW50SGVpZ2h0KGluZGV4KTsKICAgICAgaWYgKGlzTnVtYmVyKHJlbGF0aXZlVG9wKSkgewogICAgICAgIC8vIHkgPSBteCArIGIKICAgICAgICB2YXIgbSA9IGVsZW1lbnRIZWlnaHQgLSB0aGlzLnZpZXcucmVuZGVySGVpZ2h0OwogICAgICAgIHRoaXMudmlldy5zZXRTY3JvbGxUb3AobSAqIGNsYW1wKHJlbGF0aXZlVG9wLCAwLCAxKSArIGVsZW1lbnRUb3ApOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciB2aWV3SXRlbUJvdHRvbSA9IGVsZW1lbnRUb3AgKyBlbGVtZW50SGVpZ2h0OwogICAgICAgIHZhciBzY3JvbGxCb3R0b20gPSBzY3JvbGxUb3AgKyB0aGlzLnZpZXcucmVuZGVySGVpZ2h0OwogICAgICAgIGlmIChlbGVtZW50VG9wIDwgc2Nyb2xsVG9wICYmIHZpZXdJdGVtQm90dG9tID49IHNjcm9sbEJvdHRvbSkgewogICAgICAgICAgLy8gVGhlIGVsZW1lbnQgaXMgYWxyZWFkeSBvdmVyZmxvd2luZyB0aGUgdmlld3BvcnQsIG5vLW9wCiAgICAgICAgfSBlbHNlIGlmIChlbGVtZW50VG9wIDwgc2Nyb2xsVG9wIHx8IHZpZXdJdGVtQm90dG9tID49IHNjcm9sbEJvdHRvbSAmJiBlbGVtZW50SGVpZ2h0ID49IHRoaXMudmlldy5yZW5kZXJIZWlnaHQpIHsKICAgICAgICAgIHRoaXMudmlldy5zZXRTY3JvbGxUb3AoZWxlbWVudFRvcCk7CiAgICAgICAgfSBlbHNlIGlmICh2aWV3SXRlbUJvdHRvbSA+PSBzY3JvbGxCb3R0b20pIHsKICAgICAgICAgIHRoaXMudmlldy5zZXRTY3JvbGxUb3Aodmlld0l0ZW1Cb3R0b20gLSB0aGlzLnZpZXcucmVuZGVySGVpZ2h0KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRIVE1MRWxlbWVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0SFRNTEVsZW1lbnQoKSB7CiAgICAgIHJldHVybiB0aGlzLnZpZXcuZG9tTm9kZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRFbGVtZW50SUQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEVsZW1lbnRJRChpbmRleCkgewogICAgICByZXR1cm4gdGhpcy52aWV3LmdldEVsZW1lbnREb21JZChpbmRleCk7CiAgICB9CiAgfSwgewogICAga2V5OiAic3R5bGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHN0eWxlKHN0eWxlcykgewogICAgICB0aGlzLnN0eWxlQ29udHJvbGxlci5zdHlsZShzdHlsZXMpOwogICAgfQogIH0sIHsKICAgIGtleTogInRvTGlzdEV2ZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiB0b0xpc3RFdmVudChfcmVmMykgewogICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7CiAgICAgIHZhciBpbmRleGVzID0gX3JlZjMuaW5kZXhlcywKICAgICAgICBicm93c2VyRXZlbnQgPSBfcmVmMy5icm93c2VyRXZlbnQ7CiAgICAgIHJldHVybiB7CiAgICAgICAgaW5kZXhlczogaW5kZXhlcywKICAgICAgICBlbGVtZW50czogaW5kZXhlcy5tYXAoZnVuY3Rpb24gKGkpIHsKICAgICAgICAgIHJldHVybiBfdGhpczEwLnZpZXcuZWxlbWVudChpKTsKICAgICAgICB9KSwKICAgICAgICBicm93c2VyRXZlbnQ6IGJyb3dzZXJFdmVudAogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogIl9vbkZvY3VzQ2hhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Gb2N1c0NoYW5nZSgpIHsKICAgICAgdmFyIGZvY3VzID0gdGhpcy5mb2N1cy5nZXQoKTsKICAgICAgdGhpcy52aWV3LmRvbU5vZGUuY2xhc3NMaXN0LnRvZ2dsZSgnZWxlbWVudC1mb2N1c2VkJywgZm9jdXMubGVuZ3RoID4gMCk7CiAgICAgIHRoaXMub25EaWRDaGFuZ2VBY3RpdmVEZXNjZW5kYW50KCk7CiAgICB9CiAgfSwgewogICAga2V5OiAib25EaWRDaGFuZ2VBY3RpdmVEZXNjZW5kYW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkRpZENoYW5nZUFjdGl2ZURlc2NlbmRhbnQoKSB7CiAgICAgIHZhciBfYTsKICAgICAgdmFyIGZvY3VzID0gdGhpcy5mb2N1cy5nZXQoKTsKICAgICAgaWYgKGZvY3VzLmxlbmd0aCA+IDApIHsKICAgICAgICB2YXIgaWQ7CiAgICAgICAgaWYgKChfYSA9IHRoaXMuYWNjZXNzaWJpbGl0eVByb3ZpZGVyKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZ2V0QWN0aXZlRGVzY2VuZGFudElkKSB7CiAgICAgICAgICBpZCA9IHRoaXMuYWNjZXNzaWJpbGl0eVByb3ZpZGVyLmdldEFjdGl2ZURlc2NlbmRhbnRJZCh0aGlzLnZpZXcuZWxlbWVudChmb2N1c1swXSkpOwogICAgICAgIH0KICAgICAgICB0aGlzLnZpZXcuZG9tTm9kZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtYWN0aXZlZGVzY2VuZGFudCcsIGlkIHx8IHRoaXMudmlldy5nZXRFbGVtZW50RG9tSWQoZm9jdXNbMF0pKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnZpZXcuZG9tTm9kZS5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtYWN0aXZlZGVzY2VuZGFudCcpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiX29uU2VsZWN0aW9uQ2hhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25TZWxlY3Rpb25DaGFuZ2UoKSB7CiAgICAgIHZhciBzZWxlY3Rpb24gPSB0aGlzLnNlbGVjdGlvbi5nZXQoKTsKICAgICAgdGhpcy52aWV3LmRvbU5vZGUuY2xhc3NMaXN0LnRvZ2dsZSgnc2VsZWN0aW9uLW5vbmUnLCBzZWxlY3Rpb24ubGVuZ3RoID09PSAwKTsKICAgICAgdGhpcy52aWV3LmRvbU5vZGUuY2xhc3NMaXN0LnRvZ2dsZSgnc2VsZWN0aW9uLXNpbmdsZScsIHNlbGVjdGlvbi5sZW5ndGggPT09IDEpOwogICAgICB0aGlzLnZpZXcuZG9tTm9kZS5jbGFzc0xpc3QudG9nZ2xlKCdzZWxlY3Rpb24tbXVsdGlwbGUnLCBzZWxlY3Rpb24ubGVuZ3RoID4gMSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGlzcG9zZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzcG9zZSgpIHsKICAgICAgdGhpcy5fb25EaWREaXNwb3NlLmZpcmUoKTsKICAgICAgdGhpcy5kaXNwb3NhYmxlcy5kaXNwb3NlKCk7CiAgICAgIHRoaXMuX29uRGlkRGlzcG9zZS5kaXNwb3NlKCk7CiAgICB9CiAgfV0pOwogIHJldHVybiBMaXN0Owp9KCk7Cl9fZGVjb3JhdGUoW21lbW9pemVdLCBMaXN0LnByb3RvdHlwZSwgIm9uRGlkQ2hhbmdlRm9jdXMiLCBudWxsKTsKX19kZWNvcmF0ZShbbWVtb2l6ZV0sIExpc3QucHJvdG90eXBlLCAib25EaWRDaGFuZ2VTZWxlY3Rpb24iLCBudWxsKTsKX19kZWNvcmF0ZShbbWVtb2l6ZV0sIExpc3QucHJvdG90eXBlLCAib25Db250ZXh0TWVudSIsIG51bGwpOwpfX2RlY29yYXRlKFttZW1vaXplXSwgTGlzdC5wcm90b3R5cGUsICJvbktleURvd24iLCBudWxsKTsKX19kZWNvcmF0ZShbbWVtb2l6ZV0sIExpc3QucHJvdG90eXBlLCAib25EaWRGb2N1cyIsIG51bGwpOw=="},{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","createStyleSheet","DomEmitter","stopEvent","StandardKeyboardEvent","Gesture","alert","CombinedSpliceable","binarySearch","firstOrDefault","range","timeout","Color","memoize","Emitter","Event","EventBufferer","matchesPrefix","DisposableStore","dispose","clamp","mixin","platform","isNumber","ListError","ListView","TraitRenderer","trait","renderedElements","name","container","element","index","templateData","renderedElementIndex","findIndex","el","rendered","unrender","push","renderIndex","start","deleteCount","insertCount","renderedElement","indexes","indexOf","splice","Trait","_trait","sortedIndexes","_onChange","onChange","event","elements","_a","Math","max","min","diff","end","filter","map","hasTrait","first","find","renderer","_set","classList","toggle","contains","remove","browserEvent","sort","numericSort","sortedResult","toRender","disjunction","renderIndexes","fire","prototype","SelectionTrait","setAriaSelected","setAttribute","TraitSpliceable","view","identityProvider","pastElementsWithTrait","get","getId","toString","elementsWithTrait","isInputElement","tagName","isMonacoEditor","parentElement","isButton","KeyboardController","list","options","disposables","multipleSelectionDisposables","onKeyDown","keyCode","on","onEnter","onUpArrow","onDownArrow","onPageUpArrow","onPageDownArrow","onEscape","multipleSelectionSupport","isMacintosh","metaKey","ctrlKey","onCtrlA","add","chain","domNode","optionsUpdate","undefined","clear","preventDefault","stopPropagation","setSelection","getFocus","focusPrevious","setAnchor","reveal","focus","focusNext","focusPreviousPage","focusNextPage","getSelection","TypeNavigationMode","TypeNavigationControllerState","DefaultKeyboardNavigationDelegate","altKey","TypeNavigationController","keyboardNavigationLabelProvider","keyboardNavigationEventFilter","delegate","enabled","state","Idle","mode","Automatic","triggered","previouslyFocused","enabledDisposables","updateOptions","_b","typeNavigationEnabled","enable","disable","typeNavigationMode","typing","onChar","mightProducePrintableCharacter","forEach","onClear","debounce","onInput","reduce","any","ariaLabel","accessibilityProvider","getAriaLabel","word","delta","Typing","label","getKeyboardNavigationLabel","labelStr","setFocus","DOMFocusController","shiftKey","onTab","focusedDomElement","domElement","tabIndexElement","querySelector","HTMLElement","tabIndex","style","window","getComputedStyle","visibility","display","isSelectionSingleChangeEvent","isSelectionRangeChangeEvent","isMouseRightClick","MouseEvent","button","DefaultMultipleSelectionController","MouseController","_onPointer","onPointer","multipleSelectionController","mouseSupport","onMouseDown","onContextMenu","onMouseDblClick","onDoubleClick","onTouchStart","addTarget","getHTMLElement","onMouseClick","onMouseMiddleClick","onTap","onViewPointer","document","activeElement","domFocus","changeSelection","isSelectionChangeEvent","anchor","getAnchor","currentFocus","rangeSelection","selection","contiguousRange","getContiguousRangeContaining","newSelection","relativeComplement","DefaultStyleController","styleElement","selectorSuffix","styles","suffix","content","listBackground","isOpaque","console","warn","listFocusBackground","listFocusForeground","listActiveSelectionBackground","listActiveSelectionForeground","listActiveSelectionIconForeground","listFocusAndSelectionOutline","listFocusAndSelectionBackground","listFocusAndSelectionForeground","listInactiveFocusForeground","listInactiveSelectionIconForeground","listInactiveFocusBackground","listInactiveSelectionBackground","listInactiveSelectionForeground","listHoverBackground","listHoverForeground","listSelectionOutline","listFocusOutline","listInactiveFocusOutline","listHoverOutline","listDropBackground","tableColumnsBorder","tableOddRowsBackgroundColor","textContent","join","defaultStyles","fromHex","treeIndentGuidesStroke","transparent","DefaultOptions","keyboardSupport","dnd","getDragURI","onDragStart","onDragOver","drop","reverse","one","other","j","a","b","PipelineRenderer","_templateId","renderers","renderTemplate","height","renderElement","disposeElement","call","disposeTemplate","AccessibiltyRenderer","templateId","removeAttribute","ariaLevel","getAriaLevel","ListViewDragAndDrop","getSelectedElements","originalEvent","getDragLabel","data","targetElement","targetIndex","onDragLeave","onDragEnd","List","user","virtualDelegate","_options","_c","_d","eventBufferer","_ariaLabel","_onDidDispose","onDidDispose","role","getWidgetRole","baseRenderers","onDidChangeActiveDescendant","viewOptions","assign","styleController","domId","spliceable","keyboardController","keyboardNavigationDelegate","typeNavigationController","mouseController","createMouseController","onDidChangeFocus","_onFocusChange","onDidChangeSelection","_onSelectionChange","getWidgetAriaLabel","wrapEvent","toListEvent","onMouseOver","didJustPressContextMenuKey","fromKeyDown","fromKeyUp","fromMouse","_","x","pageX","y","pageY","signal","bufferEvents","rerender","contentHeight","getScrollTop","scrollTop","setScrollTop","preventScroll","width","layout","set","n","loop","findNextIndex","findPreviousIndex","lastPageIndex","indexAt","renderHeight","currentlyFocusedElementIndex","lastGoodPageIndex","previousScrollTop","nextpageScrollTop","elementHeight","firstPageIndex","indexAfter","firstGoodPageIndex","focusNth","relativeTop","elementTop","m","viewItemBottom","scrollBottom","getElementDomId","id","getActiveDescendantId"],"sources":["/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/base/browser/ui/list/listWidget.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { createStyleSheet } from '../../dom.js';\nimport { DomEmitter, stopEvent } from '../../event.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { Gesture } from '../../touch.js';\nimport { alert } from '../aria/aria.js';\nimport { CombinedSpliceable } from './splice.js';\nimport { binarySearch, firstOrDefault, range } from '../../../common/arrays.js';\nimport { timeout } from '../../../common/async.js';\nimport { Color } from '../../../common/color.js';\nimport { memoize } from '../../../common/decorators.js';\nimport { Emitter, Event, EventBufferer } from '../../../common/event.js';\nimport { matchesPrefix } from '../../../common/filters.js';\nimport { DisposableStore, dispose } from '../../../common/lifecycle.js';\nimport { clamp } from '../../../common/numbers.js';\nimport { mixin } from '../../../common/objects.js';\nimport * as platform from '../../../common/platform.js';\nimport { isNumber } from '../../../common/types.js';\nimport './list.css';\nimport { ListError } from './list.js';\nimport { ListView } from './listView.js';\nclass TraitRenderer {\n    constructor(trait) {\n        this.trait = trait;\n        this.renderedElements = [];\n    }\n    get templateId() {\n        return `template:${this.trait.name}`;\n    }\n    renderTemplate(container) {\n        return container;\n    }\n    renderElement(element, index, templateData) {\n        const renderedElementIndex = this.renderedElements.findIndex(el => el.templateData === templateData);\n        if (renderedElementIndex >= 0) {\n            const rendered = this.renderedElements[renderedElementIndex];\n            this.trait.unrender(templateData);\n            rendered.index = index;\n        }\n        else {\n            const rendered = { index, templateData };\n            this.renderedElements.push(rendered);\n        }\n        this.trait.renderIndex(index, templateData);\n    }\n    splice(start, deleteCount, insertCount) {\n        const rendered = [];\n        for (const renderedElement of this.renderedElements) {\n            if (renderedElement.index < start) {\n                rendered.push(renderedElement);\n            }\n            else if (renderedElement.index >= start + deleteCount) {\n                rendered.push({\n                    index: renderedElement.index + insertCount - deleteCount,\n                    templateData: renderedElement.templateData\n                });\n            }\n        }\n        this.renderedElements = rendered;\n    }\n    renderIndexes(indexes) {\n        for (const { index, templateData } of this.renderedElements) {\n            if (indexes.indexOf(index) > -1) {\n                this.trait.renderIndex(index, templateData);\n            }\n        }\n    }\n    disposeTemplate(templateData) {\n        const index = this.renderedElements.findIndex(el => el.templateData === templateData);\n        if (index < 0) {\n            return;\n        }\n        this.renderedElements.splice(index, 1);\n    }\n}\nclass Trait {\n    constructor(_trait) {\n        this._trait = _trait;\n        this.length = 0;\n        this.indexes = [];\n        this.sortedIndexes = [];\n        this._onChange = new Emitter();\n        this.onChange = this._onChange.event;\n    }\n    get name() { return this._trait; }\n    get renderer() {\n        return new TraitRenderer(this);\n    }\n    splice(start, deleteCount, elements) {\n        var _a;\n        deleteCount = Math.max(0, Math.min(deleteCount, this.length - start));\n        const diff = elements.length - deleteCount;\n        const end = start + deleteCount;\n        const sortedIndexes = [\n            ...this.sortedIndexes.filter(i => i < start),\n            ...elements.map((hasTrait, i) => hasTrait ? i + start : -1).filter(i => i !== -1),\n            ...this.sortedIndexes.filter(i => i >= end).map(i => i + diff)\n        ];\n        const length = this.length + diff;\n        if (this.sortedIndexes.length > 0 && sortedIndexes.length === 0 && length > 0) {\n            const first = (_a = this.sortedIndexes.find(index => index >= start)) !== null && _a !== void 0 ? _a : length - 1;\n            sortedIndexes.push(Math.min(first, length - 1));\n        }\n        this.renderer.splice(start, deleteCount, elements.length);\n        this._set(sortedIndexes, sortedIndexes);\n        this.length = length;\n    }\n    renderIndex(index, container) {\n        container.classList.toggle(this._trait, this.contains(index));\n    }\n    unrender(container) {\n        container.classList.remove(this._trait);\n    }\n    /**\n     * Sets the indexes which should have this trait.\n     *\n     * @param indexes Indexes which should have this trait.\n     * @return The old indexes which had this trait.\n     */\n    set(indexes, browserEvent) {\n        return this._set(indexes, [...indexes].sort(numericSort), browserEvent);\n    }\n    _set(indexes, sortedIndexes, browserEvent) {\n        const result = this.indexes;\n        const sortedResult = this.sortedIndexes;\n        this.indexes = indexes;\n        this.sortedIndexes = sortedIndexes;\n        const toRender = disjunction(sortedResult, indexes);\n        this.renderer.renderIndexes(toRender);\n        this._onChange.fire({ indexes, browserEvent });\n        return result;\n    }\n    get() {\n        return this.indexes;\n    }\n    contains(index) {\n        return binarySearch(this.sortedIndexes, index, numericSort) >= 0;\n    }\n    dispose() {\n        dispose(this._onChange);\n    }\n}\n__decorate([\n    memoize\n], Trait.prototype, \"renderer\", null);\nclass SelectionTrait extends Trait {\n    constructor(setAriaSelected) {\n        super('selected');\n        this.setAriaSelected = setAriaSelected;\n    }\n    renderIndex(index, container) {\n        super.renderIndex(index, container);\n        if (this.setAriaSelected) {\n            if (this.contains(index)) {\n                container.setAttribute('aria-selected', 'true');\n            }\n            else {\n                container.setAttribute('aria-selected', 'false');\n            }\n        }\n    }\n}\n/**\n * The TraitSpliceable is used as a util class to be able\n * to preserve traits across splice calls, given an identity\n * provider.\n */\nclass TraitSpliceable {\n    constructor(trait, view, identityProvider) {\n        this.trait = trait;\n        this.view = view;\n        this.identityProvider = identityProvider;\n    }\n    splice(start, deleteCount, elements) {\n        if (!this.identityProvider) {\n            return this.trait.splice(start, deleteCount, elements.map(() => false));\n        }\n        const pastElementsWithTrait = this.trait.get().map(i => this.identityProvider.getId(this.view.element(i)).toString());\n        const elementsWithTrait = elements.map(e => pastElementsWithTrait.indexOf(this.identityProvider.getId(e).toString()) > -1);\n        this.trait.splice(start, deleteCount, elementsWithTrait);\n    }\n}\nexport function isInputElement(e) {\n    return e.tagName === 'INPUT' || e.tagName === 'TEXTAREA';\n}\nexport function isMonacoEditor(e) {\n    if (e.classList.contains('monaco-editor')) {\n        return true;\n    }\n    if (e.classList.contains('monaco-list')) {\n        return false;\n    }\n    if (!e.parentElement) {\n        return false;\n    }\n    return isMonacoEditor(e.parentElement);\n}\nexport function isButton(e) {\n    if ((e.tagName === 'A' && e.classList.contains('monaco-button')) ||\n        (e.tagName === 'DIV' && e.classList.contains('monaco-button-dropdown'))) {\n        return true;\n    }\n    if (e.classList.contains('monaco-list')) {\n        return false;\n    }\n    if (!e.parentElement) {\n        return false;\n    }\n    return isButton(e.parentElement);\n}\nclass KeyboardController {\n    constructor(list, view, options) {\n        this.list = list;\n        this.view = view;\n        this.disposables = new DisposableStore();\n        this.multipleSelectionDisposables = new DisposableStore();\n        this.onKeyDown.filter(e => e.keyCode === 3 /* KeyCode.Enter */).on(this.onEnter, this, this.disposables);\n        this.onKeyDown.filter(e => e.keyCode === 16 /* KeyCode.UpArrow */).on(this.onUpArrow, this, this.disposables);\n        this.onKeyDown.filter(e => e.keyCode === 18 /* KeyCode.DownArrow */).on(this.onDownArrow, this, this.disposables);\n        this.onKeyDown.filter(e => e.keyCode === 11 /* KeyCode.PageUp */).on(this.onPageUpArrow, this, this.disposables);\n        this.onKeyDown.filter(e => e.keyCode === 12 /* KeyCode.PageDown */).on(this.onPageDownArrow, this, this.disposables);\n        this.onKeyDown.filter(e => e.keyCode === 9 /* KeyCode.Escape */).on(this.onEscape, this, this.disposables);\n        if (options.multipleSelectionSupport !== false) {\n            this.onKeyDown.filter(e => (platform.isMacintosh ? e.metaKey : e.ctrlKey) && e.keyCode === 31 /* KeyCode.KeyA */).on(this.onCtrlA, this, this.multipleSelectionDisposables);\n        }\n    }\n    get onKeyDown() {\n        return this.disposables.add(Event.chain(this.disposables.add(new DomEmitter(this.view.domNode, 'keydown')).event)\n            .filter(e => !isInputElement(e.target))\n            .map(e => new StandardKeyboardEvent(e)));\n    }\n    updateOptions(optionsUpdate) {\n        if (optionsUpdate.multipleSelectionSupport !== undefined) {\n            this.multipleSelectionDisposables.clear();\n            if (optionsUpdate.multipleSelectionSupport) {\n                this.onKeyDown.filter(e => (platform.isMacintosh ? e.metaKey : e.ctrlKey) && e.keyCode === 31 /* KeyCode.KeyA */).on(this.onCtrlA, this, this.multipleSelectionDisposables);\n            }\n        }\n    }\n    onEnter(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.setSelection(this.list.getFocus(), e.browserEvent);\n    }\n    onUpArrow(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.focusPrevious(1, false, e.browserEvent);\n        const el = this.list.getFocus()[0];\n        this.list.setAnchor(el);\n        this.list.reveal(el);\n        this.view.domNode.focus();\n    }\n    onDownArrow(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.focusNext(1, false, e.browserEvent);\n        const el = this.list.getFocus()[0];\n        this.list.setAnchor(el);\n        this.list.reveal(el);\n        this.view.domNode.focus();\n    }\n    onPageUpArrow(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.focusPreviousPage(e.browserEvent);\n        const el = this.list.getFocus()[0];\n        this.list.setAnchor(el);\n        this.list.reveal(el);\n        this.view.domNode.focus();\n    }\n    onPageDownArrow(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.focusNextPage(e.browserEvent);\n        const el = this.list.getFocus()[0];\n        this.list.setAnchor(el);\n        this.list.reveal(el);\n        this.view.domNode.focus();\n    }\n    onCtrlA(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.setSelection(range(this.list.length), e.browserEvent);\n        this.list.setAnchor(undefined);\n        this.view.domNode.focus();\n    }\n    onEscape(e) {\n        if (this.list.getSelection().length) {\n            e.preventDefault();\n            e.stopPropagation();\n            this.list.setSelection([], e.browserEvent);\n            this.list.setAnchor(undefined);\n            this.view.domNode.focus();\n        }\n    }\n    dispose() {\n        this.disposables.dispose();\n        this.multipleSelectionDisposables.dispose();\n    }\n}\n__decorate([\n    memoize\n], KeyboardController.prototype, \"onKeyDown\", null);\nexport var TypeNavigationMode;\n(function (TypeNavigationMode) {\n    TypeNavigationMode[TypeNavigationMode[\"Automatic\"] = 0] = \"Automatic\";\n    TypeNavigationMode[TypeNavigationMode[\"Trigger\"] = 1] = \"Trigger\";\n})(TypeNavigationMode || (TypeNavigationMode = {}));\nvar TypeNavigationControllerState;\n(function (TypeNavigationControllerState) {\n    TypeNavigationControllerState[TypeNavigationControllerState[\"Idle\"] = 0] = \"Idle\";\n    TypeNavigationControllerState[TypeNavigationControllerState[\"Typing\"] = 1] = \"Typing\";\n})(TypeNavigationControllerState || (TypeNavigationControllerState = {}));\nexport const DefaultKeyboardNavigationDelegate = new class {\n    mightProducePrintableCharacter(event) {\n        if (event.ctrlKey || event.metaKey || event.altKey) {\n            return false;\n        }\n        return (event.keyCode >= 31 /* KeyCode.KeyA */ && event.keyCode <= 56 /* KeyCode.KeyZ */)\n            || (event.keyCode >= 21 /* KeyCode.Digit0 */ && event.keyCode <= 30 /* KeyCode.Digit9 */)\n            || (event.keyCode >= 93 /* KeyCode.Numpad0 */ && event.keyCode <= 102 /* KeyCode.Numpad9 */)\n            || (event.keyCode >= 80 /* KeyCode.Semicolon */ && event.keyCode <= 90 /* KeyCode.Quote */);\n    }\n};\nclass TypeNavigationController {\n    constructor(list, view, keyboardNavigationLabelProvider, keyboardNavigationEventFilter, delegate) {\n        this.list = list;\n        this.view = view;\n        this.keyboardNavigationLabelProvider = keyboardNavigationLabelProvider;\n        this.keyboardNavigationEventFilter = keyboardNavigationEventFilter;\n        this.delegate = delegate;\n        this.enabled = false;\n        this.state = TypeNavigationControllerState.Idle;\n        this.mode = TypeNavigationMode.Automatic;\n        this.triggered = false;\n        this.previouslyFocused = -1;\n        this.enabledDisposables = new DisposableStore();\n        this.disposables = new DisposableStore();\n        this.updateOptions(list.options);\n    }\n    updateOptions(options) {\n        var _a, _b;\n        if ((_a = options.typeNavigationEnabled) !== null && _a !== void 0 ? _a : true) {\n            this.enable();\n        }\n        else {\n            this.disable();\n        }\n        this.mode = (_b = options.typeNavigationMode) !== null && _b !== void 0 ? _b : TypeNavigationMode.Automatic;\n    }\n    enable() {\n        if (this.enabled) {\n            return;\n        }\n        let typing = false;\n        const onChar = this.enabledDisposables.add(Event.chain(this.enabledDisposables.add(new DomEmitter(this.view.domNode, 'keydown')).event))\n            .filter(e => !isInputElement(e.target))\n            .filter(() => this.mode === TypeNavigationMode.Automatic || this.triggered)\n            .map(event => new StandardKeyboardEvent(event))\n            .filter(e => typing || this.keyboardNavigationEventFilter(e))\n            .filter(e => this.delegate.mightProducePrintableCharacter(e))\n            .forEach(stopEvent)\n            .map(event => event.browserEvent.key)\n            .event;\n        const onClear = Event.debounce(onChar, () => null, 800, undefined, undefined, this.enabledDisposables);\n        const onInput = Event.reduce(Event.any(onChar, onClear), (r, i) => i === null ? null : ((r || '') + i), undefined, this.enabledDisposables);\n        onInput(this.onInput, this, this.enabledDisposables);\n        onClear(this.onClear, this, this.enabledDisposables);\n        onChar(() => typing = true, undefined, this.enabledDisposables);\n        onClear(() => typing = false, undefined, this.enabledDisposables);\n        this.enabled = true;\n        this.triggered = false;\n    }\n    disable() {\n        if (!this.enabled) {\n            return;\n        }\n        this.enabledDisposables.clear();\n        this.enabled = false;\n        this.triggered = false;\n    }\n    onClear() {\n        var _a;\n        const focus = this.list.getFocus();\n        if (focus.length > 0 && focus[0] === this.previouslyFocused) {\n            // List: re-announce element on typing end since typed keys will interrupt aria label of focused element\n            // Do not announce if there was a focus change at the end to prevent duplication https://github.com/microsoft/vscode/issues/95961\n            const ariaLabel = (_a = this.list.options.accessibilityProvider) === null || _a === void 0 ? void 0 : _a.getAriaLabel(this.list.element(focus[0]));\n            if (ariaLabel) {\n                alert(ariaLabel);\n            }\n        }\n        this.previouslyFocused = -1;\n    }\n    onInput(word) {\n        if (!word) {\n            this.state = TypeNavigationControllerState.Idle;\n            this.triggered = false;\n            return;\n        }\n        const focus = this.list.getFocus();\n        const start = focus.length > 0 ? focus[0] : 0;\n        const delta = this.state === TypeNavigationControllerState.Idle ? 1 : 0;\n        this.state = TypeNavigationControllerState.Typing;\n        for (let i = 0; i < this.list.length; i++) {\n            const index = (start + i + delta) % this.list.length;\n            const label = this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(index));\n            const labelStr = label && label.toString();\n            if (typeof labelStr === 'undefined' || matchesPrefix(word, labelStr)) {\n                this.previouslyFocused = start;\n                this.list.setFocus([index]);\n                this.list.reveal(index);\n                return;\n            }\n        }\n    }\n    dispose() {\n        this.disable();\n        this.enabledDisposables.dispose();\n        this.disposables.dispose();\n    }\n}\nclass DOMFocusController {\n    constructor(list, view) {\n        this.list = list;\n        this.view = view;\n        this.disposables = new DisposableStore();\n        const onKeyDown = this.disposables.add(Event.chain(this.disposables.add(new DomEmitter(view.domNode, 'keydown')).event))\n            .filter(e => !isInputElement(e.target))\n            .map(e => new StandardKeyboardEvent(e));\n        onKeyDown.filter(e => e.keyCode === 2 /* KeyCode.Tab */ && !e.ctrlKey && !e.metaKey && !e.shiftKey && !e.altKey)\n            .on(this.onTab, this, this.disposables);\n    }\n    onTab(e) {\n        if (e.target !== this.view.domNode) {\n            return;\n        }\n        const focus = this.list.getFocus();\n        if (focus.length === 0) {\n            return;\n        }\n        const focusedDomElement = this.view.domElement(focus[0]);\n        if (!focusedDomElement) {\n            return;\n        }\n        const tabIndexElement = focusedDomElement.querySelector('[tabIndex]');\n        if (!tabIndexElement || !(tabIndexElement instanceof HTMLElement) || tabIndexElement.tabIndex === -1) {\n            return;\n        }\n        const style = window.getComputedStyle(tabIndexElement);\n        if (style.visibility === 'hidden' || style.display === 'none') {\n            return;\n        }\n        e.preventDefault();\n        e.stopPropagation();\n        tabIndexElement.focus();\n    }\n    dispose() {\n        this.disposables.dispose();\n    }\n}\nexport function isSelectionSingleChangeEvent(event) {\n    return platform.isMacintosh ? event.browserEvent.metaKey : event.browserEvent.ctrlKey;\n}\nexport function isSelectionRangeChangeEvent(event) {\n    return event.browserEvent.shiftKey;\n}\nfunction isMouseRightClick(event) {\n    return event instanceof MouseEvent && event.button === 2;\n}\nconst DefaultMultipleSelectionController = {\n    isSelectionSingleChangeEvent,\n    isSelectionRangeChangeEvent\n};\nexport class MouseController {\n    constructor(list) {\n        this.list = list;\n        this.disposables = new DisposableStore();\n        this._onPointer = new Emitter();\n        this.onPointer = this._onPointer.event;\n        if (list.options.multipleSelectionSupport !== false) {\n            this.multipleSelectionController = this.list.options.multipleSelectionController || DefaultMultipleSelectionController;\n        }\n        this.mouseSupport = typeof list.options.mouseSupport === 'undefined' || !!list.options.mouseSupport;\n        if (this.mouseSupport) {\n            list.onMouseDown(this.onMouseDown, this, this.disposables);\n            list.onContextMenu(this.onContextMenu, this, this.disposables);\n            list.onMouseDblClick(this.onDoubleClick, this, this.disposables);\n            list.onTouchStart(this.onMouseDown, this, this.disposables);\n            this.disposables.add(Gesture.addTarget(list.getHTMLElement()));\n        }\n        Event.any(list.onMouseClick, list.onMouseMiddleClick, list.onTap)(this.onViewPointer, this, this.disposables);\n    }\n    updateOptions(optionsUpdate) {\n        if (optionsUpdate.multipleSelectionSupport !== undefined) {\n            this.multipleSelectionController = undefined;\n            if (optionsUpdate.multipleSelectionSupport) {\n                this.multipleSelectionController = this.list.options.multipleSelectionController || DefaultMultipleSelectionController;\n            }\n        }\n    }\n    isSelectionSingleChangeEvent(event) {\n        if (!this.multipleSelectionController) {\n            return false;\n        }\n        return this.multipleSelectionController.isSelectionSingleChangeEvent(event);\n    }\n    isSelectionRangeChangeEvent(event) {\n        if (!this.multipleSelectionController) {\n            return false;\n        }\n        return this.multipleSelectionController.isSelectionRangeChangeEvent(event);\n    }\n    isSelectionChangeEvent(event) {\n        return this.isSelectionSingleChangeEvent(event) || this.isSelectionRangeChangeEvent(event);\n    }\n    onMouseDown(e) {\n        if (isMonacoEditor(e.browserEvent.target)) {\n            return;\n        }\n        if (document.activeElement !== e.browserEvent.target) {\n            this.list.domFocus();\n        }\n    }\n    onContextMenu(e) {\n        if (isMonacoEditor(e.browserEvent.target)) {\n            return;\n        }\n        const focus = typeof e.index === 'undefined' ? [] : [e.index];\n        this.list.setFocus(focus, e.browserEvent);\n    }\n    onViewPointer(e) {\n        if (!this.mouseSupport) {\n            return;\n        }\n        if (isInputElement(e.browserEvent.target) || isMonacoEditor(e.browserEvent.target)) {\n            return;\n        }\n        const focus = e.index;\n        if (typeof focus === 'undefined') {\n            this.list.setFocus([], e.browserEvent);\n            this.list.setSelection([], e.browserEvent);\n            this.list.setAnchor(undefined);\n            return;\n        }\n        if (this.isSelectionRangeChangeEvent(e)) {\n            return this.changeSelection(e);\n        }\n        if (this.isSelectionChangeEvent(e)) {\n            return this.changeSelection(e);\n        }\n        this.list.setFocus([focus], e.browserEvent);\n        this.list.setAnchor(focus);\n        if (!isMouseRightClick(e.browserEvent)) {\n            this.list.setSelection([focus], e.browserEvent);\n        }\n        this._onPointer.fire(e);\n    }\n    onDoubleClick(e) {\n        if (isInputElement(e.browserEvent.target) || isMonacoEditor(e.browserEvent.target)) {\n            return;\n        }\n        if (this.isSelectionChangeEvent(e)) {\n            return;\n        }\n        const focus = this.list.getFocus();\n        this.list.setSelection(focus, e.browserEvent);\n    }\n    changeSelection(e) {\n        const focus = e.index;\n        let anchor = this.list.getAnchor();\n        if (this.isSelectionRangeChangeEvent(e)) {\n            if (typeof anchor === 'undefined') {\n                const currentFocus = this.list.getFocus()[0];\n                anchor = currentFocus !== null && currentFocus !== void 0 ? currentFocus : focus;\n                this.list.setAnchor(anchor);\n            }\n            const min = Math.min(anchor, focus);\n            const max = Math.max(anchor, focus);\n            const rangeSelection = range(min, max + 1);\n            const selection = this.list.getSelection();\n            const contiguousRange = getContiguousRangeContaining(disjunction(selection, [anchor]), anchor);\n            if (contiguousRange.length === 0) {\n                return;\n            }\n            const newSelection = disjunction(rangeSelection, relativeComplement(selection, contiguousRange));\n            this.list.setSelection(newSelection, e.browserEvent);\n            this.list.setFocus([focus], e.browserEvent);\n        }\n        else if (this.isSelectionSingleChangeEvent(e)) {\n            const selection = this.list.getSelection();\n            const newSelection = selection.filter(i => i !== focus);\n            this.list.setFocus([focus]);\n            this.list.setAnchor(focus);\n            if (selection.length === newSelection.length) {\n                this.list.setSelection([...newSelection, focus], e.browserEvent);\n            }\n            else {\n                this.list.setSelection(newSelection, e.browserEvent);\n            }\n        }\n    }\n    dispose() {\n        this.disposables.dispose();\n    }\n}\nexport class DefaultStyleController {\n    constructor(styleElement, selectorSuffix) {\n        this.styleElement = styleElement;\n        this.selectorSuffix = selectorSuffix;\n    }\n    style(styles) {\n        const suffix = this.selectorSuffix && `.${this.selectorSuffix}`;\n        const content = [];\n        if (styles.listBackground) {\n            if (styles.listBackground.isOpaque()) {\n                content.push(`.monaco-list${suffix} .monaco-list-rows { background: ${styles.listBackground}; }`);\n            }\n            else if (!platform.isMacintosh) { // subpixel AA doesn't exist in macOS\n                console.warn(`List with id '${this.selectorSuffix}' was styled with a non-opaque background color. This will break sub-pixel antialiasing.`);\n            }\n        }\n        if (styles.listFocusBackground) {\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.focused { background-color: ${styles.listFocusBackground}; }`);\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.focused:hover { background-color: ${styles.listFocusBackground}; }`); // overwrite :hover style in this case!\n        }\n        if (styles.listFocusForeground) {\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.focused { color: ${styles.listFocusForeground}; }`);\n        }\n        if (styles.listActiveSelectionBackground) {\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected { background-color: ${styles.listActiveSelectionBackground}; }`);\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected:hover { background-color: ${styles.listActiveSelectionBackground}; }`); // overwrite :hover style in this case!\n        }\n        if (styles.listActiveSelectionForeground) {\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected { color: ${styles.listActiveSelectionForeground}; }`);\n        }\n        if (styles.listActiveSelectionIconForeground) {\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected .codicon { color: ${styles.listActiveSelectionIconForeground}; }`);\n        }\n        if (styles.listFocusAndSelectionOutline) {\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected { outline-color: ${styles.listFocusAndSelectionOutline} !important; }`);\n        }\n        if (styles.listFocusAndSelectionBackground) {\n            content.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus .monaco-list-row.selected.focused { background-color: ${styles.listFocusAndSelectionBackground}; }\n\t\t\t`);\n        }\n        if (styles.listFocusAndSelectionForeground) {\n            content.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus .monaco-list-row.selected.focused { color: ${styles.listFocusAndSelectionForeground}; }\n\t\t\t`);\n        }\n        if (styles.listInactiveFocusForeground) {\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused { color:  ${styles.listInactiveFocusForeground}; }`);\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused:hover { color:  ${styles.listInactiveFocusForeground}; }`); // overwrite :hover style in this case!\n        }\n        if (styles.listInactiveSelectionIconForeground) {\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused .codicon { color:  ${styles.listInactiveSelectionIconForeground}; }`);\n        }\n        if (styles.listInactiveFocusBackground) {\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused { background-color:  ${styles.listInactiveFocusBackground}; }`);\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused:hover { background-color:  ${styles.listInactiveFocusBackground}; }`); // overwrite :hover style in this case!\n        }\n        if (styles.listInactiveSelectionBackground) {\n            content.push(`.monaco-list${suffix} .monaco-list-row.selected { background-color:  ${styles.listInactiveSelectionBackground}; }`);\n            content.push(`.monaco-list${suffix} .monaco-list-row.selected:hover { background-color:  ${styles.listInactiveSelectionBackground}; }`); // overwrite :hover style in this case!\n        }\n        if (styles.listInactiveSelectionForeground) {\n            content.push(`.monaco-list${suffix} .monaco-list-row.selected { color: ${styles.listInactiveSelectionForeground}; }`);\n        }\n        if (styles.listHoverBackground) {\n            content.push(`.monaco-list${suffix}:not(.drop-target) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${styles.listHoverBackground}; }`);\n        }\n        if (styles.listHoverForeground) {\n            content.push(`.monaco-list${suffix} .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${styles.listHoverForeground}; }`);\n        }\n        if (styles.listSelectionOutline) {\n            content.push(`.monaco-list${suffix} .monaco-list-row.selected { outline: 1px dotted ${styles.listSelectionOutline}; outline-offset: -1px; }`);\n        }\n        if (styles.listFocusOutline) {\n            content.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus .monaco-list-row.focused { outline: 1px solid ${styles.listFocusOutline}; outline-offset: -1px; }\n\t\t\t\t.monaco-workbench.context-menu-visible .monaco-list${suffix}.last-focused .monaco-list-row.focused { outline: 1px solid ${styles.listFocusOutline}; outline-offset: -1px; }\n\t\t\t`);\n        }\n        if (styles.listInactiveFocusOutline) {\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused { outline: 1px dotted ${styles.listInactiveFocusOutline}; outline-offset: -1px; }`);\n        }\n        if (styles.listHoverOutline) {\n            content.push(`.monaco-list${suffix} .monaco-list-row:hover { outline: 1px dashed ${styles.listHoverOutline}; outline-offset: -1px; }`);\n        }\n        if (styles.listDropBackground) {\n            content.push(`\n\t\t\t\t.monaco-list${suffix}.drop-target,\n\t\t\t\t.monaco-list${suffix} .monaco-list-rows.drop-target,\n\t\t\t\t.monaco-list${suffix} .monaco-list-row.drop-target { background-color: ${styles.listDropBackground} !important; color: inherit !important; }\n\t\t\t`);\n        }\n        if (styles.tableColumnsBorder) {\n            content.push(`\n\t\t\t\t.monaco-table:hover > .monaco-split-view2,\n\t\t\t\t.monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {\n\t\t\t\t\tborder-color: ${styles.tableColumnsBorder};\n\t\t\t}`);\n        }\n        if (styles.tableOddRowsBackgroundColor) {\n            content.push(`\n\t\t\t\t.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,\n\t\t\t\t.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,\n\t\t\t\t.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {\n\t\t\t\t\tbackground-color: ${styles.tableOddRowsBackgroundColor};\n\t\t\t\t}\n\t\t\t`);\n        }\n        this.styleElement.textContent = content.join('\\n');\n    }\n}\nconst defaultStyles = {\n    listFocusBackground: Color.fromHex('#7FB0D0'),\n    listActiveSelectionBackground: Color.fromHex('#0E639C'),\n    listActiveSelectionForeground: Color.fromHex('#FFFFFF'),\n    listActiveSelectionIconForeground: Color.fromHex('#FFFFFF'),\n    listFocusAndSelectionOutline: Color.fromHex('#90C2F9'),\n    listFocusAndSelectionBackground: Color.fromHex('#094771'),\n    listFocusAndSelectionForeground: Color.fromHex('#FFFFFF'),\n    listInactiveSelectionBackground: Color.fromHex('#3F3F46'),\n    listInactiveSelectionIconForeground: Color.fromHex('#FFFFFF'),\n    listHoverBackground: Color.fromHex('#2A2D2E'),\n    listDropBackground: Color.fromHex('#383B3D'),\n    treeIndentGuidesStroke: Color.fromHex('#a9a9a9'),\n    tableColumnsBorder: Color.fromHex('#cccccc').transparent(0.2),\n    tableOddRowsBackgroundColor: Color.fromHex('#cccccc').transparent(0.04)\n};\nconst DefaultOptions = {\n    keyboardSupport: true,\n    mouseSupport: true,\n    multipleSelectionSupport: true,\n    dnd: {\n        getDragURI() { return null; },\n        onDragStart() { },\n        onDragOver() { return false; },\n        drop() { }\n    }\n};\n// TODO@Joao: move these utils into a SortedArray class\nfunction getContiguousRangeContaining(range, value) {\n    const index = range.indexOf(value);\n    if (index === -1) {\n        return [];\n    }\n    const result = [];\n    let i = index - 1;\n    while (i >= 0 && range[i] === value - (index - i)) {\n        result.push(range[i--]);\n    }\n    result.reverse();\n    i = index;\n    while (i < range.length && range[i] === value + (i - index)) {\n        result.push(range[i++]);\n    }\n    return result;\n}\n/**\n * Given two sorted collections of numbers, returns the intersection\n * between them (OR).\n */\nfunction disjunction(one, other) {\n    const result = [];\n    let i = 0, j = 0;\n    while (i < one.length || j < other.length) {\n        if (i >= one.length) {\n            result.push(other[j++]);\n        }\n        else if (j >= other.length) {\n            result.push(one[i++]);\n        }\n        else if (one[i] === other[j]) {\n            result.push(one[i]);\n            i++;\n            j++;\n            continue;\n        }\n        else if (one[i] < other[j]) {\n            result.push(one[i++]);\n        }\n        else {\n            result.push(other[j++]);\n        }\n    }\n    return result;\n}\n/**\n * Given two sorted collections of numbers, returns the relative\n * complement between them (XOR).\n */\nfunction relativeComplement(one, other) {\n    const result = [];\n    let i = 0, j = 0;\n    while (i < one.length || j < other.length) {\n        if (i >= one.length) {\n            result.push(other[j++]);\n        }\n        else if (j >= other.length) {\n            result.push(one[i++]);\n        }\n        else if (one[i] === other[j]) {\n            i++;\n            j++;\n            continue;\n        }\n        else if (one[i] < other[j]) {\n            result.push(one[i++]);\n        }\n        else {\n            j++;\n        }\n    }\n    return result;\n}\nconst numericSort = (a, b) => a - b;\nclass PipelineRenderer {\n    constructor(_templateId, renderers) {\n        this._templateId = _templateId;\n        this.renderers = renderers;\n    }\n    get templateId() {\n        return this._templateId;\n    }\n    renderTemplate(container) {\n        return this.renderers.map(r => r.renderTemplate(container));\n    }\n    renderElement(element, index, templateData, height) {\n        let i = 0;\n        for (const renderer of this.renderers) {\n            renderer.renderElement(element, index, templateData[i++], height);\n        }\n    }\n    disposeElement(element, index, templateData, height) {\n        var _a;\n        let i = 0;\n        for (const renderer of this.renderers) {\n            (_a = renderer.disposeElement) === null || _a === void 0 ? void 0 : _a.call(renderer, element, index, templateData[i], height);\n            i += 1;\n        }\n    }\n    disposeTemplate(templateData) {\n        let i = 0;\n        for (const renderer of this.renderers) {\n            renderer.disposeTemplate(templateData[i++]);\n        }\n    }\n}\nclass AccessibiltyRenderer {\n    constructor(accessibilityProvider) {\n        this.accessibilityProvider = accessibilityProvider;\n        this.templateId = 'a18n';\n    }\n    renderTemplate(container) {\n        return container;\n    }\n    renderElement(element, index, container) {\n        const ariaLabel = this.accessibilityProvider.getAriaLabel(element);\n        if (ariaLabel) {\n            container.setAttribute('aria-label', ariaLabel);\n        }\n        else {\n            container.removeAttribute('aria-label');\n        }\n        const ariaLevel = this.accessibilityProvider.getAriaLevel && this.accessibilityProvider.getAriaLevel(element);\n        if (typeof ariaLevel === 'number') {\n            container.setAttribute('aria-level', `${ariaLevel}`);\n        }\n        else {\n            container.removeAttribute('aria-level');\n        }\n    }\n    disposeTemplate(templateData) {\n        // noop\n    }\n}\nclass ListViewDragAndDrop {\n    constructor(list, dnd) {\n        this.list = list;\n        this.dnd = dnd;\n    }\n    getDragElements(element) {\n        const selection = this.list.getSelectedElements();\n        const elements = selection.indexOf(element) > -1 ? selection : [element];\n        return elements;\n    }\n    getDragURI(element) {\n        return this.dnd.getDragURI(element);\n    }\n    getDragLabel(elements, originalEvent) {\n        if (this.dnd.getDragLabel) {\n            return this.dnd.getDragLabel(elements, originalEvent);\n        }\n        return undefined;\n    }\n    onDragStart(data, originalEvent) {\n        var _a, _b;\n        (_b = (_a = this.dnd).onDragStart) === null || _b === void 0 ? void 0 : _b.call(_a, data, originalEvent);\n    }\n    onDragOver(data, targetElement, targetIndex, originalEvent) {\n        return this.dnd.onDragOver(data, targetElement, targetIndex, originalEvent);\n    }\n    onDragLeave(data, targetElement, targetIndex, originalEvent) {\n        var _a, _b;\n        (_b = (_a = this.dnd).onDragLeave) === null || _b === void 0 ? void 0 : _b.call(_a, data, targetElement, targetIndex, originalEvent);\n    }\n    onDragEnd(originalEvent) {\n        var _a, _b;\n        (_b = (_a = this.dnd).onDragEnd) === null || _b === void 0 ? void 0 : _b.call(_a, originalEvent);\n    }\n    drop(data, targetElement, targetIndex, originalEvent) {\n        this.dnd.drop(data, targetElement, targetIndex, originalEvent);\n    }\n}\n/**\n * The {@link List} is a virtual scrolling widget, built on top of the {@link ListView}\n * widget.\n *\n * Features:\n * - Customizable keyboard and mouse support\n * - Element traits: focus, selection, achor\n * - Accessibility support\n * - Touch support\n * - Performant template-based rendering\n * - Horizontal scrolling\n * - Variable element height support\n * - Dynamic element height support\n * - Drag-and-drop support\n */\nexport class List {\n    constructor(user, container, virtualDelegate, renderers, _options = DefaultOptions) {\n        var _a, _b, _c, _d;\n        this.user = user;\n        this._options = _options;\n        this.focus = new Trait('focused');\n        this.anchor = new Trait('anchor');\n        this.eventBufferer = new EventBufferer();\n        this._ariaLabel = '';\n        this.disposables = new DisposableStore();\n        this._onDidDispose = new Emitter();\n        this.onDidDispose = this._onDidDispose.event;\n        const role = this._options.accessibilityProvider && this._options.accessibilityProvider.getWidgetRole ? (_a = this._options.accessibilityProvider) === null || _a === void 0 ? void 0 : _a.getWidgetRole() : 'list';\n        this.selection = new SelectionTrait(role !== 'listbox');\n        mixin(_options, defaultStyles, false);\n        const baseRenderers = [this.focus.renderer, this.selection.renderer];\n        this.accessibilityProvider = _options.accessibilityProvider;\n        if (this.accessibilityProvider) {\n            baseRenderers.push(new AccessibiltyRenderer(this.accessibilityProvider));\n            (_c = (_b = this.accessibilityProvider).onDidChangeActiveDescendant) === null || _c === void 0 ? void 0 : _c.call(_b, this.onDidChangeActiveDescendant, this, this.disposables);\n        }\n        renderers = renderers.map(r => new PipelineRenderer(r.templateId, [...baseRenderers, r]));\n        const viewOptions = Object.assign(Object.assign({}, _options), { dnd: _options.dnd && new ListViewDragAndDrop(this, _options.dnd) });\n        this.view = new ListView(container, virtualDelegate, renderers, viewOptions);\n        this.view.domNode.setAttribute('role', role);\n        if (_options.styleController) {\n            this.styleController = _options.styleController(this.view.domId);\n        }\n        else {\n            const styleElement = createStyleSheet(this.view.domNode);\n            this.styleController = new DefaultStyleController(styleElement, this.view.domId);\n        }\n        this.spliceable = new CombinedSpliceable([\n            new TraitSpliceable(this.focus, this.view, _options.identityProvider),\n            new TraitSpliceable(this.selection, this.view, _options.identityProvider),\n            new TraitSpliceable(this.anchor, this.view, _options.identityProvider),\n            this.view\n        ]);\n        this.disposables.add(this.focus);\n        this.disposables.add(this.selection);\n        this.disposables.add(this.anchor);\n        this.disposables.add(this.view);\n        this.disposables.add(this._onDidDispose);\n        this.disposables.add(new DOMFocusController(this, this.view));\n        if (typeof _options.keyboardSupport !== 'boolean' || _options.keyboardSupport) {\n            this.keyboardController = new KeyboardController(this, this.view, _options);\n            this.disposables.add(this.keyboardController);\n        }\n        if (_options.keyboardNavigationLabelProvider) {\n            const delegate = _options.keyboardNavigationDelegate || DefaultKeyboardNavigationDelegate;\n            this.typeNavigationController = new TypeNavigationController(this, this.view, _options.keyboardNavigationLabelProvider, (_d = _options.keyboardNavigationEventFilter) !== null && _d !== void 0 ? _d : (() => true), delegate);\n            this.disposables.add(this.typeNavigationController);\n        }\n        this.mouseController = this.createMouseController(_options);\n        this.disposables.add(this.mouseController);\n        this.onDidChangeFocus(this._onFocusChange, this, this.disposables);\n        this.onDidChangeSelection(this._onSelectionChange, this, this.disposables);\n        if (this.accessibilityProvider) {\n            this.ariaLabel = this.accessibilityProvider.getWidgetAriaLabel();\n        }\n        if (this._options.multipleSelectionSupport !== false) {\n            this.view.domNode.setAttribute('aria-multiselectable', 'true');\n        }\n    }\n    get onDidChangeFocus() {\n        return Event.map(this.eventBufferer.wrapEvent(this.focus.onChange), e => this.toListEvent(e), this.disposables);\n    }\n    get onDidChangeSelection() {\n        return Event.map(this.eventBufferer.wrapEvent(this.selection.onChange), e => this.toListEvent(e), this.disposables);\n    }\n    get domId() { return this.view.domId; }\n    get onMouseClick() { return this.view.onMouseClick; }\n    get onMouseDblClick() { return this.view.onMouseDblClick; }\n    get onMouseMiddleClick() { return this.view.onMouseMiddleClick; }\n    get onPointer() { return this.mouseController.onPointer; }\n    get onMouseDown() { return this.view.onMouseDown; }\n    get onMouseOver() { return this.view.onMouseOver; }\n    get onTouchStart() { return this.view.onTouchStart; }\n    get onTap() { return this.view.onTap; }\n    /**\n     * Possible context menu trigger events:\n     * - ContextMenu key\n     * - Shift F10\n     * - Ctrl Option Shift M (macOS with VoiceOver)\n     * - Mouse right click\n     */\n    get onContextMenu() {\n        let didJustPressContextMenuKey = false;\n        const fromKeyDown = this.disposables.add(Event.chain(this.disposables.add(new DomEmitter(this.view.domNode, 'keydown')).event))\n            .map(e => new StandardKeyboardEvent(e))\n            .filter(e => didJustPressContextMenuKey = e.keyCode === 58 /* KeyCode.ContextMenu */ || (e.shiftKey && e.keyCode === 68 /* KeyCode.F10 */))\n            .map(stopEvent)\n            .filter(() => false)\n            .event;\n        const fromKeyUp = this.disposables.add(Event.chain(this.disposables.add(new DomEmitter(this.view.domNode, 'keyup')).event))\n            .forEach(() => didJustPressContextMenuKey = false)\n            .map(e => new StandardKeyboardEvent(e))\n            .filter(e => e.keyCode === 58 /* KeyCode.ContextMenu */ || (e.shiftKey && e.keyCode === 68 /* KeyCode.F10 */))\n            .map(stopEvent)\n            .map(({ browserEvent }) => {\n            const focus = this.getFocus();\n            const index = focus.length ? focus[0] : undefined;\n            const element = typeof index !== 'undefined' ? this.view.element(index) : undefined;\n            const anchor = typeof index !== 'undefined' ? this.view.domElement(index) : this.view.domNode;\n            return { index, element, anchor, browserEvent };\n        })\n            .event;\n        const fromMouse = this.disposables.add(Event.chain(this.view.onContextMenu))\n            .filter(_ => !didJustPressContextMenuKey)\n            .map(({ element, index, browserEvent }) => ({ element, index, anchor: { x: browserEvent.pageX + 1, y: browserEvent.pageY }, browserEvent }))\n            .event;\n        return Event.any(fromKeyDown, fromKeyUp, fromMouse);\n    }\n    get onKeyDown() { return this.disposables.add(new DomEmitter(this.view.domNode, 'keydown')).event; }\n    get onDidFocus() { return Event.signal(this.disposables.add(new DomEmitter(this.view.domNode, 'focus', true)).event); }\n    createMouseController(options) {\n        return new MouseController(this);\n    }\n    updateOptions(optionsUpdate = {}) {\n        var _a, _b;\n        this._options = Object.assign(Object.assign({}, this._options), optionsUpdate);\n        (_a = this.typeNavigationController) === null || _a === void 0 ? void 0 : _a.updateOptions(this._options);\n        if (this._options.multipleSelectionController !== undefined) {\n            if (this._options.multipleSelectionSupport) {\n                this.view.domNode.setAttribute('aria-multiselectable', 'true');\n            }\n            else {\n                this.view.domNode.removeAttribute('aria-multiselectable');\n            }\n        }\n        this.mouseController.updateOptions(optionsUpdate);\n        (_b = this.keyboardController) === null || _b === void 0 ? void 0 : _b.updateOptions(optionsUpdate);\n        this.view.updateOptions(optionsUpdate);\n    }\n    get options() {\n        return this._options;\n    }\n    splice(start, deleteCount, elements = []) {\n        if (start < 0 || start > this.view.length) {\n            throw new ListError(this.user, `Invalid start index: ${start}`);\n        }\n        if (deleteCount < 0) {\n            throw new ListError(this.user, `Invalid delete count: ${deleteCount}`);\n        }\n        if (deleteCount === 0 && elements.length === 0) {\n            return;\n        }\n        this.eventBufferer.bufferEvents(() => this.spliceable.splice(start, deleteCount, elements));\n    }\n    rerender() {\n        this.view.rerender();\n    }\n    element(index) {\n        return this.view.element(index);\n    }\n    get length() {\n        return this.view.length;\n    }\n    get contentHeight() {\n        return this.view.contentHeight;\n    }\n    get scrollTop() {\n        return this.view.getScrollTop();\n    }\n    set scrollTop(scrollTop) {\n        this.view.setScrollTop(scrollTop);\n    }\n    get ariaLabel() {\n        return this._ariaLabel;\n    }\n    set ariaLabel(value) {\n        this._ariaLabel = value;\n        this.view.domNode.setAttribute('aria-label', value);\n    }\n    domFocus() {\n        this.view.domNode.focus({ preventScroll: true });\n    }\n    layout(height, width) {\n        this.view.layout(height, width);\n    }\n    setSelection(indexes, browserEvent) {\n        for (const index of indexes) {\n            if (index < 0 || index >= this.length) {\n                throw new ListError(this.user, `Invalid index ${index}`);\n            }\n        }\n        this.selection.set(indexes, browserEvent);\n    }\n    getSelection() {\n        return this.selection.get();\n    }\n    getSelectedElements() {\n        return this.getSelection().map(i => this.view.element(i));\n    }\n    setAnchor(index) {\n        if (typeof index === 'undefined') {\n            this.anchor.set([]);\n            return;\n        }\n        if (index < 0 || index >= this.length) {\n            throw new ListError(this.user, `Invalid index ${index}`);\n        }\n        this.anchor.set([index]);\n    }\n    getAnchor() {\n        return firstOrDefault(this.anchor.get(), undefined);\n    }\n    getAnchorElement() {\n        const anchor = this.getAnchor();\n        return typeof anchor === 'undefined' ? undefined : this.element(anchor);\n    }\n    setFocus(indexes, browserEvent) {\n        for (const index of indexes) {\n            if (index < 0 || index >= this.length) {\n                throw new ListError(this.user, `Invalid index ${index}`);\n            }\n        }\n        this.focus.set(indexes, browserEvent);\n    }\n    focusNext(n = 1, loop = false, browserEvent, filter) {\n        if (this.length === 0) {\n            return;\n        }\n        const focus = this.focus.get();\n        const index = this.findNextIndex(focus.length > 0 ? focus[0] + n : 0, loop, filter);\n        if (index > -1) {\n            this.setFocus([index], browserEvent);\n        }\n    }\n    focusPrevious(n = 1, loop = false, browserEvent, filter) {\n        if (this.length === 0) {\n            return;\n        }\n        const focus = this.focus.get();\n        const index = this.findPreviousIndex(focus.length > 0 ? focus[0] - n : 0, loop, filter);\n        if (index > -1) {\n            this.setFocus([index], browserEvent);\n        }\n    }\n    focusNextPage(browserEvent, filter) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let lastPageIndex = this.view.indexAt(this.view.getScrollTop() + this.view.renderHeight);\n            lastPageIndex = lastPageIndex === 0 ? 0 : lastPageIndex - 1;\n            const currentlyFocusedElementIndex = this.getFocus()[0];\n            if (currentlyFocusedElementIndex !== lastPageIndex && (currentlyFocusedElementIndex === undefined || lastPageIndex > currentlyFocusedElementIndex)) {\n                const lastGoodPageIndex = this.findPreviousIndex(lastPageIndex, false, filter);\n                if (lastGoodPageIndex > -1 && currentlyFocusedElementIndex !== lastGoodPageIndex) {\n                    this.setFocus([lastGoodPageIndex], browserEvent);\n                }\n                else {\n                    this.setFocus([lastPageIndex], browserEvent);\n                }\n            }\n            else {\n                const previousScrollTop = this.view.getScrollTop();\n                let nextpageScrollTop = previousScrollTop + this.view.renderHeight;\n                if (lastPageIndex > currentlyFocusedElementIndex) {\n                    // scroll last page element to the top only if the last page element is below the focused element\n                    nextpageScrollTop -= this.view.elementHeight(lastPageIndex);\n                }\n                this.view.setScrollTop(nextpageScrollTop);\n                if (this.view.getScrollTop() !== previousScrollTop) {\n                    this.setFocus([]);\n                    // Let the scroll event listener run\n                    yield timeout(0);\n                    yield this.focusNextPage(browserEvent, filter);\n                }\n            }\n        });\n    }\n    focusPreviousPage(browserEvent, filter) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let firstPageIndex;\n            const scrollTop = this.view.getScrollTop();\n            if (scrollTop === 0) {\n                firstPageIndex = this.view.indexAt(scrollTop);\n            }\n            else {\n                firstPageIndex = this.view.indexAfter(scrollTop - 1);\n            }\n            const currentlyFocusedElementIndex = this.getFocus()[0];\n            if (currentlyFocusedElementIndex !== firstPageIndex && (currentlyFocusedElementIndex === undefined || currentlyFocusedElementIndex >= firstPageIndex)) {\n                const firstGoodPageIndex = this.findNextIndex(firstPageIndex, false, filter);\n                if (firstGoodPageIndex > -1 && currentlyFocusedElementIndex !== firstGoodPageIndex) {\n                    this.setFocus([firstGoodPageIndex], browserEvent);\n                }\n                else {\n                    this.setFocus([firstPageIndex], browserEvent);\n                }\n            }\n            else {\n                const previousScrollTop = scrollTop;\n                this.view.setScrollTop(scrollTop - this.view.renderHeight);\n                if (this.view.getScrollTop() !== previousScrollTop) {\n                    this.setFocus([]);\n                    // Let the scroll event listener run\n                    yield timeout(0);\n                    yield this.focusPreviousPage(browserEvent, filter);\n                }\n            }\n        });\n    }\n    focusLast(browserEvent, filter) {\n        if (this.length === 0) {\n            return;\n        }\n        const index = this.findPreviousIndex(this.length - 1, false, filter);\n        if (index > -1) {\n            this.setFocus([index], browserEvent);\n        }\n    }\n    focusFirst(browserEvent, filter) {\n        this.focusNth(0, browserEvent, filter);\n    }\n    focusNth(n, browserEvent, filter) {\n        if (this.length === 0) {\n            return;\n        }\n        const index = this.findNextIndex(n, false, filter);\n        if (index > -1) {\n            this.setFocus([index], browserEvent);\n        }\n    }\n    findNextIndex(index, loop = false, filter) {\n        for (let i = 0; i < this.length; i++) {\n            if (index >= this.length && !loop) {\n                return -1;\n            }\n            index = index % this.length;\n            if (!filter || filter(this.element(index))) {\n                return index;\n            }\n            index++;\n        }\n        return -1;\n    }\n    findPreviousIndex(index, loop = false, filter) {\n        for (let i = 0; i < this.length; i++) {\n            if (index < 0 && !loop) {\n                return -1;\n            }\n            index = (this.length + (index % this.length)) % this.length;\n            if (!filter || filter(this.element(index))) {\n                return index;\n            }\n            index--;\n        }\n        return -1;\n    }\n    getFocus() {\n        return this.focus.get();\n    }\n    getFocusedElements() {\n        return this.getFocus().map(i => this.view.element(i));\n    }\n    reveal(index, relativeTop) {\n        if (index < 0 || index >= this.length) {\n            throw new ListError(this.user, `Invalid index ${index}`);\n        }\n        const scrollTop = this.view.getScrollTop();\n        const elementTop = this.view.elementTop(index);\n        const elementHeight = this.view.elementHeight(index);\n        if (isNumber(relativeTop)) {\n            // y = mx + b\n            const m = elementHeight - this.view.renderHeight;\n            this.view.setScrollTop(m * clamp(relativeTop, 0, 1) + elementTop);\n        }\n        else {\n            const viewItemBottom = elementTop + elementHeight;\n            const scrollBottom = scrollTop + this.view.renderHeight;\n            if (elementTop < scrollTop && viewItemBottom >= scrollBottom) {\n                // The element is already overflowing the viewport, no-op\n            }\n            else if (elementTop < scrollTop || (viewItemBottom >= scrollBottom && elementHeight >= this.view.renderHeight)) {\n                this.view.setScrollTop(elementTop);\n            }\n            else if (viewItemBottom >= scrollBottom) {\n                this.view.setScrollTop(viewItemBottom - this.view.renderHeight);\n            }\n        }\n    }\n    getHTMLElement() {\n        return this.view.domNode;\n    }\n    getElementID(index) {\n        return this.view.getElementDomId(index);\n    }\n    style(styles) {\n        this.styleController.style(styles);\n    }\n    toListEvent({ indexes, browserEvent }) {\n        return { indexes, elements: indexes.map(i => this.view.element(i)), browserEvent };\n    }\n    _onFocusChange() {\n        const focus = this.focus.get();\n        this.view.domNode.classList.toggle('element-focused', focus.length > 0);\n        this.onDidChangeActiveDescendant();\n    }\n    onDidChangeActiveDescendant() {\n        var _a;\n        const focus = this.focus.get();\n        if (focus.length > 0) {\n            let id;\n            if ((_a = this.accessibilityProvider) === null || _a === void 0 ? void 0 : _a.getActiveDescendantId) {\n                id = this.accessibilityProvider.getActiveDescendantId(this.view.element(focus[0]));\n            }\n            this.view.domNode.setAttribute('aria-activedescendant', id || this.view.getElementDomId(focus[0]));\n        }\n        else {\n            this.view.domNode.removeAttribute('aria-activedescendant');\n        }\n    }\n    _onSelectionChange() {\n        const selection = this.selection.get();\n        this.view.domNode.classList.toggle('selection-none', selection.length === 0);\n        this.view.domNode.classList.toggle('selection-single', selection.length === 1);\n        this.view.domNode.classList.toggle('selection-multiple', selection.length > 1);\n    }\n    dispose() {\n        this._onDidDispose.fire();\n        this.disposables.dispose();\n        this._onDidDispose.dispose();\n    }\n}\n__decorate([\n    memoize\n], List.prototype, \"onDidChangeFocus\", null);\n__decorate([\n    memoize\n], List.prototype, \"onDidChangeSelection\", null);\n__decorate([\n    memoize\n], List.prototype, \"onContextMenu\", null);\n__decorate([\n    memoize\n], List.prototype, \"onKeyDown\", null);\n__decorate([\n    memoize\n], List.prototype, \"onDidFocus\", null);\n"],"mappings":"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"}]}