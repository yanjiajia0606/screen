{"remainingRequest":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/thread-loader/dist/cjs.js!/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js!/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/format.js","dependencies":[{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/format.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/babel.config.js","mtime":1668271197000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vc2xpY2VkVG9BcnJheS5qcyI7CmltcG9ydCBfdG9Db25zdW1hYmxlQXJyYXkgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheS5qcyI7CmltcG9ydCBfcmVnZW5lcmF0b3JSdW50aW1lIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vcmVnZW5lcmF0b3JSdW50aW1lLmpzIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvVXNlcnMveWFuamlhamlhL0Rlc2t0b3Avd29ya3NwYWNlL2F2dWUtZGF0YS1uZXcvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrLmpzIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICIvVXNlcnMveWFuamlhamlhL0Rlc2t0b3Avd29ya3NwYWNlL2F2dWUtZGF0YS1uZXcvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzLmpzIjsKaW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zZXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnVuc2hpZnQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5yZWR1Y2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zb3J0LmpzIjsKLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLgogKiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi4KICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCnZhciBfX2F3YWl0ZXIgPSB0aGlzICYmIHRoaXMuX19hd2FpdGVyIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHsKICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgewogICAgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgcmVzb2x2ZSh2YWx1ZSk7CiAgICB9KTsKICB9CiAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsKICAgICAgdHJ5IHsKICAgICAgICBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICByZWplY3QoZSk7CiAgICAgIH0KICAgIH0KICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7CiAgICAgIHRyeSB7CiAgICAgICAgc3RlcChnZW5lcmF0b3JbInRocm93Il0odmFsdWUpKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHJlamVjdChlKTsKICAgICAgfQogICAgfQogICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsKICAgICAgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7CiAgICB9CiAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7CiAgfSk7Cn07CmltcG9ydCB7IGFsZXJ0IH0gZnJvbSAnLi4vLi4vLi4vLi4vYmFzZS9icm93c2VyL3VpL2FyaWEvYXJpYS5qcyc7CmltcG9ydCB7IGFzQXJyYXksIGlzTm9uRW1wdHlBcnJheSB9IGZyb20gJy4uLy4uLy4uLy4uL2Jhc2UvY29tbW9uL2FycmF5cy5qcyc7CmltcG9ydCB7IENhbmNlbGxhdGlvblRva2VuIH0gZnJvbSAnLi4vLi4vLi4vLi4vYmFzZS9jb21tb24vY2FuY2VsbGF0aW9uLmpzJzsKaW1wb3J0IHsgb25VbmV4cGVjdGVkRXh0ZXJuYWxFcnJvciB9IGZyb20gJy4uLy4uLy4uLy4uL2Jhc2UvY29tbW9uL2Vycm9ycy5qcyc7CmltcG9ydCB7IEl0ZXJhYmxlIH0gZnJvbSAnLi4vLi4vLi4vLi4vYmFzZS9jb21tb24vaXRlcmF0b3IuanMnOwppbXBvcnQgeyBMaW5rZWRMaXN0IH0gZnJvbSAnLi4vLi4vLi4vLi4vYmFzZS9jb21tb24vbGlua2VkTGlzdC5qcyc7CmltcG9ydCB7IGFzc2VydFR5cGUgfSBmcm9tICcuLi8uLi8uLi8uLi9iYXNlL2NvbW1vbi90eXBlcy5qcyc7CmltcG9ydCB7IFVSSSB9IGZyb20gJy4uLy4uLy4uLy4uL2Jhc2UvY29tbW9uL3VyaS5qcyc7CmltcG9ydCB7IEVkaXRvclN0YXRlQ2FuY2VsbGF0aW9uVG9rZW5Tb3VyY2UsIFRleHRNb2RlbENhbmNlbGxhdGlvblRva2VuU291cmNlIH0gZnJvbSAnLi4vLi4vZWRpdG9yU3RhdGUvYnJvd3Nlci9lZGl0b3JTdGF0ZS5qcyc7CmltcG9ydCB7IGlzQ29kZUVkaXRvciB9IGZyb20gJy4uLy4uLy4uL2Jyb3dzZXIvZWRpdG9yQnJvd3Nlci5qcyc7CmltcG9ydCB7IFBvc2l0aW9uIH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL2NvcmUvcG9zaXRpb24uanMnOwppbXBvcnQgeyBSYW5nZSB9IGZyb20gJy4uLy4uLy4uL2NvbW1vbi9jb3JlL3JhbmdlLmpzJzsKaW1wb3J0IHsgU2VsZWN0aW9uIH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL2NvcmUvc2VsZWN0aW9uLmpzJzsKaW1wb3J0IHsgSUVkaXRvcldvcmtlclNlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi9jb21tb24vc2VydmljZXMvZWRpdG9yV29ya2VyLmpzJzsKaW1wb3J0IHsgSVRleHRNb2RlbFNlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi9jb21tb24vc2VydmljZXMvcmVzb2x2ZXJTZXJ2aWNlLmpzJzsKaW1wb3J0IHsgRm9ybWF0dGluZ0VkaXQgfSBmcm9tICcuL2Zvcm1hdHRpbmdFZGl0LmpzJzsKaW1wb3J0ICogYXMgbmxzIGZyb20gJy4uLy4uLy4uLy4uL25scy5qcyc7CmltcG9ydCB7IENvbW1hbmRzUmVnaXN0cnkgfSBmcm9tICcuLi8uLi8uLi8uLi9wbGF0Zm9ybS9jb21tYW5kcy9jb21tb24vY29tbWFuZHMuanMnOwppbXBvcnQgeyBFeHRlbnNpb25JZGVudGlmaWVyIH0gZnJvbSAnLi4vLi4vLi4vLi4vcGxhdGZvcm0vZXh0ZW5zaW9ucy9jb21tb24vZXh0ZW5zaW9ucy5qcyc7CmltcG9ydCB7IElJbnN0YW50aWF0aW9uU2VydmljZSB9IGZyb20gJy4uLy4uLy4uLy4uL3BsYXRmb3JtL2luc3RhbnRpYXRpb24vY29tbW9uL2luc3RhbnRpYXRpb24uanMnOwppbXBvcnQgeyBJTGFuZ3VhZ2VGZWF0dXJlc1NlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi9jb21tb24vc2VydmljZXMvbGFuZ3VhZ2VGZWF0dXJlcy5qcyc7CmV4cG9ydCBmdW5jdGlvbiBhbGVydEZvcm1hdHRpbmdFZGl0cyhlZGl0cykgewogIGVkaXRzID0gZWRpdHMuZmlsdGVyKGZ1bmN0aW9uIChlZGl0KSB7CiAgICByZXR1cm4gZWRpdC5yYW5nZTsKICB9KTsKICBpZiAoIWVkaXRzLmxlbmd0aCkgewogICAgcmV0dXJuOwogIH0KICB2YXIgcmFuZ2UgPSBlZGl0c1swXS5yYW5nZTsKICBmb3IgKHZhciBpID0gMTsgaSA8IGVkaXRzLmxlbmd0aDsgaSsrKSB7CiAgICByYW5nZSA9IFJhbmdlLnBsdXNSYW5nZShyYW5nZSwgZWRpdHNbaV0ucmFuZ2UpOwogIH0KICB2YXIgX3JhbmdlID0gcmFuZ2UsCiAgICBzdGFydExpbmVOdW1iZXIgPSBfcmFuZ2Uuc3RhcnRMaW5lTnVtYmVyLAogICAgZW5kTGluZU51bWJlciA9IF9yYW5nZS5lbmRMaW5lTnVtYmVyOwogIGlmIChzdGFydExpbmVOdW1iZXIgPT09IGVuZExpbmVOdW1iZXIpIHsKICAgIGlmIChlZGl0cy5sZW5ndGggPT09IDEpIHsKICAgICAgYWxlcnQobmxzLmxvY2FsaXplKCdoaW50MTEnLCAiTWFkZSAxIGZvcm1hdHRpbmcgZWRpdCBvbiBsaW5lIHswfSIsIHN0YXJ0TGluZU51bWJlcikpOwogICAgfSBlbHNlIHsKICAgICAgYWxlcnQobmxzLmxvY2FsaXplKCdoaW50bjEnLCAiTWFkZSB7MH0gZm9ybWF0dGluZyBlZGl0cyBvbiBsaW5lIHsxfSIsIGVkaXRzLmxlbmd0aCwgc3RhcnRMaW5lTnVtYmVyKSk7CiAgICB9CiAgfSBlbHNlIHsKICAgIGlmIChlZGl0cy5sZW5ndGggPT09IDEpIHsKICAgICAgYWxlcnQobmxzLmxvY2FsaXplKCdoaW50MW4nLCAiTWFkZSAxIGZvcm1hdHRpbmcgZWRpdCBiZXR3ZWVuIGxpbmVzIHswfSBhbmQgezF9Iiwgc3RhcnRMaW5lTnVtYmVyLCBlbmRMaW5lTnVtYmVyKSk7CiAgICB9IGVsc2UgewogICAgICBhbGVydChubHMubG9jYWxpemUoJ2hpbnRubicsICJNYWRlIHswfSBmb3JtYXR0aW5nIGVkaXRzIGJldHdlZW4gbGluZXMgezF9IGFuZCB7Mn0iLCBlZGl0cy5sZW5ndGgsIHN0YXJ0TGluZU51bWJlciwgZW5kTGluZU51bWJlcikpOwogICAgfQogIH0KfQpleHBvcnQgZnVuY3Rpb24gZ2V0UmVhbEFuZFN5bnRoZXRpY0RvY3VtZW50Rm9ybWF0dGVyc09yZGVyZWQoZG9jdW1lbnRGb3JtYXR0aW5nRWRpdFByb3ZpZGVyLCBkb2N1bWVudFJhbmdlRm9ybWF0dGluZ0VkaXRQcm92aWRlciwgbW9kZWwpIHsKICB2YXIgcmVzdWx0ID0gW107CiAgdmFyIHNlZW4gPSBuZXcgU2V0KCk7CiAgLy8gKDEpIGFkZCBhbGwgZG9jdW1lbnQgZm9ybWF0dGVyCiAgdmFyIGRvY0Zvcm1hdHRlciA9IGRvY3VtZW50Rm9ybWF0dGluZ0VkaXRQcm92aWRlci5vcmRlcmVkKG1vZGVsKTsKICB2YXIgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoZG9jRm9ybWF0dGVyKSwKICAgIF9zdGVwOwogIHRyeSB7CiAgICBmb3IgKF9pdGVyYXRvci5zKCk7ICEoX3N0ZXAgPSBfaXRlcmF0b3IubigpKS5kb25lOykgewogICAgICB2YXIgZm9ybWF0dGVyID0gX3N0ZXAudmFsdWU7CiAgICAgIHJlc3VsdC5wdXNoKGZvcm1hdHRlcik7CiAgICAgIGlmIChmb3JtYXR0ZXIuZXh0ZW5zaW9uSWQpIHsKICAgICAgICBzZWVuLmFkZChFeHRlbnNpb25JZGVudGlmaWVyLnRvS2V5KGZvcm1hdHRlci5leHRlbnNpb25JZCkpOwogICAgICB9CiAgICB9CiAgICAvLyAoMikgYWRkIGFsbCByYW5nZSBmb3JtYXR0ZXIgYXMgZG9jdW1lbnQgZm9ybWF0dGVyICh1bmxlc3MgdGhlIHNhbWUgZXh0ZW5zaW9uIGFscmVhZHkgZGlkIHRoYXQpCiAgfSBjYXRjaCAoZXJyKSB7CiAgICBfaXRlcmF0b3IuZShlcnIpOwogIH0gZmluYWxseSB7CiAgICBfaXRlcmF0b3IuZigpOwogIH0KICB2YXIgcmFuZ2VGb3JtYXR0ZXIgPSBkb2N1bWVudFJhbmdlRm9ybWF0dGluZ0VkaXRQcm92aWRlci5vcmRlcmVkKG1vZGVsKTsKICB2YXIgX2l0ZXJhdG9yMiA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHJhbmdlRm9ybWF0dGVyKSwKICAgIF9zdGVwMjsKICB0cnkgewogICAgdmFyIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoKSB7CiAgICAgIHZhciBmb3JtYXR0ZXIgPSBfc3RlcDIudmFsdWU7CiAgICAgIGlmIChmb3JtYXR0ZXIuZXh0ZW5zaW9uSWQpIHsKICAgICAgICBpZiAoc2Vlbi5oYXMoRXh0ZW5zaW9uSWRlbnRpZmllci50b0tleShmb3JtYXR0ZXIuZXh0ZW5zaW9uSWQpKSkgewogICAgICAgICAgcmV0dXJuICJjb250aW51ZSI7CiAgICAgICAgfQogICAgICAgIHNlZW4uYWRkKEV4dGVuc2lvbklkZW50aWZpZXIudG9LZXkoZm9ybWF0dGVyLmV4dGVuc2lvbklkKSk7CiAgICAgIH0KICAgICAgcmVzdWx0LnB1c2goewogICAgICAgIGRpc3BsYXlOYW1lOiBmb3JtYXR0ZXIuZGlzcGxheU5hbWUsCiAgICAgICAgZXh0ZW5zaW9uSWQ6IGZvcm1hdHRlci5leHRlbnNpb25JZCwKICAgICAgICBwcm92aWRlRG9jdW1lbnRGb3JtYXR0aW5nRWRpdHM6IGZ1bmN0aW9uIHByb3ZpZGVEb2N1bWVudEZvcm1hdHRpbmdFZGl0cyhtb2RlbCwgb3B0aW9ucywgdG9rZW4pIHsKICAgICAgICAgIHJldHVybiBmb3JtYXR0ZXIucHJvdmlkZURvY3VtZW50UmFuZ2VGb3JtYXR0aW5nRWRpdHMobW9kZWwsIG1vZGVsLmdldEZ1bGxNb2RlbFJhbmdlKCksIG9wdGlvbnMsIHRva2VuKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKICAgIGZvciAoX2l0ZXJhdG9yMi5zKCk7ICEoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uKCkpLmRvbmU7KSB7CiAgICAgIHZhciBfcmV0ID0gX2xvb3AoKTsKICAgICAgaWYgKF9yZXQgPT09ICJjb250aW51ZSIpIGNvbnRpbnVlOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2l0ZXJhdG9yMi5lKGVycik7CiAgfSBmaW5hbGx5IHsKICAgIF9pdGVyYXRvcjIuZigpOwogIH0KICByZXR1cm4gcmVzdWx0Owp9CmV4cG9ydCB2YXIgRm9ybWF0dGluZ0NvbmZsaWN0cyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gRm9ybWF0dGluZ0NvbmZsaWN0cygpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBGb3JtYXR0aW5nQ29uZmxpY3RzKTsKICB9CiAgX2NyZWF0ZUNsYXNzKEZvcm1hdHRpbmdDb25mbGljdHMsIG51bGwsIFt7CiAgICBrZXk6ICJzZXRGb3JtYXR0ZXJTZWxlY3RvciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0Rm9ybWF0dGVyU2VsZWN0b3Ioc2VsZWN0b3IpIHsKICAgICAgdmFyIHJlbW92ZSA9IEZvcm1hdHRpbmdDb25mbGljdHMuX3NlbGVjdG9ycy51bnNoaWZ0KHNlbGVjdG9yKTsKICAgICAgcmV0dXJuIHsKICAgICAgICBkaXNwb3NlOiByZW1vdmUKICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZWxlY3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNlbGVjdChmb3JtYXR0ZXIsIGRvY3VtZW50LCBtb2RlKSB7CiAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBzZWxlY3RvcjsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZiAoIShmb3JtYXR0ZXIubGVuZ3RoID09PSAwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCB1bmRlZmluZWQpOwogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHNlbGVjdG9yID0gSXRlcmFibGUuZmlyc3QoRm9ybWF0dGluZ0NvbmZsaWN0cy5fc2VsZWN0b3JzKTsKICAgICAgICAgICAgICAgIGlmICghc2VsZWN0b3IpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7CiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0b3IoZm9ybWF0dGVyLCBkb2N1bWVudCwgbW9kZSk7CiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgX2NvbnRleHQuc2VudCk7CiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgdW5kZWZpbmVkKTsKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgfSkpOwogICAgfQogIH1dKTsKICByZXR1cm4gRm9ybWF0dGluZ0NvbmZsaWN0czsKfSgpOwpGb3JtYXR0aW5nQ29uZmxpY3RzLl9zZWxlY3RvcnMgPSBuZXcgTGlua2VkTGlzdCgpOwpleHBvcnQgZnVuY3Rpb24gZm9ybWF0RG9jdW1lbnRSYW5nZXNXaXRoU2VsZWN0ZWRQcm92aWRlcihhY2Nlc3NvciwgZWRpdG9yT3JNb2RlbCwgcmFuZ2VPclJhbmdlcywgbW9kZSwgcHJvZ3Jlc3MsIHRva2VuKSB7CiAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgdmFyIGluc3RhU2VydmljZSwgX2FjY2Vzc29yJGdldCwgZG9jdW1lbnRSYW5nZUZvcm1hdHRpbmdFZGl0UHJvdmlkZXJSZWdpc3RyeSwgbW9kZWwsIHByb3ZpZGVyLCBzZWxlY3RlZDsKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIGluc3RhU2VydmljZSA9IGFjY2Vzc29yLmdldChJSW5zdGFudGlhdGlvblNlcnZpY2UpOwogICAgICAgICAgICBfYWNjZXNzb3IkZ2V0ID0gYWNjZXNzb3IuZ2V0KElMYW5ndWFnZUZlYXR1cmVzU2VydmljZSksIGRvY3VtZW50UmFuZ2VGb3JtYXR0aW5nRWRpdFByb3ZpZGVyUmVnaXN0cnkgPSBfYWNjZXNzb3IkZ2V0LmRvY3VtZW50UmFuZ2VGb3JtYXR0aW5nRWRpdFByb3ZpZGVyOwogICAgICAgICAgICBtb2RlbCA9IGlzQ29kZUVkaXRvcihlZGl0b3JPck1vZGVsKSA/IGVkaXRvck9yTW9kZWwuZ2V0TW9kZWwoKSA6IGVkaXRvck9yTW9kZWw7CiAgICAgICAgICAgIHByb3ZpZGVyID0gZG9jdW1lbnRSYW5nZUZvcm1hdHRpbmdFZGl0UHJvdmlkZXJSZWdpc3RyeS5vcmRlcmVkKG1vZGVsKTsKICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA2OwogICAgICAgICAgICByZXR1cm4gRm9ybWF0dGluZ0NvbmZsaWN0cy5zZWxlY3QocHJvdmlkZXIsIG1vZGVsLCBtb2RlKTsKICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgc2VsZWN0ZWQgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgaWYgKCFzZWxlY3RlZCkgewogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcHJvZ3Jlc3MucmVwb3J0KHNlbGVjdGVkKTsKICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMTsKICAgICAgICAgICAgcmV0dXJuIGluc3RhU2VydmljZS5pbnZva2VGdW5jdGlvbihmb3JtYXREb2N1bWVudFJhbmdlc1dpdGhQcm92aWRlciwgc2VsZWN0ZWQsIGVkaXRvck9yTW9kZWwsIHJhbmdlT3JSYW5nZXMsIHRva2VuKTsKICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUyKTsKICB9KSk7Cn0KZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdERvY3VtZW50UmFuZ2VzV2l0aFByb3ZpZGVyKGFjY2Vzc29yLCBwcm92aWRlciwgZWRpdG9yT3JNb2RlbCwgcmFuZ2VPclJhbmdlcywgdG9rZW4pIHsKICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgdmFyIHdvcmtlclNlcnZpY2UsIG1vZGVsLCBjdHMsIHJhbmdlcywgbGVuLCBfaXRlcmF0b3IzLCBfc3RlcDMsIF9yYW5nZTQsIGNvbXB1dGVFZGl0cywgaGFzSW50ZXJzZWN0aW5nRWRpdCwgYWxsRWRpdHMsIHJhd0VkaXRzTGlzdCwgX2ksIF9yYW5nZXMsIHJhbmdlLCBpLCBqLCBtZXJnZWRSYW5nZSwgZWRpdHMsIF9pMiwgX3Jhd0VkaXRzTGlzdCwgcmF3RWRpdHMsIG1pbmltYWxFZGl0cywgX3JhbmdlMiwgaW5pdGlhbFNlbGVjdGlvbjsKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIHdvcmtlclNlcnZpY2UgPSBhY2Nlc3Nvci5nZXQoSUVkaXRvcldvcmtlclNlcnZpY2UpOwogICAgICAgICAgICBpZiAoaXNDb2RlRWRpdG9yKGVkaXRvck9yTW9kZWwpKSB7CiAgICAgICAgICAgICAgbW9kZWwgPSBlZGl0b3JPck1vZGVsLmdldE1vZGVsKCk7CiAgICAgICAgICAgICAgY3RzID0gbmV3IEVkaXRvclN0YXRlQ2FuY2VsbGF0aW9uVG9rZW5Tb3VyY2UoZWRpdG9yT3JNb2RlbCwgMSAvKiBDb2RlRWRpdG9yU3RhdGVGbGFnLlZhbHVlICovIHwgNCAvKiBDb2RlRWRpdG9yU3RhdGVGbGFnLlBvc2l0aW9uICovLCB1bmRlZmluZWQsIHRva2VuKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBtb2RlbCA9IGVkaXRvck9yTW9kZWw7CiAgICAgICAgICAgICAgY3RzID0gbmV3IFRleHRNb2RlbENhbmNlbGxhdGlvblRva2VuU291cmNlKGVkaXRvck9yTW9kZWwsIHRva2VuKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBtYWtlIHN1cmUgdGhhdCByYW5nZXMgZG9uJ3Qgb3ZlcmxhcCBub3IgdG91Y2ggZWFjaCBvdGhlcgogICAgICAgICAgICByYW5nZXMgPSBbXTsKICAgICAgICAgICAgbGVuID0gMDsKICAgICAgICAgICAgX2l0ZXJhdG9yMyA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKGFzQXJyYXkocmFuZ2VPclJhbmdlcykuc29ydChSYW5nZS5jb21wYXJlUmFuZ2VzVXNpbmdTdGFydHMpKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBmb3IgKF9pdGVyYXRvcjMucygpOyAhKF9zdGVwMyA9IF9pdGVyYXRvcjMubigpKS5kb25lOykgewogICAgICAgICAgICAgICAgX3JhbmdlNCA9IF9zdGVwMy52YWx1ZTsKICAgICAgICAgICAgICAgIGlmIChsZW4gPiAwICYmIFJhbmdlLmFyZUludGVyc2VjdGluZ09yVG91Y2hpbmcocmFuZ2VzW2xlbiAtIDFdLCBfcmFuZ2U0KSkgewogICAgICAgICAgICAgICAgICByYW5nZXNbbGVuIC0gMV0gPSBSYW5nZS5mcm9tUG9zaXRpb25zKHJhbmdlc1tsZW4gLSAxXS5nZXRTdGFydFBvc2l0aW9uKCksIF9yYW5nZTQuZ2V0RW5kUG9zaXRpb24oKSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBsZW4gPSByYW5nZXMucHVzaChfcmFuZ2U0KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgIF9pdGVyYXRvcjMuZShlcnIpOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgIF9pdGVyYXRvcjMuZigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbXB1dGVFZGl0cyA9IGZ1bmN0aW9uIGNvbXB1dGVFZGl0cyhyYW5nZSkgewogICAgICAgICAgICAgIHJldHVybiBfX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwcm92aWRlci5wcm92aWRlRG9jdW1lbnRSYW5nZUZvcm1hdHRpbmdFZGl0cyhtb2RlbCwgcmFuZ2UsIG1vZGVsLmdldEZvcm1hdHRpbmdPcHRpb25zKCksIGN0cy50b2tlbik7CiAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My50MCA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2NvbnRleHQzLnQwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA1OwogICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0My50MCA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgX2NvbnRleHQzLnQwKTsKICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwgX2NhbGxlZTMpOwogICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgaGFzSW50ZXJzZWN0aW5nRWRpdCA9IGZ1bmN0aW9uIGhhc0ludGVyc2VjdGluZ0VkaXQoYSwgYikgewogICAgICAgICAgICAgIGlmICghYS5sZW5ndGggfHwgIWIubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIC8vIHF1aWNrIGV4aXQgaWYgdGhlIGxpc3Qgb2YgcmFuZ2VzIGFyZSBjb21wbGV0ZWx5IHVucmVsYXRlZCBbTyhuKV0KICAgICAgICAgICAgICB2YXIgbWVyZ2VkQSA9IGEucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHZhbCkgewogICAgICAgICAgICAgICAgcmV0dXJuIFJhbmdlLnBsdXNSYW5nZShhY2MsIHZhbC5yYW5nZSk7CiAgICAgICAgICAgICAgfSwgYVswXS5yYW5nZSk7CiAgICAgICAgICAgICAgaWYgKCFiLnNvbWUoZnVuY3Rpb24gKHgpIHsKICAgICAgICAgICAgICAgIHJldHVybiBSYW5nZS5pbnRlcnNlY3RSYW5nZXMobWVyZ2VkQSwgeC5yYW5nZSk7CiAgICAgICAgICAgICAgfSkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8gZmFsbGJhY2sgdG8gYSBjb21wbGV0ZSBjaGVjayBbTyhuXjIpXQogICAgICAgICAgICAgIHZhciBfaXRlcmF0b3I0ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoYSksCiAgICAgICAgICAgICAgICBfc3RlcDQ7CiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGZvciAoX2l0ZXJhdG9yNC5zKCk7ICEoX3N0ZXA0ID0gX2l0ZXJhdG9yNC5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgICAgICAgIHZhciBlZGl0ID0gX3N0ZXA0LnZhbHVlOwogICAgICAgICAgICAgICAgICB2YXIgX2l0ZXJhdG9yNSA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKGIpLAogICAgICAgICAgICAgICAgICAgIF9zdGVwNTsKICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBmb3IgKF9pdGVyYXRvcjUucygpOyAhKF9zdGVwNSA9IF9pdGVyYXRvcjUubigpKS5kb25lOykgewogICAgICAgICAgICAgICAgICAgICAgdmFyIG90aGVyRWRpdCA9IF9zdGVwNS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICAgIGlmIChSYW5nZS5pbnRlcnNlY3RSYW5nZXMoZWRpdC5yYW5nZSwgb3RoZXJFZGl0LnJhbmdlKSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvcjUuZShlcnIpOwogICAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvcjUuZigpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgICBfaXRlcmF0b3I0LmUoZXJyKTsKICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgX2l0ZXJhdG9yNC5mKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgYWxsRWRpdHMgPSBbXTsKICAgICAgICAgICAgcmF3RWRpdHNMaXN0ID0gW107CiAgICAgICAgICAgIF9jb250ZXh0NC5wcmV2ID0gMTA7CiAgICAgICAgICAgIF9pID0gMCwgX3JhbmdlcyA9IHJhbmdlczsKICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgIGlmICghKF9pIDwgX3Jhbmdlcy5sZW5ndGgpKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyNDsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICByYW5nZSA9IF9yYW5nZXNbX2ldOwogICAgICAgICAgICBpZiAoIWN0cy50b2tlbi5pc0NhbmNlbGxhdGlvblJlcXVlc3RlZCkgewogICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMTY7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIsIHRydWUpOwogICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgX2NvbnRleHQ0LnQwID0gcmF3RWRpdHNMaXN0OwogICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDE5OwogICAgICAgICAgICByZXR1cm4gY29tcHV0ZUVkaXRzKHJhbmdlKTsKICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgIF9jb250ZXh0NC50MSA9IF9jb250ZXh0NC5zZW50OwogICAgICAgICAgICBfY29udGV4dDQudDAucHVzaC5jYWxsKF9jb250ZXh0NC50MCwgX2NvbnRleHQ0LnQxKTsKICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgIF9pKys7CiAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMTI7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAyNDoKICAgICAgICAgICAgaSA9IDA7CiAgICAgICAgICBjYXNlIDI1OgogICAgICAgICAgICBpZiAoIShpIDwgcmFuZ2VzLmxlbmd0aCkpIHsKICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDQ5OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGogPSBpICsgMTsKICAgICAgICAgIGNhc2UgMjc6CiAgICAgICAgICAgIGlmICghKGogPCByYW5nZXMubGVuZ3RoKSkgewogICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNDY7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCFjdHMudG9rZW4uaXNDYW5jZWxsYXRpb25SZXF1ZXN0ZWQpIHsKICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDMwOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCB0cnVlKTsKICAgICAgICAgIGNhc2UgMzA6CiAgICAgICAgICAgIGlmICghaGFzSW50ZXJzZWN0aW5nRWRpdChyYXdFZGl0c0xpc3RbaV0sIHJhd0VkaXRzTGlzdFtqXSkpIHsKICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDQzOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIE1lcmdlIHJhbmdlcyBpIGFuZCBqIGludG8gYSBzaW5nbGUgcmFuZ2UsIHJlY29tcHV0ZSB0aGUgYXNzb2NpYXRlZCBlZGl0cwogICAgICAgICAgICBtZXJnZWRSYW5nZSA9IFJhbmdlLnBsdXNSYW5nZShyYW5nZXNbaV0sIHJhbmdlc1tqXSk7CiAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMzQ7CiAgICAgICAgICAgIHJldHVybiBjb21wdXRlRWRpdHMobWVyZ2VkUmFuZ2UpOwogICAgICAgICAgY2FzZSAzNDoKICAgICAgICAgICAgZWRpdHMgPSBfY29udGV4dDQuc2VudDsKICAgICAgICAgICAgcmFuZ2VzLnNwbGljZShqLCAxKTsKICAgICAgICAgICAgcmFuZ2VzLnNwbGljZShpLCAxKTsKICAgICAgICAgICAgcmFuZ2VzLnB1c2gobWVyZ2VkUmFuZ2UpOwogICAgICAgICAgICByYXdFZGl0c0xpc3Quc3BsaWNlKGosIDEpOwogICAgICAgICAgICByYXdFZGl0c0xpc3Quc3BsaWNlKGksIDEpOwogICAgICAgICAgICByYXdFZGl0c0xpc3QucHVzaChlZGl0cyk7CiAgICAgICAgICAgIC8vIFJlc3RhcnQgc2Nhbm5pbmcKICAgICAgICAgICAgaSA9IDA7CiAgICAgICAgICAgIGogPSAwOwogICAgICAgICAgY2FzZSA0MzoKICAgICAgICAgICAgKytqOwogICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDI3OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgNDY6CiAgICAgICAgICAgICsraTsKICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyNTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDQ5OgogICAgICAgICAgICBfaTIgPSAwLCBfcmF3RWRpdHNMaXN0ID0gcmF3RWRpdHNMaXN0OwogICAgICAgICAgY2FzZSA1MDoKICAgICAgICAgICAgaWYgKCEoX2kyIDwgX3Jhd0VkaXRzTGlzdC5sZW5ndGgpKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA2MTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICByYXdFZGl0cyA9IF9yYXdFZGl0c0xpc3RbX2kyXTsKICAgICAgICAgICAgaWYgKCFjdHMudG9rZW4uaXNDYW5jZWxsYXRpb25SZXF1ZXN0ZWQpIHsKICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDU0OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCB0cnVlKTsKICAgICAgICAgIGNhc2UgNTQ6CiAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNTY7CiAgICAgICAgICAgIHJldHVybiB3b3JrZXJTZXJ2aWNlLmNvbXB1dGVNb3JlTWluaW1hbEVkaXRzKG1vZGVsLnVyaSwgcmF3RWRpdHMpOwogICAgICAgICAgY2FzZSA1NjoKICAgICAgICAgICAgbWluaW1hbEVkaXRzID0gX2NvbnRleHQ0LnNlbnQ7CiAgICAgICAgICAgIGlmIChtaW5pbWFsRWRpdHMpIHsKICAgICAgICAgICAgICBhbGxFZGl0cy5wdXNoLmFwcGx5KGFsbEVkaXRzLCBfdG9Db25zdW1hYmxlQXJyYXkobWluaW1hbEVkaXRzKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIGNhc2UgNTg6CiAgICAgICAgICAgIF9pMisrOwogICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDUwOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgNjE6CiAgICAgICAgICAgIF9jb250ZXh0NC5wcmV2ID0gNjE7CiAgICAgICAgICAgIGN0cy5kaXNwb3NlKCk7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuZmluaXNoKDYxKTsKICAgICAgICAgIGNhc2UgNjQ6CiAgICAgICAgICAgIGlmICghKGFsbEVkaXRzLmxlbmd0aCA9PT0gMCkpIHsKICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDY2OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCBmYWxzZSk7CiAgICAgICAgICBjYXNlIDY2OgogICAgICAgICAgICBpZiAoaXNDb2RlRWRpdG9yKGVkaXRvck9yTW9kZWwpKSB7CiAgICAgICAgICAgICAgLy8gdXNlIGVkaXRvciB0byBhcHBseSBlZGl0cwogICAgICAgICAgICAgIEZvcm1hdHRpbmdFZGl0LmV4ZWN1dGUoZWRpdG9yT3JNb2RlbCwgYWxsRWRpdHMsIHRydWUpOwogICAgICAgICAgICAgIGFsZXJ0Rm9ybWF0dGluZ0VkaXRzKGFsbEVkaXRzKTsKICAgICAgICAgICAgICBlZGl0b3JPck1vZGVsLnJldmVhbFBvc2l0aW9uSW5DZW50ZXJJZk91dHNpZGVWaWV3cG9ydChlZGl0b3JPck1vZGVsLmdldFBvc2l0aW9uKCksIDEgLyogU2Nyb2xsVHlwZS5JbW1lZGlhdGUgKi8pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIC8vIHVzZSBtb2RlbCB0byBhcHBseSBlZGl0cwogICAgICAgICAgICAgIF9yYW5nZTIgPSBhbGxFZGl0c1swXS5yYW5nZTsKICAgICAgICAgICAgICBpbml0aWFsU2VsZWN0aW9uID0gbmV3IFNlbGVjdGlvbihfcmFuZ2UyLnN0YXJ0TGluZU51bWJlciwgX3JhbmdlMi5zdGFydENvbHVtbiwgX3JhbmdlMi5lbmRMaW5lTnVtYmVyLCBfcmFuZ2UyLmVuZENvbHVtbik7CiAgICAgICAgICAgICAgbW9kZWwucHVzaEVkaXRPcGVyYXRpb25zKFtpbml0aWFsU2VsZWN0aW9uXSwgYWxsRWRpdHMubWFwKGZ1bmN0aW9uIChlZGl0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICB0ZXh0OiBlZGl0LnRleHQsCiAgICAgICAgICAgICAgICAgIHJhbmdlOiBSYW5nZS5saWZ0KGVkaXQucmFuZ2UpLAogICAgICAgICAgICAgICAgICBmb3JjZU1vdmVNYXJrZXJzOiB0cnVlCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIH0pLCBmdW5jdGlvbiAodW5kb0VkaXRzKSB7CiAgICAgICAgICAgICAgICB2YXIgX2l0ZXJhdG9yNiA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHVuZG9FZGl0cyksCiAgICAgICAgICAgICAgICAgIF9zdGVwNjsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgIGZvciAoX2l0ZXJhdG9yNi5zKCk7ICEoX3N0ZXA2ID0gX2l0ZXJhdG9yNi5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIF9yYW5nZTMgPSBfc3RlcDYudmFsdWUucmFuZ2U7CiAgICAgICAgICAgICAgICAgICAgaWYgKFJhbmdlLmFyZUludGVyc2VjdGluZ09yVG91Y2hpbmcoX3JhbmdlMywgaW5pdGlhbFNlbGVjdGlvbikpIHsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbbmV3IFNlbGVjdGlvbihfcmFuZ2UzLnN0YXJ0TGluZU51bWJlciwgX3JhbmdlMy5zdGFydENvbHVtbiwgX3JhbmdlMy5lbmRMaW5lTnVtYmVyLCBfcmFuZ2UzLmVuZENvbHVtbildOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgICAgIF9pdGVyYXRvcjYuZShlcnIpOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yNi5mKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIiwgdHJ1ZSk7CiAgICAgICAgICBjYXNlIDY4OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlNCwgbnVsbCwgW1sxMCwsIDYxLCA2NF1dKTsKICB9KSk7Cn0KZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdERvY3VtZW50V2l0aFNlbGVjdGVkUHJvdmlkZXIoYWNjZXNzb3IsIGVkaXRvck9yTW9kZWwsIG1vZGUsIHByb2dyZXNzLCB0b2tlbikgewogIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlNSgpIHsKICAgIHZhciBpbnN0YVNlcnZpY2UsIGxhbmd1YWdlRmVhdHVyZXNTZXJ2aWNlLCBtb2RlbCwgcHJvdmlkZXIsIHNlbGVjdGVkOwogICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgaW5zdGFTZXJ2aWNlID0gYWNjZXNzb3IuZ2V0KElJbnN0YW50aWF0aW9uU2VydmljZSk7CiAgICAgICAgICAgIGxhbmd1YWdlRmVhdHVyZXNTZXJ2aWNlID0gYWNjZXNzb3IuZ2V0KElMYW5ndWFnZUZlYXR1cmVzU2VydmljZSk7CiAgICAgICAgICAgIG1vZGVsID0gaXNDb2RlRWRpdG9yKGVkaXRvck9yTW9kZWwpID8gZWRpdG9yT3JNb2RlbC5nZXRNb2RlbCgpIDogZWRpdG9yT3JNb2RlbDsKICAgICAgICAgICAgcHJvdmlkZXIgPSBnZXRSZWFsQW5kU3ludGhldGljRG9jdW1lbnRGb3JtYXR0ZXJzT3JkZXJlZChsYW5ndWFnZUZlYXR1cmVzU2VydmljZS5kb2N1bWVudEZvcm1hdHRpbmdFZGl0UHJvdmlkZXIsIGxhbmd1YWdlRmVhdHVyZXNTZXJ2aWNlLmRvY3VtZW50UmFuZ2VGb3JtYXR0aW5nRWRpdFByb3ZpZGVyLCBtb2RlbCk7CiAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gNjsKICAgICAgICAgICAgcmV0dXJuIEZvcm1hdHRpbmdDb25mbGljdHMuc2VsZWN0KHByb3ZpZGVyLCBtb2RlbCwgbW9kZSk7CiAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgIHNlbGVjdGVkID0gX2NvbnRleHQ1LnNlbnQ7CiAgICAgICAgICAgIGlmICghc2VsZWN0ZWQpIHsKICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDExOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHByb2dyZXNzLnJlcG9ydChzZWxlY3RlZCk7CiAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMTE7CiAgICAgICAgICAgIHJldHVybiBpbnN0YVNlcnZpY2UuaW52b2tlRnVuY3Rpb24oZm9ybWF0RG9jdW1lbnRXaXRoUHJvdmlkZXIsIHNlbGVjdGVkLCBlZGl0b3JPck1vZGVsLCBtb2RlLCB0b2tlbik7CiAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlNSk7CiAgfSkpOwp9CmV4cG9ydCBmdW5jdGlvbiBmb3JtYXREb2N1bWVudFdpdGhQcm92aWRlcihhY2Nlc3NvciwgcHJvdmlkZXIsIGVkaXRvck9yTW9kZWwsIG1vZGUsIHRva2VuKSB7CiAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KCkgewogICAgdmFyIHdvcmtlclNlcnZpY2UsIG1vZGVsLCBjdHMsIGVkaXRzLCByYXdFZGl0cywgX2VkaXRzLCBfZWRpdHMyLCByYW5nZSwgaW5pdGlhbFNlbGVjdGlvbjsKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIHdvcmtlclNlcnZpY2UgPSBhY2Nlc3Nvci5nZXQoSUVkaXRvcldvcmtlclNlcnZpY2UpOwogICAgICAgICAgICBpZiAoaXNDb2RlRWRpdG9yKGVkaXRvck9yTW9kZWwpKSB7CiAgICAgICAgICAgICAgbW9kZWwgPSBlZGl0b3JPck1vZGVsLmdldE1vZGVsKCk7CiAgICAgICAgICAgICAgY3RzID0gbmV3IEVkaXRvclN0YXRlQ2FuY2VsbGF0aW9uVG9rZW5Tb3VyY2UoZWRpdG9yT3JNb2RlbCwgMSAvKiBDb2RlRWRpdG9yU3RhdGVGbGFnLlZhbHVlICovIHwgNCAvKiBDb2RlRWRpdG9yU3RhdGVGbGFnLlBvc2l0aW9uICovLCB1bmRlZmluZWQsIHRva2VuKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBtb2RlbCA9IGVkaXRvck9yTW9kZWw7CiAgICAgICAgICAgICAgY3RzID0gbmV3IFRleHRNb2RlbENhbmNlbGxhdGlvblRva2VuU291cmNlKGVkaXRvck9yTW9kZWwsIHRva2VuKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBfY29udGV4dDYucHJldiA9IDI7CiAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNTsKICAgICAgICAgICAgcmV0dXJuIHByb3ZpZGVyLnByb3ZpZGVEb2N1bWVudEZvcm1hdHRpbmdFZGl0cyhtb2RlbCwgbW9kZWwuZ2V0Rm9ybWF0dGluZ09wdGlvbnMoKSwgY3RzLnRva2VuKTsKICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgcmF3RWRpdHMgPSBfY29udGV4dDYuc2VudDsKICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA4OwogICAgICAgICAgICByZXR1cm4gd29ya2VyU2VydmljZS5jb21wdXRlTW9yZU1pbmltYWxFZGl0cyhtb2RlbC51cmksIHJhd0VkaXRzKTsKICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgZWRpdHMgPSBfY29udGV4dDYuc2VudDsKICAgICAgICAgICAgaWYgKCFjdHMudG9rZW4uaXNDYW5jZWxsYXRpb25SZXF1ZXN0ZWQpIHsKICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDExOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KCJyZXR1cm4iLCB0cnVlKTsKICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgIF9jb250ZXh0Ni5wcmV2ID0gMTE7CiAgICAgICAgICAgIGN0cy5kaXNwb3NlKCk7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuZmluaXNoKDExKTsKICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgIGlmICghKCFlZGl0cyB8fCBlZGl0cy5sZW5ndGggPT09IDApKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAxNjsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdCgicmV0dXJuIiwgZmFsc2UpOwogICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgaWYgKGlzQ29kZUVkaXRvcihlZGl0b3JPck1vZGVsKSkgewogICAgICAgICAgICAgIC8vIHVzZSBlZGl0b3IgdG8gYXBwbHkgZWRpdHMKICAgICAgICAgICAgICBGb3JtYXR0aW5nRWRpdC5leGVjdXRlKGVkaXRvck9yTW9kZWwsIGVkaXRzLCBtb2RlICE9PSAyIC8qIEZvcm1hdHRpbmdNb2RlLlNpbGVudCAqLyk7CiAgICAgICAgICAgICAgaWYgKG1vZGUgIT09IDIgLyogRm9ybWF0dGluZ01vZGUuU2lsZW50ICovKSB7CiAgICAgICAgICAgICAgICBhbGVydEZvcm1hdHRpbmdFZGl0cyhlZGl0cyk7CiAgICAgICAgICAgICAgICBlZGl0b3JPck1vZGVsLnJldmVhbFBvc2l0aW9uSW5DZW50ZXJJZk91dHNpZGVWaWV3cG9ydChlZGl0b3JPck1vZGVsLmdldFBvc2l0aW9uKCksIDEgLyogU2Nyb2xsVHlwZS5JbW1lZGlhdGUgKi8pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAvLyB1c2UgbW9kZWwgdG8gYXBwbHkgZWRpdHMKICAgICAgICAgICAgICBfZWRpdHMgPSBlZGl0cywgX2VkaXRzMiA9IF9zbGljZWRUb0FycmF5KF9lZGl0cywgMSksIHJhbmdlID0gX2VkaXRzMlswXS5yYW5nZTsKICAgICAgICAgICAgICBpbml0aWFsU2VsZWN0aW9uID0gbmV3IFNlbGVjdGlvbihyYW5nZS5zdGFydExpbmVOdW1iZXIsIHJhbmdlLnN0YXJ0Q29sdW1uLCByYW5nZS5lbmRMaW5lTnVtYmVyLCByYW5nZS5lbmRDb2x1bW4pOwogICAgICAgICAgICAgIG1vZGVsLnB1c2hFZGl0T3BlcmF0aW9ucyhbaW5pdGlhbFNlbGVjdGlvbl0sIGVkaXRzLm1hcChmdW5jdGlvbiAoZWRpdCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgdGV4dDogZWRpdC50ZXh0LAogICAgICAgICAgICAgICAgICByYW5nZTogUmFuZ2UubGlmdChlZGl0LnJhbmdlKSwKICAgICAgICAgICAgICAgICAgZm9yY2VNb3ZlTWFya2VyczogdHJ1ZQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICB9KSwgZnVuY3Rpb24gKHVuZG9FZGl0cykgewogICAgICAgICAgICAgICAgdmFyIF9pdGVyYXRvcjcgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih1bmRvRWRpdHMpLAogICAgICAgICAgICAgICAgICBfc3RlcDc7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICBmb3IgKF9pdGVyYXRvcjcucygpOyAhKF9zdGVwNyA9IF9pdGVyYXRvcjcubigpKS5kb25lOykgewogICAgICAgICAgICAgICAgICAgIHZhciBfcmFuZ2U1ID0gX3N0ZXA3LnZhbHVlLnJhbmdlOwogICAgICAgICAgICAgICAgICAgIGlmIChSYW5nZS5hcmVJbnRlcnNlY3RpbmdPclRvdWNoaW5nKF9yYW5nZTUsIGluaXRpYWxTZWxlY3Rpb24pKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW25ldyBTZWxlY3Rpb24oX3JhbmdlNS5zdGFydExpbmVOdW1iZXIsIF9yYW5nZTUuc3RhcnRDb2x1bW4sIF9yYW5nZTUuZW5kTGluZU51bWJlciwgX3JhbmdlNS5lbmRDb2x1bW4pXTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgICAgICBfaXRlcmF0b3I3LmUoZXJyKTsKICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgIF9pdGVyYXRvcjcuZigpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIsIHRydWUpOwogICAgICAgICAgY2FzZSAxODoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTYsIG51bGwsIFtbMiwsIDExLCAxNF1dKTsKICB9KSk7Cn0KZXhwb3J0IGZ1bmN0aW9uIGdldERvY3VtZW50UmFuZ2VGb3JtYXR0aW5nRWRpdHNVbnRpbFJlc3VsdCh3b3JrZXJTZXJ2aWNlLCBsYW5ndWFnZUZlYXR1cmVzU2VydmljZSwgbW9kZWwsIHJhbmdlLCBvcHRpb25zLCB0b2tlbikgewogIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlNygpIHsKICAgIHZhciBwcm92aWRlcnMsIF9pdGVyYXRvcjgsIF9zdGVwOCwgcHJvdmlkZXIsIHJhd0VkaXRzOwogICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ny5wcmV2ID0gX2NvbnRleHQ3Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgcHJvdmlkZXJzID0gbGFuZ3VhZ2VGZWF0dXJlc1NlcnZpY2UuZG9jdW1lbnRSYW5nZUZvcm1hdHRpbmdFZGl0UHJvdmlkZXIub3JkZXJlZChtb2RlbCk7CiAgICAgICAgICAgIF9pdGVyYXRvcjggPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihwcm92aWRlcnMpOwogICAgICAgICAgICBfY29udGV4dDcucHJldiA9IDI7CiAgICAgICAgICAgIF9pdGVyYXRvcjgucygpOwogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICBpZiAoKF9zdGVwOCA9IF9pdGVyYXRvcjgubigpKS5kb25lKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAxNTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBwcm92aWRlciA9IF9zdGVwOC52YWx1ZTsKICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSA4OwogICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHByb3ZpZGVyLnByb3ZpZGVEb2N1bWVudFJhbmdlRm9ybWF0dGluZ0VkaXRzKG1vZGVsLCByYW5nZSwgb3B0aW9ucywgdG9rZW4pKS5jYXRjaChvblVuZXhwZWN0ZWRFeHRlcm5hbEVycm9yKTsKICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgcmF3RWRpdHMgPSBfY29udGV4dDcuc2VudDsKICAgICAgICAgICAgaWYgKCFpc05vbkVtcHR5QXJyYXkocmF3RWRpdHMpKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAxMzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDEyOwogICAgICAgICAgICByZXR1cm4gd29ya2VyU2VydmljZS5jb21wdXRlTW9yZU1pbmltYWxFZGl0cyhtb2RlbC51cmksIHJhd0VkaXRzKTsKICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KCJyZXR1cm4iLCBfY29udGV4dDcuc2VudCk7CiAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDQ7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAyMDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICBfY29udGV4dDcucHJldiA9IDE3OwogICAgICAgICAgICBfY29udGV4dDcudDAgPSBfY29udGV4dDdbImNhdGNoIl0oMik7CiAgICAgICAgICAgIF9pdGVyYXRvcjguZShfY29udGV4dDcudDApOwogICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgX2NvbnRleHQ3LnByZXYgPSAyMDsKICAgICAgICAgICAgX2l0ZXJhdG9yOC5mKCk7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuZmluaXNoKDIwKTsKICAgICAgICAgIGNhc2UgMjM6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KCJyZXR1cm4iLCB1bmRlZmluZWQpOwogICAgICAgICAgY2FzZSAyNDoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTcsIG51bGwsIFtbMiwgMTcsIDIwLCAyM11dKTsKICB9KSk7Cn0KZXhwb3J0IGZ1bmN0aW9uIGdldERvY3VtZW50Rm9ybWF0dGluZ0VkaXRzVW50aWxSZXN1bHQod29ya2VyU2VydmljZSwgbGFuZ3VhZ2VGZWF0dXJlc1NlcnZpY2UsIG1vZGVsLCBvcHRpb25zLCB0b2tlbikgewogIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlOCgpIHsKICAgIHZhciBwcm92aWRlcnMsIF9pdGVyYXRvcjksIF9zdGVwOSwgcHJvdmlkZXIsIHJhd0VkaXRzOwogICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU4JChfY29udGV4dDgpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OC5wcmV2ID0gX2NvbnRleHQ4Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgcHJvdmlkZXJzID0gZ2V0UmVhbEFuZFN5bnRoZXRpY0RvY3VtZW50Rm9ybWF0dGVyc09yZGVyZWQobGFuZ3VhZ2VGZWF0dXJlc1NlcnZpY2UuZG9jdW1lbnRGb3JtYXR0aW5nRWRpdFByb3ZpZGVyLCBsYW5ndWFnZUZlYXR1cmVzU2VydmljZS5kb2N1bWVudFJhbmdlRm9ybWF0dGluZ0VkaXRQcm92aWRlciwgbW9kZWwpOwogICAgICAgICAgICBfaXRlcmF0b3I5ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIocHJvdmlkZXJzKTsKICAgICAgICAgICAgX2NvbnRleHQ4LnByZXYgPSAyOwogICAgICAgICAgICBfaXRlcmF0b3I5LnMoKTsKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgaWYgKChfc3RlcDkgPSBfaXRlcmF0b3I5Lm4oKSkuZG9uZSkgewogICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcHJvdmlkZXIgPSBfc3RlcDkudmFsdWU7CiAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gODsKICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShwcm92aWRlci5wcm92aWRlRG9jdW1lbnRGb3JtYXR0aW5nRWRpdHMobW9kZWwsIG9wdGlvbnMsIHRva2VuKSkuY2F0Y2gob25VbmV4cGVjdGVkRXh0ZXJuYWxFcnJvcik7CiAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgIHJhd0VkaXRzID0gX2NvbnRleHQ4LnNlbnQ7CiAgICAgICAgICAgIGlmICghaXNOb25FbXB0eUFycmF5KHJhd0VkaXRzKSkgewogICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAxMjsKICAgICAgICAgICAgcmV0dXJuIHdvcmtlclNlcnZpY2UuY29tcHV0ZU1vcmVNaW5pbWFsRWRpdHMobW9kZWwudXJpLCByYXdFZGl0cyk7CiAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LmFicnVwdCgicmV0dXJuIiwgX2NvbnRleHQ4LnNlbnQpOwogICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSA0OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMjA7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgX2NvbnRleHQ4LnByZXYgPSAxNzsKICAgICAgICAgICAgX2NvbnRleHQ4LnQwID0gX2NvbnRleHQ4WyJjYXRjaCJdKDIpOwogICAgICAgICAgICBfaXRlcmF0b3I5LmUoX2NvbnRleHQ4LnQwKTsKICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgIF9jb250ZXh0OC5wcmV2ID0gMjA7CiAgICAgICAgICAgIF9pdGVyYXRvcjkuZigpOwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LmZpbmlzaCgyMCk7CiAgICAgICAgICBjYXNlIDIzOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LmFicnVwdCgicmV0dXJuIiwgdW5kZWZpbmVkKTsKICAgICAgICAgIGNhc2UgMjQ6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWU4LCBudWxsLCBbWzIsIDE3LCAyMCwgMjNdXSk7CiAgfSkpOwp9CmV4cG9ydCBmdW5jdGlvbiBnZXRPblR5cGVGb3JtYXR0aW5nRWRpdHMod29ya2VyU2VydmljZSwgbGFuZ3VhZ2VGZWF0dXJlc1NlcnZpY2UsIG1vZGVsLCBwb3NpdGlvbiwgY2gsIG9wdGlvbnMsIHRva2VuKSB7CiAgdmFyIHByb3ZpZGVycyA9IGxhbmd1YWdlRmVhdHVyZXNTZXJ2aWNlLm9uVHlwZUZvcm1hdHRpbmdFZGl0UHJvdmlkZXIub3JkZXJlZChtb2RlbCk7CiAgaWYgKHByb3ZpZGVycy5sZW5ndGggPT09IDApIHsKICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodW5kZWZpbmVkKTsKICB9CiAgaWYgKHByb3ZpZGVyc1swXS5hdXRvRm9ybWF0VHJpZ2dlckNoYXJhY3RlcnMuaW5kZXhPZihjaCkgPCAwKSB7CiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHVuZGVmaW5lZCk7CiAgfQogIHJldHVybiBQcm9taXNlLnJlc29sdmUocHJvdmlkZXJzWzBdLnByb3ZpZGVPblR5cGVGb3JtYXR0aW5nRWRpdHMobW9kZWwsIHBvc2l0aW9uLCBjaCwgb3B0aW9ucywgdG9rZW4pKS5jYXRjaChvblVuZXhwZWN0ZWRFeHRlcm5hbEVycm9yKS50aGVuKGZ1bmN0aW9uIChlZGl0cykgewogICAgcmV0dXJuIHdvcmtlclNlcnZpY2UuY29tcHV0ZU1vcmVNaW5pbWFsRWRpdHMobW9kZWwudXJpLCBlZGl0cyk7CiAgfSk7Cn0KQ29tbWFuZHNSZWdpc3RyeS5yZWdpc3RlckNvbW1hbmQoJ19leGVjdXRlRm9ybWF0UmFuZ2VQcm92aWRlcicsIGZ1bmN0aW9uIChhY2Nlc3NvcikgewogIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHsKICAgIGFyZ3NbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldOwogIH0KICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTkoKSB7CiAgICB2YXIgcmVzb3VyY2UsIHJhbmdlLCBvcHRpb25zLCByZXNvbHZlclNlcnZpY2UsIHdvcmtlclNlcnZpY2UsIGxhbmd1YWdlRmVhdHVyZXNTZXJ2aWNlLCByZWZlcmVuY2U7CiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTkkKF9jb250ZXh0OSkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQ5LnByZXYgPSBfY29udGV4dDkubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICByZXNvdXJjZSA9IGFyZ3NbMF0sIHJhbmdlID0gYXJnc1sxXSwgb3B0aW9ucyA9IGFyZ3NbMl07CiAgICAgICAgICAgIGFzc2VydFR5cGUoVVJJLmlzVXJpKHJlc291cmNlKSk7CiAgICAgICAgICAgIGFzc2VydFR5cGUoUmFuZ2UuaXNJUmFuZ2UocmFuZ2UpKTsKICAgICAgICAgICAgcmVzb2x2ZXJTZXJ2aWNlID0gYWNjZXNzb3IuZ2V0KElUZXh0TW9kZWxTZXJ2aWNlKTsKICAgICAgICAgICAgd29ya2VyU2VydmljZSA9IGFjY2Vzc29yLmdldChJRWRpdG9yV29ya2VyU2VydmljZSk7CiAgICAgICAgICAgIGxhbmd1YWdlRmVhdHVyZXNTZXJ2aWNlID0gYWNjZXNzb3IuZ2V0KElMYW5ndWFnZUZlYXR1cmVzU2VydmljZSk7CiAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gODsKICAgICAgICAgICAgcmV0dXJuIHJlc29sdmVyU2VydmljZS5jcmVhdGVNb2RlbFJlZmVyZW5jZShyZXNvdXJjZSk7CiAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgIHJlZmVyZW5jZSA9IF9jb250ZXh0OS5zZW50OwogICAgICAgICAgICBfY29udGV4dDkucHJldiA9IDk7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuYWJydXB0KCJyZXR1cm4iLCBnZXREb2N1bWVudFJhbmdlRm9ybWF0dGluZ0VkaXRzVW50aWxSZXN1bHQod29ya2VyU2VydmljZSwgbGFuZ3VhZ2VGZWF0dXJlc1NlcnZpY2UsIHJlZmVyZW5jZS5vYmplY3QudGV4dEVkaXRvck1vZGVsLCBSYW5nZS5saWZ0KHJhbmdlKSwgb3B0aW9ucywgQ2FuY2VsbGF0aW9uVG9rZW4uTm9uZSkpOwogICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgX2NvbnRleHQ5LnByZXYgPSAxMTsKICAgICAgICAgICAgcmVmZXJlbmNlLmRpc3Bvc2UoKTsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5maW5pc2goMTEpOwogICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTksIG51bGwsIFtbOSwsIDExLCAxNF1dKTsKICB9KSk7Cn0pOwpDb21tYW5kc1JlZ2lzdHJ5LnJlZ2lzdGVyQ29tbWFuZCgnX2V4ZWN1dGVGb3JtYXREb2N1bWVudFByb3ZpZGVyJywgZnVuY3Rpb24gKGFjY2Vzc29yKSB7CiAgZm9yICh2YXIgX2xlbjIgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4yID4gMSA/IF9sZW4yIC0gMSA6IDApLCBfa2V5MiA9IDE7IF9rZXkyIDwgX2xlbjI7IF9rZXkyKyspIHsKICAgIGFyZ3NbX2tleTIgLSAxXSA9IGFyZ3VtZW50c1tfa2V5Ml07CiAgfQogIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMTAoKSB7CiAgICB2YXIgcmVzb3VyY2UsIG9wdGlvbnMsIHJlc29sdmVyU2VydmljZSwgd29ya2VyU2VydmljZSwgbGFuZ3VhZ2VGZWF0dXJlc1NlcnZpY2UsIHJlZmVyZW5jZTsKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlMTAkKF9jb250ZXh0MTApIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTAucHJldiA9IF9jb250ZXh0MTAubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICByZXNvdXJjZSA9IGFyZ3NbMF0sIG9wdGlvbnMgPSBhcmdzWzFdOwogICAgICAgICAgICBhc3NlcnRUeXBlKFVSSS5pc1VyaShyZXNvdXJjZSkpOwogICAgICAgICAgICByZXNvbHZlclNlcnZpY2UgPSBhY2Nlc3Nvci5nZXQoSVRleHRNb2RlbFNlcnZpY2UpOwogICAgICAgICAgICB3b3JrZXJTZXJ2aWNlID0gYWNjZXNzb3IuZ2V0KElFZGl0b3JXb3JrZXJTZXJ2aWNlKTsKICAgICAgICAgICAgbGFuZ3VhZ2VGZWF0dXJlc1NlcnZpY2UgPSBhY2Nlc3Nvci5nZXQoSUxhbmd1YWdlRmVhdHVyZXNTZXJ2aWNlKTsKICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gNzsKICAgICAgICAgICAgcmV0dXJuIHJlc29sdmVyU2VydmljZS5jcmVhdGVNb2RlbFJlZmVyZW5jZShyZXNvdXJjZSk7CiAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgIHJlZmVyZW5jZSA9IF9jb250ZXh0MTAuc2VudDsKICAgICAgICAgICAgX2NvbnRleHQxMC5wcmV2ID0gODsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTAuYWJydXB0KCJyZXR1cm4iLCBnZXREb2N1bWVudEZvcm1hdHRpbmdFZGl0c1VudGlsUmVzdWx0KHdvcmtlclNlcnZpY2UsIGxhbmd1YWdlRmVhdHVyZXNTZXJ2aWNlLCByZWZlcmVuY2Uub2JqZWN0LnRleHRFZGl0b3JNb2RlbCwgb3B0aW9ucywgQ2FuY2VsbGF0aW9uVG9rZW4uTm9uZSkpOwogICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgX2NvbnRleHQxMC5wcmV2ID0gMTA7CiAgICAgICAgICAgIHJlZmVyZW5jZS5kaXNwb3NlKCk7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLmZpbmlzaCgxMCk7CiAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTAuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTEwLCBudWxsLCBbWzgsLCAxMCwgMTNdXSk7CiAgfSkpOwp9KTsKQ29tbWFuZHNSZWdpc3RyeS5yZWdpc3RlckNvbW1hbmQoJ19leGVjdXRlRm9ybWF0T25UeXBlUHJvdmlkZXInLCBmdW5jdGlvbiAoYWNjZXNzb3IpIHsKICBmb3IgKHZhciBfbGVuMyA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbjMgPiAxID8gX2xlbjMgLSAxIDogMCksIF9rZXkzID0gMTsgX2tleTMgPCBfbGVuMzsgX2tleTMrKykgewogICAgYXJnc1tfa2V5MyAtIDFdID0gYXJndW1lbnRzW19rZXkzXTsKICB9CiAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMSgpIHsKICAgIHZhciByZXNvdXJjZSwgcG9zaXRpb24sIGNoLCBvcHRpb25zLCByZXNvbHZlclNlcnZpY2UsIHdvcmtlclNlcnZpY2UsIGxhbmd1YWdlRmVhdHVyZXNTZXJ2aWNlLCByZWZlcmVuY2U7CiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTExJChfY29udGV4dDExKSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDExLnByZXYgPSBfY29udGV4dDExLm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgcmVzb3VyY2UgPSBhcmdzWzBdLCBwb3NpdGlvbiA9IGFyZ3NbMV0sIGNoID0gYXJnc1syXSwgb3B0aW9ucyA9IGFyZ3NbM107CiAgICAgICAgICAgIGFzc2VydFR5cGUoVVJJLmlzVXJpKHJlc291cmNlKSk7CiAgICAgICAgICAgIGFzc2VydFR5cGUoUG9zaXRpb24uaXNJUG9zaXRpb24ocG9zaXRpb24pKTsKICAgICAgICAgICAgYXNzZXJ0VHlwZSh0eXBlb2YgY2ggPT09ICdzdHJpbmcnKTsKICAgICAgICAgICAgcmVzb2x2ZXJTZXJ2aWNlID0gYWNjZXNzb3IuZ2V0KElUZXh0TW9kZWxTZXJ2aWNlKTsKICAgICAgICAgICAgd29ya2VyU2VydmljZSA9IGFjY2Vzc29yLmdldChJRWRpdG9yV29ya2VyU2VydmljZSk7CiAgICAgICAgICAgIGxhbmd1YWdlRmVhdHVyZXNTZXJ2aWNlID0gYWNjZXNzb3IuZ2V0KElMYW5ndWFnZUZlYXR1cmVzU2VydmljZSk7CiAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDk7CiAgICAgICAgICAgIHJldHVybiByZXNvbHZlclNlcnZpY2UuY3JlYXRlTW9kZWxSZWZlcmVuY2UocmVzb3VyY2UpOwogICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICByZWZlcmVuY2UgPSBfY29udGV4dDExLnNlbnQ7CiAgICAgICAgICAgIF9jb250ZXh0MTEucHJldiA9IDEwOwogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5hYnJ1cHQoInJldHVybiIsIGdldE9uVHlwZUZvcm1hdHRpbmdFZGl0cyh3b3JrZXJTZXJ2aWNlLCBsYW5ndWFnZUZlYXR1cmVzU2VydmljZSwgcmVmZXJlbmNlLm9iamVjdC50ZXh0RWRpdG9yTW9kZWwsIFBvc2l0aW9uLmxpZnQocG9zaXRpb24pLCBjaCwgb3B0aW9ucywgQ2FuY2VsbGF0aW9uVG9rZW4uTm9uZSkpOwogICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgX2NvbnRleHQxMS5wcmV2ID0gMTI7CiAgICAgICAgICAgIHJlZmVyZW5jZS5kaXNwb3NlKCk7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLmZpbmlzaCgxMik7CiAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTExLCBudWxsLCBbWzEwLCwgMTIsIDE1XV0pOwogIH0pKTsKfSk7"},{"version":3,"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","alert","asArray","isNonEmptyArray","CancellationToken","onUnexpectedExternalError","Iterable","LinkedList","assertType","URI","EditorStateCancellationTokenSource","TextModelCancellationTokenSource","isCodeEditor","Position","Range","Selection","IEditorWorkerService","ITextModelService","FormattingEdit","nls","CommandsRegistry","ExtensionIdentifier","IInstantiationService","ILanguageFeaturesService","alertFormattingEdits","edits","filter","edit","range","length","i","plusRange","startLineNumber","endLineNumber","localize","getRealAndSyntheticDocumentFormattersOrdered","documentFormattingEditProvider","documentRangeFormattingEditProvider","model","seen","Set","docFormatter","ordered","formatter","push","extensionId","add","toKey","rangeFormatter","has","displayName","provideDocumentFormattingEdits","options","token","provideDocumentRangeFormattingEdits","getFullModelRange","FormattingConflicts","selector","remove","_selectors","unshift","dispose","document","mode","undefined","first","formatDocumentRangesWithSelectedProvider","accessor","editorOrModel","rangeOrRanges","progress","instaService","get","documentRangeFormattingEditProviderRegistry","getModel","provider","select","selected","report","invokeFunction","formatDocumentRangesWithProvider","workerService","cts","ranges","len","sort","compareRangesUsingStarts","areIntersectingOrTouching","fromPositions","getStartPosition","getEndPosition","computeEdits","getFormattingOptions","hasIntersectingEdit","a","b","mergedA","reduce","acc","val","some","x","intersectRanges","otherEdit","allEdits","rawEditsList","isCancellationRequested","j","mergedRange","splice","rawEdits","computeMoreMinimalEdits","uri","minimalEdits","execute","revealPositionInCenterIfOutsideViewport","getPosition","initialSelection","startColumn","endColumn","pushEditOperations","map","text","lift","forceMoveMarkers","undoEdits","formatDocumentWithSelectedProvider","languageFeaturesService","formatDocumentWithProvider","getDocumentRangeFormattingEditsUntilResult","providers","catch","getDocumentFormattingEditsUntilResult","getOnTypeFormattingEdits","position","ch","onTypeFormattingEditProvider","autoFormatTriggerCharacters","indexOf","provideOnTypeFormattingEdits","registerCommand","args","resource","isUri","isIRange","resolverService","createModelReference","reference","object","textEditorModel","None","isIPosition"],"sources":["/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/format.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { asArray, isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource, TextModelCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { isCodeEditor } from '../../../browser/editorBrowser.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { FormattingEdit } from './formattingEdit.js';\nimport * as nls from '../../../../nls.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ExtensionIdentifier } from '../../../../platform/extensions/common/extensions.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport function alertFormattingEdits(edits) {\n    edits = edits.filter(edit => edit.range);\n    if (!edits.length) {\n        return;\n    }\n    let { range } = edits[0];\n    for (let i = 1; i < edits.length; i++) {\n        range = Range.plusRange(range, edits[i].range);\n    }\n    const { startLineNumber, endLineNumber } = range;\n    if (startLineNumber === endLineNumber) {\n        if (edits.length === 1) {\n            alert(nls.localize('hint11', \"Made 1 formatting edit on line {0}\", startLineNumber));\n        }\n        else {\n            alert(nls.localize('hintn1', \"Made {0} formatting edits on line {1}\", edits.length, startLineNumber));\n        }\n    }\n    else {\n        if (edits.length === 1) {\n            alert(nls.localize('hint1n', \"Made 1 formatting edit between lines {0} and {1}\", startLineNumber, endLineNumber));\n        }\n        else {\n            alert(nls.localize('hintnn', \"Made {0} formatting edits between lines {1} and {2}\", edits.length, startLineNumber, endLineNumber));\n        }\n    }\n}\nexport function getRealAndSyntheticDocumentFormattersOrdered(documentFormattingEditProvider, documentRangeFormattingEditProvider, model) {\n    const result = [];\n    const seen = new Set();\n    // (1) add all document formatter\n    const docFormatter = documentFormattingEditProvider.ordered(model);\n    for (const formatter of docFormatter) {\n        result.push(formatter);\n        if (formatter.extensionId) {\n            seen.add(ExtensionIdentifier.toKey(formatter.extensionId));\n        }\n    }\n    // (2) add all range formatter as document formatter (unless the same extension already did that)\n    const rangeFormatter = documentRangeFormattingEditProvider.ordered(model);\n    for (const formatter of rangeFormatter) {\n        if (formatter.extensionId) {\n            if (seen.has(ExtensionIdentifier.toKey(formatter.extensionId))) {\n                continue;\n            }\n            seen.add(ExtensionIdentifier.toKey(formatter.extensionId));\n        }\n        result.push({\n            displayName: formatter.displayName,\n            extensionId: formatter.extensionId,\n            provideDocumentFormattingEdits(model, options, token) {\n                return formatter.provideDocumentRangeFormattingEdits(model, model.getFullModelRange(), options, token);\n            }\n        });\n    }\n    return result;\n}\nexport class FormattingConflicts {\n    static setFormatterSelector(selector) {\n        const remove = FormattingConflicts._selectors.unshift(selector);\n        return { dispose: remove };\n    }\n    static select(formatter, document, mode) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (formatter.length === 0) {\n                return undefined;\n            }\n            const selector = Iterable.first(FormattingConflicts._selectors);\n            if (selector) {\n                return yield selector(formatter, document, mode);\n            }\n            return undefined;\n        });\n    }\n}\nFormattingConflicts._selectors = new LinkedList();\nexport function formatDocumentRangesWithSelectedProvider(accessor, editorOrModel, rangeOrRanges, mode, progress, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const instaService = accessor.get(IInstantiationService);\n        const { documentRangeFormattingEditProvider: documentRangeFormattingEditProviderRegistry } = accessor.get(ILanguageFeaturesService);\n        const model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\n        const provider = documentRangeFormattingEditProviderRegistry.ordered(model);\n        const selected = yield FormattingConflicts.select(provider, model, mode);\n        if (selected) {\n            progress.report(selected);\n            yield instaService.invokeFunction(formatDocumentRangesWithProvider, selected, editorOrModel, rangeOrRanges, token);\n        }\n    });\n}\nexport function formatDocumentRangesWithProvider(accessor, provider, editorOrModel, rangeOrRanges, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const workerService = accessor.get(IEditorWorkerService);\n        let model;\n        let cts;\n        if (isCodeEditor(editorOrModel)) {\n            model = editorOrModel.getModel();\n            cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */, undefined, token);\n        }\n        else {\n            model = editorOrModel;\n            cts = new TextModelCancellationTokenSource(editorOrModel, token);\n        }\n        // make sure that ranges don't overlap nor touch each other\n        const ranges = [];\n        let len = 0;\n        for (const range of asArray(rangeOrRanges).sort(Range.compareRangesUsingStarts)) {\n            if (len > 0 && Range.areIntersectingOrTouching(ranges[len - 1], range)) {\n                ranges[len - 1] = Range.fromPositions(ranges[len - 1].getStartPosition(), range.getEndPosition());\n            }\n            else {\n                len = ranges.push(range);\n            }\n        }\n        const computeEdits = (range) => __awaiter(this, void 0, void 0, function* () {\n            return (yield provider.provideDocumentRangeFormattingEdits(model, range, model.getFormattingOptions(), cts.token)) || [];\n        });\n        const hasIntersectingEdit = (a, b) => {\n            if (!a.length || !b.length) {\n                return false;\n            }\n            // quick exit if the list of ranges are completely unrelated [O(n)]\n            const mergedA = a.reduce((acc, val) => { return Range.plusRange(acc, val.range); }, a[0].range);\n            if (!b.some(x => { return Range.intersectRanges(mergedA, x.range); })) {\n                return false;\n            }\n            // fallback to a complete check [O(n^2)]\n            for (const edit of a) {\n                for (const otherEdit of b) {\n                    if (Range.intersectRanges(edit.range, otherEdit.range)) {\n                        return true;\n                    }\n                }\n            }\n            return false;\n        };\n        const allEdits = [];\n        const rawEditsList = [];\n        try {\n            for (const range of ranges) {\n                if (cts.token.isCancellationRequested) {\n                    return true;\n                }\n                rawEditsList.push(yield computeEdits(range));\n            }\n            for (let i = 0; i < ranges.length; ++i) {\n                for (let j = i + 1; j < ranges.length; ++j) {\n                    if (cts.token.isCancellationRequested) {\n                        return true;\n                    }\n                    if (hasIntersectingEdit(rawEditsList[i], rawEditsList[j])) {\n                        // Merge ranges i and j into a single range, recompute the associated edits\n                        const mergedRange = Range.plusRange(ranges[i], ranges[j]);\n                        const edits = yield computeEdits(mergedRange);\n                        ranges.splice(j, 1);\n                        ranges.splice(i, 1);\n                        ranges.push(mergedRange);\n                        rawEditsList.splice(j, 1);\n                        rawEditsList.splice(i, 1);\n                        rawEditsList.push(edits);\n                        // Restart scanning\n                        i = 0;\n                        j = 0;\n                    }\n                }\n            }\n            for (const rawEdits of rawEditsList) {\n                if (cts.token.isCancellationRequested) {\n                    return true;\n                }\n                const minimalEdits = yield workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n                if (minimalEdits) {\n                    allEdits.push(...minimalEdits);\n                }\n            }\n        }\n        finally {\n            cts.dispose();\n        }\n        if (allEdits.length === 0) {\n            return false;\n        }\n        if (isCodeEditor(editorOrModel)) {\n            // use editor to apply edits\n            FormattingEdit.execute(editorOrModel, allEdits, true);\n            alertFormattingEdits(allEdits);\n            editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* ScrollType.Immediate */);\n        }\n        else {\n            // use model to apply edits\n            const [{ range }] = allEdits;\n            const initialSelection = new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\n            model.pushEditOperations([initialSelection], allEdits.map(edit => {\n                return {\n                    text: edit.text,\n                    range: Range.lift(edit.range),\n                    forceMoveMarkers: true\n                };\n            }), undoEdits => {\n                for (const { range } of undoEdits) {\n                    if (Range.areIntersectingOrTouching(range, initialSelection)) {\n                        return [new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn)];\n                    }\n                }\n                return null;\n            });\n        }\n        return true;\n    });\n}\nexport function formatDocumentWithSelectedProvider(accessor, editorOrModel, mode, progress, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const instaService = accessor.get(IInstantiationService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\n        const provider = getRealAndSyntheticDocumentFormattersOrdered(languageFeaturesService.documentFormattingEditProvider, languageFeaturesService.documentRangeFormattingEditProvider, model);\n        const selected = yield FormattingConflicts.select(provider, model, mode);\n        if (selected) {\n            progress.report(selected);\n            yield instaService.invokeFunction(formatDocumentWithProvider, selected, editorOrModel, mode, token);\n        }\n    });\n}\nexport function formatDocumentWithProvider(accessor, provider, editorOrModel, mode, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const workerService = accessor.get(IEditorWorkerService);\n        let model;\n        let cts;\n        if (isCodeEditor(editorOrModel)) {\n            model = editorOrModel.getModel();\n            cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */, undefined, token);\n        }\n        else {\n            model = editorOrModel;\n            cts = new TextModelCancellationTokenSource(editorOrModel, token);\n        }\n        let edits;\n        try {\n            const rawEdits = yield provider.provideDocumentFormattingEdits(model, model.getFormattingOptions(), cts.token);\n            edits = yield workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n            if (cts.token.isCancellationRequested) {\n                return true;\n            }\n        }\n        finally {\n            cts.dispose();\n        }\n        if (!edits || edits.length === 0) {\n            return false;\n        }\n        if (isCodeEditor(editorOrModel)) {\n            // use editor to apply edits\n            FormattingEdit.execute(editorOrModel, edits, mode !== 2 /* FormattingMode.Silent */);\n            if (mode !== 2 /* FormattingMode.Silent */) {\n                alertFormattingEdits(edits);\n                editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* ScrollType.Immediate */);\n            }\n        }\n        else {\n            // use model to apply edits\n            const [{ range }] = edits;\n            const initialSelection = new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\n            model.pushEditOperations([initialSelection], edits.map(edit => {\n                return {\n                    text: edit.text,\n                    range: Range.lift(edit.range),\n                    forceMoveMarkers: true\n                };\n            }), undoEdits => {\n                for (const { range } of undoEdits) {\n                    if (Range.areIntersectingOrTouching(range, initialSelection)) {\n                        return [new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn)];\n                    }\n                }\n                return null;\n            });\n        }\n        return true;\n    });\n}\nexport function getDocumentRangeFormattingEditsUntilResult(workerService, languageFeaturesService, model, range, options, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const providers = languageFeaturesService.documentRangeFormattingEditProvider.ordered(model);\n        for (const provider of providers) {\n            const rawEdits = yield Promise.resolve(provider.provideDocumentRangeFormattingEdits(model, range, options, token)).catch(onUnexpectedExternalError);\n            if (isNonEmptyArray(rawEdits)) {\n                return yield workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n            }\n        }\n        return undefined;\n    });\n}\nexport function getDocumentFormattingEditsUntilResult(workerService, languageFeaturesService, model, options, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const providers = getRealAndSyntheticDocumentFormattersOrdered(languageFeaturesService.documentFormattingEditProvider, languageFeaturesService.documentRangeFormattingEditProvider, model);\n        for (const provider of providers) {\n            const rawEdits = yield Promise.resolve(provider.provideDocumentFormattingEdits(model, options, token)).catch(onUnexpectedExternalError);\n            if (isNonEmptyArray(rawEdits)) {\n                return yield workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n            }\n        }\n        return undefined;\n    });\n}\nexport function getOnTypeFormattingEdits(workerService, languageFeaturesService, model, position, ch, options, token) {\n    const providers = languageFeaturesService.onTypeFormattingEditProvider.ordered(model);\n    if (providers.length === 0) {\n        return Promise.resolve(undefined);\n    }\n    if (providers[0].autoFormatTriggerCharacters.indexOf(ch) < 0) {\n        return Promise.resolve(undefined);\n    }\n    return Promise.resolve(providers[0].provideOnTypeFormattingEdits(model, position, ch, options, token)).catch(onUnexpectedExternalError).then(edits => {\n        return workerService.computeMoreMinimalEdits(model.uri, edits);\n    });\n}\nCommandsRegistry.registerCommand('_executeFormatRangeProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource, range, options] = args;\n        assertType(URI.isUri(resource));\n        assertType(Range.isIRange(range));\n        const resolverService = accessor.get(ITextModelService);\n        const workerService = accessor.get(IEditorWorkerService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const reference = yield resolverService.createModelReference(resource);\n        try {\n            return getDocumentRangeFormattingEditsUntilResult(workerService, languageFeaturesService, reference.object.textEditorModel, Range.lift(range), options, CancellationToken.None);\n        }\n        finally {\n            reference.dispose();\n        }\n    });\n});\nCommandsRegistry.registerCommand('_executeFormatDocumentProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource, options] = args;\n        assertType(URI.isUri(resource));\n        const resolverService = accessor.get(ITextModelService);\n        const workerService = accessor.get(IEditorWorkerService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const reference = yield resolverService.createModelReference(resource);\n        try {\n            return getDocumentFormattingEditsUntilResult(workerService, languageFeaturesService, reference.object.textEditorModel, options, CancellationToken.None);\n        }\n        finally {\n            reference.dispose();\n        }\n    });\n});\nCommandsRegistry.registerCommand('_executeFormatOnTypeProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource, position, ch, options] = args;\n        assertType(URI.isUri(resource));\n        assertType(Position.isIPosition(position));\n        assertType(typeof ch === 'string');\n        const resolverService = accessor.get(ITextModelService);\n        const workerService = accessor.get(IEditorWorkerService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const reference = yield resolverService.createModelReference(resource);\n        try {\n            return getOnTypeFormattingEdits(workerService, languageFeaturesService, reference.object.textEditorModel, Position.lift(position), ch, options, CancellationToken.None);\n        }\n        finally {\n            reference.dispose();\n        }\n    });\n});\n"],"mappings":"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"}]}