{"remainingRequest":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/thread-loader/dist/cjs.js!/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js!/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/base/browser/ui/list/listView.js","dependencies":[{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/base/browser/ui/list/listView.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/babel.config.js","mtime":1668271197000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlci5qcyI7CmltcG9ydCBfdG9Db25zdW1hYmxlQXJyYXkgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheS5qcyI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjay5qcyI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcy5qcyI7CmltcG9ydCBfdHlwZW9mIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdHlwZW9mLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWZsZWN0LnRvLXN0cmluZy10YWcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmVycm9yLmNhdXNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc29ydC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm51bWJlci5jb25zdHJ1Y3Rvci5qcyI7Ci8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAqICBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uCiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwp2YXIgX19kZWNvcmF0ZSA9IHRoaXMgJiYgdGhpcy5fX2RlY29yYXRlIHx8IGZ1bmN0aW9uIChkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykgewogIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwKICAgIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLAogICAgZDsKICBpZiAoKHR5cGVvZiBSZWZsZWN0ID09PSAidW5kZWZpbmVkIiA/ICJ1bmRlZmluZWQiIDogX3R5cGVvZihSZWZsZWN0KSkgPT09ICJvYmplY3QiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSAiZnVuY3Rpb24iKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7ZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjsKICB9CiAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjsKfTsKaW1wb3J0IHsgaXNGaXJlZm94IH0gZnJvbSAnLi4vLi4vYnJvd3Nlci5qcyc7CmltcG9ydCB7IERhdGFUcmFuc2ZlcnMsIFN0YXRpY0RORCB9IGZyb20gJy4uLy4uL2RuZC5qcyc7CmltcG9ydCB7ICQsIGFkZERpc3Bvc2FibGVMaXN0ZW5lciwgYW5pbWF0ZSwgZ2V0Q29udGVudEhlaWdodCwgZ2V0Q29udGVudFdpZHRoLCBnZXRUb3BMZWZ0T2Zmc2V0LCBzY2hlZHVsZUF0TmV4dEFuaW1hdGlvbkZyYW1lIGFzIF9zY2hlZHVsZUF0TmV4dEFuaW1hdGlvbkZyYW1lIH0gZnJvbSAnLi4vLi4vZG9tLmpzJzsKaW1wb3J0IHsgRG9tRW1pdHRlciB9IGZyb20gJy4uLy4uL2V2ZW50LmpzJzsKaW1wb3J0IHsgRXZlbnRUeXBlIGFzIFRvdWNoRXZlbnRUeXBlLCBHZXN0dXJlIH0gZnJvbSAnLi4vLi4vdG91Y2guanMnOwppbXBvcnQgeyBTbW9vdGhTY3JvbGxhYmxlRWxlbWVudCB9IGZyb20gJy4uL3Njcm9sbGJhci9zY3JvbGxhYmxlRWxlbWVudC5qcyc7CmltcG9ydCB7IGRpc3RpbmN0LCBlcXVhbHMgfSBmcm9tICcuLi8uLi8uLi9jb21tb24vYXJyYXlzLmpzJzsKaW1wb3J0IHsgRGVsYXllciwgZGlzcG9zYWJsZVRpbWVvdXQgfSBmcm9tICcuLi8uLi8uLi9jb21tb24vYXN5bmMuanMnOwppbXBvcnQgeyBtZW1vaXplIH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL2RlY29yYXRvcnMuanMnOwppbXBvcnQgeyBFbWl0dGVyLCBFdmVudCB9IGZyb20gJy4uLy4uLy4uL2NvbW1vbi9ldmVudC5qcyc7CmltcG9ydCB7IERpc3Bvc2FibGUsIERpc3Bvc2FibGVTdG9yZSwgZGlzcG9zZSBhcyBfZGlzcG9zZSwgdG9EaXNwb3NhYmxlIH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL2xpZmVjeWNsZS5qcyc7CmltcG9ydCB7IFJhbmdlIH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL3JhbmdlLmpzJzsKaW1wb3J0IHsgU2Nyb2xsYWJsZSB9IGZyb20gJy4uLy4uLy4uL2NvbW1vbi9zY3JvbGxhYmxlLmpzJzsKaW1wb3J0IHsgUmFuZ2VNYXAsIHNoaWZ0IH0gZnJvbSAnLi9yYW5nZU1hcC5qcyc7CmltcG9ydCB7IFJvd0NhY2hlIH0gZnJvbSAnLi9yb3dDYWNoZS5qcyc7CnZhciBEZWZhdWx0T3B0aW9ucyA9IHsKICB1c2VTaGFkb3dzOiB0cnVlLAogIHZlcnRpY2FsU2Nyb2xsTW9kZTogMSAvKiBTY3JvbGxiYXJWaXNpYmlsaXR5LkF1dG8gKi8sCiAgc2V0Um93TGluZUhlaWdodDogdHJ1ZSwKICBzZXRSb3dIZWlnaHQ6IHRydWUsCiAgc3VwcG9ydER5bmFtaWNIZWlnaHRzOiBmYWxzZSwKICBkbmQ6IHsKICAgIGdldERyYWdFbGVtZW50czogZnVuY3Rpb24gZ2V0RHJhZ0VsZW1lbnRzKGUpIHsKICAgICAgcmV0dXJuIFtlXTsKICAgIH0sCiAgICBnZXREcmFnVVJJOiBmdW5jdGlvbiBnZXREcmFnVVJJKCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0sCiAgICBvbkRyYWdTdGFydDogZnVuY3Rpb24gb25EcmFnU3RhcnQoKSB7fSwKICAgIG9uRHJhZ092ZXI6IGZ1bmN0aW9uIG9uRHJhZ092ZXIoKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCiAgICBkcm9wOiBmdW5jdGlvbiBkcm9wKCkge30KICB9LAogIGhvcml6b250YWxTY3JvbGxpbmc6IGZhbHNlLAogIHRyYW5zZm9ybU9wdGltaXphdGlvbjogdHJ1ZSwKICBhbHdheXNDb25zdW1lTW91c2VXaGVlbDogdHJ1ZQp9OwpleHBvcnQgdmFyIEVsZW1lbnRzRHJhZ0FuZERyb3BEYXRhID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBFbGVtZW50c0RyYWdBbmREcm9wRGF0YShlbGVtZW50cykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEVsZW1lbnRzRHJhZ0FuZERyb3BEYXRhKTsKICAgIHRoaXMuZWxlbWVudHMgPSBlbGVtZW50czsKICB9CiAgX2NyZWF0ZUNsYXNzKEVsZW1lbnRzRHJhZ0FuZERyb3BEYXRhLCBbewogICAga2V5OiAidXBkYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGUoKSB7fQogIH0sIHsKICAgIGtleTogImdldERhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldERhdGEoKSB7CiAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRzOwogICAgfQogIH1dKTsKICByZXR1cm4gRWxlbWVudHNEcmFnQW5kRHJvcERhdGE7Cn0oKTsKZXhwb3J0IHZhciBFeHRlcm5hbEVsZW1lbnRzRHJhZ0FuZERyb3BEYXRhID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBFeHRlcm5hbEVsZW1lbnRzRHJhZ0FuZERyb3BEYXRhKGVsZW1lbnRzKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRXh0ZXJuYWxFbGVtZW50c0RyYWdBbmREcm9wRGF0YSk7CiAgICB0aGlzLmVsZW1lbnRzID0gZWxlbWVudHM7CiAgfQogIF9jcmVhdGVDbGFzcyhFeHRlcm5hbEVsZW1lbnRzRHJhZ0FuZERyb3BEYXRhLCBbewogICAga2V5OiAidXBkYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGUoKSB7fQogIH0sIHsKICAgIGtleTogImdldERhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldERhdGEoKSB7CiAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRzOwogICAgfQogIH1dKTsKICByZXR1cm4gRXh0ZXJuYWxFbGVtZW50c0RyYWdBbmREcm9wRGF0YTsKfSgpOwpleHBvcnQgdmFyIE5hdGl2ZURyYWdBbmREcm9wRGF0YSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gTmF0aXZlRHJhZ0FuZERyb3BEYXRhKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE5hdGl2ZURyYWdBbmREcm9wRGF0YSk7CiAgICB0aGlzLnR5cGVzID0gW107CiAgICB0aGlzLmZpbGVzID0gW107CiAgfQogIF9jcmVhdGVDbGFzcyhOYXRpdmVEcmFnQW5kRHJvcERhdGEsIFt7CiAgICBrZXk6ICJ1cGRhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZShkYXRhVHJhbnNmZXIpIHsKICAgICAgaWYgKGRhdGFUcmFuc2Zlci50eXBlcykgewogICAgICAgIHZhciBfdGhpcyR0eXBlczsKICAgICAgICAoX3RoaXMkdHlwZXMgPSB0aGlzLnR5cGVzKS5zcGxpY2UuYXBwbHkoX3RoaXMkdHlwZXMsIFswLCB0aGlzLnR5cGVzLmxlbmd0aF0uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShkYXRhVHJhbnNmZXIudHlwZXMpKSk7CiAgICAgIH0KICAgICAgaWYgKGRhdGFUcmFuc2Zlci5maWxlcykgewogICAgICAgIHRoaXMuZmlsZXMuc3BsaWNlKDAsIHRoaXMuZmlsZXMubGVuZ3RoKTsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGFUcmFuc2Zlci5maWxlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgdmFyIGZpbGUgPSBkYXRhVHJhbnNmZXIuZmlsZXMuaXRlbShpKTsKICAgICAgICAgIGlmIChmaWxlICYmIChmaWxlLnNpemUgfHwgZmlsZS50eXBlKSkgewogICAgICAgICAgICB0aGlzLmZpbGVzLnB1c2goZmlsZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0RGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RGF0YSgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICB0eXBlczogdGhpcy50eXBlcywKICAgICAgICBmaWxlczogdGhpcy5maWxlcwogICAgICB9OwogICAgfQogIH1dKTsKICByZXR1cm4gTmF0aXZlRHJhZ0FuZERyb3BEYXRhOwp9KCk7CmZ1bmN0aW9uIGVxdWFsc0RyYWdGZWVkYmFjayhmMSwgZjIpIHsKICBpZiAoQXJyYXkuaXNBcnJheShmMSkgJiYgQXJyYXkuaXNBcnJheShmMikpIHsKICAgIHJldHVybiBlcXVhbHMoZjEsIGYyKTsKICB9CiAgcmV0dXJuIGYxID09PSBmMjsKfQp2YXIgTGlzdFZpZXdBY2Nlc3NpYmlsaXR5UHJvdmlkZXIgPSAvKiNfX1BVUkVfXyovX2NyZWF0ZUNsYXNzKGZ1bmN0aW9uIExpc3RWaWV3QWNjZXNzaWJpbGl0eVByb3ZpZGVyKGFjY2Vzc2liaWxpdHlQcm92aWRlcikgewogIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBMaXN0Vmlld0FjY2Vzc2liaWxpdHlQcm92aWRlcik7CiAgaWYgKGFjY2Vzc2liaWxpdHlQcm92aWRlciA9PT0gbnVsbCB8fCBhY2Nlc3NpYmlsaXR5UHJvdmlkZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGFjY2Vzc2liaWxpdHlQcm92aWRlci5nZXRTZXRTaXplKSB7CiAgICB0aGlzLmdldFNldFNpemUgPSBhY2Nlc3NpYmlsaXR5UHJvdmlkZXIuZ2V0U2V0U2l6ZS5iaW5kKGFjY2Vzc2liaWxpdHlQcm92aWRlcik7CiAgfSBlbHNlIHsKICAgIHRoaXMuZ2V0U2V0U2l6ZSA9IGZ1bmN0aW9uIChlLCBpLCBsKSB7CiAgICAgIHJldHVybiBsOwogICAgfTsKICB9CiAgaWYgKGFjY2Vzc2liaWxpdHlQcm92aWRlciA9PT0gbnVsbCB8fCBhY2Nlc3NpYmlsaXR5UHJvdmlkZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGFjY2Vzc2liaWxpdHlQcm92aWRlci5nZXRQb3NJblNldCkgewogICAgdGhpcy5nZXRQb3NJblNldCA9IGFjY2Vzc2liaWxpdHlQcm92aWRlci5nZXRQb3NJblNldC5iaW5kKGFjY2Vzc2liaWxpdHlQcm92aWRlcik7CiAgfSBlbHNlIHsKICAgIHRoaXMuZ2V0UG9zSW5TZXQgPSBmdW5jdGlvbiAoZSwgaSkgewogICAgICByZXR1cm4gaSArIDE7CiAgICB9OwogIH0KICBpZiAoYWNjZXNzaWJpbGl0eVByb3ZpZGVyID09PSBudWxsIHx8IGFjY2Vzc2liaWxpdHlQcm92aWRlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogYWNjZXNzaWJpbGl0eVByb3ZpZGVyLmdldFJvbGUpIHsKICAgIHRoaXMuZ2V0Um9sZSA9IGFjY2Vzc2liaWxpdHlQcm92aWRlci5nZXRSb2xlLmJpbmQoYWNjZXNzaWJpbGl0eVByb3ZpZGVyKTsKICB9IGVsc2UgewogICAgdGhpcy5nZXRSb2xlID0gZnVuY3Rpb24gKF8pIHsKICAgICAgcmV0dXJuICdsaXN0aXRlbSc7CiAgICB9OwogIH0KICBpZiAoYWNjZXNzaWJpbGl0eVByb3ZpZGVyID09PSBudWxsIHx8IGFjY2Vzc2liaWxpdHlQcm92aWRlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogYWNjZXNzaWJpbGl0eVByb3ZpZGVyLmlzQ2hlY2tlZCkgewogICAgdGhpcy5pc0NoZWNrZWQgPSBhY2Nlc3NpYmlsaXR5UHJvdmlkZXIuaXNDaGVja2VkLmJpbmQoYWNjZXNzaWJpbGl0eVByb3ZpZGVyKTsKICB9IGVsc2UgewogICAgdGhpcy5pc0NoZWNrZWQgPSBmdW5jdGlvbiAoXykgewogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfTsKICB9Cn0pOwovKioKICogVGhlIHtAbGluayBMaXN0Vmlld30gaXMgYSB2aXJ0dWFsIHNjcm9sbGluZyBlbmdpbmUuCiAqCiAqIEdpdmVuIHRoYXQgaXQgb25seSByZW5kZXJzIGVsZW1lbnRzIHdpdGhpbiBpdHMgdmlld3BvcnQsIGl0IGNhbiBob2xkIGxhcmdlCiAqIGNvbGxlY3Rpb25zIG9mIGVsZW1lbnRzIGFuZCBzdGF5IHZlcnkgcGVyZm9ybWFudC4gVGhlIHBlcmZvcm1hbmNlIGJvdHRsZW5lY2sKICogdXN1YWxseSBsaWVzIHdpdGhpbiB0aGUgdXNlcidzIHJlbmRlcmluZyBjb2RlIGZvciBlYWNoIGVsZW1lbnQuCiAqCiAqIEByZW1hcmtzIEl0IGlzIGEgbG93LWxldmVsIHdpZGdldCwgbm90IG1lYW50IHRvIGJlIHVzZWQgZGlyZWN0bHkuIFJlZmVyIHRvIHRoZQogKiBMaXN0IHdpZGdldCBpbnN0ZWFkLgogKi8KZXhwb3J0IHZhciBMaXN0VmlldyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gTGlzdFZpZXcoY29udGFpbmVyLCB2aXJ0dWFsRGVsZWdhdGUsIHJlbmRlcmVycykgewogICAgdmFyIF90aGlzID0gdGhpczsKICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiBEZWZhdWx0T3B0aW9uczsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBMaXN0Vmlldyk7CiAgICB2YXIgX2EsIF9iLCBfYywgX2QsIF9lLCBfZiwgX2csIF9oLCBfaiwgX2s7CiAgICB0aGlzLnZpcnR1YWxEZWxlZ2F0ZSA9IHZpcnR1YWxEZWxlZ2F0ZTsKICAgIHRoaXMuZG9tSWQgPSAibGlzdF9pZF8iLmNvbmNhdCgrK0xpc3RWaWV3Lkluc3RhbmNlQ291bnQpOwogICAgdGhpcy5yZW5kZXJlcnMgPSBuZXcgTWFwKCk7CiAgICB0aGlzLnJlbmRlcldpZHRoID0gMDsKICAgIHRoaXMuX3Njcm9sbEhlaWdodCA9IDA7CiAgICB0aGlzLnNjcm9sbGFibGVFbGVtZW50VXBkYXRlRGlzcG9zYWJsZSA9IG51bGw7CiAgICB0aGlzLnNjcm9sbGFibGVFbGVtZW50V2lkdGhEZWxheWVyID0gbmV3IERlbGF5ZXIoNTApOwogICAgdGhpcy5zcGxpY2luZyA9IGZhbHNlOwogICAgdGhpcy5kcmFnT3ZlckFuaW1hdGlvblN0b3BEaXNwb3NhYmxlID0gRGlzcG9zYWJsZS5Ob25lOwogICAgdGhpcy5kcmFnT3Zlck1vdXNlWSA9IDA7CiAgICB0aGlzLmNhbkRyb3AgPSBmYWxzZTsKICAgIHRoaXMuY3VycmVudERyYWdGZWVkYmFja0Rpc3Bvc2FibGUgPSBEaXNwb3NhYmxlLk5vbmU7CiAgICB0aGlzLm9uRHJhZ0xlYXZlVGltZW91dCA9IERpc3Bvc2FibGUuTm9uZTsKICAgIHRoaXMuZGlzcG9zYWJsZXMgPSBuZXcgRGlzcG9zYWJsZVN0b3JlKCk7CiAgICB0aGlzLl9vbkRpZENoYW5nZUNvbnRlbnRIZWlnaHQgPSBuZXcgRW1pdHRlcigpOwogICAgdGhpcy5faG9yaXpvbnRhbFNjcm9sbGluZyA9IGZhbHNlOwogICAgaWYgKG9wdGlvbnMuaG9yaXpvbnRhbFNjcm9sbGluZyAmJiBvcHRpb25zLnN1cHBvcnREeW5hbWljSGVpZ2h0cykgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ0hvcml6b250YWwgc2Nyb2xsaW5nIGFuZCBkeW5hbWljIGhlaWdodHMgbm90IHN1cHBvcnRlZCBzaW11bHRhbmVvdXNseScpOwogICAgfQogICAgdGhpcy5pdGVtcyA9IFtdOwogICAgdGhpcy5pdGVtSWQgPSAwOwogICAgdGhpcy5yYW5nZU1hcCA9IG5ldyBSYW5nZU1hcCgpOwogICAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHJlbmRlcmVycyksCiAgICAgIF9zdGVwOwogICAgdHJ5IHsKICAgICAgZm9yIChfaXRlcmF0b3IucygpOyAhKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZTspIHsKICAgICAgICB2YXIgcmVuZGVyZXIgPSBfc3RlcC52YWx1ZTsKICAgICAgICB0aGlzLnJlbmRlcmVycy5zZXQocmVuZGVyZXIudGVtcGxhdGVJZCwgcmVuZGVyZXIpOwogICAgICB9CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgX2l0ZXJhdG9yLmUoZXJyKTsKICAgIH0gZmluYWxseSB7CiAgICAgIF9pdGVyYXRvci5mKCk7CiAgICB9CiAgICB0aGlzLmNhY2hlID0gdGhpcy5kaXNwb3NhYmxlcy5hZGQobmV3IFJvd0NhY2hlKHRoaXMucmVuZGVyZXJzKSk7CiAgICB0aGlzLmxhc3RSZW5kZXJUb3AgPSAwOwogICAgdGhpcy5sYXN0UmVuZGVySGVpZ2h0ID0gMDsKICAgIHRoaXMuZG9tTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgdGhpcy5kb21Ob2RlLmNsYXNzTmFtZSA9ICdtb25hY28tbGlzdCc7CiAgICB0aGlzLmRvbU5vZGUuY2xhc3NMaXN0LmFkZCh0aGlzLmRvbUlkKTsKICAgIHRoaXMuZG9tTm9kZS50YWJJbmRleCA9IDA7CiAgICB0aGlzLmRvbU5vZGUuY2xhc3NMaXN0LnRvZ2dsZSgnbW91c2Utc3VwcG9ydCcsIHR5cGVvZiBvcHRpb25zLm1vdXNlU3VwcG9ydCA9PT0gJ2Jvb2xlYW4nID8gb3B0aW9ucy5tb3VzZVN1cHBvcnQgOiB0cnVlKTsKICAgIHRoaXMuX2hvcml6b250YWxTY3JvbGxpbmcgPSAoX2EgPSBvcHRpb25zLmhvcml6b250YWxTY3JvbGxpbmcpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IERlZmF1bHRPcHRpb25zLmhvcml6b250YWxTY3JvbGxpbmc7CiAgICB0aGlzLmRvbU5vZGUuY2xhc3NMaXN0LnRvZ2dsZSgnaG9yaXpvbnRhbC1zY3JvbGxpbmcnLCB0aGlzLl9ob3Jpem9udGFsU2Nyb2xsaW5nKTsKICAgIHRoaXMuYWRkaXRpb25hbFNjcm9sbEhlaWdodCA9IHR5cGVvZiBvcHRpb25zLmFkZGl0aW9uYWxTY3JvbGxIZWlnaHQgPT09ICd1bmRlZmluZWQnID8gMCA6IG9wdGlvbnMuYWRkaXRpb25hbFNjcm9sbEhlaWdodDsKICAgIHRoaXMuYWNjZXNzaWJpbGl0eVByb3ZpZGVyID0gbmV3IExpc3RWaWV3QWNjZXNzaWJpbGl0eVByb3ZpZGVyKG9wdGlvbnMuYWNjZXNzaWJpbGl0eVByb3ZpZGVyKTsKICAgIHRoaXMucm93c0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgdGhpcy5yb3dzQ29udGFpbmVyLmNsYXNzTmFtZSA9ICdtb25hY28tbGlzdC1yb3dzJzsKICAgIHZhciB0cmFuc2Zvcm1PcHRpbWl6YXRpb24gPSAoX2IgPSBvcHRpb25zLnRyYW5zZm9ybU9wdGltaXphdGlvbikgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogRGVmYXVsdE9wdGlvbnMudHJhbnNmb3JtT3B0aW1pemF0aW9uOwogICAgaWYgKHRyYW5zZm9ybU9wdGltaXphdGlvbikgewogICAgICB0aGlzLnJvd3NDb250YWluZXIuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZTNkKDBweCwgMHB4LCAwcHgpJzsKICAgIH0KICAgIHRoaXMuZGlzcG9zYWJsZXMuYWRkKEdlc3R1cmUuYWRkVGFyZ2V0KHRoaXMucm93c0NvbnRhaW5lcikpOwogICAgdGhpcy5zY3JvbGxhYmxlID0gbmV3IFNjcm9sbGFibGUoewogICAgICBmb3JjZUludGVnZXJWYWx1ZXM6IHRydWUsCiAgICAgIHNtb290aFNjcm9sbER1cmF0aW9uOiAoKF9jID0gb3B0aW9ucy5zbW9vdGhTY3JvbGxpbmcpICE9PSBudWxsICYmIF9jICE9PSB2b2lkIDAgPyBfYyA6IGZhbHNlKSA/IDEyNSA6IDAsCiAgICAgIHNjaGVkdWxlQXROZXh0QW5pbWF0aW9uRnJhbWU6IGZ1bmN0aW9uIHNjaGVkdWxlQXROZXh0QW5pbWF0aW9uRnJhbWUoY2IpIHsKICAgICAgICByZXR1cm4gX3NjaGVkdWxlQXROZXh0QW5pbWF0aW9uRnJhbWUoY2IpOwogICAgICB9CiAgICB9KTsKICAgIHRoaXMuc2Nyb2xsYWJsZUVsZW1lbnQgPSB0aGlzLmRpc3Bvc2FibGVzLmFkZChuZXcgU21vb3RoU2Nyb2xsYWJsZUVsZW1lbnQodGhpcy5yb3dzQ29udGFpbmVyLCB7CiAgICAgIGFsd2F5c0NvbnN1bWVNb3VzZVdoZWVsOiAoX2QgPSBvcHRpb25zLmFsd2F5c0NvbnN1bWVNb3VzZVdoZWVsKSAhPT0gbnVsbCAmJiBfZCAhPT0gdm9pZCAwID8gX2QgOiBEZWZhdWx0T3B0aW9ucy5hbHdheXNDb25zdW1lTW91c2VXaGVlbCwKICAgICAgaG9yaXpvbnRhbDogMSAvKiBTY3JvbGxiYXJWaXNpYmlsaXR5LkF1dG8gKi8sCiAgICAgIHZlcnRpY2FsOiAoX2UgPSBvcHRpb25zLnZlcnRpY2FsU2Nyb2xsTW9kZSkgIT09IG51bGwgJiYgX2UgIT09IHZvaWQgMCA/IF9lIDogRGVmYXVsdE9wdGlvbnMudmVydGljYWxTY3JvbGxNb2RlLAogICAgICB1c2VTaGFkb3dzOiAoX2YgPSBvcHRpb25zLnVzZVNoYWRvd3MpICE9PSBudWxsICYmIF9mICE9PSB2b2lkIDAgPyBfZiA6IERlZmF1bHRPcHRpb25zLnVzZVNoYWRvd3MsCiAgICAgIG1vdXNlV2hlZWxTY3JvbGxTZW5zaXRpdml0eTogb3B0aW9ucy5tb3VzZVdoZWVsU2Nyb2xsU2Vuc2l0aXZpdHksCiAgICAgIGZhc3RTY3JvbGxTZW5zaXRpdml0eTogb3B0aW9ucy5mYXN0U2Nyb2xsU2Vuc2l0aXZpdHkKICAgIH0sIHRoaXMuc2Nyb2xsYWJsZSkpOwogICAgdGhpcy5kb21Ob2RlLmFwcGVuZENoaWxkKHRoaXMuc2Nyb2xsYWJsZUVsZW1lbnQuZ2V0RG9tTm9kZSgpKTsKICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmRvbU5vZGUpOwogICAgdGhpcy5zY3JvbGxhYmxlRWxlbWVudC5vblNjcm9sbCh0aGlzLm9uU2Nyb2xsLCB0aGlzLCB0aGlzLmRpc3Bvc2FibGVzKTsKICAgIHRoaXMuZGlzcG9zYWJsZXMuYWRkKGFkZERpc3Bvc2FibGVMaXN0ZW5lcih0aGlzLnJvd3NDb250YWluZXIsIFRvdWNoRXZlbnRUeXBlLkNoYW5nZSwgZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuIF90aGlzLm9uVG91Y2hDaGFuZ2UoZSk7CiAgICB9KSk7CiAgICAvLyBQcmV2ZW50IHRoZSBtb25hY28tc2Nyb2xsYWJsZS1lbGVtZW50IGZyb20gc2Nyb2xsaW5nCiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vbWljcm9zb2Z0L3ZzY29kZS9pc3N1ZXMvNDQxODEKICAgIHRoaXMuZGlzcG9zYWJsZXMuYWRkKGFkZERpc3Bvc2FibGVMaXN0ZW5lcih0aGlzLnNjcm9sbGFibGVFbGVtZW50LmdldERvbU5vZGUoKSwgJ3Njcm9sbCcsIGZ1bmN0aW9uIChlKSB7CiAgICAgIHJldHVybiBlLnRhcmdldC5zY3JvbGxUb3AgPSAwOwogICAgfSkpOwogICAgdGhpcy5kaXNwb3NhYmxlcy5hZGQoYWRkRGlzcG9zYWJsZUxpc3RlbmVyKHRoaXMuZG9tTm9kZSwgJ2RyYWdvdmVyJywgZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuIF90aGlzLm9uRHJhZ092ZXIoX3RoaXMudG9EcmFnRXZlbnQoZSkpOwogICAgfSkpOwogICAgdGhpcy5kaXNwb3NhYmxlcy5hZGQoYWRkRGlzcG9zYWJsZUxpc3RlbmVyKHRoaXMuZG9tTm9kZSwgJ2Ryb3AnLCBmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gX3RoaXMub25Ecm9wKF90aGlzLnRvRHJhZ0V2ZW50KGUpKTsKICAgIH0pKTsKICAgIHRoaXMuZGlzcG9zYWJsZXMuYWRkKGFkZERpc3Bvc2FibGVMaXN0ZW5lcih0aGlzLmRvbU5vZGUsICdkcmFnbGVhdmUnLCBmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gX3RoaXMub25EcmFnTGVhdmUoX3RoaXMudG9EcmFnRXZlbnQoZSkpOwogICAgfSkpOwogICAgdGhpcy5kaXNwb3NhYmxlcy5hZGQoYWRkRGlzcG9zYWJsZUxpc3RlbmVyKHRoaXMuZG9tTm9kZSwgJ2RyYWdlbmQnLCBmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gX3RoaXMub25EcmFnRW5kKGUpOwogICAgfSkpOwogICAgdGhpcy5zZXRSb3dMaW5lSGVpZ2h0ID0gKF9nID0gb3B0aW9ucy5zZXRSb3dMaW5lSGVpZ2h0KSAhPT0gbnVsbCAmJiBfZyAhPT0gdm9pZCAwID8gX2cgOiBEZWZhdWx0T3B0aW9ucy5zZXRSb3dMaW5lSGVpZ2h0OwogICAgdGhpcy5zZXRSb3dIZWlnaHQgPSAoX2ggPSBvcHRpb25zLnNldFJvd0hlaWdodCkgIT09IG51bGwgJiYgX2ggIT09IHZvaWQgMCA/IF9oIDogRGVmYXVsdE9wdGlvbnMuc2V0Um93SGVpZ2h0OwogICAgdGhpcy5zdXBwb3J0RHluYW1pY0hlaWdodHMgPSAoX2ogPSBvcHRpb25zLnN1cHBvcnREeW5hbWljSGVpZ2h0cykgIT09IG51bGwgJiYgX2ogIT09IHZvaWQgMCA/IF9qIDogRGVmYXVsdE9wdGlvbnMuc3VwcG9ydER5bmFtaWNIZWlnaHRzOwogICAgdGhpcy5kbmQgPSAoX2sgPSBvcHRpb25zLmRuZCkgIT09IG51bGwgJiYgX2sgIT09IHZvaWQgMCA/IF9rIDogRGVmYXVsdE9wdGlvbnMuZG5kOwogICAgdGhpcy5sYXlvdXQoKTsKICB9CiAgX2NyZWF0ZUNsYXNzKExpc3RWaWV3LCBbewogICAga2V5OiAiY29udGVudEhlaWdodCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMucmFuZ2VNYXAuc2l6ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJob3Jpem9udGFsU2Nyb2xsaW5nIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5faG9yaXpvbnRhbFNjcm9sbGluZzsKICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkgewogICAgICBpZiAodmFsdWUgPT09IHRoaXMuX2hvcml6b250YWxTY3JvbGxpbmcpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKHZhbHVlICYmIHRoaXMuc3VwcG9ydER5bmFtaWNIZWlnaHRzKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdIb3Jpem9udGFsIHNjcm9sbGluZyBhbmQgZHluYW1pYyBoZWlnaHRzIG5vdCBzdXBwb3J0ZWQgc2ltdWx0YW5lb3VzbHknKTsKICAgICAgfQogICAgICB0aGlzLl9ob3Jpem9udGFsU2Nyb2xsaW5nID0gdmFsdWU7CiAgICAgIHRoaXMuZG9tTm9kZS5jbGFzc0xpc3QudG9nZ2xlKCdob3Jpem9udGFsLXNjcm9sbGluZycsIHRoaXMuX2hvcml6b250YWxTY3JvbGxpbmcpOwogICAgICBpZiAodGhpcy5faG9yaXpvbnRhbFNjcm9sbGluZykgewogICAgICAgIHZhciBfaXRlcmF0b3IyID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodGhpcy5pdGVtcyksCiAgICAgICAgICBfc3RlcDI7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGZvciAoX2l0ZXJhdG9yMi5zKCk7ICEoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgIHZhciBpdGVtID0gX3N0ZXAyLnZhbHVlOwogICAgICAgICAgICB0aGlzLm1lYXN1cmVJdGVtV2lkdGgoaXRlbSk7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBfaXRlcmF0b3IyLmUoZXJyKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgX2l0ZXJhdG9yMi5mKCk7CiAgICAgICAgfQogICAgICAgIHRoaXMudXBkYXRlU2Nyb2xsV2lkdGgoKTsKICAgICAgICB0aGlzLnNjcm9sbGFibGVFbGVtZW50LnNldFNjcm9sbERpbWVuc2lvbnMoewogICAgICAgICAgd2lkdGg6IGdldENvbnRlbnRXaWR0aCh0aGlzLmRvbU5vZGUpCiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5yb3dzQ29udGFpbmVyLnN0eWxlLndpZHRoID0gIiIuY29uY2F0KE1hdGgubWF4KHRoaXMuc2Nyb2xsV2lkdGggfHwgMCwgdGhpcy5yZW5kZXJXaWR0aCksICJweCIpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2Nyb2xsYWJsZUVsZW1lbnRXaWR0aERlbGF5ZXIuY2FuY2VsKCk7CiAgICAgICAgdGhpcy5zY3JvbGxhYmxlRWxlbWVudC5zZXRTY3JvbGxEaW1lbnNpb25zKHsKICAgICAgICAgIHdpZHRoOiB0aGlzLnJlbmRlcldpZHRoLAogICAgICAgICAgc2Nyb2xsV2lkdGg6IHRoaXMucmVuZGVyV2lkdGgKICAgICAgICB9KTsKICAgICAgICB0aGlzLnJvd3NDb250YWluZXIuc3R5bGUud2lkdGggPSAnJzsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInVwZGF0ZU9wdGlvbnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZU9wdGlvbnMob3B0aW9ucykgewogICAgICBpZiAob3B0aW9ucy5hZGRpdGlvbmFsU2Nyb2xsSGVpZ2h0ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICB0aGlzLmFkZGl0aW9uYWxTY3JvbGxIZWlnaHQgPSBvcHRpb25zLmFkZGl0aW9uYWxTY3JvbGxIZWlnaHQ7CiAgICAgICAgdGhpcy5zY3JvbGxhYmxlRWxlbWVudC5zZXRTY3JvbGxEaW1lbnNpb25zKHsKICAgICAgICAgIHNjcm9sbEhlaWdodDogdGhpcy5zY3JvbGxIZWlnaHQKICAgICAgICB9KTsKICAgICAgfQogICAgICBpZiAob3B0aW9ucy5zbW9vdGhTY3JvbGxpbmcgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHRoaXMuc2Nyb2xsYWJsZS5zZXRTbW9vdGhTY3JvbGxEdXJhdGlvbihvcHRpb25zLnNtb290aFNjcm9sbGluZyA/IDEyNSA6IDApOwogICAgICB9CiAgICAgIGlmIChvcHRpb25zLmhvcml6b250YWxTY3JvbGxpbmcgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHRoaXMuaG9yaXpvbnRhbFNjcm9sbGluZyA9IG9wdGlvbnMuaG9yaXpvbnRhbFNjcm9sbGluZzsKICAgICAgfQogICAgICBpZiAob3B0aW9ucy5tb3VzZVdoZWVsU2Nyb2xsU2Vuc2l0aXZpdHkgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHRoaXMuc2Nyb2xsYWJsZUVsZW1lbnQudXBkYXRlT3B0aW9ucyh7CiAgICAgICAgICBtb3VzZVdoZWVsU2Nyb2xsU2Vuc2l0aXZpdHk6IG9wdGlvbnMubW91c2VXaGVlbFNjcm9sbFNlbnNpdGl2aXR5CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgaWYgKG9wdGlvbnMuZmFzdFNjcm9sbFNlbnNpdGl2aXR5ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICB0aGlzLnNjcm9sbGFibGVFbGVtZW50LnVwZGF0ZU9wdGlvbnMoewogICAgICAgICAgZmFzdFNjcm9sbFNlbnNpdGl2aXR5OiBvcHRpb25zLmZhc3RTY3JvbGxTZW5zaXRpdml0eQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAic3BsaWNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzcGxpY2Uoc3RhcnQsIGRlbGV0ZUNvdW50KSB7CiAgICAgIHZhciBlbGVtZW50cyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogW107CiAgICAgIGlmICh0aGlzLnNwbGljaW5nKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5cJ3QgcnVuIHJlY3Vyc2l2ZSBzcGxpY2VzLicpOwogICAgICB9CiAgICAgIHRoaXMuc3BsaWNpbmcgPSB0cnVlOwogICAgICB0cnkgewogICAgICAgIHJldHVybiB0aGlzLl9zcGxpY2Uoc3RhcnQsIGRlbGV0ZUNvdW50LCBlbGVtZW50cyk7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgdGhpcy5zcGxpY2luZyA9IGZhbHNlOwogICAgICAgIHRoaXMuX29uRGlkQ2hhbmdlQ29udGVudEhlaWdodC5maXJlKHRoaXMuY29udGVudEhlaWdodCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJfc3BsaWNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfc3BsaWNlKHN0YXJ0LCBkZWxldGVDb3VudCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgICAgdmFyIGVsZW1lbnRzID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBbXTsKICAgICAgdmFyIHByZXZpb3VzUmVuZGVyUmFuZ2UgPSB0aGlzLmdldFJlbmRlclJhbmdlKHRoaXMubGFzdFJlbmRlclRvcCwgdGhpcy5sYXN0UmVuZGVySGVpZ2h0KTsKICAgICAgdmFyIGRlbGV0ZVJhbmdlID0gewogICAgICAgIHN0YXJ0OiBzdGFydCwKICAgICAgICBlbmQ6IHN0YXJ0ICsgZGVsZXRlQ291bnQKICAgICAgfTsKICAgICAgdmFyIHJlbW92ZVJhbmdlID0gUmFuZ2UuaW50ZXJzZWN0KHByZXZpb3VzUmVuZGVyUmFuZ2UsIGRlbGV0ZVJhbmdlKTsKICAgICAgLy8gdHJ5IHRvIHJldXNlIHJvd3MsIGF2b2lkIHJlbW92aW5nIHRoZW0gZnJvbSBET00KICAgICAgdmFyIHJvd3NUb0Rpc3Bvc2UgPSBuZXcgTWFwKCk7CiAgICAgIGZvciAodmFyIGkgPSByZW1vdmVSYW5nZS5lbmQgLSAxOyBpID49IHJlbW92ZVJhbmdlLnN0YXJ0OyBpLS0pIHsKICAgICAgICB2YXIgaXRlbSA9IHRoaXMuaXRlbXNbaV07CiAgICAgICAgaXRlbS5kcmFnU3RhcnREaXNwb3NhYmxlLmRpc3Bvc2UoKTsKICAgICAgICBpdGVtLmNoZWNrZWREaXNwb3NhYmxlLmRpc3Bvc2UoKTsKICAgICAgICBpZiAoaXRlbS5yb3cpIHsKICAgICAgICAgIHZhciByb3dzID0gcm93c1RvRGlzcG9zZS5nZXQoaXRlbS50ZW1wbGF0ZUlkKTsKICAgICAgICAgIGlmICghcm93cykgewogICAgICAgICAgICByb3dzID0gW107CiAgICAgICAgICAgIHJvd3NUb0Rpc3Bvc2Uuc2V0KGl0ZW0udGVtcGxhdGVJZCwgcm93cyk7CiAgICAgICAgICB9CiAgICAgICAgICB2YXIgcmVuZGVyZXIgPSB0aGlzLnJlbmRlcmVycy5nZXQoaXRlbS50ZW1wbGF0ZUlkKTsKICAgICAgICAgIGlmIChyZW5kZXJlciAmJiByZW5kZXJlci5kaXNwb3NlRWxlbWVudCkgewogICAgICAgICAgICByZW5kZXJlci5kaXNwb3NlRWxlbWVudChpdGVtLmVsZW1lbnQsIGksIGl0ZW0ucm93LnRlbXBsYXRlRGF0YSwgaXRlbS5zaXplKTsKICAgICAgICAgIH0KICAgICAgICAgIHJvd3MucHVzaChpdGVtLnJvdyk7CiAgICAgICAgfQogICAgICAgIGl0ZW0ucm93ID0gbnVsbDsKICAgICAgfQogICAgICB2YXIgcHJldmlvdXNSZXN0UmFuZ2UgPSB7CiAgICAgICAgc3RhcnQ6IHN0YXJ0ICsgZGVsZXRlQ291bnQsCiAgICAgICAgZW5kOiB0aGlzLml0ZW1zLmxlbmd0aAogICAgICB9OwogICAgICB2YXIgcHJldmlvdXNSZW5kZXJlZFJlc3RSYW5nZSA9IFJhbmdlLmludGVyc2VjdChwcmV2aW91c1Jlc3RSYW5nZSwgcHJldmlvdXNSZW5kZXJSYW5nZSk7CiAgICAgIHZhciBwcmV2aW91c1VucmVuZGVyZWRSZXN0UmFuZ2VzID0gUmFuZ2UucmVsYXRpdmVDb21wbGVtZW50KHByZXZpb3VzUmVzdFJhbmdlLCBwcmV2aW91c1JlbmRlclJhbmdlKTsKICAgICAgdmFyIGluc2VydGVkID0gZWxlbWVudHMubWFwKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGlkOiBTdHJpbmcoX3RoaXMyLml0ZW1JZCsrKSwKICAgICAgICAgIGVsZW1lbnQ6IGVsZW1lbnQsCiAgICAgICAgICB0ZW1wbGF0ZUlkOiBfdGhpczIudmlydHVhbERlbGVnYXRlLmdldFRlbXBsYXRlSWQoZWxlbWVudCksCiAgICAgICAgICBzaXplOiBfdGhpczIudmlydHVhbERlbGVnYXRlLmdldEhlaWdodChlbGVtZW50KSwKICAgICAgICAgIHdpZHRoOiB1bmRlZmluZWQsCiAgICAgICAgICBoYXNEeW5hbWljSGVpZ2h0OiAhIV90aGlzMi52aXJ0dWFsRGVsZWdhdGUuaGFzRHluYW1pY0hlaWdodCAmJiBfdGhpczIudmlydHVhbERlbGVnYXRlLmhhc0R5bmFtaWNIZWlnaHQoZWxlbWVudCksCiAgICAgICAgICBsYXN0RHluYW1pY0hlaWdodFdpZHRoOiB1bmRlZmluZWQsCiAgICAgICAgICByb3c6IG51bGwsCiAgICAgICAgICB1cmk6IHVuZGVmaW5lZCwKICAgICAgICAgIGRyb3BUYXJnZXQ6IGZhbHNlLAogICAgICAgICAgZHJhZ1N0YXJ0RGlzcG9zYWJsZTogRGlzcG9zYWJsZS5Ob25lLAogICAgICAgICAgY2hlY2tlZERpc3Bvc2FibGU6IERpc3Bvc2FibGUuTm9uZQogICAgICAgIH07CiAgICAgIH0pOwogICAgICB2YXIgZGVsZXRlZDsKICAgICAgLy8gVE9ET0Bqb2FvOiBpbXByb3ZlIHRoaXMgb3B0aW1pemF0aW9uIHRvIGNhdGNoIGV2ZW4gbW9yZSBjYXNlcwogICAgICBpZiAoc3RhcnQgPT09IDAgJiYgZGVsZXRlQ291bnQgPj0gdGhpcy5pdGVtcy5sZW5ndGgpIHsKICAgICAgICB0aGlzLnJhbmdlTWFwID0gbmV3IFJhbmdlTWFwKCk7CiAgICAgICAgdGhpcy5yYW5nZU1hcC5zcGxpY2UoMCwgMCwgaW5zZXJ0ZWQpOwogICAgICAgIGRlbGV0ZWQgPSB0aGlzLml0ZW1zOwogICAgICAgIHRoaXMuaXRlbXMgPSBpbnNlcnRlZDsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgX3RoaXMkaXRlbXM7CiAgICAgICAgdGhpcy5yYW5nZU1hcC5zcGxpY2Uoc3RhcnQsIGRlbGV0ZUNvdW50LCBpbnNlcnRlZCk7CiAgICAgICAgZGVsZXRlZCA9IChfdGhpcyRpdGVtcyA9IHRoaXMuaXRlbXMpLnNwbGljZS5hcHBseShfdGhpcyRpdGVtcywgW3N0YXJ0LCBkZWxldGVDb3VudF0uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShpbnNlcnRlZCkpKTsKICAgICAgfQogICAgICB2YXIgZGVsdGEgPSBlbGVtZW50cy5sZW5ndGggLSBkZWxldGVDb3VudDsKICAgICAgdmFyIHJlbmRlclJhbmdlID0gdGhpcy5nZXRSZW5kZXJSYW5nZSh0aGlzLmxhc3RSZW5kZXJUb3AsIHRoaXMubGFzdFJlbmRlckhlaWdodCk7CiAgICAgIHZhciByZW5kZXJlZFJlc3RSYW5nZSA9IHNoaWZ0KHByZXZpb3VzUmVuZGVyZWRSZXN0UmFuZ2UsIGRlbHRhKTsKICAgICAgdmFyIHVwZGF0ZVJhbmdlID0gUmFuZ2UuaW50ZXJzZWN0KHJlbmRlclJhbmdlLCByZW5kZXJlZFJlc3RSYW5nZSk7CiAgICAgIGZvciAodmFyIF9pID0gdXBkYXRlUmFuZ2Uuc3RhcnQ7IF9pIDwgdXBkYXRlUmFuZ2UuZW5kOyBfaSsrKSB7CiAgICAgICAgdGhpcy51cGRhdGVJdGVtSW5ET00odGhpcy5pdGVtc1tfaV0sIF9pKTsKICAgICAgfQogICAgICB2YXIgcmVtb3ZlUmFuZ2VzID0gUmFuZ2UucmVsYXRpdmVDb21wbGVtZW50KHJlbmRlcmVkUmVzdFJhbmdlLCByZW5kZXJSYW5nZSk7CiAgICAgIHZhciBfaXRlcmF0b3IzID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIocmVtb3ZlUmFuZ2VzKSwKICAgICAgICBfc3RlcDM7CiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3IzLnMoKTsgIShfc3RlcDMgPSBfaXRlcmF0b3IzLm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciByYW5nZSA9IF9zdGVwMy52YWx1ZTsKICAgICAgICAgIGZvciAodmFyIF9pMiA9IHJhbmdlLnN0YXJ0OyBfaTIgPCByYW5nZS5lbmQ7IF9pMisrKSB7CiAgICAgICAgICAgIHRoaXMucmVtb3ZlSXRlbUZyb21ET00oX2kyKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvcjMuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvcjMuZigpOwogICAgICB9CiAgICAgIHZhciB1bnJlbmRlcmVkUmVzdFJhbmdlcyA9IHByZXZpb3VzVW5yZW5kZXJlZFJlc3RSYW5nZXMubWFwKGZ1bmN0aW9uIChyKSB7CiAgICAgICAgcmV0dXJuIHNoaWZ0KHIsIGRlbHRhKTsKICAgICAgfSk7CiAgICAgIHZhciBlbGVtZW50c1JhbmdlID0gewogICAgICAgIHN0YXJ0OiBzdGFydCwKICAgICAgICBlbmQ6IHN0YXJ0ICsgZWxlbWVudHMubGVuZ3RoCiAgICAgIH07CiAgICAgIHZhciBpbnNlcnRSYW5nZXMgPSBbZWxlbWVudHNSYW5nZV0uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheSh1bnJlbmRlcmVkUmVzdFJhbmdlcykpLm1hcChmdW5jdGlvbiAocikgewogICAgICAgIHJldHVybiBSYW5nZS5pbnRlcnNlY3QocmVuZGVyUmFuZ2UsIHIpOwogICAgICB9KTsKICAgICAgdmFyIGJlZm9yZUVsZW1lbnQgPSB0aGlzLmdldE5leHRUb0xhc3RFbGVtZW50KGluc2VydFJhbmdlcyk7CiAgICAgIHZhciBfaXRlcmF0b3I0ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoaW5zZXJ0UmFuZ2VzKSwKICAgICAgICBfc3RlcDQ7CiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3I0LnMoKTsgIShfc3RlcDQgPSBfaXRlcmF0b3I0Lm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciBfcmFuZ2UgPSBfc3RlcDQudmFsdWU7CiAgICAgICAgICBmb3IgKHZhciBfaTMgPSBfcmFuZ2Uuc3RhcnQ7IF9pMyA8IF9yYW5nZS5lbmQ7IF9pMysrKSB7CiAgICAgICAgICAgIHZhciBfaXRlbSA9IHRoaXMuaXRlbXNbX2kzXTsKICAgICAgICAgICAgdmFyIF9yb3dzID0gcm93c1RvRGlzcG9zZS5nZXQoX2l0ZW0udGVtcGxhdGVJZCk7CiAgICAgICAgICAgIHZhciByb3cgPSBfcm93cyA9PT0gbnVsbCB8fCBfcm93cyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3Jvd3MucG9wKCk7CiAgICAgICAgICAgIHRoaXMuaW5zZXJ0SXRlbUluRE9NKF9pMywgYmVmb3JlRWxlbWVudCwgcm93KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvcjQuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvcjQuZigpOwogICAgICB9CiAgICAgIHZhciBfaXRlcmF0b3I1ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIocm93c1RvRGlzcG9zZS52YWx1ZXMoKSksCiAgICAgICAgX3N0ZXA1OwogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yNS5zKCk7ICEoX3N0ZXA1ID0gX2l0ZXJhdG9yNS5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgX3Jvd3MyID0gX3N0ZXA1LnZhbHVlOwogICAgICAgICAgdmFyIF9pdGVyYXRvcjYgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihfcm93czIpLAogICAgICAgICAgICBfc3RlcDY7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBmb3IgKF9pdGVyYXRvcjYucygpOyAhKF9zdGVwNiA9IF9pdGVyYXRvcjYubigpKS5kb25lOykgewogICAgICAgICAgICAgIHZhciBfcm93ID0gX3N0ZXA2LnZhbHVlOwogICAgICAgICAgICAgIHRoaXMuY2FjaGUucmVsZWFzZShfcm93KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgIF9pdGVyYXRvcjYuZShlcnIpOwogICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgX2l0ZXJhdG9yNi5mKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3I1LmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3I1LmYoKTsKICAgICAgfQogICAgICB0aGlzLmV2ZW50dWFsbHlVcGRhdGVTY3JvbGxEaW1lbnNpb25zKCk7CiAgICAgIGlmICh0aGlzLnN1cHBvcnREeW5hbWljSGVpZ2h0cykgewogICAgICAgIHRoaXMuX3JlcmVuZGVyKHRoaXMuc2Nyb2xsVG9wLCB0aGlzLnJlbmRlckhlaWdodCk7CiAgICAgIH0KICAgICAgcmV0dXJuIGRlbGV0ZWQubWFwKGZ1bmN0aW9uIChpKSB7CiAgICAgICAgcmV0dXJuIGkuZWxlbWVudDsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZXZlbnR1YWxseVVwZGF0ZVNjcm9sbERpbWVuc2lvbnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGV2ZW50dWFsbHlVcGRhdGVTY3JvbGxEaW1lbnNpb25zKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKICAgICAgdGhpcy5fc2Nyb2xsSGVpZ2h0ID0gdGhpcy5jb250ZW50SGVpZ2h0OwogICAgICB0aGlzLnJvd3NDb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gIiIuY29uY2F0KHRoaXMuX3Njcm9sbEhlaWdodCwgInB4Iik7CiAgICAgIGlmICghdGhpcy5zY3JvbGxhYmxlRWxlbWVudFVwZGF0ZURpc3Bvc2FibGUpIHsKICAgICAgICB0aGlzLnNjcm9sbGFibGVFbGVtZW50VXBkYXRlRGlzcG9zYWJsZSA9IF9zY2hlZHVsZUF0TmV4dEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzMy5zY3JvbGxhYmxlRWxlbWVudC5zZXRTY3JvbGxEaW1lbnNpb25zKHsKICAgICAgICAgICAgc2Nyb2xsSGVpZ2h0OiBfdGhpczMuc2Nyb2xsSGVpZ2h0CiAgICAgICAgICB9KTsKICAgICAgICAgIF90aGlzMy51cGRhdGVTY3JvbGxXaWR0aCgpOwogICAgICAgICAgX3RoaXMzLnNjcm9sbGFibGVFbGVtZW50VXBkYXRlRGlzcG9zYWJsZSA9IG51bGw7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJldmVudHVhbGx5VXBkYXRlU2Nyb2xsV2lkdGgiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGV2ZW50dWFsbHlVcGRhdGVTY3JvbGxXaWR0aCgpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CiAgICAgIGlmICghdGhpcy5ob3Jpem9udGFsU2Nyb2xsaW5nKSB7CiAgICAgICAgdGhpcy5zY3JvbGxhYmxlRWxlbWVudFdpZHRoRGVsYXllci5jYW5jZWwoKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy5zY3JvbGxhYmxlRWxlbWVudFdpZHRoRGVsYXllci50cmlnZ2VyKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gX3RoaXM0LnVwZGF0ZVNjcm9sbFdpZHRoKCk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInVwZGF0ZVNjcm9sbFdpZHRoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVTY3JvbGxXaWR0aCgpIHsKICAgICAgaWYgKCF0aGlzLmhvcml6b250YWxTY3JvbGxpbmcpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdmFyIHNjcm9sbFdpZHRoID0gMDsKICAgICAgdmFyIF9pdGVyYXRvcjcgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih0aGlzLml0ZW1zKSwKICAgICAgICBfc3RlcDc7CiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3I3LnMoKTsgIShfc3RlcDcgPSBfaXRlcmF0b3I3Lm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciBpdGVtID0gX3N0ZXA3LnZhbHVlOwogICAgICAgICAgaWYgKHR5cGVvZiBpdGVtLndpZHRoICE9PSAndW5kZWZpbmVkJykgewogICAgICAgICAgICBzY3JvbGxXaWR0aCA9IE1hdGgubWF4KHNjcm9sbFdpZHRoLCBpdGVtLndpZHRoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvcjcuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvcjcuZigpOwogICAgICB9CiAgICAgIHRoaXMuc2Nyb2xsV2lkdGggPSBzY3JvbGxXaWR0aDsKICAgICAgdGhpcy5zY3JvbGxhYmxlRWxlbWVudC5zZXRTY3JvbGxEaW1lbnNpb25zKHsKICAgICAgICBzY3JvbGxXaWR0aDogc2Nyb2xsV2lkdGggPT09IDAgPyAwIDogc2Nyb2xsV2lkdGggKyAxMAogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZXJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVyZW5kZXIoKSB7CiAgICAgIGlmICghdGhpcy5zdXBwb3J0RHluYW1pY0hlaWdodHMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdmFyIF9pdGVyYXRvcjggPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih0aGlzLml0ZW1zKSwKICAgICAgICBfc3RlcDg7CiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3I4LnMoKTsgIShfc3RlcDggPSBfaXRlcmF0b3I4Lm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciBpdGVtID0gX3N0ZXA4LnZhbHVlOwogICAgICAgICAgaXRlbS5sYXN0RHluYW1pY0hlaWdodFdpZHRoID0gdW5kZWZpbmVkOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yOC5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yOC5mKCk7CiAgICAgIH0KICAgICAgdGhpcy5fcmVyZW5kZXIodGhpcy5sYXN0UmVuZGVyVG9wLCB0aGlzLmxhc3RSZW5kZXJIZWlnaHQpOwogICAgfQogIH0sIHsKICAgIGtleTogImxlbmd0aCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuaXRlbXMubGVuZ3RoOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlckhlaWdodCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIHNjcm9sbERpbWVuc2lvbnMgPSB0aGlzLnNjcm9sbGFibGVFbGVtZW50LmdldFNjcm9sbERpbWVuc2lvbnMoKTsKICAgICAgcmV0dXJuIHNjcm9sbERpbWVuc2lvbnMuaGVpZ2h0OwogICAgfQogIH0sIHsKICAgIGtleTogImVsZW1lbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGVsZW1lbnQoaW5kZXgpIHsKICAgICAgcmV0dXJuIHRoaXMuaXRlbXNbaW5kZXhdLmVsZW1lbnQ7CiAgICB9CiAgfSwgewogICAga2V5OiAiZG9tRWxlbWVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZG9tRWxlbWVudChpbmRleCkgewogICAgICB2YXIgcm93ID0gdGhpcy5pdGVtc1tpbmRleF0ucm93OwogICAgICByZXR1cm4gcm93ICYmIHJvdy5kb21Ob2RlOwogICAgfQogIH0sIHsKICAgIGtleTogImVsZW1lbnRIZWlnaHQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGVsZW1lbnRIZWlnaHQoaW5kZXgpIHsKICAgICAgcmV0dXJuIHRoaXMuaXRlbXNbaW5kZXhdLnNpemU7CiAgICB9CiAgfSwgewogICAga2V5OiAiZWxlbWVudFRvcCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZWxlbWVudFRvcChpbmRleCkgewogICAgICByZXR1cm4gdGhpcy5yYW5nZU1hcC5wb3NpdGlvbkF0KGluZGV4KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpbmRleEF0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpbmRleEF0KHBvc2l0aW9uKSB7CiAgICAgIHJldHVybiB0aGlzLnJhbmdlTWFwLmluZGV4QXQocG9zaXRpb24pOwogICAgfQogIH0sIHsKICAgIGtleTogImluZGV4QWZ0ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGluZGV4QWZ0ZXIocG9zaXRpb24pIHsKICAgICAgcmV0dXJuIHRoaXMucmFuZ2VNYXAuaW5kZXhBZnRlcihwb3NpdGlvbik7CiAgICB9CiAgfSwgewogICAga2V5OiAibGF5b3V0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBsYXlvdXQoaGVpZ2h0LCB3aWR0aCkgewogICAgICB2YXIgc2Nyb2xsRGltZW5zaW9ucyA9IHsKICAgICAgICBoZWlnaHQ6IHR5cGVvZiBoZWlnaHQgPT09ICdudW1iZXInID8gaGVpZ2h0IDogZ2V0Q29udGVudEhlaWdodCh0aGlzLmRvbU5vZGUpCiAgICAgIH07CiAgICAgIGlmICh0aGlzLnNjcm9sbGFibGVFbGVtZW50VXBkYXRlRGlzcG9zYWJsZSkgewogICAgICAgIHRoaXMuc2Nyb2xsYWJsZUVsZW1lbnRVcGRhdGVEaXNwb3NhYmxlLmRpc3Bvc2UoKTsKICAgICAgICB0aGlzLnNjcm9sbGFibGVFbGVtZW50VXBkYXRlRGlzcG9zYWJsZSA9IG51bGw7CiAgICAgICAgc2Nyb2xsRGltZW5zaW9ucy5zY3JvbGxIZWlnaHQgPSB0aGlzLnNjcm9sbEhlaWdodDsKICAgICAgfQogICAgICB0aGlzLnNjcm9sbGFibGVFbGVtZW50LnNldFNjcm9sbERpbWVuc2lvbnMoc2Nyb2xsRGltZW5zaW9ucyk7CiAgICAgIGlmICh0eXBlb2Ygd2lkdGggIT09ICd1bmRlZmluZWQnKSB7CiAgICAgICAgdGhpcy5yZW5kZXJXaWR0aCA9IHdpZHRoOwogICAgICAgIGlmICh0aGlzLnN1cHBvcnREeW5hbWljSGVpZ2h0cykgewogICAgICAgICAgdGhpcy5fcmVyZW5kZXIodGhpcy5zY3JvbGxUb3AsIHRoaXMucmVuZGVySGVpZ2h0KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHRoaXMuaG9yaXpvbnRhbFNjcm9sbGluZykgewogICAgICAgIHRoaXMuc2Nyb2xsYWJsZUVsZW1lbnQuc2V0U2Nyb2xsRGltZW5zaW9ucyh7CiAgICAgICAgICB3aWR0aDogdHlwZW9mIHdpZHRoID09PSAnbnVtYmVyJyA/IHdpZHRoIDogZ2V0Q29udGVudFdpZHRoKHRoaXMuZG9tTm9kZSkKICAgICAgICB9KTsKICAgICAgfQogICAgfQogICAgLy8gUmVuZGVyCiAgfSwgewogICAga2V5OiAicmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIocHJldmlvdXNSZW5kZXJSYW5nZSwgcmVuZGVyVG9wLCByZW5kZXJIZWlnaHQsIHJlbmRlckxlZnQsIHNjcm9sbFdpZHRoKSB7CiAgICAgIHZhciB1cGRhdGVJdGVtc0luRE9NID0gYXJndW1lbnRzLmxlbmd0aCA+IDUgJiYgYXJndW1lbnRzWzVdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNV0gOiBmYWxzZTsKICAgICAgdmFyIHJlbmRlclJhbmdlID0gdGhpcy5nZXRSZW5kZXJSYW5nZShyZW5kZXJUb3AsIHJlbmRlckhlaWdodCk7CiAgICAgIHZhciByYW5nZXNUb0luc2VydCA9IFJhbmdlLnJlbGF0aXZlQ29tcGxlbWVudChyZW5kZXJSYW5nZSwgcHJldmlvdXNSZW5kZXJSYW5nZSk7CiAgICAgIHZhciByYW5nZXNUb1JlbW92ZSA9IFJhbmdlLnJlbGF0aXZlQ29tcGxlbWVudChwcmV2aW91c1JlbmRlclJhbmdlLCByZW5kZXJSYW5nZSk7CiAgICAgIHZhciBiZWZvcmVFbGVtZW50ID0gdGhpcy5nZXROZXh0VG9MYXN0RWxlbWVudChyYW5nZXNUb0luc2VydCk7CiAgICAgIGlmICh1cGRhdGVJdGVtc0luRE9NKSB7CiAgICAgICAgdmFyIHJhbmdlc1RvVXBkYXRlID0gUmFuZ2UuaW50ZXJzZWN0KHByZXZpb3VzUmVuZGVyUmFuZ2UsIHJlbmRlclJhbmdlKTsKICAgICAgICBmb3IgKHZhciBpID0gcmFuZ2VzVG9VcGRhdGUuc3RhcnQ7IGkgPCByYW5nZXNUb1VwZGF0ZS5lbmQ7IGkrKykgewogICAgICAgICAgdGhpcy51cGRhdGVJdGVtSW5ET00odGhpcy5pdGVtc1tpXSwgaSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHZhciBfaXRlcmF0b3I5ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIocmFuZ2VzVG9JbnNlcnQpLAogICAgICAgIF9zdGVwOTsKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjkucygpOyAhKF9zdGVwOSA9IF9pdGVyYXRvcjkubigpKS5kb25lOykgewogICAgICAgICAgdmFyIHJhbmdlID0gX3N0ZXA5LnZhbHVlOwogICAgICAgICAgZm9yICh2YXIgX2k0ID0gcmFuZ2Uuc3RhcnQ7IF9pNCA8IHJhbmdlLmVuZDsgX2k0KyspIHsKICAgICAgICAgICAgdGhpcy5pbnNlcnRJdGVtSW5ET00oX2k0LCBiZWZvcmVFbGVtZW50KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvcjkuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvcjkuZigpOwogICAgICB9CiAgICAgIHZhciBfaXRlcmF0b3IxMCA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHJhbmdlc1RvUmVtb3ZlKSwKICAgICAgICBfc3RlcDEwOwogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yMTAucygpOyAhKF9zdGVwMTAgPSBfaXRlcmF0b3IxMC5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgX3JhbmdlMiA9IF9zdGVwMTAudmFsdWU7CiAgICAgICAgICBmb3IgKHZhciBfaTUgPSBfcmFuZ2UyLnN0YXJ0OyBfaTUgPCBfcmFuZ2UyLmVuZDsgX2k1KyspIHsKICAgICAgICAgICAgdGhpcy5yZW1vdmVJdGVtRnJvbURPTShfaTUpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yMTAuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvcjEwLmYoKTsKICAgICAgfQogICAgICBpZiAocmVuZGVyTGVmdCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdGhpcy5yb3dzQ29udGFpbmVyLnN0eWxlLmxlZnQgPSAiLSIuY29uY2F0KHJlbmRlckxlZnQsICJweCIpOwogICAgICB9CiAgICAgIHRoaXMucm93c0NvbnRhaW5lci5zdHlsZS50b3AgPSAiLSIuY29uY2F0KHJlbmRlclRvcCwgInB4Iik7CiAgICAgIGlmICh0aGlzLmhvcml6b250YWxTY3JvbGxpbmcgJiYgc2Nyb2xsV2lkdGggIT09IHVuZGVmaW5lZCkgewogICAgICAgIHRoaXMucm93c0NvbnRhaW5lci5zdHlsZS53aWR0aCA9ICIiLmNvbmNhdChNYXRoLm1heChzY3JvbGxXaWR0aCwgdGhpcy5yZW5kZXJXaWR0aCksICJweCIpOwogICAgICB9CiAgICAgIHRoaXMubGFzdFJlbmRlclRvcCA9IHJlbmRlclRvcDsKICAgICAgdGhpcy5sYXN0UmVuZGVySGVpZ2h0ID0gcmVuZGVySGVpZ2h0OwogICAgfQogICAgLy8gRE9NIG9wZXJhdGlvbnMKICB9LCB7CiAgICBrZXk6ICJpbnNlcnRJdGVtSW5ET00iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGluc2VydEl0ZW1JbkRPTShpbmRleCwgYmVmb3JlRWxlbWVudCwgcm93KSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwogICAgICB2YXIgaXRlbSA9IHRoaXMuaXRlbXNbaW5kZXhdOwogICAgICBpZiAoIWl0ZW0ucm93KSB7CiAgICAgICAgaXRlbS5yb3cgPSByb3cgIT09IG51bGwgJiYgcm93ICE9PSB2b2lkIDAgPyByb3cgOiB0aGlzLmNhY2hlLmFsbG9jKGl0ZW0udGVtcGxhdGVJZCk7CiAgICAgIH0KICAgICAgdmFyIHJvbGUgPSB0aGlzLmFjY2Vzc2liaWxpdHlQcm92aWRlci5nZXRSb2xlKGl0ZW0uZWxlbWVudCkgfHwgJ2xpc3RpdGVtJzsKICAgICAgaXRlbS5yb3cuZG9tTm9kZS5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCByb2xlKTsKICAgICAgdmFyIGNoZWNrZWQgPSB0aGlzLmFjY2Vzc2liaWxpdHlQcm92aWRlci5pc0NoZWNrZWQoaXRlbS5lbGVtZW50KTsKICAgICAgaWYgKHR5cGVvZiBjaGVja2VkID09PSAnYm9vbGVhbicpIHsKICAgICAgICBpdGVtLnJvdy5kb21Ob2RlLnNldEF0dHJpYnV0ZSgnYXJpYS1jaGVja2VkJywgU3RyaW5nKCEhY2hlY2tlZCkpOwogICAgICB9IGVsc2UgaWYgKGNoZWNrZWQpIHsKICAgICAgICB2YXIgdXBkYXRlID0gZnVuY3Rpb24gdXBkYXRlKGNoZWNrZWQpIHsKICAgICAgICAgIHJldHVybiBpdGVtLnJvdy5kb21Ob2RlLnNldEF0dHJpYnV0ZSgnYXJpYS1jaGVja2VkJywgU3RyaW5nKCEhY2hlY2tlZCkpOwogICAgICAgIH07CiAgICAgICAgdXBkYXRlKGNoZWNrZWQudmFsdWUpOwogICAgICAgIGl0ZW0uY2hlY2tlZERpc3Bvc2FibGUgPSBjaGVja2VkLm9uRGlkQ2hhbmdlKHVwZGF0ZSk7CiAgICAgIH0KICAgICAgaWYgKCFpdGVtLnJvdy5kb21Ob2RlLnBhcmVudEVsZW1lbnQpIHsKICAgICAgICBpZiAoYmVmb3JlRWxlbWVudCkgewogICAgICAgICAgdGhpcy5yb3dzQ29udGFpbmVyLmluc2VydEJlZm9yZShpdGVtLnJvdy5kb21Ob2RlLCBiZWZvcmVFbGVtZW50KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5yb3dzQ29udGFpbmVyLmFwcGVuZENoaWxkKGl0ZW0ucm93LmRvbU5vZGUpOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLnVwZGF0ZUl0ZW1JbkRPTShpdGVtLCBpbmRleCk7CiAgICAgIHZhciByZW5kZXJlciA9IHRoaXMucmVuZGVyZXJzLmdldChpdGVtLnRlbXBsYXRlSWQpOwogICAgICBpZiAoIXJlbmRlcmVyKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJObyByZW5kZXJlciBmb3VuZCBmb3IgdGVtcGxhdGUgaWQgIi5jb25jYXQoaXRlbS50ZW1wbGF0ZUlkKSk7CiAgICAgIH0KICAgICAgcmVuZGVyZXIgPT09IG51bGwgfHwgcmVuZGVyZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHJlbmRlcmVyLnJlbmRlckVsZW1lbnQoaXRlbS5lbGVtZW50LCBpbmRleCwgaXRlbS5yb3cudGVtcGxhdGVEYXRhLCBpdGVtLnNpemUpOwogICAgICB2YXIgdXJpID0gdGhpcy5kbmQuZ2V0RHJhZ1VSSShpdGVtLmVsZW1lbnQpOwogICAgICBpdGVtLmRyYWdTdGFydERpc3Bvc2FibGUuZGlzcG9zZSgpOwogICAgICBpdGVtLnJvdy5kb21Ob2RlLmRyYWdnYWJsZSA9ICEhdXJpOwogICAgICBpZiAodXJpKSB7CiAgICAgICAgaXRlbS5kcmFnU3RhcnREaXNwb3NhYmxlID0gYWRkRGlzcG9zYWJsZUxpc3RlbmVyKGl0ZW0ucm93LmRvbU5vZGUsICdkcmFnc3RhcnQnLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIHJldHVybiBfdGhpczUub25EcmFnU3RhcnQoaXRlbS5lbGVtZW50LCB1cmksIGV2ZW50KTsKICAgICAgICB9KTsKICAgICAgfQogICAgICBpZiAodGhpcy5ob3Jpem9udGFsU2Nyb2xsaW5nKSB7CiAgICAgICAgdGhpcy5tZWFzdXJlSXRlbVdpZHRoKGl0ZW0pOwogICAgICAgIHRoaXMuZXZlbnR1YWxseVVwZGF0ZVNjcm9sbFdpZHRoKCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJtZWFzdXJlSXRlbVdpZHRoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtZWFzdXJlSXRlbVdpZHRoKGl0ZW0pIHsKICAgICAgaWYgKCFpdGVtLnJvdyB8fCAhaXRlbS5yb3cuZG9tTm9kZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpdGVtLnJvdy5kb21Ob2RlLnN0eWxlLndpZHRoID0gaXNGaXJlZm94ID8gJy1tb3otZml0LWNvbnRlbnQnIDogJ2ZpdC1jb250ZW50JzsKICAgICAgaXRlbS53aWR0aCA9IGdldENvbnRlbnRXaWR0aChpdGVtLnJvdy5kb21Ob2RlKTsKICAgICAgdmFyIHN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoaXRlbS5yb3cuZG9tTm9kZSk7CiAgICAgIGlmIChzdHlsZS5wYWRkaW5nTGVmdCkgewogICAgICAgIGl0ZW0ud2lkdGggKz0gcGFyc2VGbG9hdChzdHlsZS5wYWRkaW5nTGVmdCk7CiAgICAgIH0KICAgICAgaWYgKHN0eWxlLnBhZGRpbmdSaWdodCkgewogICAgICAgIGl0ZW0ud2lkdGggKz0gcGFyc2VGbG9hdChzdHlsZS5wYWRkaW5nUmlnaHQpOwogICAgICB9CiAgICAgIGl0ZW0ucm93LmRvbU5vZGUuc3R5bGUud2lkdGggPSAnJzsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ1cGRhdGVJdGVtSW5ET00iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUl0ZW1JbkRPTShpdGVtLCBpbmRleCkgewogICAgICBpdGVtLnJvdy5kb21Ob2RlLnN0eWxlLnRvcCA9ICIiLmNvbmNhdCh0aGlzLmVsZW1lbnRUb3AoaW5kZXgpLCAicHgiKTsKICAgICAgaWYgKHRoaXMuc2V0Um93SGVpZ2h0KSB7CiAgICAgICAgaXRlbS5yb3cuZG9tTm9kZS5zdHlsZS5oZWlnaHQgPSAiIi5jb25jYXQoaXRlbS5zaXplLCAicHgiKTsKICAgICAgfQogICAgICBpZiAodGhpcy5zZXRSb3dMaW5lSGVpZ2h0KSB7CiAgICAgICAgaXRlbS5yb3cuZG9tTm9kZS5zdHlsZS5saW5lSGVpZ2h0ID0gIiIuY29uY2F0KGl0ZW0uc2l6ZSwgInB4Iik7CiAgICAgIH0KICAgICAgaXRlbS5yb3cuZG9tTm9kZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtaW5kZXgnLCAiIi5jb25jYXQoaW5kZXgpKTsKICAgICAgaXRlbS5yb3cuZG9tTm9kZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtbGFzdC1lbGVtZW50JywgaW5kZXggPT09IHRoaXMubGVuZ3RoIC0gMSA/ICd0cnVlJyA6ICdmYWxzZScpOwogICAgICBpdGVtLnJvdy5kb21Ob2RlLnNldEF0dHJpYnV0ZSgnZGF0YS1wYXJpdHknLCBpbmRleCAlIDIgPT09IDAgPyAnZXZlbicgOiAnb2RkJyk7CiAgICAgIGl0ZW0ucm93LmRvbU5vZGUuc2V0QXR0cmlidXRlKCdhcmlhLXNldHNpemUnLCBTdHJpbmcodGhpcy5hY2Nlc3NpYmlsaXR5UHJvdmlkZXIuZ2V0U2V0U2l6ZShpdGVtLmVsZW1lbnQsIGluZGV4LCB0aGlzLmxlbmd0aCkpKTsKICAgICAgaXRlbS5yb3cuZG9tTm9kZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtcG9zaW5zZXQnLCBTdHJpbmcodGhpcy5hY2Nlc3NpYmlsaXR5UHJvdmlkZXIuZ2V0UG9zSW5TZXQoaXRlbS5lbGVtZW50LCBpbmRleCkpKTsKICAgICAgaXRlbS5yb3cuZG9tTm9kZS5zZXRBdHRyaWJ1dGUoJ2lkJywgdGhpcy5nZXRFbGVtZW50RG9tSWQoaW5kZXgpKTsKICAgICAgaXRlbS5yb3cuZG9tTm9kZS5jbGFzc0xpc3QudG9nZ2xlKCdkcm9wLXRhcmdldCcsIGl0ZW0uZHJvcFRhcmdldCk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVtb3ZlSXRlbUZyb21ET00iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUl0ZW1Gcm9tRE9NKGluZGV4KSB7CiAgICAgIHZhciBpdGVtID0gdGhpcy5pdGVtc1tpbmRleF07CiAgICAgIGl0ZW0uZHJhZ1N0YXJ0RGlzcG9zYWJsZS5kaXNwb3NlKCk7CiAgICAgIGl0ZW0uY2hlY2tlZERpc3Bvc2FibGUuZGlzcG9zZSgpOwogICAgICBpZiAoaXRlbS5yb3cpIHsKICAgICAgICB2YXIgcmVuZGVyZXIgPSB0aGlzLnJlbmRlcmVycy5nZXQoaXRlbS50ZW1wbGF0ZUlkKTsKICAgICAgICBpZiAocmVuZGVyZXIgJiYgcmVuZGVyZXIuZGlzcG9zZUVsZW1lbnQpIHsKICAgICAgICAgIHJlbmRlcmVyLmRpc3Bvc2VFbGVtZW50KGl0ZW0uZWxlbWVudCwgaW5kZXgsIGl0ZW0ucm93LnRlbXBsYXRlRGF0YSwgaXRlbS5zaXplKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5jYWNoZS5yZWxlYXNlKGl0ZW0ucm93KTsKICAgICAgICBpdGVtLnJvdyA9IG51bGw7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuaG9yaXpvbnRhbFNjcm9sbGluZykgewogICAgICAgIHRoaXMuZXZlbnR1YWxseVVwZGF0ZVNjcm9sbFdpZHRoKCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRTY3JvbGxUb3AiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFNjcm9sbFRvcCgpIHsKICAgICAgdmFyIHNjcm9sbFBvc2l0aW9uID0gdGhpcy5zY3JvbGxhYmxlRWxlbWVudC5nZXRTY3JvbGxQb3NpdGlvbigpOwogICAgICByZXR1cm4gc2Nyb2xsUG9zaXRpb24uc2Nyb2xsVG9wOwogICAgfQogIH0sIHsKICAgIGtleTogInNldFNjcm9sbFRvcCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0U2Nyb2xsVG9wKHNjcm9sbFRvcCwgcmV1c2VBbmltYXRpb24pIHsKICAgICAgaWYgKHRoaXMuc2Nyb2xsYWJsZUVsZW1lbnRVcGRhdGVEaXNwb3NhYmxlKSB7CiAgICAgICAgdGhpcy5zY3JvbGxhYmxlRWxlbWVudFVwZGF0ZURpc3Bvc2FibGUuZGlzcG9zZSgpOwogICAgICAgIHRoaXMuc2Nyb2xsYWJsZUVsZW1lbnRVcGRhdGVEaXNwb3NhYmxlID0gbnVsbDsKICAgICAgICB0aGlzLnNjcm9sbGFibGVFbGVtZW50LnNldFNjcm9sbERpbWVuc2lvbnMoewogICAgICAgICAgc2Nyb2xsSGVpZ2h0OiB0aGlzLnNjcm9sbEhlaWdodAogICAgICAgIH0pOwogICAgICB9CiAgICAgIHRoaXMuc2Nyb2xsYWJsZUVsZW1lbnQuc2V0U2Nyb2xsUG9zaXRpb24oewogICAgICAgIHNjcm9sbFRvcDogc2Nyb2xsVG9wLAogICAgICAgIHJldXNlQW5pbWF0aW9uOiByZXVzZUFuaW1hdGlvbgogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzY3JvbGxUb3AiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLmdldFNjcm9sbFRvcCgpOwogICAgfSwKICAgIHNldDogZnVuY3Rpb24gc2V0KHNjcm9sbFRvcCkgewogICAgICB0aGlzLnNldFNjcm9sbFRvcChzY3JvbGxUb3ApOwogICAgfQogIH0sIHsKICAgIGtleTogInNjcm9sbEhlaWdodCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuX3Njcm9sbEhlaWdodCArICh0aGlzLmhvcml6b250YWxTY3JvbGxpbmcgPyAxMCA6IDApICsgdGhpcy5hZGRpdGlvbmFsU2Nyb2xsSGVpZ2h0OwogICAgfQogICAgLy8gRXZlbnRzCiAgfSwgewogICAga2V5OiAib25Nb3VzZUNsaWNrIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKICAgICAgcmV0dXJuIEV2ZW50Lm1hcCh0aGlzLmRpc3Bvc2FibGVzLmFkZChuZXcgRG9tRW1pdHRlcih0aGlzLmRvbU5vZGUsICdjbGljaycpKS5ldmVudCwgZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gX3RoaXM2LnRvTW91c2VFdmVudChlKTsKICAgICAgfSwgdGhpcy5kaXNwb3NhYmxlcyk7CiAgICB9CiAgfSwgewogICAga2V5OiAib25Nb3VzZURibENsaWNrIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKICAgICAgcmV0dXJuIEV2ZW50Lm1hcCh0aGlzLmRpc3Bvc2FibGVzLmFkZChuZXcgRG9tRW1pdHRlcih0aGlzLmRvbU5vZGUsICdkYmxjbGljaycpKS5ldmVudCwgZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gX3RoaXM3LnRvTW91c2VFdmVudChlKTsKICAgICAgfSwgdGhpcy5kaXNwb3NhYmxlcyk7CiAgICB9CiAgfSwgewogICAga2V5OiAib25Nb3VzZU1pZGRsZUNsaWNrIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKICAgICAgcmV0dXJuIEV2ZW50LmZpbHRlcihFdmVudC5tYXAodGhpcy5kaXNwb3NhYmxlcy5hZGQobmV3IERvbUVtaXR0ZXIodGhpcy5kb21Ob2RlLCAnYXV4Y2xpY2snKSkuZXZlbnQsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIF90aGlzOC50b01vdXNlRXZlbnQoZSk7CiAgICAgIH0sIHRoaXMuZGlzcG9zYWJsZXMpLCBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBlLmJyb3dzZXJFdmVudC5idXR0b24gPT09IDE7CiAgICAgIH0sIHRoaXMuZGlzcG9zYWJsZXMpOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uTW91c2VEb3duIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXM5ID0gdGhpczsKICAgICAgcmV0dXJuIEV2ZW50Lm1hcCh0aGlzLmRpc3Bvc2FibGVzLmFkZChuZXcgRG9tRW1pdHRlcih0aGlzLmRvbU5vZGUsICdtb3VzZWRvd24nKSkuZXZlbnQsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIF90aGlzOS50b01vdXNlRXZlbnQoZSk7CiAgICAgIH0sIHRoaXMuZGlzcG9zYWJsZXMpOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uTW91c2VPdmVyIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7CiAgICAgIHJldHVybiBFdmVudC5tYXAodGhpcy5kaXNwb3NhYmxlcy5hZGQobmV3IERvbUVtaXR0ZXIodGhpcy5kb21Ob2RlLCAnbW91c2VvdmVyJykpLmV2ZW50LCBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBfdGhpczEwLnRvTW91c2VFdmVudChlKTsKICAgICAgfSwgdGhpcy5kaXNwb3NhYmxlcyk7CiAgICB9CiAgfSwgewogICAga2V5OiAib25Db250ZXh0TWVudSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIF90aGlzMTEgPSB0aGlzOwogICAgICByZXR1cm4gRXZlbnQuYW55KEV2ZW50Lm1hcCh0aGlzLmRpc3Bvc2FibGVzLmFkZChuZXcgRG9tRW1pdHRlcih0aGlzLmRvbU5vZGUsICdjb250ZXh0bWVudScpKS5ldmVudCwgZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gX3RoaXMxMS50b01vdXNlRXZlbnQoZSk7CiAgICAgIH0sIHRoaXMuZGlzcG9zYWJsZXMpLCBFdmVudC5tYXAodGhpcy5kaXNwb3NhYmxlcy5hZGQobmV3IERvbUVtaXR0ZXIodGhpcy5kb21Ob2RlLCBUb3VjaEV2ZW50VHlwZS5Db250ZXh0bWVudSkpLmV2ZW50LCBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBfdGhpczExLnRvR2VzdHVyZUV2ZW50KGUpOwogICAgICB9LCB0aGlzLmRpc3Bvc2FibGVzKSk7CiAgICB9CiAgfSwgewogICAga2V5OiAib25Ub3VjaFN0YXJ0IiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXMxMiA9IHRoaXM7CiAgICAgIHJldHVybiBFdmVudC5tYXAodGhpcy5kaXNwb3NhYmxlcy5hZGQobmV3IERvbUVtaXR0ZXIodGhpcy5kb21Ob2RlLCAndG91Y2hzdGFydCcpKS5ldmVudCwgZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gX3RoaXMxMi50b1RvdWNoRXZlbnQoZSk7CiAgICAgIH0sIHRoaXMuZGlzcG9zYWJsZXMpOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uVGFwIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXMxMyA9IHRoaXM7CiAgICAgIHJldHVybiBFdmVudC5tYXAodGhpcy5kaXNwb3NhYmxlcy5hZGQobmV3IERvbUVtaXR0ZXIodGhpcy5yb3dzQ29udGFpbmVyLCBUb3VjaEV2ZW50VHlwZS5UYXApKS5ldmVudCwgZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gX3RoaXMxMy50b0dlc3R1cmVFdmVudChlKTsKICAgICAgfSwgdGhpcy5kaXNwb3NhYmxlcyk7CiAgICB9CiAgfSwgewogICAga2V5OiAidG9Nb3VzZUV2ZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiB0b01vdXNlRXZlbnQoYnJvd3NlckV2ZW50KSB7CiAgICAgIHZhciBpbmRleCA9IHRoaXMuZ2V0SXRlbUluZGV4RnJvbUV2ZW50VGFyZ2V0KGJyb3dzZXJFdmVudC50YXJnZXQgfHwgbnVsbCk7CiAgICAgIHZhciBpdGVtID0gdHlwZW9mIGluZGV4ID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IHRoaXMuaXRlbXNbaW5kZXhdOwogICAgICB2YXIgZWxlbWVudCA9IGl0ZW0gJiYgaXRlbS5lbGVtZW50OwogICAgICByZXR1cm4gewogICAgICAgIGJyb3dzZXJFdmVudDogYnJvd3NlckV2ZW50LAogICAgICAgIGluZGV4OiBpbmRleCwKICAgICAgICBlbGVtZW50OiBlbGVtZW50CiAgICAgIH07CiAgICB9CiAgfSwgewogICAga2V5OiAidG9Ub3VjaEV2ZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiB0b1RvdWNoRXZlbnQoYnJvd3NlckV2ZW50KSB7CiAgICAgIHZhciBpbmRleCA9IHRoaXMuZ2V0SXRlbUluZGV4RnJvbUV2ZW50VGFyZ2V0KGJyb3dzZXJFdmVudC50YXJnZXQgfHwgbnVsbCk7CiAgICAgIHZhciBpdGVtID0gdHlwZW9mIGluZGV4ID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IHRoaXMuaXRlbXNbaW5kZXhdOwogICAgICB2YXIgZWxlbWVudCA9IGl0ZW0gJiYgaXRlbS5lbGVtZW50OwogICAgICByZXR1cm4gewogICAgICAgIGJyb3dzZXJFdmVudDogYnJvd3NlckV2ZW50LAogICAgICAgIGluZGV4OiBpbmRleCwKICAgICAgICBlbGVtZW50OiBlbGVtZW50CiAgICAgIH07CiAgICB9CiAgfSwgewogICAga2V5OiAidG9HZXN0dXJlRXZlbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRvR2VzdHVyZUV2ZW50KGJyb3dzZXJFdmVudCkgewogICAgICB2YXIgaW5kZXggPSB0aGlzLmdldEl0ZW1JbmRleEZyb21FdmVudFRhcmdldChicm93c2VyRXZlbnQuaW5pdGlhbFRhcmdldCB8fCBudWxsKTsKICAgICAgdmFyIGl0ZW0gPSB0eXBlb2YgaW5kZXggPT09ICd1bmRlZmluZWQnID8gdW5kZWZpbmVkIDogdGhpcy5pdGVtc1tpbmRleF07CiAgICAgIHZhciBlbGVtZW50ID0gaXRlbSAmJiBpdGVtLmVsZW1lbnQ7CiAgICAgIHJldHVybiB7CiAgICAgICAgYnJvd3NlckV2ZW50OiBicm93c2VyRXZlbnQsCiAgICAgICAgaW5kZXg6IGluZGV4LAogICAgICAgIGVsZW1lbnQ6IGVsZW1lbnQKICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ0b0RyYWdFdmVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdG9EcmFnRXZlbnQoYnJvd3NlckV2ZW50KSB7CiAgICAgIHZhciBpbmRleCA9IHRoaXMuZ2V0SXRlbUluZGV4RnJvbUV2ZW50VGFyZ2V0KGJyb3dzZXJFdmVudC50YXJnZXQgfHwgbnVsbCk7CiAgICAgIHZhciBpdGVtID0gdHlwZW9mIGluZGV4ID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IHRoaXMuaXRlbXNbaW5kZXhdOwogICAgICB2YXIgZWxlbWVudCA9IGl0ZW0gJiYgaXRlbS5lbGVtZW50OwogICAgICByZXR1cm4gewogICAgICAgIGJyb3dzZXJFdmVudDogYnJvd3NlckV2ZW50LAogICAgICAgIGluZGV4OiBpbmRleCwKICAgICAgICBlbGVtZW50OiBlbGVtZW50CiAgICAgIH07CiAgICB9CiAgfSwgewogICAga2V5OiAib25TY3JvbGwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uU2Nyb2xsKGUpIHsKICAgICAgdHJ5IHsKICAgICAgICB2YXIgcHJldmlvdXNSZW5kZXJSYW5nZSA9IHRoaXMuZ2V0UmVuZGVyUmFuZ2UodGhpcy5sYXN0UmVuZGVyVG9wLCB0aGlzLmxhc3RSZW5kZXJIZWlnaHQpOwogICAgICAgIHRoaXMucmVuZGVyKHByZXZpb3VzUmVuZGVyUmFuZ2UsIGUuc2Nyb2xsVG9wLCBlLmhlaWdodCwgZS5zY3JvbGxMZWZ0LCBlLnNjcm9sbFdpZHRoKTsKICAgICAgICBpZiAodGhpcy5zdXBwb3J0RHluYW1pY0hlaWdodHMpIHsKICAgICAgICAgIHRoaXMuX3JlcmVuZGVyKGUuc2Nyb2xsVG9wLCBlLmhlaWdodCwgZS5pblNtb290aFNjcm9sbGluZyk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCdHb3QgYmFkIHNjcm9sbCBldmVudDonLCBlKTsKICAgICAgICB0aHJvdyBlcnI7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJvblRvdWNoQ2hhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvblRvdWNoQ2hhbmdlKGV2ZW50KSB7CiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgICB0aGlzLnNjcm9sbFRvcCAtPSBldmVudC50cmFuc2xhdGlvblk7CiAgICB9CiAgICAvLyBETkQKICB9LCB7CiAgICBrZXk6ICJvbkRyYWdTdGFydCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25EcmFnU3RhcnQoZWxlbWVudCwgdXJpLCBldmVudCkgewogICAgICB2YXIgX2EsIF9iOwogICAgICBpZiAoIWV2ZW50LmRhdGFUcmFuc2ZlcikgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB2YXIgZWxlbWVudHMgPSB0aGlzLmRuZC5nZXREcmFnRWxlbWVudHMoZWxlbWVudCk7CiAgICAgIGV2ZW50LmRhdGFUcmFuc2Zlci5lZmZlY3RBbGxvd2VkID0gJ2NvcHlNb3ZlJzsKICAgICAgZXZlbnQuZGF0YVRyYW5zZmVyLnNldERhdGEoRGF0YVRyYW5zZmVycy5URVhULCB1cmkpOwogICAgICBpZiAoZXZlbnQuZGF0YVRyYW5zZmVyLnNldERyYWdJbWFnZSkgewogICAgICAgIHZhciBsYWJlbDsKICAgICAgICBpZiAodGhpcy5kbmQuZ2V0RHJhZ0xhYmVsKSB7CiAgICAgICAgICBsYWJlbCA9IHRoaXMuZG5kLmdldERyYWdMYWJlbChlbGVtZW50cywgZXZlbnQpOwogICAgICAgIH0KICAgICAgICBpZiAodHlwZW9mIGxhYmVsID09PSAndW5kZWZpbmVkJykgewogICAgICAgICAgbGFiZWwgPSBTdHJpbmcoZWxlbWVudHMubGVuZ3RoKTsKICAgICAgICB9CiAgICAgICAgdmFyIGRyYWdJbWFnZSA9ICQoJy5tb25hY28tZHJhZy1pbWFnZScpOwogICAgICAgIGRyYWdJbWFnZS50ZXh0Q29udGVudCA9IGxhYmVsOwogICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZHJhZ0ltYWdlKTsKICAgICAgICBldmVudC5kYXRhVHJhbnNmZXIuc2V0RHJhZ0ltYWdlKGRyYWdJbWFnZSwgLTEwLCAtMTApOwogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZHJhZ0ltYWdlKTsKICAgICAgICB9LCAwKTsKICAgICAgfQogICAgICB0aGlzLmN1cnJlbnREcmFnRGF0YSA9IG5ldyBFbGVtZW50c0RyYWdBbmREcm9wRGF0YShlbGVtZW50cyk7CiAgICAgIFN0YXRpY0RORC5DdXJyZW50RHJhZ0FuZERyb3BEYXRhID0gbmV3IEV4dGVybmFsRWxlbWVudHNEcmFnQW5kRHJvcERhdGEoZWxlbWVudHMpOwogICAgICAoX2IgPSAoX2EgPSB0aGlzLmRuZCkub25EcmFnU3RhcnQpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5jYWxsKF9hLCB0aGlzLmN1cnJlbnREcmFnRGF0YSwgZXZlbnQpOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uRHJhZ092ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uRHJhZ092ZXIoZXZlbnQpIHsKICAgICAgdmFyIF90aGlzMTQgPSB0aGlzOwogICAgICB2YXIgX2E7CiAgICAgIGV2ZW50LmJyb3dzZXJFdmVudC5wcmV2ZW50RGVmYXVsdCgpOyAvLyBuZWVkZWQgc28gdGhhdCB0aGUgZHJvcCBldmVudCBmaXJlcyAoaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjEzMzk5MjQvZHJvcC1ldmVudC1ub3QtZmlyaW5nLWluLWNocm9tZSkKICAgICAgdGhpcy5vbkRyYWdMZWF2ZVRpbWVvdXQuZGlzcG9zZSgpOwogICAgICBpZiAoU3RhdGljRE5ELkN1cnJlbnREcmFnQW5kRHJvcERhdGEgJiYgU3RhdGljRE5ELkN1cnJlbnREcmFnQW5kRHJvcERhdGEuZ2V0RGF0YSgpID09PSAndnNjb2RlLXVpJykgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICB0aGlzLnNldHVwRHJhZ0FuZERyb3BTY3JvbGxUb3BBbmltYXRpb24oZXZlbnQuYnJvd3NlckV2ZW50KTsKICAgICAgaWYgKCFldmVudC5icm93c2VyRXZlbnQuZGF0YVRyYW5zZmVyKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIC8vIERyYWcgb3ZlciBmcm9tIG91dHNpZGUKICAgICAgaWYgKCF0aGlzLmN1cnJlbnREcmFnRGF0YSkgewogICAgICAgIGlmIChTdGF0aWNETkQuQ3VycmVudERyYWdBbmREcm9wRGF0YSkgewogICAgICAgICAgLy8gRHJhZyBvdmVyIGZyb20gYW5vdGhlciBsaXN0CiAgICAgICAgICB0aGlzLmN1cnJlbnREcmFnRGF0YSA9IFN0YXRpY0RORC5DdXJyZW50RHJhZ0FuZERyb3BEYXRhOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBEcmFnIG92ZXIgZnJvbSB0aGUgZGVza3RvcAogICAgICAgICAgaWYgKCFldmVudC5icm93c2VyRXZlbnQuZGF0YVRyYW5zZmVyLnR5cGVzKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuY3VycmVudERyYWdEYXRhID0gbmV3IE5hdGl2ZURyYWdBbmREcm9wRGF0YSgpOwogICAgICAgIH0KICAgICAgfQogICAgICB2YXIgcmVzdWx0ID0gdGhpcy5kbmQub25EcmFnT3Zlcih0aGlzLmN1cnJlbnREcmFnRGF0YSwgZXZlbnQuZWxlbWVudCwgZXZlbnQuaW5kZXgsIGV2ZW50LmJyb3dzZXJFdmVudCk7CiAgICAgIHRoaXMuY2FuRHJvcCA9IHR5cGVvZiByZXN1bHQgPT09ICdib29sZWFuJyA/IHJlc3VsdCA6IHJlc3VsdC5hY2NlcHQ7CiAgICAgIGlmICghdGhpcy5jYW5Ecm9wKSB7CiAgICAgICAgdGhpcy5jdXJyZW50RHJhZ0ZlZWRiYWNrID0gdW5kZWZpbmVkOwogICAgICAgIHRoaXMuY3VycmVudERyYWdGZWVkYmFja0Rpc3Bvc2FibGUuZGlzcG9zZSgpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICBldmVudC5icm93c2VyRXZlbnQuZGF0YVRyYW5zZmVyLmRyb3BFZmZlY3QgPSB0eXBlb2YgcmVzdWx0ICE9PSAnYm9vbGVhbicgJiYgcmVzdWx0LmVmZmVjdCA9PT0gMCAvKiBMaXN0RHJhZ092ZXJFZmZlY3QuQ29weSAqLyA/ICdjb3B5JyA6ICdtb3ZlJzsKICAgICAgdmFyIGZlZWRiYWNrOwogICAgICBpZiAodHlwZW9mIHJlc3VsdCAhPT0gJ2Jvb2xlYW4nICYmIHJlc3VsdC5mZWVkYmFjaykgewogICAgICAgIGZlZWRiYWNrID0gcmVzdWx0LmZlZWRiYWNrOwogICAgICB9IGVsc2UgewogICAgICAgIGlmICh0eXBlb2YgZXZlbnQuaW5kZXggPT09ICd1bmRlZmluZWQnKSB7CiAgICAgICAgICBmZWVkYmFjayA9IFstMV07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZlZWRiYWNrID0gW2V2ZW50LmluZGV4XTsKICAgICAgICB9CiAgICAgIH0KICAgICAgLy8gc2FuaXRpemUgZmVlZGJhY2sgbGlzdAogICAgICBmZWVkYmFjayA9IGRpc3RpbmN0KGZlZWRiYWNrKS5maWx0ZXIoZnVuY3Rpb24gKGkpIHsKICAgICAgICByZXR1cm4gaSA+PSAtMSAmJiBpIDwgX3RoaXMxNC5sZW5ndGg7CiAgICAgIH0pLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICByZXR1cm4gYSAtIGI7CiAgICAgIH0pOwogICAgICBmZWVkYmFjayA9IGZlZWRiYWNrWzBdID09PSAtMSA/IFstMV0gOiBmZWVkYmFjazsKICAgICAgaWYgKGVxdWFsc0RyYWdGZWVkYmFjayh0aGlzLmN1cnJlbnREcmFnRmVlZGJhY2ssIGZlZWRiYWNrKSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICAgIHRoaXMuY3VycmVudERyYWdGZWVkYmFjayA9IGZlZWRiYWNrOwogICAgICB0aGlzLmN1cnJlbnREcmFnRmVlZGJhY2tEaXNwb3NhYmxlLmRpc3Bvc2UoKTsKICAgICAgaWYgKGZlZWRiYWNrWzBdID09PSAtMSkgewogICAgICAgIC8vIGVudGlyZSBsaXN0IGZlZWRiYWNrCiAgICAgICAgdGhpcy5kb21Ob2RlLmNsYXNzTGlzdC5hZGQoJ2Ryb3AtdGFyZ2V0Jyk7CiAgICAgICAgdGhpcy5yb3dzQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2Ryb3AtdGFyZ2V0Jyk7CiAgICAgICAgdGhpcy5jdXJyZW50RHJhZ0ZlZWRiYWNrRGlzcG9zYWJsZSA9IHRvRGlzcG9zYWJsZShmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpczE0LmRvbU5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnZHJvcC10YXJnZXQnKTsKICAgICAgICAgIF90aGlzMTQucm93c0NvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKCdkcm9wLXRhcmdldCcpOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBfaXRlcmF0b3IxMSA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKGZlZWRiYWNrKSwKICAgICAgICAgIF9zdGVwMTE7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGZvciAoX2l0ZXJhdG9yMTEucygpOyAhKF9zdGVwMTEgPSBfaXRlcmF0b3IxMS5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgIHZhciBpbmRleCA9IF9zdGVwMTEudmFsdWU7CiAgICAgICAgICAgIHZhciBpdGVtID0gdGhpcy5pdGVtc1tpbmRleF07CiAgICAgICAgICAgIGl0ZW0uZHJvcFRhcmdldCA9IHRydWU7CiAgICAgICAgICAgIChfYSA9IGl0ZW0ucm93KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZG9tTm9kZS5jbGFzc0xpc3QuYWRkKCdkcm9wLXRhcmdldCcpOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgX2l0ZXJhdG9yMTEuZShlcnIpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBfaXRlcmF0b3IxMS5mKCk7CiAgICAgICAgfQogICAgICAgIHRoaXMuY3VycmVudERyYWdGZWVkYmFja0Rpc3Bvc2FibGUgPSB0b0Rpc3Bvc2FibGUoZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIF9hOwogICAgICAgICAgdmFyIF9pdGVyYXRvcjEyID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoZmVlZGJhY2spLAogICAgICAgICAgICBfc3RlcDEyOwogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZm9yIChfaXRlcmF0b3IxMi5zKCk7ICEoX3N0ZXAxMiA9IF9pdGVyYXRvcjEyLm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgICB2YXIgaW5kZXggPSBfc3RlcDEyLnZhbHVlOwogICAgICAgICAgICAgIHZhciBpdGVtID0gX3RoaXMxNC5pdGVtc1tpbmRleF07CiAgICAgICAgICAgICAgaXRlbS5kcm9wVGFyZ2V0ID0gZmFsc2U7CiAgICAgICAgICAgICAgKF9hID0gaXRlbS5yb3cpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5kb21Ob2RlLmNsYXNzTGlzdC5yZW1vdmUoJ2Ryb3AtdGFyZ2V0Jyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICBfaXRlcmF0b3IxMi5lKGVycik7CiAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBfaXRlcmF0b3IxMi5mKCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfSwgewogICAga2V5OiAib25EcmFnTGVhdmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uRHJhZ0xlYXZlKGV2ZW50KSB7CiAgICAgIHZhciBfdGhpczE1ID0gdGhpczsKICAgICAgdmFyIF9hLCBfYjsKICAgICAgdGhpcy5vbkRyYWdMZWF2ZVRpbWVvdXQuZGlzcG9zZSgpOwogICAgICB0aGlzLm9uRHJhZ0xlYXZlVGltZW91dCA9IGRpc3Bvc2FibGVUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gX3RoaXMxNS5jbGVhckRyYWdPdmVyRmVlZGJhY2soKTsKICAgICAgfSwgMTAwKTsKICAgICAgaWYgKHRoaXMuY3VycmVudERyYWdEYXRhKSB7CiAgICAgICAgKF9iID0gKF9hID0gdGhpcy5kbmQpLm9uRHJhZ0xlYXZlKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuY2FsbChfYSwgdGhpcy5jdXJyZW50RHJhZ0RhdGEsIGV2ZW50LmVsZW1lbnQsIGV2ZW50LmluZGV4LCBldmVudC5icm93c2VyRXZlbnQpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAib25Ecm9wIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkRyb3AoZXZlbnQpIHsKICAgICAgaWYgKCF0aGlzLmNhbkRyb3ApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdmFyIGRyYWdEYXRhID0gdGhpcy5jdXJyZW50RHJhZ0RhdGE7CiAgICAgIHRoaXMudGVhcmRvd25EcmFnQW5kRHJvcFNjcm9sbFRvcEFuaW1hdGlvbigpOwogICAgICB0aGlzLmNsZWFyRHJhZ092ZXJGZWVkYmFjaygpOwogICAgICB0aGlzLmN1cnJlbnREcmFnRGF0YSA9IHVuZGVmaW5lZDsKICAgICAgU3RhdGljRE5ELkN1cnJlbnREcmFnQW5kRHJvcERhdGEgPSB1bmRlZmluZWQ7CiAgICAgIGlmICghZHJhZ0RhdGEgfHwgIWV2ZW50LmJyb3dzZXJFdmVudC5kYXRhVHJhbnNmZXIpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgZXZlbnQuYnJvd3NlckV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIGRyYWdEYXRhLnVwZGF0ZShldmVudC5icm93c2VyRXZlbnQuZGF0YVRyYW5zZmVyKTsKICAgICAgdGhpcy5kbmQuZHJvcChkcmFnRGF0YSwgZXZlbnQuZWxlbWVudCwgZXZlbnQuaW5kZXgsIGV2ZW50LmJyb3dzZXJFdmVudCk7CiAgICB9CiAgfSwgewogICAga2V5OiAib25EcmFnRW5kIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkRyYWdFbmQoZXZlbnQpIHsKICAgICAgdmFyIF9hLCBfYjsKICAgICAgdGhpcy5jYW5Ecm9wID0gZmFsc2U7CiAgICAgIHRoaXMudGVhcmRvd25EcmFnQW5kRHJvcFNjcm9sbFRvcEFuaW1hdGlvbigpOwogICAgICB0aGlzLmNsZWFyRHJhZ092ZXJGZWVkYmFjaygpOwogICAgICB0aGlzLmN1cnJlbnREcmFnRGF0YSA9IHVuZGVmaW5lZDsKICAgICAgU3RhdGljRE5ELkN1cnJlbnREcmFnQW5kRHJvcERhdGEgPSB1bmRlZmluZWQ7CiAgICAgIChfYiA9IChfYSA9IHRoaXMuZG5kKS5vbkRyYWdFbmQpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5jYWxsKF9hLCBldmVudCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY2xlYXJEcmFnT3ZlckZlZWRiYWNrIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhckRyYWdPdmVyRmVlZGJhY2soKSB7CiAgICAgIHRoaXMuY3VycmVudERyYWdGZWVkYmFjayA9IHVuZGVmaW5lZDsKICAgICAgdGhpcy5jdXJyZW50RHJhZ0ZlZWRiYWNrRGlzcG9zYWJsZS5kaXNwb3NlKCk7CiAgICAgIHRoaXMuY3VycmVudERyYWdGZWVkYmFja0Rpc3Bvc2FibGUgPSBEaXNwb3NhYmxlLk5vbmU7CiAgICB9CiAgICAvLyBETkQgc2Nyb2xsIHRvcCBhbmltYXRpb24KICB9LCB7CiAgICBrZXk6ICJzZXR1cERyYWdBbmREcm9wU2Nyb2xsVG9wQW5pbWF0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXR1cERyYWdBbmREcm9wU2Nyb2xsVG9wQW5pbWF0aW9uKGV2ZW50KSB7CiAgICAgIHZhciBfdGhpczE2ID0gdGhpczsKICAgICAgaWYgKCF0aGlzLmRyYWdPdmVyQW5pbWF0aW9uRGlzcG9zYWJsZSkgewogICAgICAgIHZhciB2aWV3VG9wID0gZ2V0VG9wTGVmdE9mZnNldCh0aGlzLmRvbU5vZGUpLnRvcDsKICAgICAgICB0aGlzLmRyYWdPdmVyQW5pbWF0aW9uRGlzcG9zYWJsZSA9IGFuaW1hdGUodGhpcy5hbmltYXRlRHJhZ0FuZERyb3BTY3JvbGxUb3AuYmluZCh0aGlzLCB2aWV3VG9wKSk7CiAgICAgIH0KICAgICAgdGhpcy5kcmFnT3ZlckFuaW1hdGlvblN0b3BEaXNwb3NhYmxlLmRpc3Bvc2UoKTsKICAgICAgdGhpcy5kcmFnT3ZlckFuaW1hdGlvblN0b3BEaXNwb3NhYmxlID0gZGlzcG9zYWJsZVRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIGlmIChfdGhpczE2LmRyYWdPdmVyQW5pbWF0aW9uRGlzcG9zYWJsZSkgewogICAgICAgICAgX3RoaXMxNi5kcmFnT3ZlckFuaW1hdGlvbkRpc3Bvc2FibGUuZGlzcG9zZSgpOwogICAgICAgICAgX3RoaXMxNi5kcmFnT3ZlckFuaW1hdGlvbkRpc3Bvc2FibGUgPSB1bmRlZmluZWQ7CiAgICAgICAgfQogICAgICB9LCAxMDAwKTsKICAgICAgdGhpcy5kcmFnT3Zlck1vdXNlWSA9IGV2ZW50LnBhZ2VZOwogICAgfQogIH0sIHsKICAgIGtleTogImFuaW1hdGVEcmFnQW5kRHJvcFNjcm9sbFRvcCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYW5pbWF0ZURyYWdBbmREcm9wU2Nyb2xsVG9wKHZpZXdUb3ApIHsKICAgICAgaWYgKHRoaXMuZHJhZ092ZXJNb3VzZVkgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB2YXIgZGlmZiA9IHRoaXMuZHJhZ092ZXJNb3VzZVkgLSB2aWV3VG9wOwogICAgICB2YXIgdXBwZXJMaW1pdCA9IHRoaXMucmVuZGVySGVpZ2h0IC0gMzU7CiAgICAgIGlmIChkaWZmIDwgMzUpIHsKICAgICAgICB0aGlzLnNjcm9sbFRvcCArPSBNYXRoLm1heCgtMTQsIE1hdGguZmxvb3IoMC4zICogKGRpZmYgLSAzNSkpKTsKICAgICAgfSBlbHNlIGlmIChkaWZmID4gdXBwZXJMaW1pdCkgewogICAgICAgIHRoaXMuc2Nyb2xsVG9wICs9IE1hdGgubWluKDE0LCBNYXRoLmZsb29yKDAuMyAqIChkaWZmIC0gdXBwZXJMaW1pdCkpKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInRlYXJkb3duRHJhZ0FuZERyb3BTY3JvbGxUb3BBbmltYXRpb24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRlYXJkb3duRHJhZ0FuZERyb3BTY3JvbGxUb3BBbmltYXRpb24oKSB7CiAgICAgIHRoaXMuZHJhZ092ZXJBbmltYXRpb25TdG9wRGlzcG9zYWJsZS5kaXNwb3NlKCk7CiAgICAgIGlmICh0aGlzLmRyYWdPdmVyQW5pbWF0aW9uRGlzcG9zYWJsZSkgewogICAgICAgIHRoaXMuZHJhZ092ZXJBbmltYXRpb25EaXNwb3NhYmxlLmRpc3Bvc2UoKTsKICAgICAgICB0aGlzLmRyYWdPdmVyQW5pbWF0aW9uRGlzcG9zYWJsZSA9IHVuZGVmaW5lZDsKICAgICAgfQogICAgfQogICAgLy8gVXRpbAogIH0sIHsKICAgIGtleTogImdldEl0ZW1JbmRleEZyb21FdmVudFRhcmdldCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0SXRlbUluZGV4RnJvbUV2ZW50VGFyZ2V0KHRhcmdldCkgewogICAgICB2YXIgc2Nyb2xsYWJsZUVsZW1lbnQgPSB0aGlzLnNjcm9sbGFibGVFbGVtZW50LmdldERvbU5vZGUoKTsKICAgICAgdmFyIGVsZW1lbnQgPSB0YXJnZXQ7CiAgICAgIHdoaWxlIChlbGVtZW50IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQgJiYgZWxlbWVudCAhPT0gdGhpcy5yb3dzQ29udGFpbmVyICYmIHNjcm9sbGFibGVFbGVtZW50LmNvbnRhaW5zKGVsZW1lbnQpKSB7CiAgICAgICAgdmFyIHJhd0luZGV4ID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtaW5kZXgnKTsKICAgICAgICBpZiAocmF3SW5kZXgpIHsKICAgICAgICAgIHZhciBpbmRleCA9IE51bWJlcihyYXdJbmRleCk7CiAgICAgICAgICBpZiAoIWlzTmFOKGluZGV4KSkgewogICAgICAgICAgICByZXR1cm4gaW5kZXg7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsZW1lbnQgPSBlbGVtZW50LnBhcmVudEVsZW1lbnQ7CiAgICAgIH0KICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRSZW5kZXJSYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UmVuZGVyUmFuZ2UocmVuZGVyVG9wLCByZW5kZXJIZWlnaHQpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBzdGFydDogdGhpcy5yYW5nZU1hcC5pbmRleEF0KHJlbmRlclRvcCksCiAgICAgICAgZW5kOiB0aGlzLnJhbmdlTWFwLmluZGV4QWZ0ZXIocmVuZGVyVG9wICsgcmVuZGVySGVpZ2h0IC0gMSkKICAgICAgfTsKICAgIH0KICAgIC8qKgogICAgICogR2l2ZW4gYSBzdGFibGUgcmVuZGVyZWQgc3RhdGUsIGNoZWNrcyBldmVyeSByZW5kZXJlZCBlbGVtZW50IHdoZXRoZXIgaXQgbmVlZHMKICAgICAqIHRvIGJlIHByb2JlZCBmb3IgZHluYW1pYyBoZWlnaHQuIEFkanVzdHMgc2Nyb2xsIGhlaWdodCBhbmQgdG9wIGlmIG5lY2Vzc2FyeS4KICAgICAqLwogIH0sIHsKICAgIGtleTogIl9yZXJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlcmVuZGVyKHJlbmRlclRvcCwgcmVuZGVySGVpZ2h0LCBpblNtb290aFNjcm9sbGluZykgewogICAgICB2YXIgcHJldmlvdXNSZW5kZXJSYW5nZSA9IHRoaXMuZ2V0UmVuZGVyUmFuZ2UocmVuZGVyVG9wLCByZW5kZXJIZWlnaHQpOwogICAgICAvLyBMZXQncyByZW1lbWJlciB0aGUgc2Vjb25kIGVsZW1lbnQncyBwb3NpdGlvbiwgdGhpcyBoZWxwcyBpbiBzY3JvbGxpbmcgdXAKICAgICAgLy8gYW5kIHByZXNlcnZpbmcgYSBsaW5lYXIgdXB3YXJkcyBzY3JvbGwgbW92ZW1lbnQKICAgICAgdmFyIGFuY2hvckVsZW1lbnRJbmRleDsKICAgICAgdmFyIGFuY2hvckVsZW1lbnRUb3BEZWx0YTsKICAgICAgaWYgKHJlbmRlclRvcCA9PT0gdGhpcy5lbGVtZW50VG9wKHByZXZpb3VzUmVuZGVyUmFuZ2Uuc3RhcnQpKSB7CiAgICAgICAgYW5jaG9yRWxlbWVudEluZGV4ID0gcHJldmlvdXNSZW5kZXJSYW5nZS5zdGFydDsKICAgICAgICBhbmNob3JFbGVtZW50VG9wRGVsdGEgPSAwOwogICAgICB9IGVsc2UgaWYgKHByZXZpb3VzUmVuZGVyUmFuZ2UuZW5kIC0gcHJldmlvdXNSZW5kZXJSYW5nZS5zdGFydCA+IDEpIHsKICAgICAgICBhbmNob3JFbGVtZW50SW5kZXggPSBwcmV2aW91c1JlbmRlclJhbmdlLnN0YXJ0ICsgMTsKICAgICAgICBhbmNob3JFbGVtZW50VG9wRGVsdGEgPSB0aGlzLmVsZW1lbnRUb3AoYW5jaG9yRWxlbWVudEluZGV4KSAtIHJlbmRlclRvcDsKICAgICAgfQogICAgICB2YXIgaGVpZ2h0RGlmZiA9IDA7CiAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgdmFyIHJlbmRlclJhbmdlID0gdGhpcy5nZXRSZW5kZXJSYW5nZShyZW5kZXJUb3AsIHJlbmRlckhlaWdodCk7CiAgICAgICAgdmFyIGRpZENoYW5nZSA9IGZhbHNlOwogICAgICAgIGZvciAodmFyIGkgPSByZW5kZXJSYW5nZS5zdGFydDsgaSA8IHJlbmRlclJhbmdlLmVuZDsgaSsrKSB7CiAgICAgICAgICB2YXIgZGlmZiA9IHRoaXMucHJvYmVEeW5hbWljSGVpZ2h0KGkpOwogICAgICAgICAgaWYgKGRpZmYgIT09IDApIHsKICAgICAgICAgICAgdGhpcy5yYW5nZU1hcC5zcGxpY2UoaSwgMSwgW3RoaXMuaXRlbXNbaV1dKTsKICAgICAgICAgIH0KICAgICAgICAgIGhlaWdodERpZmYgKz0gZGlmZjsKICAgICAgICAgIGRpZENoYW5nZSA9IGRpZENoYW5nZSB8fCBkaWZmICE9PSAwOwogICAgICAgIH0KICAgICAgICBpZiAoIWRpZENoYW5nZSkgewogICAgICAgICAgaWYgKGhlaWdodERpZmYgIT09IDApIHsKICAgICAgICAgICAgdGhpcy5ldmVudHVhbGx5VXBkYXRlU2Nyb2xsRGltZW5zaW9ucygpOwogICAgICAgICAgfQogICAgICAgICAgdmFyIHVucmVuZGVyUmFuZ2VzID0gUmFuZ2UucmVsYXRpdmVDb21wbGVtZW50KHByZXZpb3VzUmVuZGVyUmFuZ2UsIHJlbmRlclJhbmdlKTsKICAgICAgICAgIHZhciBfaXRlcmF0b3IxMyA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHVucmVuZGVyUmFuZ2VzKSwKICAgICAgICAgICAgX3N0ZXAxMzsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGZvciAoX2l0ZXJhdG9yMTMucygpOyAhKF9zdGVwMTMgPSBfaXRlcmF0b3IxMy5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgICAgdmFyIHJhbmdlID0gX3N0ZXAxMy52YWx1ZTsKICAgICAgICAgICAgICBmb3IgKHZhciBfaTcgPSByYW5nZS5zdGFydDsgX2k3IDwgcmFuZ2UuZW5kOyBfaTcrKykgewogICAgICAgICAgICAgICAgaWYgKHRoaXMuaXRlbXNbX2k3XS5yb3cpIHsKICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVJdGVtRnJvbURPTShfaTcpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgIF9pdGVyYXRvcjEzLmUoZXJyKTsKICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIF9pdGVyYXRvcjEzLmYoKTsKICAgICAgICAgIH0KICAgICAgICAgIHZhciByZW5kZXJSYW5nZXMgPSBSYW5nZS5yZWxhdGl2ZUNvbXBsZW1lbnQocmVuZGVyUmFuZ2UsIHByZXZpb3VzUmVuZGVyUmFuZ2UpOwogICAgICAgICAgdmFyIF9pdGVyYXRvcjE0ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIocmVuZGVyUmFuZ2VzKSwKICAgICAgICAgICAgX3N0ZXAxNDsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGZvciAoX2l0ZXJhdG9yMTQucygpOyAhKF9zdGVwMTQgPSBfaXRlcmF0b3IxNC5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgICAgdmFyIF9yYW5nZTMgPSBfc3RlcDE0LnZhbHVlOwogICAgICAgICAgICAgIGZvciAodmFyIF9pOCA9IF9yYW5nZTMuc3RhcnQ7IF9pOCA8IF9yYW5nZTMuZW5kOyBfaTgrKykgewogICAgICAgICAgICAgICAgdmFyIGFmdGVySW5kZXggPSBfaTggKyAxOwogICAgICAgICAgICAgICAgdmFyIGJlZm9yZVJvdyA9IGFmdGVySW5kZXggPCB0aGlzLml0ZW1zLmxlbmd0aCA/IHRoaXMuaXRlbXNbYWZ0ZXJJbmRleF0ucm93IDogbnVsbDsKICAgICAgICAgICAgICAgIHZhciBiZWZvcmVFbGVtZW50ID0gYmVmb3JlUm93ID8gYmVmb3JlUm93LmRvbU5vZGUgOiBudWxsOwogICAgICAgICAgICAgICAgdGhpcy5pbnNlcnRJdGVtSW5ET00oX2k4LCBiZWZvcmVFbGVtZW50KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICBfaXRlcmF0b3IxNC5lKGVycik7CiAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBfaXRlcmF0b3IxNC5mKCk7CiAgICAgICAgICB9CiAgICAgICAgICBmb3IgKHZhciBfaTYgPSByZW5kZXJSYW5nZS5zdGFydDsgX2k2IDwgcmVuZGVyUmFuZ2UuZW5kOyBfaTYrKykgewogICAgICAgICAgICBpZiAodGhpcy5pdGVtc1tfaTZdLnJvdykgewogICAgICAgICAgICAgIHRoaXMudXBkYXRlSXRlbUluRE9NKHRoaXMuaXRlbXNbX2k2XSwgX2k2KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgaWYgKHR5cGVvZiBhbmNob3JFbGVtZW50SW5kZXggPT09ICdudW1iZXInKSB7CiAgICAgICAgICAgIC8vIFRvIGNvbXB1dGUgYSBkZXN0aW5hdGlvbiBzY3JvbGwgdG9wLCB3ZSBuZWVkIHRvIHRha2UgaW50byBhY2NvdW50IHRoZSBjdXJyZW50IHNtb290aCBzY3JvbGxpbmcKICAgICAgICAgICAgLy8gYW5pbWF0aW9uLCBhbmQgdGhlbiByZXVzZSBpdCB3aXRoIGEgbmV3IHRhcmdldCAodG8gYXZvaWQgcHJvbG9uZ2luZyB0aGUgc2Nyb2xsKQogICAgICAgICAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdC92c2NvZGUvaXNzdWVzLzEwNDE0NAogICAgICAgICAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdC92c2NvZGUvcHVsbC8xMDQyODQKICAgICAgICAgICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9taWNyb3NvZnQvdnNjb2RlL2lzc3Vlcy8xMDc3MDQKICAgICAgICAgICAgdmFyIGRlbHRhU2Nyb2xsVG9wID0gdGhpcy5zY3JvbGxhYmxlLmdldEZ1dHVyZVNjcm9sbFBvc2l0aW9uKCkuc2Nyb2xsVG9wIC0gcmVuZGVyVG9wOwogICAgICAgICAgICB2YXIgbmV3U2Nyb2xsVG9wID0gdGhpcy5lbGVtZW50VG9wKGFuY2hvckVsZW1lbnRJbmRleCkgLSBhbmNob3JFbGVtZW50VG9wRGVsdGEgKyBkZWx0YVNjcm9sbFRvcDsKICAgICAgICAgICAgdGhpcy5zZXRTY3JvbGxUb3AobmV3U2Nyb2xsVG9wLCBpblNtb290aFNjcm9sbGluZyk7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLl9vbkRpZENoYW5nZUNvbnRlbnRIZWlnaHQuZmlyZSh0aGlzLmNvbnRlbnRIZWlnaHQpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInByb2JlRHluYW1pY0hlaWdodCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcHJvYmVEeW5hbWljSGVpZ2h0KGluZGV4KSB7CiAgICAgIHZhciBfYSwgX2IsIF9jOwogICAgICB2YXIgaXRlbSA9IHRoaXMuaXRlbXNbaW5kZXhdOwogICAgICBpZiAoISF0aGlzLnZpcnR1YWxEZWxlZ2F0ZS5nZXREeW5hbWljSGVpZ2h0KSB7CiAgICAgICAgdmFyIG5ld1NpemUgPSB0aGlzLnZpcnR1YWxEZWxlZ2F0ZS5nZXREeW5hbWljSGVpZ2h0KGl0ZW0uZWxlbWVudCk7CiAgICAgICAgaWYgKG5ld1NpemUgIT09IG51bGwpIHsKICAgICAgICAgIHZhciBfc2l6ZSA9IGl0ZW0uc2l6ZTsKICAgICAgICAgIGl0ZW0uc2l6ZSA9IG5ld1NpemU7CiAgICAgICAgICBpdGVtLmxhc3REeW5hbWljSGVpZ2h0V2lkdGggPSB0aGlzLnJlbmRlcldpZHRoOwogICAgICAgICAgcmV0dXJuIG5ld1NpemUgLSBfc2l6ZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKCFpdGVtLmhhc0R5bmFtaWNIZWlnaHQgfHwgaXRlbS5sYXN0RHluYW1pY0hlaWdodFdpZHRoID09PSB0aGlzLnJlbmRlcldpZHRoKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICAgIH0KICAgICAgaWYgKCEhdGhpcy52aXJ0dWFsRGVsZWdhdGUuaGFzRHluYW1pY0hlaWdodCAmJiAhdGhpcy52aXJ0dWFsRGVsZWdhdGUuaGFzRHluYW1pY0hlaWdodChpdGVtLmVsZW1lbnQpKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICAgIH0KICAgICAgdmFyIHNpemUgPSBpdGVtLnNpemU7CiAgICAgIGlmICghdGhpcy5zZXRSb3dIZWlnaHQgJiYgaXRlbS5yb3cpIHsKICAgICAgICB2YXIgX25ld1NpemUgPSBpdGVtLnJvdy5kb21Ob2RlLm9mZnNldEhlaWdodDsKICAgICAgICBpdGVtLnNpemUgPSBfbmV3U2l6ZTsKICAgICAgICBpdGVtLmxhc3REeW5hbWljSGVpZ2h0V2lkdGggPSB0aGlzLnJlbmRlcldpZHRoOwogICAgICAgIHJldHVybiBfbmV3U2l6ZSAtIHNpemU7CiAgICAgIH0KICAgICAgdmFyIHJvdyA9IHRoaXMuY2FjaGUuYWxsb2MoaXRlbS50ZW1wbGF0ZUlkKTsKICAgICAgcm93LmRvbU5vZGUuc3R5bGUuaGVpZ2h0ID0gJyc7CiAgICAgIHRoaXMucm93c0NvbnRhaW5lci5hcHBlbmRDaGlsZChyb3cuZG9tTm9kZSk7CiAgICAgIHZhciByZW5kZXJlciA9IHRoaXMucmVuZGVyZXJzLmdldChpdGVtLnRlbXBsYXRlSWQpOwogICAgICBpZiAocmVuZGVyZXIpIHsKICAgICAgICByZW5kZXJlci5yZW5kZXJFbGVtZW50KGl0ZW0uZWxlbWVudCwgaW5kZXgsIHJvdy50ZW1wbGF0ZURhdGEsIHVuZGVmaW5lZCk7CiAgICAgICAgKF9hID0gcmVuZGVyZXIuZGlzcG9zZUVsZW1lbnQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5jYWxsKHJlbmRlcmVyLCBpdGVtLmVsZW1lbnQsIGluZGV4LCByb3cudGVtcGxhdGVEYXRhLCB1bmRlZmluZWQpOwogICAgICB9CiAgICAgIGl0ZW0uc2l6ZSA9IHJvdy5kb21Ob2RlLm9mZnNldEhlaWdodDsKICAgICAgKF9jID0gKF9iID0gdGhpcy52aXJ0dWFsRGVsZWdhdGUpLnNldER5bmFtaWNIZWlnaHQpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5jYWxsKF9iLCBpdGVtLmVsZW1lbnQsIGl0ZW0uc2l6ZSk7CiAgICAgIGl0ZW0ubGFzdER5bmFtaWNIZWlnaHRXaWR0aCA9IHRoaXMucmVuZGVyV2lkdGg7CiAgICAgIHRoaXMucm93c0NvbnRhaW5lci5yZW1vdmVDaGlsZChyb3cuZG9tTm9kZSk7CiAgICAgIHRoaXMuY2FjaGUucmVsZWFzZShyb3cpOwogICAgICByZXR1cm4gaXRlbS5zaXplIC0gc2l6ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXROZXh0VG9MYXN0RWxlbWVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TmV4dFRvTGFzdEVsZW1lbnQocmFuZ2VzKSB7CiAgICAgIHZhciBsYXN0UmFuZ2UgPSByYW5nZXNbcmFuZ2VzLmxlbmd0aCAtIDFdOwogICAgICBpZiAoIWxhc3RSYW5nZSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICAgIHZhciBuZXh0VG9MYXN0SXRlbSA9IHRoaXMuaXRlbXNbbGFzdFJhbmdlLmVuZF07CiAgICAgIGlmICghbmV4dFRvTGFzdEl0ZW0pIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgICBpZiAoIW5leHRUb0xhc3RJdGVtLnJvdykgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICAgIHJldHVybiBuZXh0VG9MYXN0SXRlbS5yb3cuZG9tTm9kZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRFbGVtZW50RG9tSWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEVsZW1lbnREb21JZChpbmRleCkgewogICAgICByZXR1cm4gIiIuY29uY2F0KHRoaXMuZG9tSWQsICJfIikuY29uY2F0KGluZGV4KTsKICAgIH0KICAgIC8vIERpc3Bvc2UKICB9LCB7CiAgICBrZXk6ICJkaXNwb3NlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNwb3NlKCkgewogICAgICB2YXIgX2E7CiAgICAgIGlmICh0aGlzLml0ZW1zKSB7CiAgICAgICAgdmFyIF9pdGVyYXRvcjE1ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodGhpcy5pdGVtcyksCiAgICAgICAgICBfc3RlcDE1OwogICAgICAgIHRyeSB7CiAgICAgICAgICBmb3IgKF9pdGVyYXRvcjE1LnMoKTsgIShfc3RlcDE1ID0gX2l0ZXJhdG9yMTUubigpKS5kb25lOykgewogICAgICAgICAgICB2YXIgaXRlbSA9IF9zdGVwMTUudmFsdWU7CiAgICAgICAgICAgIGlmIChpdGVtLnJvdykgewogICAgICAgICAgICAgIHZhciByZW5kZXJlciA9IHRoaXMucmVuZGVyZXJzLmdldChpdGVtLnJvdy50ZW1wbGF0ZUlkKTsKICAgICAgICAgICAgICBpZiAocmVuZGVyZXIpIHsKICAgICAgICAgICAgICAgIChfYSA9IHJlbmRlcmVyLmRpc3Bvc2VFbGVtZW50KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuY2FsbChyZW5kZXJlciwgaXRlbS5lbGVtZW50LCAtMSwgaXRlbS5yb3cudGVtcGxhdGVEYXRhLCB1bmRlZmluZWQpOwogICAgICAgICAgICAgICAgcmVuZGVyZXIuZGlzcG9zZVRlbXBsYXRlKGl0ZW0ucm93LnRlbXBsYXRlRGF0YSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBfaXRlcmF0b3IxNS5lKGVycik7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIF9pdGVyYXRvcjE1LmYoKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5pdGVtcyA9IFtdOwogICAgICB9CiAgICAgIGlmICh0aGlzLmRvbU5vZGUgJiYgdGhpcy5kb21Ob2RlLnBhcmVudE5vZGUpIHsKICAgICAgICB0aGlzLmRvbU5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmRvbU5vZGUpOwogICAgICB9CiAgICAgIF9kaXNwb3NlKHRoaXMuZGlzcG9zYWJsZXMpOwogICAgfQogIH1dKTsKICByZXR1cm4gTGlzdFZpZXc7Cn0oKTsKTGlzdFZpZXcuSW5zdGFuY2VDb3VudCA9IDA7Cl9fZGVjb3JhdGUoW21lbW9pemVdLCBMaXN0Vmlldy5wcm90b3R5cGUsICJvbk1vdXNlQ2xpY2siLCBudWxsKTsKX19kZWNvcmF0ZShbbWVtb2l6ZV0sIExpc3RWaWV3LnByb3RvdHlwZSwgIm9uTW91c2VEYmxDbGljayIsIG51bGwpOwpfX2RlY29yYXRlKFttZW1vaXplXSwgTGlzdFZpZXcucHJvdG90eXBlLCAib25Nb3VzZU1pZGRsZUNsaWNrIiwgbnVsbCk7Cl9fZGVjb3JhdGUoW21lbW9pemVdLCBMaXN0Vmlldy5wcm90b3R5cGUsICJvbk1vdXNlRG93biIsIG51bGwpOwpfX2RlY29yYXRlKFttZW1vaXplXSwgTGlzdFZpZXcucHJvdG90eXBlLCAib25Nb3VzZU92ZXIiLCBudWxsKTsKX19kZWNvcmF0ZShbbWVtb2l6ZV0sIExpc3RWaWV3LnByb3RvdHlwZSwgIm9uQ29udGV4dE1lbnUiLCBudWxsKTsKX19kZWNvcmF0ZShbbWVtb2l6ZV0sIExpc3RWaWV3LnByb3RvdHlwZSwgIm9uVG91Y2hTdGFydCIsIG51bGwpOwpfX2RlY29yYXRlKFttZW1vaXplXSwgTGlzdFZpZXcucHJvdG90eXBlLCAib25UYXAiLCBudWxsKTs="},{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","isFirefox","DataTransfers","StaticDND","$","addDisposableListener","animate","getContentHeight","getContentWidth","getTopLeftOffset","scheduleAtNextAnimationFrame","DomEmitter","EventType","TouchEventType","Gesture","SmoothScrollableElement","distinct","equals","Delayer","disposableTimeout","memoize","Emitter","Event","Disposable","DisposableStore","dispose","toDisposable","Range","Scrollable","RangeMap","shift","RowCache","DefaultOptions","useShadows","verticalScrollMode","setRowLineHeight","setRowHeight","supportDynamicHeights","dnd","getDragElements","e","getDragURI","onDragStart","onDragOver","drop","horizontalScrolling","transformOptimization","alwaysConsumeMouseWheel","ElementsDragAndDropData","elements","ExternalElementsDragAndDropData","NativeDragAndDropData","types","files","dataTransfer","splice","file","item","size","type","push","equalsDragFeedback","f1","f2","Array","isArray","ListViewAccessibilityProvider","accessibilityProvider","getSetSize","bind","l","getPosInSet","getRole","_","isChecked","undefined","ListView","container","virtualDelegate","renderers","options","_a","_b","_c","_d","_e","_f","_g","_h","_j","_k","domId","InstanceCount","Map","renderWidth","_scrollHeight","scrollableElementUpdateDisposable","scrollableElementWidthDelayer","splicing","dragOverAnimationStopDisposable","None","dragOverMouseY","canDrop","currentDragFeedbackDisposable","onDragLeaveTimeout","disposables","_onDidChangeContentHeight","_horizontalScrolling","Error","items","itemId","rangeMap","renderer","set","templateId","cache","add","lastRenderTop","lastRenderHeight","domNode","document","createElement","className","classList","tabIndex","toggle","mouseSupport","additionalScrollHeight","rowsContainer","style","transform","addTarget","scrollable","forceIntegerValues","smoothScrollDuration","smoothScrolling","cb","scrollableElement","horizontal","vertical","mouseWheelScrollSensitivity","fastScrollSensitivity","appendChild","getDomNode","onScroll","Change","onTouchChange","scrollTop","toDragEvent","onDrop","onDragLeave","onDragEnd","layout","value","measureItemWidth","updateScrollWidth","setScrollDimensions","width","Math","max","scrollWidth","cancel","scrollHeight","setSmoothScrollDuration","updateOptions","start","deleteCount","_splice","fire","contentHeight","previousRenderRange","getRenderRange","deleteRange","end","removeRange","intersect","rowsToDispose","dragStartDisposable","checkedDisposable","row","rows","get","disposeElement","element","templateData","previousRestRange","previousRenderedRestRange","previousUnrenderedRestRanges","relativeComplement","inserted","map","id","String","getTemplateId","getHeight","hasDynamicHeight","lastDynamicHeightWidth","uri","dropTarget","deleted","delta","renderRange","renderedRestRange","updateRange","updateItemInDOM","removeRanges","range","removeItemFromDOM","unrenderedRestRanges","elementsRange","insertRanges","beforeElement","getNextToLastElement","pop","insertItemInDOM","values","release","eventuallyUpdateScrollDimensions","_rerender","renderHeight","height","trigger","scrollDimensions","getScrollDimensions","index","positionAt","position","indexAt","indexAfter","renderTop","renderLeft","updateItemsInDOM","rangesToInsert","rangesToRemove","rangesToUpdate","left","top","alloc","role","setAttribute","checked","update","onDidChange","parentElement","insertBefore","renderElement","draggable","event","eventuallyUpdateScrollWidth","window","getComputedStyle","paddingLeft","parseFloat","paddingRight","elementTop","lineHeight","getElementDomId","scrollPosition","getScrollPosition","reuseAnimation","setScrollPosition","getScrollTop","setScrollTop","toMouseEvent","filter","browserEvent","button","any","Contextmenu","toGestureEvent","toTouchEvent","Tap","getItemIndexFromEventTarget","initialTarget","render","scrollLeft","inSmoothScrolling","err","console","error","preventDefault","stopPropagation","translationY","effectAllowed","setData","TEXT","setDragImage","label","getDragLabel","dragImage","textContent","body","setTimeout","removeChild","currentDragData","CurrentDragAndDropData","call","getData","setupDragAndDropScrollTopAnimation","result","accept","currentDragFeedback","dropEffect","effect","feedback","sort","a","b","remove","clearDragOverFeedback","dragData","teardownDragAndDropScrollTopAnimation","dragOverAnimationDisposable","viewTop","animateDragAndDropScrollTop","pageY","diff","upperLimit","floor","min","HTMLElement","contains","rawIndex","getAttribute","Number","isNaN","anchorElementIndex","anchorElementTopDelta","heightDiff","didChange","probeDynamicHeight","unrenderRanges","renderRanges","afterIndex","beforeRow","deltaScrollTop","getFutureScrollPosition","newScrollTop","getDynamicHeight","newSize","offsetHeight","setDynamicHeight","ranges","lastRange","nextToLastItem","disposeTemplate","parentNode","prototype"],"sources":["/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/base/browser/ui/list/listView.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { isFirefox } from '../../browser.js';\nimport { DataTransfers, StaticDND } from '../../dnd.js';\nimport { $, addDisposableListener, animate, getContentHeight, getContentWidth, getTopLeftOffset, scheduleAtNextAnimationFrame } from '../../dom.js';\nimport { DomEmitter } from '../../event.js';\nimport { EventType as TouchEventType, Gesture } from '../../touch.js';\nimport { SmoothScrollableElement } from '../scrollbar/scrollableElement.js';\nimport { distinct, equals } from '../../../common/arrays.js';\nimport { Delayer, disposableTimeout } from '../../../common/async.js';\nimport { memoize } from '../../../common/decorators.js';\nimport { Emitter, Event } from '../../../common/event.js';\nimport { Disposable, DisposableStore, dispose, toDisposable } from '../../../common/lifecycle.js';\nimport { Range } from '../../../common/range.js';\nimport { Scrollable } from '../../../common/scrollable.js';\nimport { RangeMap, shift } from './rangeMap.js';\nimport { RowCache } from './rowCache.js';\nconst DefaultOptions = {\n    useShadows: true,\n    verticalScrollMode: 1 /* ScrollbarVisibility.Auto */,\n    setRowLineHeight: true,\n    setRowHeight: true,\n    supportDynamicHeights: false,\n    dnd: {\n        getDragElements(e) { return [e]; },\n        getDragURI() { return null; },\n        onDragStart() { },\n        onDragOver() { return false; },\n        drop() { }\n    },\n    horizontalScrolling: false,\n    transformOptimization: true,\n    alwaysConsumeMouseWheel: true,\n};\nexport class ElementsDragAndDropData {\n    constructor(elements) {\n        this.elements = elements;\n    }\n    update() { }\n    getData() {\n        return this.elements;\n    }\n}\nexport class ExternalElementsDragAndDropData {\n    constructor(elements) {\n        this.elements = elements;\n    }\n    update() { }\n    getData() {\n        return this.elements;\n    }\n}\nexport class NativeDragAndDropData {\n    constructor() {\n        this.types = [];\n        this.files = [];\n    }\n    update(dataTransfer) {\n        if (dataTransfer.types) {\n            this.types.splice(0, this.types.length, ...dataTransfer.types);\n        }\n        if (dataTransfer.files) {\n            this.files.splice(0, this.files.length);\n            for (let i = 0; i < dataTransfer.files.length; i++) {\n                const file = dataTransfer.files.item(i);\n                if (file && (file.size || file.type)) {\n                    this.files.push(file);\n                }\n            }\n        }\n    }\n    getData() {\n        return {\n            types: this.types,\n            files: this.files\n        };\n    }\n}\nfunction equalsDragFeedback(f1, f2) {\n    if (Array.isArray(f1) && Array.isArray(f2)) {\n        return equals(f1, f2);\n    }\n    return f1 === f2;\n}\nclass ListViewAccessibilityProvider {\n    constructor(accessibilityProvider) {\n        if (accessibilityProvider === null || accessibilityProvider === void 0 ? void 0 : accessibilityProvider.getSetSize) {\n            this.getSetSize = accessibilityProvider.getSetSize.bind(accessibilityProvider);\n        }\n        else {\n            this.getSetSize = (e, i, l) => l;\n        }\n        if (accessibilityProvider === null || accessibilityProvider === void 0 ? void 0 : accessibilityProvider.getPosInSet) {\n            this.getPosInSet = accessibilityProvider.getPosInSet.bind(accessibilityProvider);\n        }\n        else {\n            this.getPosInSet = (e, i) => i + 1;\n        }\n        if (accessibilityProvider === null || accessibilityProvider === void 0 ? void 0 : accessibilityProvider.getRole) {\n            this.getRole = accessibilityProvider.getRole.bind(accessibilityProvider);\n        }\n        else {\n            this.getRole = _ => 'listitem';\n        }\n        if (accessibilityProvider === null || accessibilityProvider === void 0 ? void 0 : accessibilityProvider.isChecked) {\n            this.isChecked = accessibilityProvider.isChecked.bind(accessibilityProvider);\n        }\n        else {\n            this.isChecked = _ => undefined;\n        }\n    }\n}\n/**\n * The {@link ListView} is a virtual scrolling engine.\n *\n * Given that it only renders elements within its viewport, it can hold large\n * collections of elements and stay very performant. The performance bottleneck\n * usually lies within the user's rendering code for each element.\n *\n * @remarks It is a low-level widget, not meant to be used directly. Refer to the\n * List widget instead.\n */\nexport class ListView {\n    constructor(container, virtualDelegate, renderers, options = DefaultOptions) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\n        this.virtualDelegate = virtualDelegate;\n        this.domId = `list_id_${++ListView.InstanceCount}`;\n        this.renderers = new Map();\n        this.renderWidth = 0;\n        this._scrollHeight = 0;\n        this.scrollableElementUpdateDisposable = null;\n        this.scrollableElementWidthDelayer = new Delayer(50);\n        this.splicing = false;\n        this.dragOverAnimationStopDisposable = Disposable.None;\n        this.dragOverMouseY = 0;\n        this.canDrop = false;\n        this.currentDragFeedbackDisposable = Disposable.None;\n        this.onDragLeaveTimeout = Disposable.None;\n        this.disposables = new DisposableStore();\n        this._onDidChangeContentHeight = new Emitter();\n        this._horizontalScrolling = false;\n        if (options.horizontalScrolling && options.supportDynamicHeights) {\n            throw new Error('Horizontal scrolling and dynamic heights not supported simultaneously');\n        }\n        this.items = [];\n        this.itemId = 0;\n        this.rangeMap = new RangeMap();\n        for (const renderer of renderers) {\n            this.renderers.set(renderer.templateId, renderer);\n        }\n        this.cache = this.disposables.add(new RowCache(this.renderers));\n        this.lastRenderTop = 0;\n        this.lastRenderHeight = 0;\n        this.domNode = document.createElement('div');\n        this.domNode.className = 'monaco-list';\n        this.domNode.classList.add(this.domId);\n        this.domNode.tabIndex = 0;\n        this.domNode.classList.toggle('mouse-support', typeof options.mouseSupport === 'boolean' ? options.mouseSupport : true);\n        this._horizontalScrolling = (_a = options.horizontalScrolling) !== null && _a !== void 0 ? _a : DefaultOptions.horizontalScrolling;\n        this.domNode.classList.toggle('horizontal-scrolling', this._horizontalScrolling);\n        this.additionalScrollHeight = typeof options.additionalScrollHeight === 'undefined' ? 0 : options.additionalScrollHeight;\n        this.accessibilityProvider = new ListViewAccessibilityProvider(options.accessibilityProvider);\n        this.rowsContainer = document.createElement('div');\n        this.rowsContainer.className = 'monaco-list-rows';\n        const transformOptimization = (_b = options.transformOptimization) !== null && _b !== void 0 ? _b : DefaultOptions.transformOptimization;\n        if (transformOptimization) {\n            this.rowsContainer.style.transform = 'translate3d(0px, 0px, 0px)';\n        }\n        this.disposables.add(Gesture.addTarget(this.rowsContainer));\n        this.scrollable = new Scrollable({\n            forceIntegerValues: true,\n            smoothScrollDuration: ((_c = options.smoothScrolling) !== null && _c !== void 0 ? _c : false) ? 125 : 0,\n            scheduleAtNextAnimationFrame: cb => scheduleAtNextAnimationFrame(cb)\n        });\n        this.scrollableElement = this.disposables.add(new SmoothScrollableElement(this.rowsContainer, {\n            alwaysConsumeMouseWheel: (_d = options.alwaysConsumeMouseWheel) !== null && _d !== void 0 ? _d : DefaultOptions.alwaysConsumeMouseWheel,\n            horizontal: 1 /* ScrollbarVisibility.Auto */,\n            vertical: (_e = options.verticalScrollMode) !== null && _e !== void 0 ? _e : DefaultOptions.verticalScrollMode,\n            useShadows: (_f = options.useShadows) !== null && _f !== void 0 ? _f : DefaultOptions.useShadows,\n            mouseWheelScrollSensitivity: options.mouseWheelScrollSensitivity,\n            fastScrollSensitivity: options.fastScrollSensitivity\n        }, this.scrollable));\n        this.domNode.appendChild(this.scrollableElement.getDomNode());\n        container.appendChild(this.domNode);\n        this.scrollableElement.onScroll(this.onScroll, this, this.disposables);\n        this.disposables.add(addDisposableListener(this.rowsContainer, TouchEventType.Change, e => this.onTouchChange(e)));\n        // Prevent the monaco-scrollable-element from scrolling\n        // https://github.com/microsoft/vscode/issues/44181\n        this.disposables.add(addDisposableListener(this.scrollableElement.getDomNode(), 'scroll', e => e.target.scrollTop = 0));\n        this.disposables.add(addDisposableListener(this.domNode, 'dragover', e => this.onDragOver(this.toDragEvent(e))));\n        this.disposables.add(addDisposableListener(this.domNode, 'drop', e => this.onDrop(this.toDragEvent(e))));\n        this.disposables.add(addDisposableListener(this.domNode, 'dragleave', e => this.onDragLeave(this.toDragEvent(e))));\n        this.disposables.add(addDisposableListener(this.domNode, 'dragend', e => this.onDragEnd(e)));\n        this.setRowLineHeight = (_g = options.setRowLineHeight) !== null && _g !== void 0 ? _g : DefaultOptions.setRowLineHeight;\n        this.setRowHeight = (_h = options.setRowHeight) !== null && _h !== void 0 ? _h : DefaultOptions.setRowHeight;\n        this.supportDynamicHeights = (_j = options.supportDynamicHeights) !== null && _j !== void 0 ? _j : DefaultOptions.supportDynamicHeights;\n        this.dnd = (_k = options.dnd) !== null && _k !== void 0 ? _k : DefaultOptions.dnd;\n        this.layout();\n    }\n    get contentHeight() { return this.rangeMap.size; }\n    get horizontalScrolling() { return this._horizontalScrolling; }\n    set horizontalScrolling(value) {\n        if (value === this._horizontalScrolling) {\n            return;\n        }\n        if (value && this.supportDynamicHeights) {\n            throw new Error('Horizontal scrolling and dynamic heights not supported simultaneously');\n        }\n        this._horizontalScrolling = value;\n        this.domNode.classList.toggle('horizontal-scrolling', this._horizontalScrolling);\n        if (this._horizontalScrolling) {\n            for (const item of this.items) {\n                this.measureItemWidth(item);\n            }\n            this.updateScrollWidth();\n            this.scrollableElement.setScrollDimensions({ width: getContentWidth(this.domNode) });\n            this.rowsContainer.style.width = `${Math.max(this.scrollWidth || 0, this.renderWidth)}px`;\n        }\n        else {\n            this.scrollableElementWidthDelayer.cancel();\n            this.scrollableElement.setScrollDimensions({ width: this.renderWidth, scrollWidth: this.renderWidth });\n            this.rowsContainer.style.width = '';\n        }\n    }\n    updateOptions(options) {\n        if (options.additionalScrollHeight !== undefined) {\n            this.additionalScrollHeight = options.additionalScrollHeight;\n            this.scrollableElement.setScrollDimensions({ scrollHeight: this.scrollHeight });\n        }\n        if (options.smoothScrolling !== undefined) {\n            this.scrollable.setSmoothScrollDuration(options.smoothScrolling ? 125 : 0);\n        }\n        if (options.horizontalScrolling !== undefined) {\n            this.horizontalScrolling = options.horizontalScrolling;\n        }\n        if (options.mouseWheelScrollSensitivity !== undefined) {\n            this.scrollableElement.updateOptions({ mouseWheelScrollSensitivity: options.mouseWheelScrollSensitivity });\n        }\n        if (options.fastScrollSensitivity !== undefined) {\n            this.scrollableElement.updateOptions({ fastScrollSensitivity: options.fastScrollSensitivity });\n        }\n    }\n    splice(start, deleteCount, elements = []) {\n        if (this.splicing) {\n            throw new Error('Can\\'t run recursive splices.');\n        }\n        this.splicing = true;\n        try {\n            return this._splice(start, deleteCount, elements);\n        }\n        finally {\n            this.splicing = false;\n            this._onDidChangeContentHeight.fire(this.contentHeight);\n        }\n    }\n    _splice(start, deleteCount, elements = []) {\n        const previousRenderRange = this.getRenderRange(this.lastRenderTop, this.lastRenderHeight);\n        const deleteRange = { start, end: start + deleteCount };\n        const removeRange = Range.intersect(previousRenderRange, deleteRange);\n        // try to reuse rows, avoid removing them from DOM\n        const rowsToDispose = new Map();\n        for (let i = removeRange.end - 1; i >= removeRange.start; i--) {\n            const item = this.items[i];\n            item.dragStartDisposable.dispose();\n            item.checkedDisposable.dispose();\n            if (item.row) {\n                let rows = rowsToDispose.get(item.templateId);\n                if (!rows) {\n                    rows = [];\n                    rowsToDispose.set(item.templateId, rows);\n                }\n                const renderer = this.renderers.get(item.templateId);\n                if (renderer && renderer.disposeElement) {\n                    renderer.disposeElement(item.element, i, item.row.templateData, item.size);\n                }\n                rows.push(item.row);\n            }\n            item.row = null;\n        }\n        const previousRestRange = { start: start + deleteCount, end: this.items.length };\n        const previousRenderedRestRange = Range.intersect(previousRestRange, previousRenderRange);\n        const previousUnrenderedRestRanges = Range.relativeComplement(previousRestRange, previousRenderRange);\n        const inserted = elements.map(element => ({\n            id: String(this.itemId++),\n            element,\n            templateId: this.virtualDelegate.getTemplateId(element),\n            size: this.virtualDelegate.getHeight(element),\n            width: undefined,\n            hasDynamicHeight: !!this.virtualDelegate.hasDynamicHeight && this.virtualDelegate.hasDynamicHeight(element),\n            lastDynamicHeightWidth: undefined,\n            row: null,\n            uri: undefined,\n            dropTarget: false,\n            dragStartDisposable: Disposable.None,\n            checkedDisposable: Disposable.None\n        }));\n        let deleted;\n        // TODO@joao: improve this optimization to catch even more cases\n        if (start === 0 && deleteCount >= this.items.length) {\n            this.rangeMap = new RangeMap();\n            this.rangeMap.splice(0, 0, inserted);\n            deleted = this.items;\n            this.items = inserted;\n        }\n        else {\n            this.rangeMap.splice(start, deleteCount, inserted);\n            deleted = this.items.splice(start, deleteCount, ...inserted);\n        }\n        const delta = elements.length - deleteCount;\n        const renderRange = this.getRenderRange(this.lastRenderTop, this.lastRenderHeight);\n        const renderedRestRange = shift(previousRenderedRestRange, delta);\n        const updateRange = Range.intersect(renderRange, renderedRestRange);\n        for (let i = updateRange.start; i < updateRange.end; i++) {\n            this.updateItemInDOM(this.items[i], i);\n        }\n        const removeRanges = Range.relativeComplement(renderedRestRange, renderRange);\n        for (const range of removeRanges) {\n            for (let i = range.start; i < range.end; i++) {\n                this.removeItemFromDOM(i);\n            }\n        }\n        const unrenderedRestRanges = previousUnrenderedRestRanges.map(r => shift(r, delta));\n        const elementsRange = { start, end: start + elements.length };\n        const insertRanges = [elementsRange, ...unrenderedRestRanges].map(r => Range.intersect(renderRange, r));\n        const beforeElement = this.getNextToLastElement(insertRanges);\n        for (const range of insertRanges) {\n            for (let i = range.start; i < range.end; i++) {\n                const item = this.items[i];\n                const rows = rowsToDispose.get(item.templateId);\n                const row = rows === null || rows === void 0 ? void 0 : rows.pop();\n                this.insertItemInDOM(i, beforeElement, row);\n            }\n        }\n        for (const rows of rowsToDispose.values()) {\n            for (const row of rows) {\n                this.cache.release(row);\n            }\n        }\n        this.eventuallyUpdateScrollDimensions();\n        if (this.supportDynamicHeights) {\n            this._rerender(this.scrollTop, this.renderHeight);\n        }\n        return deleted.map(i => i.element);\n    }\n    eventuallyUpdateScrollDimensions() {\n        this._scrollHeight = this.contentHeight;\n        this.rowsContainer.style.height = `${this._scrollHeight}px`;\n        if (!this.scrollableElementUpdateDisposable) {\n            this.scrollableElementUpdateDisposable = scheduleAtNextAnimationFrame(() => {\n                this.scrollableElement.setScrollDimensions({ scrollHeight: this.scrollHeight });\n                this.updateScrollWidth();\n                this.scrollableElementUpdateDisposable = null;\n            });\n        }\n    }\n    eventuallyUpdateScrollWidth() {\n        if (!this.horizontalScrolling) {\n            this.scrollableElementWidthDelayer.cancel();\n            return;\n        }\n        this.scrollableElementWidthDelayer.trigger(() => this.updateScrollWidth());\n    }\n    updateScrollWidth() {\n        if (!this.horizontalScrolling) {\n            return;\n        }\n        let scrollWidth = 0;\n        for (const item of this.items) {\n            if (typeof item.width !== 'undefined') {\n                scrollWidth = Math.max(scrollWidth, item.width);\n            }\n        }\n        this.scrollWidth = scrollWidth;\n        this.scrollableElement.setScrollDimensions({ scrollWidth: scrollWidth === 0 ? 0 : (scrollWidth + 10) });\n    }\n    rerender() {\n        if (!this.supportDynamicHeights) {\n            return;\n        }\n        for (const item of this.items) {\n            item.lastDynamicHeightWidth = undefined;\n        }\n        this._rerender(this.lastRenderTop, this.lastRenderHeight);\n    }\n    get length() {\n        return this.items.length;\n    }\n    get renderHeight() {\n        const scrollDimensions = this.scrollableElement.getScrollDimensions();\n        return scrollDimensions.height;\n    }\n    element(index) {\n        return this.items[index].element;\n    }\n    domElement(index) {\n        const row = this.items[index].row;\n        return row && row.domNode;\n    }\n    elementHeight(index) {\n        return this.items[index].size;\n    }\n    elementTop(index) {\n        return this.rangeMap.positionAt(index);\n    }\n    indexAt(position) {\n        return this.rangeMap.indexAt(position);\n    }\n    indexAfter(position) {\n        return this.rangeMap.indexAfter(position);\n    }\n    layout(height, width) {\n        const scrollDimensions = {\n            height: typeof height === 'number' ? height : getContentHeight(this.domNode)\n        };\n        if (this.scrollableElementUpdateDisposable) {\n            this.scrollableElementUpdateDisposable.dispose();\n            this.scrollableElementUpdateDisposable = null;\n            scrollDimensions.scrollHeight = this.scrollHeight;\n        }\n        this.scrollableElement.setScrollDimensions(scrollDimensions);\n        if (typeof width !== 'undefined') {\n            this.renderWidth = width;\n            if (this.supportDynamicHeights) {\n                this._rerender(this.scrollTop, this.renderHeight);\n            }\n        }\n        if (this.horizontalScrolling) {\n            this.scrollableElement.setScrollDimensions({\n                width: typeof width === 'number' ? width : getContentWidth(this.domNode)\n            });\n        }\n    }\n    // Render\n    render(previousRenderRange, renderTop, renderHeight, renderLeft, scrollWidth, updateItemsInDOM = false) {\n        const renderRange = this.getRenderRange(renderTop, renderHeight);\n        const rangesToInsert = Range.relativeComplement(renderRange, previousRenderRange);\n        const rangesToRemove = Range.relativeComplement(previousRenderRange, renderRange);\n        const beforeElement = this.getNextToLastElement(rangesToInsert);\n        if (updateItemsInDOM) {\n            const rangesToUpdate = Range.intersect(previousRenderRange, renderRange);\n            for (let i = rangesToUpdate.start; i < rangesToUpdate.end; i++) {\n                this.updateItemInDOM(this.items[i], i);\n            }\n        }\n        for (const range of rangesToInsert) {\n            for (let i = range.start; i < range.end; i++) {\n                this.insertItemInDOM(i, beforeElement);\n            }\n        }\n        for (const range of rangesToRemove) {\n            for (let i = range.start; i < range.end; i++) {\n                this.removeItemFromDOM(i);\n            }\n        }\n        if (renderLeft !== undefined) {\n            this.rowsContainer.style.left = `-${renderLeft}px`;\n        }\n        this.rowsContainer.style.top = `-${renderTop}px`;\n        if (this.horizontalScrolling && scrollWidth !== undefined) {\n            this.rowsContainer.style.width = `${Math.max(scrollWidth, this.renderWidth)}px`;\n        }\n        this.lastRenderTop = renderTop;\n        this.lastRenderHeight = renderHeight;\n    }\n    // DOM operations\n    insertItemInDOM(index, beforeElement, row) {\n        const item = this.items[index];\n        if (!item.row) {\n            item.row = row !== null && row !== void 0 ? row : this.cache.alloc(item.templateId);\n        }\n        const role = this.accessibilityProvider.getRole(item.element) || 'listitem';\n        item.row.domNode.setAttribute('role', role);\n        const checked = this.accessibilityProvider.isChecked(item.element);\n        if (typeof checked === 'boolean') {\n            item.row.domNode.setAttribute('aria-checked', String(!!checked));\n        }\n        else if (checked) {\n            const update = (checked) => item.row.domNode.setAttribute('aria-checked', String(!!checked));\n            update(checked.value);\n            item.checkedDisposable = checked.onDidChange(update);\n        }\n        if (!item.row.domNode.parentElement) {\n            if (beforeElement) {\n                this.rowsContainer.insertBefore(item.row.domNode, beforeElement);\n            }\n            else {\n                this.rowsContainer.appendChild(item.row.domNode);\n            }\n        }\n        this.updateItemInDOM(item, index);\n        const renderer = this.renderers.get(item.templateId);\n        if (!renderer) {\n            throw new Error(`No renderer found for template id ${item.templateId}`);\n        }\n        renderer === null || renderer === void 0 ? void 0 : renderer.renderElement(item.element, index, item.row.templateData, item.size);\n        const uri = this.dnd.getDragURI(item.element);\n        item.dragStartDisposable.dispose();\n        item.row.domNode.draggable = !!uri;\n        if (uri) {\n            item.dragStartDisposable = addDisposableListener(item.row.domNode, 'dragstart', event => this.onDragStart(item.element, uri, event));\n        }\n        if (this.horizontalScrolling) {\n            this.measureItemWidth(item);\n            this.eventuallyUpdateScrollWidth();\n        }\n    }\n    measureItemWidth(item) {\n        if (!item.row || !item.row.domNode) {\n            return;\n        }\n        item.row.domNode.style.width = isFirefox ? '-moz-fit-content' : 'fit-content';\n        item.width = getContentWidth(item.row.domNode);\n        const style = window.getComputedStyle(item.row.domNode);\n        if (style.paddingLeft) {\n            item.width += parseFloat(style.paddingLeft);\n        }\n        if (style.paddingRight) {\n            item.width += parseFloat(style.paddingRight);\n        }\n        item.row.domNode.style.width = '';\n    }\n    updateItemInDOM(item, index) {\n        item.row.domNode.style.top = `${this.elementTop(index)}px`;\n        if (this.setRowHeight) {\n            item.row.domNode.style.height = `${item.size}px`;\n        }\n        if (this.setRowLineHeight) {\n            item.row.domNode.style.lineHeight = `${item.size}px`;\n        }\n        item.row.domNode.setAttribute('data-index', `${index}`);\n        item.row.domNode.setAttribute('data-last-element', index === this.length - 1 ? 'true' : 'false');\n        item.row.domNode.setAttribute('data-parity', index % 2 === 0 ? 'even' : 'odd');\n        item.row.domNode.setAttribute('aria-setsize', String(this.accessibilityProvider.getSetSize(item.element, index, this.length)));\n        item.row.domNode.setAttribute('aria-posinset', String(this.accessibilityProvider.getPosInSet(item.element, index)));\n        item.row.domNode.setAttribute('id', this.getElementDomId(index));\n        item.row.domNode.classList.toggle('drop-target', item.dropTarget);\n    }\n    removeItemFromDOM(index) {\n        const item = this.items[index];\n        item.dragStartDisposable.dispose();\n        item.checkedDisposable.dispose();\n        if (item.row) {\n            const renderer = this.renderers.get(item.templateId);\n            if (renderer && renderer.disposeElement) {\n                renderer.disposeElement(item.element, index, item.row.templateData, item.size);\n            }\n            this.cache.release(item.row);\n            item.row = null;\n        }\n        if (this.horizontalScrolling) {\n            this.eventuallyUpdateScrollWidth();\n        }\n    }\n    getScrollTop() {\n        const scrollPosition = this.scrollableElement.getScrollPosition();\n        return scrollPosition.scrollTop;\n    }\n    setScrollTop(scrollTop, reuseAnimation) {\n        if (this.scrollableElementUpdateDisposable) {\n            this.scrollableElementUpdateDisposable.dispose();\n            this.scrollableElementUpdateDisposable = null;\n            this.scrollableElement.setScrollDimensions({ scrollHeight: this.scrollHeight });\n        }\n        this.scrollableElement.setScrollPosition({ scrollTop, reuseAnimation });\n    }\n    get scrollTop() {\n        return this.getScrollTop();\n    }\n    set scrollTop(scrollTop) {\n        this.setScrollTop(scrollTop);\n    }\n    get scrollHeight() {\n        return this._scrollHeight + (this.horizontalScrolling ? 10 : 0) + this.additionalScrollHeight;\n    }\n    // Events\n    get onMouseClick() { return Event.map(this.disposables.add(new DomEmitter(this.domNode, 'click')).event, e => this.toMouseEvent(e), this.disposables); }\n    get onMouseDblClick() { return Event.map(this.disposables.add(new DomEmitter(this.domNode, 'dblclick')).event, e => this.toMouseEvent(e), this.disposables); }\n    get onMouseMiddleClick() { return Event.filter(Event.map(this.disposables.add(new DomEmitter(this.domNode, 'auxclick')).event, e => this.toMouseEvent(e), this.disposables), e => e.browserEvent.button === 1, this.disposables); }\n    get onMouseDown() { return Event.map(this.disposables.add(new DomEmitter(this.domNode, 'mousedown')).event, e => this.toMouseEvent(e), this.disposables); }\n    get onMouseOver() { return Event.map(this.disposables.add(new DomEmitter(this.domNode, 'mouseover')).event, e => this.toMouseEvent(e), this.disposables); }\n    get onContextMenu() { return Event.any(Event.map(this.disposables.add(new DomEmitter(this.domNode, 'contextmenu')).event, e => this.toMouseEvent(e), this.disposables), Event.map(this.disposables.add(new DomEmitter(this.domNode, TouchEventType.Contextmenu)).event, e => this.toGestureEvent(e), this.disposables)); }\n    get onTouchStart() { return Event.map(this.disposables.add(new DomEmitter(this.domNode, 'touchstart')).event, e => this.toTouchEvent(e), this.disposables); }\n    get onTap() { return Event.map(this.disposables.add(new DomEmitter(this.rowsContainer, TouchEventType.Tap)).event, e => this.toGestureEvent(e), this.disposables); }\n    toMouseEvent(browserEvent) {\n        const index = this.getItemIndexFromEventTarget(browserEvent.target || null);\n        const item = typeof index === 'undefined' ? undefined : this.items[index];\n        const element = item && item.element;\n        return { browserEvent, index, element };\n    }\n    toTouchEvent(browserEvent) {\n        const index = this.getItemIndexFromEventTarget(browserEvent.target || null);\n        const item = typeof index === 'undefined' ? undefined : this.items[index];\n        const element = item && item.element;\n        return { browserEvent, index, element };\n    }\n    toGestureEvent(browserEvent) {\n        const index = this.getItemIndexFromEventTarget(browserEvent.initialTarget || null);\n        const item = typeof index === 'undefined' ? undefined : this.items[index];\n        const element = item && item.element;\n        return { browserEvent, index, element };\n    }\n    toDragEvent(browserEvent) {\n        const index = this.getItemIndexFromEventTarget(browserEvent.target || null);\n        const item = typeof index === 'undefined' ? undefined : this.items[index];\n        const element = item && item.element;\n        return { browserEvent, index, element };\n    }\n    onScroll(e) {\n        try {\n            const previousRenderRange = this.getRenderRange(this.lastRenderTop, this.lastRenderHeight);\n            this.render(previousRenderRange, e.scrollTop, e.height, e.scrollLeft, e.scrollWidth);\n            if (this.supportDynamicHeights) {\n                this._rerender(e.scrollTop, e.height, e.inSmoothScrolling);\n            }\n        }\n        catch (err) {\n            console.error('Got bad scroll event:', e);\n            throw err;\n        }\n    }\n    onTouchChange(event) {\n        event.preventDefault();\n        event.stopPropagation();\n        this.scrollTop -= event.translationY;\n    }\n    // DND\n    onDragStart(element, uri, event) {\n        var _a, _b;\n        if (!event.dataTransfer) {\n            return;\n        }\n        const elements = this.dnd.getDragElements(element);\n        event.dataTransfer.effectAllowed = 'copyMove';\n        event.dataTransfer.setData(DataTransfers.TEXT, uri);\n        if (event.dataTransfer.setDragImage) {\n            let label;\n            if (this.dnd.getDragLabel) {\n                label = this.dnd.getDragLabel(elements, event);\n            }\n            if (typeof label === 'undefined') {\n                label = String(elements.length);\n            }\n            const dragImage = $('.monaco-drag-image');\n            dragImage.textContent = label;\n            document.body.appendChild(dragImage);\n            event.dataTransfer.setDragImage(dragImage, -10, -10);\n            setTimeout(() => document.body.removeChild(dragImage), 0);\n        }\n        this.currentDragData = new ElementsDragAndDropData(elements);\n        StaticDND.CurrentDragAndDropData = new ExternalElementsDragAndDropData(elements);\n        (_b = (_a = this.dnd).onDragStart) === null || _b === void 0 ? void 0 : _b.call(_a, this.currentDragData, event);\n    }\n    onDragOver(event) {\n        var _a;\n        event.browserEvent.preventDefault(); // needed so that the drop event fires (https://stackoverflow.com/questions/21339924/drop-event-not-firing-in-chrome)\n        this.onDragLeaveTimeout.dispose();\n        if (StaticDND.CurrentDragAndDropData && StaticDND.CurrentDragAndDropData.getData() === 'vscode-ui') {\n            return false;\n        }\n        this.setupDragAndDropScrollTopAnimation(event.browserEvent);\n        if (!event.browserEvent.dataTransfer) {\n            return false;\n        }\n        // Drag over from outside\n        if (!this.currentDragData) {\n            if (StaticDND.CurrentDragAndDropData) {\n                // Drag over from another list\n                this.currentDragData = StaticDND.CurrentDragAndDropData;\n            }\n            else {\n                // Drag over from the desktop\n                if (!event.browserEvent.dataTransfer.types) {\n                    return false;\n                }\n                this.currentDragData = new NativeDragAndDropData();\n            }\n        }\n        const result = this.dnd.onDragOver(this.currentDragData, event.element, event.index, event.browserEvent);\n        this.canDrop = typeof result === 'boolean' ? result : result.accept;\n        if (!this.canDrop) {\n            this.currentDragFeedback = undefined;\n            this.currentDragFeedbackDisposable.dispose();\n            return false;\n        }\n        event.browserEvent.dataTransfer.dropEffect = (typeof result !== 'boolean' && result.effect === 0 /* ListDragOverEffect.Copy */) ? 'copy' : 'move';\n        let feedback;\n        if (typeof result !== 'boolean' && result.feedback) {\n            feedback = result.feedback;\n        }\n        else {\n            if (typeof event.index === 'undefined') {\n                feedback = [-1];\n            }\n            else {\n                feedback = [event.index];\n            }\n        }\n        // sanitize feedback list\n        feedback = distinct(feedback).filter(i => i >= -1 && i < this.length).sort((a, b) => a - b);\n        feedback = feedback[0] === -1 ? [-1] : feedback;\n        if (equalsDragFeedback(this.currentDragFeedback, feedback)) {\n            return true;\n        }\n        this.currentDragFeedback = feedback;\n        this.currentDragFeedbackDisposable.dispose();\n        if (feedback[0] === -1) { // entire list feedback\n            this.domNode.classList.add('drop-target');\n            this.rowsContainer.classList.add('drop-target');\n            this.currentDragFeedbackDisposable = toDisposable(() => {\n                this.domNode.classList.remove('drop-target');\n                this.rowsContainer.classList.remove('drop-target');\n            });\n        }\n        else {\n            for (const index of feedback) {\n                const item = this.items[index];\n                item.dropTarget = true;\n                (_a = item.row) === null || _a === void 0 ? void 0 : _a.domNode.classList.add('drop-target');\n            }\n            this.currentDragFeedbackDisposable = toDisposable(() => {\n                var _a;\n                for (const index of feedback) {\n                    const item = this.items[index];\n                    item.dropTarget = false;\n                    (_a = item.row) === null || _a === void 0 ? void 0 : _a.domNode.classList.remove('drop-target');\n                }\n            });\n        }\n        return true;\n    }\n    onDragLeave(event) {\n        var _a, _b;\n        this.onDragLeaveTimeout.dispose();\n        this.onDragLeaveTimeout = disposableTimeout(() => this.clearDragOverFeedback(), 100);\n        if (this.currentDragData) {\n            (_b = (_a = this.dnd).onDragLeave) === null || _b === void 0 ? void 0 : _b.call(_a, this.currentDragData, event.element, event.index, event.browserEvent);\n        }\n    }\n    onDrop(event) {\n        if (!this.canDrop) {\n            return;\n        }\n        const dragData = this.currentDragData;\n        this.teardownDragAndDropScrollTopAnimation();\n        this.clearDragOverFeedback();\n        this.currentDragData = undefined;\n        StaticDND.CurrentDragAndDropData = undefined;\n        if (!dragData || !event.browserEvent.dataTransfer) {\n            return;\n        }\n        event.browserEvent.preventDefault();\n        dragData.update(event.browserEvent.dataTransfer);\n        this.dnd.drop(dragData, event.element, event.index, event.browserEvent);\n    }\n    onDragEnd(event) {\n        var _a, _b;\n        this.canDrop = false;\n        this.teardownDragAndDropScrollTopAnimation();\n        this.clearDragOverFeedback();\n        this.currentDragData = undefined;\n        StaticDND.CurrentDragAndDropData = undefined;\n        (_b = (_a = this.dnd).onDragEnd) === null || _b === void 0 ? void 0 : _b.call(_a, event);\n    }\n    clearDragOverFeedback() {\n        this.currentDragFeedback = undefined;\n        this.currentDragFeedbackDisposable.dispose();\n        this.currentDragFeedbackDisposable = Disposable.None;\n    }\n    // DND scroll top animation\n    setupDragAndDropScrollTopAnimation(event) {\n        if (!this.dragOverAnimationDisposable) {\n            const viewTop = getTopLeftOffset(this.domNode).top;\n            this.dragOverAnimationDisposable = animate(this.animateDragAndDropScrollTop.bind(this, viewTop));\n        }\n        this.dragOverAnimationStopDisposable.dispose();\n        this.dragOverAnimationStopDisposable = disposableTimeout(() => {\n            if (this.dragOverAnimationDisposable) {\n                this.dragOverAnimationDisposable.dispose();\n                this.dragOverAnimationDisposable = undefined;\n            }\n        }, 1000);\n        this.dragOverMouseY = event.pageY;\n    }\n    animateDragAndDropScrollTop(viewTop) {\n        if (this.dragOverMouseY === undefined) {\n            return;\n        }\n        const diff = this.dragOverMouseY - viewTop;\n        const upperLimit = this.renderHeight - 35;\n        if (diff < 35) {\n            this.scrollTop += Math.max(-14, Math.floor(0.3 * (diff - 35)));\n        }\n        else if (diff > upperLimit) {\n            this.scrollTop += Math.min(14, Math.floor(0.3 * (diff - upperLimit)));\n        }\n    }\n    teardownDragAndDropScrollTopAnimation() {\n        this.dragOverAnimationStopDisposable.dispose();\n        if (this.dragOverAnimationDisposable) {\n            this.dragOverAnimationDisposable.dispose();\n            this.dragOverAnimationDisposable = undefined;\n        }\n    }\n    // Util\n    getItemIndexFromEventTarget(target) {\n        const scrollableElement = this.scrollableElement.getDomNode();\n        let element = target;\n        while (element instanceof HTMLElement && element !== this.rowsContainer && scrollableElement.contains(element)) {\n            const rawIndex = element.getAttribute('data-index');\n            if (rawIndex) {\n                const index = Number(rawIndex);\n                if (!isNaN(index)) {\n                    return index;\n                }\n            }\n            element = element.parentElement;\n        }\n        return undefined;\n    }\n    getRenderRange(renderTop, renderHeight) {\n        return {\n            start: this.rangeMap.indexAt(renderTop),\n            end: this.rangeMap.indexAfter(renderTop + renderHeight - 1)\n        };\n    }\n    /**\n     * Given a stable rendered state, checks every rendered element whether it needs\n     * to be probed for dynamic height. Adjusts scroll height and top if necessary.\n     */\n    _rerender(renderTop, renderHeight, inSmoothScrolling) {\n        const previousRenderRange = this.getRenderRange(renderTop, renderHeight);\n        // Let's remember the second element's position, this helps in scrolling up\n        // and preserving a linear upwards scroll movement\n        let anchorElementIndex;\n        let anchorElementTopDelta;\n        if (renderTop === this.elementTop(previousRenderRange.start)) {\n            anchorElementIndex = previousRenderRange.start;\n            anchorElementTopDelta = 0;\n        }\n        else if (previousRenderRange.end - previousRenderRange.start > 1) {\n            anchorElementIndex = previousRenderRange.start + 1;\n            anchorElementTopDelta = this.elementTop(anchorElementIndex) - renderTop;\n        }\n        let heightDiff = 0;\n        while (true) {\n            const renderRange = this.getRenderRange(renderTop, renderHeight);\n            let didChange = false;\n            for (let i = renderRange.start; i < renderRange.end; i++) {\n                const diff = this.probeDynamicHeight(i);\n                if (diff !== 0) {\n                    this.rangeMap.splice(i, 1, [this.items[i]]);\n                }\n                heightDiff += diff;\n                didChange = didChange || diff !== 0;\n            }\n            if (!didChange) {\n                if (heightDiff !== 0) {\n                    this.eventuallyUpdateScrollDimensions();\n                }\n                const unrenderRanges = Range.relativeComplement(previousRenderRange, renderRange);\n                for (const range of unrenderRanges) {\n                    for (let i = range.start; i < range.end; i++) {\n                        if (this.items[i].row) {\n                            this.removeItemFromDOM(i);\n                        }\n                    }\n                }\n                const renderRanges = Range.relativeComplement(renderRange, previousRenderRange);\n                for (const range of renderRanges) {\n                    for (let i = range.start; i < range.end; i++) {\n                        const afterIndex = i + 1;\n                        const beforeRow = afterIndex < this.items.length ? this.items[afterIndex].row : null;\n                        const beforeElement = beforeRow ? beforeRow.domNode : null;\n                        this.insertItemInDOM(i, beforeElement);\n                    }\n                }\n                for (let i = renderRange.start; i < renderRange.end; i++) {\n                    if (this.items[i].row) {\n                        this.updateItemInDOM(this.items[i], i);\n                    }\n                }\n                if (typeof anchorElementIndex === 'number') {\n                    // To compute a destination scroll top, we need to take into account the current smooth scrolling\n                    // animation, and then reuse it with a new target (to avoid prolonging the scroll)\n                    // See https://github.com/microsoft/vscode/issues/104144\n                    // See https://github.com/microsoft/vscode/pull/104284\n                    // See https://github.com/microsoft/vscode/issues/107704\n                    const deltaScrollTop = this.scrollable.getFutureScrollPosition().scrollTop - renderTop;\n                    const newScrollTop = this.elementTop(anchorElementIndex) - anchorElementTopDelta + deltaScrollTop;\n                    this.setScrollTop(newScrollTop, inSmoothScrolling);\n                }\n                this._onDidChangeContentHeight.fire(this.contentHeight);\n                return;\n            }\n        }\n    }\n    probeDynamicHeight(index) {\n        var _a, _b, _c;\n        const item = this.items[index];\n        if (!!this.virtualDelegate.getDynamicHeight) {\n            const newSize = this.virtualDelegate.getDynamicHeight(item.element);\n            if (newSize !== null) {\n                const size = item.size;\n                item.size = newSize;\n                item.lastDynamicHeightWidth = this.renderWidth;\n                return newSize - size;\n            }\n        }\n        if (!item.hasDynamicHeight || item.lastDynamicHeightWidth === this.renderWidth) {\n            return 0;\n        }\n        if (!!this.virtualDelegate.hasDynamicHeight && !this.virtualDelegate.hasDynamicHeight(item.element)) {\n            return 0;\n        }\n        const size = item.size;\n        if (!this.setRowHeight && item.row) {\n            const newSize = item.row.domNode.offsetHeight;\n            item.size = newSize;\n            item.lastDynamicHeightWidth = this.renderWidth;\n            return newSize - size;\n        }\n        const row = this.cache.alloc(item.templateId);\n        row.domNode.style.height = '';\n        this.rowsContainer.appendChild(row.domNode);\n        const renderer = this.renderers.get(item.templateId);\n        if (renderer) {\n            renderer.renderElement(item.element, index, row.templateData, undefined);\n            (_a = renderer.disposeElement) === null || _a === void 0 ? void 0 : _a.call(renderer, item.element, index, row.templateData, undefined);\n        }\n        item.size = row.domNode.offsetHeight;\n        (_c = (_b = this.virtualDelegate).setDynamicHeight) === null || _c === void 0 ? void 0 : _c.call(_b, item.element, item.size);\n        item.lastDynamicHeightWidth = this.renderWidth;\n        this.rowsContainer.removeChild(row.domNode);\n        this.cache.release(row);\n        return item.size - size;\n    }\n    getNextToLastElement(ranges) {\n        const lastRange = ranges[ranges.length - 1];\n        if (!lastRange) {\n            return null;\n        }\n        const nextToLastItem = this.items[lastRange.end];\n        if (!nextToLastItem) {\n            return null;\n        }\n        if (!nextToLastItem.row) {\n            return null;\n        }\n        return nextToLastItem.row.domNode;\n    }\n    getElementDomId(index) {\n        return `${this.domId}_${index}`;\n    }\n    // Dispose\n    dispose() {\n        var _a;\n        if (this.items) {\n            for (const item of this.items) {\n                if (item.row) {\n                    const renderer = this.renderers.get(item.row.templateId);\n                    if (renderer) {\n                        (_a = renderer.disposeElement) === null || _a === void 0 ? void 0 : _a.call(renderer, item.element, -1, item.row.templateData, undefined);\n                        renderer.disposeTemplate(item.row.templateData);\n                    }\n                }\n            }\n            this.items = [];\n        }\n        if (this.domNode && this.domNode.parentNode) {\n            this.domNode.parentNode.removeChild(this.domNode);\n        }\n        dispose(this.disposables);\n    }\n}\nListView.InstanceCount = 0;\n__decorate([\n    memoize\n], ListView.prototype, \"onMouseClick\", null);\n__decorate([\n    memoize\n], ListView.prototype, \"onMouseDblClick\", null);\n__decorate([\n    memoize\n], ListView.prototype, \"onMouseMiddleClick\", null);\n__decorate([\n    memoize\n], ListView.prototype, \"onMouseDown\", null);\n__decorate([\n    memoize\n], ListView.prototype, \"onMouseOver\", null);\n__decorate([\n    memoize\n], ListView.prototype, \"onContextMenu\", null);\n__decorate([\n    memoize\n], ListView.prototype, \"onTouchStart\", null);\n__decorate([\n    memoize\n], ListView.prototype, \"onTap\", null);\n"],"mappings":"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"}]}