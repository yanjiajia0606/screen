{"remainingRequest":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/thread-loader/dist/cjs.js!/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js!/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/base/browser/ui/menu/menu.js","dependencies":[{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/base/browser/ui/menu/menu.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/babel.config.js","mtime":1668271197000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICIvVXNlcnMveWFuamlhamlhL0Rlc2t0b3Avd29ya3NwYWNlL2F2dWUtZGF0YS1uZXcvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3RvQ29uc3VtYWJsZUFycmF5LmpzIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvVXNlcnMveWFuamlhamlhL0Rlc2t0b3Avd29ya3NwYWNlL2F2dWUtZGF0YS1uZXcvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrLmpzIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICIvVXNlcnMveWFuamlhamlhL0Rlc2t0b3Avd29ya3NwYWNlL2F2dWUtZGF0YS1uZXcvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzLmpzIjsKaW1wb3J0IF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQuanMiOwppbXBvcnQgX2dldCBmcm9tICIvVXNlcnMveWFuamlhamlhL0Rlc2t0b3Avd29ya3NwYWNlL2F2dWUtZGF0YS1uZXcvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2dldC5qcyI7CmltcG9ydCBfZ2V0UHJvdG90eXBlT2YgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9nZXRQcm90b3R5cGVPZi5qcyI7CmltcG9ydCBfaW5oZXJpdHMgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9pbmhlcml0cy5qcyI7CmltcG9ydCBfY3JlYXRlU3VwZXIgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVTdXBlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnB1c2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zZXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnRyaW0uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nLmpzIjsKLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLgogKiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi4KICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCmltcG9ydCB7IGlzRmlyZWZveCB9IGZyb20gJy4uLy4uL2Jyb3dzZXIuanMnOwppbXBvcnQgeyBFdmVudFR5cGUgYXMgVG91Y2hFdmVudFR5cGUsIEdlc3R1cmUgfSBmcm9tICcuLi8uLi90b3VjaC5qcyc7CmltcG9ydCB7ICQsIGFkZERpc3Bvc2FibGVMaXN0ZW5lciwgYXBwZW5kLCBjbGVhck5vZGUsIGNyZWF0ZVN0eWxlU2hlZXQsIERpbWVuc2lvbiwgRXZlbnRIZWxwZXIsIEV2ZW50VHlwZSwgZ2V0QWN0aXZlRWxlbWVudCwgaXNBbmNlc3RvciwgaXNJblNoYWRvd0RPTSB9IGZyb20gJy4uLy4uL2RvbS5qcyc7CmltcG9ydCB7IFN0YW5kYXJkS2V5Ym9hcmRFdmVudCB9IGZyb20gJy4uLy4uL2tleWJvYXJkRXZlbnQuanMnOwppbXBvcnQgeyBTdGFuZGFyZE1vdXNlRXZlbnQgfSBmcm9tICcuLi8uLi9tb3VzZUV2ZW50LmpzJzsKaW1wb3J0IHsgQWN0aW9uQmFyIH0gZnJvbSAnLi4vYWN0aW9uYmFyL2FjdGlvbmJhci5qcyc7CmltcG9ydCB7IEFjdGlvblZpZXdJdGVtLCBCYXNlQWN0aW9uVmlld0l0ZW0gfSBmcm9tICcuLi9hY3Rpb25iYXIvYWN0aW9uVmlld0l0ZW1zLmpzJzsKaW1wb3J0IHsgZm9ybWF0UnVsZSB9IGZyb20gJy4uL2NvZGljb25zL2NvZGljb25TdHlsZXMuanMnOwppbXBvcnQgeyBsYXlvdXQgfSBmcm9tICcuLi9jb250ZXh0dmlldy9jb250ZXh0dmlldy5qcyc7CmltcG9ydCB7IERvbVNjcm9sbGFibGVFbGVtZW50IH0gZnJvbSAnLi4vc2Nyb2xsYmFyL3Njcm9sbGFibGVFbGVtZW50LmpzJzsKaW1wb3J0IHsgRW1wdHlTdWJtZW51QWN0aW9uLCBTZXBhcmF0b3IsIFN1Ym1lbnVBY3Rpb24gfSBmcm9tICcuLi8uLi8uLi9jb21tb24vYWN0aW9ucy5qcyc7CmltcG9ydCB7IFJ1bk9uY2VTY2hlZHVsZXIgfSBmcm9tICcuLi8uLi8uLi9jb21tb24vYXN5bmMuanMnOwppbXBvcnQgeyBDb2RpY29uIH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL2NvZGljb25zLmpzJzsKaW1wb3J0IHsgc3RyaXBJY29ucyB9IGZyb20gJy4uLy4uLy4uL2NvbW1vbi9pY29uTGFiZWxzLmpzJzsKaW1wb3J0IHsgRGlzcG9zYWJsZVN0b3JlIH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL2xpZmVjeWNsZS5qcyc7CmltcG9ydCB7IGlzTGludXgsIGlzTWFjaW50b3NoIH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL3BsYXRmb3JtLmpzJzsKaW1wb3J0ICogYXMgc3RyaW5ncyBmcm9tICcuLi8uLi8uLi9jb21tb24vc3RyaW5ncy5qcyc7CmV4cG9ydCB2YXIgTUVOVV9NTkVNT05JQ19SRUdFWCA9IC9cKCYoW15ccyZdKVwpfChefFteJl0pJihbXlxzJl0pLzsKZXhwb3J0IHZhciBNRU5VX0VTQ0FQRURfTU5FTU9OSUNfUkVHRVggPSAvKCZhbXA7KT8oJmFtcDspKFteXHMmXSkvZzsKZXhwb3J0IHZhciBEaXJlY3Rpb247CihmdW5jdGlvbiAoRGlyZWN0aW9uKSB7CiAgRGlyZWN0aW9uW0RpcmVjdGlvblsiUmlnaHQiXSA9IDBdID0gIlJpZ2h0IjsKICBEaXJlY3Rpb25bRGlyZWN0aW9uWyJMZWZ0Il0gPSAxXSA9ICJMZWZ0IjsKfSkoRGlyZWN0aW9uIHx8IChEaXJlY3Rpb24gPSB7fSkpOwpleHBvcnQgdmFyIE1lbnUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9BY3Rpb25CYXIpIHsKICBfaW5oZXJpdHMoTWVudSwgX0FjdGlvbkJhcik7CiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihNZW51KTsKICBmdW5jdGlvbiBNZW51KGNvbnRhaW5lciwgYWN0aW9ucykgewogICAgdmFyIF90aGlzOwogICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IHt9OwogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1lbnUpOwogICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ21vbmFjby1tZW51LWNvbnRhaW5lcicpOwogICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZSgncm9sZScsICdwcmVzZW50YXRpb24nKTsKICAgIHZhciBtZW51RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgbWVudUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnbW9uYWNvLW1lbnUnKTsKICAgIG1lbnVFbGVtZW50LnNldEF0dHJpYnV0ZSgncm9sZScsICdwcmVzZW50YXRpb24nKTsKICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgbWVudUVsZW1lbnQsIHsKICAgICAgb3JpZW50YXRpb246IDEgLyogQWN0aW9uc09yaWVudGF0aW9uLlZFUlRJQ0FMICovLAogICAgICBhY3Rpb25WaWV3SXRlbVByb3ZpZGVyOiBmdW5jdGlvbiBhY3Rpb25WaWV3SXRlbVByb3ZpZGVyKGFjdGlvbikgewogICAgICAgIHJldHVybiBfdGhpcy5kb0dldEFjdGlvblZpZXdJdGVtKGFjdGlvbiwgb3B0aW9ucywgcGFyZW50RGF0YSk7CiAgICAgIH0sCiAgICAgIGNvbnRleHQ6IG9wdGlvbnMuY29udGV4dCwKICAgICAgYWN0aW9uUnVubmVyOiBvcHRpb25zLmFjdGlvblJ1bm5lciwKICAgICAgYXJpYUxhYmVsOiBvcHRpb25zLmFyaWFMYWJlbCwKICAgICAgYXJpYVJvbGU6ICdtZW51JywKICAgICAgZm9jdXNPbmx5RW5hYmxlZEl0ZW1zOiB0cnVlLAogICAgICB0cmlnZ2VyS2V5czogewogICAgICAgIGtleXM6IFszIC8qIEtleUNvZGUuRW50ZXIgKi9dLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoaXNNYWNpbnRvc2ggfHwgaXNMaW51eCA/IFsxMCAvKiBLZXlDb2RlLlNwYWNlICovXSA6IFtdKSksCiAgICAgICAga2V5RG93bjogdHJ1ZQogICAgICB9CiAgICB9KTsKICAgIF90aGlzLm1lbnVFbGVtZW50ID0gbWVudUVsZW1lbnQ7CiAgICBfdGhpcy5hY3Rpb25zTGlzdC50YWJJbmRleCA9IDA7CiAgICBfdGhpcy5tZW51RGlzcG9zYWJsZXMgPSBfdGhpcy5fcmVnaXN0ZXIobmV3IERpc3Bvc2FibGVTdG9yZSgpKTsKICAgIF90aGlzLmluaXRpYWxpemVPclVwZGF0ZVN0eWxlU2hlZXQoY29udGFpbmVyLCB7fSk7CiAgICBfdGhpcy5fcmVnaXN0ZXIoR2VzdHVyZS5hZGRUYXJnZXQobWVudUVsZW1lbnQpKTsKICAgIGFkZERpc3Bvc2FibGVMaXN0ZW5lcihtZW51RWxlbWVudCwgRXZlbnRUeXBlLktFWV9ET1dOLCBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgZXZlbnQgPSBuZXcgU3RhbmRhcmRLZXlib2FyZEV2ZW50KGUpOwogICAgICAvLyBTdG9wIHRhYiBuYXZpZ2F0aW9uIG9mIG1lbnVzCiAgICAgIGlmIChldmVudC5lcXVhbHMoMiAvKiBLZXlDb2RlLlRhYiAqLykpIHsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIH0KICAgIH0pOwogICAgaWYgKG9wdGlvbnMuZW5hYmxlTW5lbW9uaWNzKSB7CiAgICAgIF90aGlzLm1lbnVEaXNwb3NhYmxlcy5hZGQoYWRkRGlzcG9zYWJsZUxpc3RlbmVyKG1lbnVFbGVtZW50LCBFdmVudFR5cGUuS0VZX0RPV04sIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgdmFyIGtleSA9IGUua2V5LnRvTG9jYWxlTG93ZXJDYXNlKCk7CiAgICAgICAgaWYgKF90aGlzLm1uZW1vbmljcy5oYXMoa2V5KSkgewogICAgICAgICAgRXZlbnRIZWxwZXIuc3RvcChlLCB0cnVlKTsKICAgICAgICAgIHZhciBfYWN0aW9ucyA9IF90aGlzLm1uZW1vbmljcy5nZXQoa2V5KTsKICAgICAgICAgIGlmIChfYWN0aW9ucy5sZW5ndGggPT09IDEpIHsKICAgICAgICAgICAgaWYgKF9hY3Rpb25zWzBdIGluc3RhbmNlb2YgU3VibWVudU1lbnVBY3Rpb25WaWV3SXRlbSAmJiBfYWN0aW9uc1swXS5jb250YWluZXIpIHsKICAgICAgICAgICAgICBfdGhpcy5mb2N1c0l0ZW1CeUVsZW1lbnQoX2FjdGlvbnNbMF0uY29udGFpbmVyKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBfYWN0aW9uc1swXS5vbkNsaWNrKGUpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKF9hY3Rpb25zLmxlbmd0aCA+IDEpIHsKICAgICAgICAgICAgdmFyIGFjdGlvbiA9IF9hY3Rpb25zLnNoaWZ0KCk7CiAgICAgICAgICAgIGlmIChhY3Rpb24gJiYgYWN0aW9uLmNvbnRhaW5lcikgewogICAgICAgICAgICAgIF90aGlzLmZvY3VzSXRlbUJ5RWxlbWVudChhY3Rpb24uY29udGFpbmVyKTsKICAgICAgICAgICAgICBfYWN0aW9ucy5wdXNoKGFjdGlvbik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX3RoaXMubW5lbW9uaWNzLnNldChrZXksIF9hY3Rpb25zKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pKTsKICAgIH0KICAgIGlmIChpc0xpbnV4KSB7CiAgICAgIF90aGlzLl9yZWdpc3RlcihhZGREaXNwb3NhYmxlTGlzdGVuZXIobWVudUVsZW1lbnQsIEV2ZW50VHlwZS5LRVlfRE9XTiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICB2YXIgZXZlbnQgPSBuZXcgU3RhbmRhcmRLZXlib2FyZEV2ZW50KGUpOwogICAgICAgIGlmIChldmVudC5lcXVhbHMoMTQgLyogS2V5Q29kZS5Ib21lICovKSB8fCBldmVudC5lcXVhbHMoMTEgLyogS2V5Q29kZS5QYWdlVXAgKi8pKSB7CiAgICAgICAgICBfdGhpcy5mb2N1c2VkSXRlbSA9IF90aGlzLnZpZXdJdGVtcy5sZW5ndGggLSAxOwogICAgICAgICAgX3RoaXMuZm9jdXNOZXh0KCk7CiAgICAgICAgICBFdmVudEhlbHBlci5zdG9wKGUsIHRydWUpOwogICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuZXF1YWxzKDEzIC8qIEtleUNvZGUuRW5kICovKSB8fCBldmVudC5lcXVhbHMoMTIgLyogS2V5Q29kZS5QYWdlRG93biAqLykpIHsKICAgICAgICAgIF90aGlzLmZvY3VzZWRJdGVtID0gMDsKICAgICAgICAgIF90aGlzLmZvY3VzUHJldmlvdXMoKTsKICAgICAgICAgIEV2ZW50SGVscGVyLnN0b3AoZSwgdHJ1ZSk7CiAgICAgICAgfQogICAgICB9KSk7CiAgICB9CiAgICBfdGhpcy5fcmVnaXN0ZXIoYWRkRGlzcG9zYWJsZUxpc3RlbmVyKF90aGlzLmRvbU5vZGUsIEV2ZW50VHlwZS5NT1VTRV9PVVQsIGZ1bmN0aW9uIChlKSB7CiAgICAgIHZhciByZWxhdGVkVGFyZ2V0ID0gZS5yZWxhdGVkVGFyZ2V0OwogICAgICBpZiAoIWlzQW5jZXN0b3IocmVsYXRlZFRhcmdldCwgX3RoaXMuZG9tTm9kZSkpIHsKICAgICAgICBfdGhpcy5mb2N1c2VkSXRlbSA9IHVuZGVmaW5lZDsKICAgICAgICBfdGhpcy51cGRhdGVGb2N1cygpOwogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgIH0KICAgIH0pKTsKICAgIF90aGlzLl9yZWdpc3RlcihhZGREaXNwb3NhYmxlTGlzdGVuZXIoX3RoaXMuYWN0aW9uc0xpc3QsIEV2ZW50VHlwZS5NT1VTRV9PVkVSLCBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQ7CiAgICAgIGlmICghdGFyZ2V0IHx8ICFpc0FuY2VzdG9yKHRhcmdldCwgX3RoaXMuYWN0aW9uc0xpc3QpIHx8IHRhcmdldCA9PT0gX3RoaXMuYWN0aW9uc0xpc3QpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgd2hpbGUgKHRhcmdldC5wYXJlbnRFbGVtZW50ICE9PSBfdGhpcy5hY3Rpb25zTGlzdCAmJiB0YXJnZXQucGFyZW50RWxlbWVudCAhPT0gbnVsbCkgewogICAgICAgIHRhcmdldCA9IHRhcmdldC5wYXJlbnRFbGVtZW50OwogICAgICB9CiAgICAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3Rpb24taXRlbScpKSB7CiAgICAgICAgdmFyIGxhc3RGb2N1c2VkSXRlbSA9IF90aGlzLmZvY3VzZWRJdGVtOwogICAgICAgIF90aGlzLnNldEZvY3VzZWRJdGVtKHRhcmdldCk7CiAgICAgICAgaWYgKGxhc3RGb2N1c2VkSXRlbSAhPT0gX3RoaXMuZm9jdXNlZEl0ZW0pIHsKICAgICAgICAgIF90aGlzLnVwZGF0ZUZvY3VzKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9KSk7CiAgICAvLyBTdXBwb3J0IHRvdWNoIG9uIGFjdGlvbnMgbGlzdCB0byBmb2N1cyBpdGVtcyAobmVlZGVkIGZvciBzdWJtZW51cykKICAgIF90aGlzLl9yZWdpc3RlcihHZXN0dXJlLmFkZFRhcmdldChfdGhpcy5hY3Rpb25zTGlzdCkpOwogICAgX3RoaXMuX3JlZ2lzdGVyKGFkZERpc3Bvc2FibGVMaXN0ZW5lcihfdGhpcy5hY3Rpb25zTGlzdCwgVG91Y2hFdmVudFR5cGUuVGFwLCBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgdGFyZ2V0ID0gZS5pbml0aWFsVGFyZ2V0OwogICAgICBpZiAoIXRhcmdldCB8fCAhaXNBbmNlc3Rvcih0YXJnZXQsIF90aGlzLmFjdGlvbnNMaXN0KSB8fCB0YXJnZXQgPT09IF90aGlzLmFjdGlvbnNMaXN0KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHdoaWxlICh0YXJnZXQucGFyZW50RWxlbWVudCAhPT0gX3RoaXMuYWN0aW9uc0xpc3QgJiYgdGFyZ2V0LnBhcmVudEVsZW1lbnQgIT09IG51bGwpIHsKICAgICAgICB0YXJnZXQgPSB0YXJnZXQucGFyZW50RWxlbWVudDsKICAgICAgfQogICAgICBpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnYWN0aW9uLWl0ZW0nKSkgewogICAgICAgIHZhciBsYXN0Rm9jdXNlZEl0ZW0gPSBfdGhpcy5mb2N1c2VkSXRlbTsKICAgICAgICBfdGhpcy5zZXRGb2N1c2VkSXRlbSh0YXJnZXQpOwogICAgICAgIGlmIChsYXN0Rm9jdXNlZEl0ZW0gIT09IF90aGlzLmZvY3VzZWRJdGVtKSB7CiAgICAgICAgICBfdGhpcy51cGRhdGVGb2N1cygpOwogICAgICAgIH0KICAgICAgfQogICAgfSkpOwogICAgdmFyIHBhcmVudERhdGEgPSB7CiAgICAgIHBhcmVudDogX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcykKICAgIH07CiAgICBfdGhpcy5tbmVtb25pY3MgPSBuZXcgTWFwKCk7CiAgICAvLyBTY3JvbGwgTG9naWMKICAgIF90aGlzLnNjcm9sbGFibGVFbGVtZW50ID0gX3RoaXMuX3JlZ2lzdGVyKG5ldyBEb21TY3JvbGxhYmxlRWxlbWVudChtZW51RWxlbWVudCwgewogICAgICBhbHdheXNDb25zdW1lTW91c2VXaGVlbDogdHJ1ZSwKICAgICAgaG9yaXpvbnRhbDogMiAvKiBTY3JvbGxiYXJWaXNpYmlsaXR5LkhpZGRlbiAqLywKICAgICAgdmVydGljYWw6IDMgLyogU2Nyb2xsYmFyVmlzaWJpbGl0eS5WaXNpYmxlICovLAogICAgICB2ZXJ0aWNhbFNjcm9sbGJhclNpemU6IDcsCiAgICAgIGhhbmRsZU1vdXNlV2hlZWw6IHRydWUsCiAgICAgIHVzZVNoYWRvd3M6IHRydWUKICAgIH0pKTsKICAgIHZhciBzY3JvbGxFbGVtZW50ID0gX3RoaXMuc2Nyb2xsYWJsZUVsZW1lbnQuZ2V0RG9tTm9kZSgpOwogICAgc2Nyb2xsRWxlbWVudC5zdHlsZS5wb3NpdGlvbiA9ICcnOwogICAgLy8gU3VwcG9ydCBzY3JvbGwgb24gbWVudSBkcmFnCiAgICBfdGhpcy5fcmVnaXN0ZXIoYWRkRGlzcG9zYWJsZUxpc3RlbmVyKG1lbnVFbGVtZW50LCBUb3VjaEV2ZW50VHlwZS5DaGFuZ2UsIGZ1bmN0aW9uIChlKSB7CiAgICAgIEV2ZW50SGVscGVyLnN0b3AoZSwgdHJ1ZSk7CiAgICAgIHZhciBzY3JvbGxUb3AgPSBfdGhpcy5zY3JvbGxhYmxlRWxlbWVudC5nZXRTY3JvbGxQb3NpdGlvbigpLnNjcm9sbFRvcDsKICAgICAgX3RoaXMuc2Nyb2xsYWJsZUVsZW1lbnQuc2V0U2Nyb2xsUG9zaXRpb24oewogICAgICAgIHNjcm9sbFRvcDogc2Nyb2xsVG9wIC0gZS50cmFuc2xhdGlvblkKICAgICAgfSk7CiAgICB9KSk7CiAgICBfdGhpcy5fcmVnaXN0ZXIoYWRkRGlzcG9zYWJsZUxpc3RlbmVyKHNjcm9sbEVsZW1lbnQsIEV2ZW50VHlwZS5NT1VTRV9VUCwgZnVuY3Rpb24gKGUpIHsKICAgICAgLy8gQWJzb3JiIGNsaWNrcyBpbiBtZW51IGRlYWQgc3BhY2UgaHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdC92c2NvZGUvaXNzdWVzLzYzNTc1CiAgICAgIC8vIFdlIGRvIHRoaXMgb24gdGhlIHNjcm9sbCBlbGVtZW50IHNvIHRoZSBzY3JvbGwgYmFyIGRvZXNuJ3QgZGlzbWlzcyB0aGUgbWVudSBlaXRoZXIKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgfSkpOwogICAgbWVudUVsZW1lbnQuc3R5bGUubWF4SGVpZ2h0ID0gIiIuY29uY2F0KE1hdGgubWF4KDEwLCB3aW5kb3cuaW5uZXJIZWlnaHQgLSBjb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wIC0gMzUpLCAicHgiKTsKICAgIGFjdGlvbnMgPSBhY3Rpb25zLmZpbHRlcihmdW5jdGlvbiAoYSkgewogICAgICB2YXIgX2E7CiAgICAgIGlmICgoX2EgPSBvcHRpb25zLnN1Ym1lbnVJZHMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5oYXMoYS5pZCkpIHsKICAgICAgICBjb25zb2xlLndhcm4oIkZvdW5kIHN1Ym1lbnUgY3ljbGU6ICIuY29uY2F0KGEuaWQpKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgcmV0dXJuIHRydWU7CiAgICB9KTsKICAgIF90aGlzLnB1c2goYWN0aW9ucywgewogICAgICBpY29uOiB0cnVlLAogICAgICBsYWJlbDogdHJ1ZSwKICAgICAgaXNNZW51OiB0cnVlCiAgICB9KTsKICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChfdGhpcy5zY3JvbGxhYmxlRWxlbWVudC5nZXREb21Ob2RlKCkpOwogICAgX3RoaXMuc2Nyb2xsYWJsZUVsZW1lbnQuc2NhbkRvbU5vZGUoKTsKICAgIF90aGlzLnZpZXdJdGVtcy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgcmV0dXJuICEoaXRlbSBpbnN0YW5jZW9mIE1lbnVTZXBhcmF0b3JBY3Rpb25WaWV3SXRlbSk7CiAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpbmRleCwgYXJyYXkpIHsKICAgICAgaXRlbS51cGRhdGVQb3NpdGlvbkluU2V0KGluZGV4ICsgMSwgYXJyYXkubGVuZ3RoKTsKICAgIH0pOwogICAgcmV0dXJuIF90aGlzOwogIH0KICBfY3JlYXRlQ2xhc3MoTWVudSwgW3sKICAgIGtleTogImluaXRpYWxpemVPclVwZGF0ZVN0eWxlU2hlZXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGluaXRpYWxpemVPclVwZGF0ZVN0eWxlU2hlZXQoY29udGFpbmVyLCBzdHlsZSkgewogICAgICBpZiAoIXRoaXMuc3R5bGVTaGVldCkgewogICAgICAgIGlmIChpc0luU2hhZG93RE9NKGNvbnRhaW5lcikpIHsKICAgICAgICAgIHRoaXMuc3R5bGVTaGVldCA9IGNyZWF0ZVN0eWxlU2hlZXQoY29udGFpbmVyKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKCFNZW51Lmdsb2JhbFN0eWxlU2hlZXQpIHsKICAgICAgICAgICAgTWVudS5nbG9iYWxTdHlsZVNoZWV0ID0gY3JlYXRlU3R5bGVTaGVldCgpOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5zdHlsZVNoZWV0ID0gTWVudS5nbG9iYWxTdHlsZVNoZWV0OwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLnN0eWxlU2hlZXQudGV4dENvbnRlbnQgPSBnZXRNZW51V2lkZ2V0Q1NTKHN0eWxlLCBpc0luU2hhZG93RE9NKGNvbnRhaW5lcikpOwogICAgfQogIH0sIHsKICAgIGtleTogInN0eWxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzdHlsZShfc3R5bGUpIHsKICAgICAgdmFyIGNvbnRhaW5lciA9IHRoaXMuZ2V0Q29udGFpbmVyKCk7CiAgICAgIHRoaXMuaW5pdGlhbGl6ZU9yVXBkYXRlU3R5bGVTaGVldChjb250YWluZXIsIF9zdHlsZSk7CiAgICAgIHZhciBmZ0NvbG9yID0gX3N0eWxlLmZvcmVncm91bmRDb2xvciA/ICIiLmNvbmNhdChfc3R5bGUuZm9yZWdyb3VuZENvbG9yKSA6ICcnOwogICAgICB2YXIgYmdDb2xvciA9IF9zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPyAiIi5jb25jYXQoX3N0eWxlLmJhY2tncm91bmRDb2xvcikgOiAnJzsKICAgICAgdmFyIGJvcmRlciA9IF9zdHlsZS5ib3JkZXJDb2xvciA/ICIxcHggc29saWQgIi5jb25jYXQoX3N0eWxlLmJvcmRlckNvbG9yKSA6ICcnOwogICAgICB2YXIgYm9yZGVyUmFkaXVzID0gJzVweCc7CiAgICAgIHZhciBzaGFkb3cgPSBfc3R5bGUuc2hhZG93Q29sb3IgPyAiMCAycHggOHB4ICIuY29uY2F0KF9zdHlsZS5zaGFkb3dDb2xvcikgOiAnJzsKICAgICAgY29udGFpbmVyLnN0eWxlLm91dGxpbmUgPSBib3JkZXI7CiAgICAgIGNvbnRhaW5lci5zdHlsZS5ib3JkZXJSYWRpdXMgPSBib3JkZXJSYWRpdXM7CiAgICAgIGNvbnRhaW5lci5zdHlsZS5jb2xvciA9IGZnQ29sb3I7CiAgICAgIGNvbnRhaW5lci5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBiZ0NvbG9yOwogICAgICBjb250YWluZXIuc3R5bGUuYm94U2hhZG93ID0gc2hhZG93OwogICAgICBpZiAodGhpcy52aWV3SXRlbXMpIHsKICAgICAgICB0aGlzLnZpZXdJdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICBpZiAoaXRlbSBpbnN0YW5jZW9mIEJhc2VNZW51QWN0aW9uVmlld0l0ZW0gfHwgaXRlbSBpbnN0YW5jZW9mIE1lbnVTZXBhcmF0b3JBY3Rpb25WaWV3SXRlbSkgewogICAgICAgICAgICBpdGVtLnN0eWxlKF9zdHlsZSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRDb250YWluZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldENvbnRhaW5lcigpIHsKICAgICAgcmV0dXJuIHRoaXMuc2Nyb2xsYWJsZUVsZW1lbnQuZ2V0RG9tTm9kZSgpOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uU2Nyb2xsIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5zY3JvbGxhYmxlRWxlbWVudC5vblNjcm9sbDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJmb2N1c0l0ZW1CeUVsZW1lbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZvY3VzSXRlbUJ5RWxlbWVudChlbGVtZW50KSB7CiAgICAgIHZhciBsYXN0Rm9jdXNlZEl0ZW0gPSB0aGlzLmZvY3VzZWRJdGVtOwogICAgICB0aGlzLnNldEZvY3VzZWRJdGVtKGVsZW1lbnQpOwogICAgICBpZiAobGFzdEZvY3VzZWRJdGVtICE9PSB0aGlzLmZvY3VzZWRJdGVtKSB7CiAgICAgICAgdGhpcy51cGRhdGVGb2N1cygpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0Rm9jdXNlZEl0ZW0iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldEZvY3VzZWRJdGVtKGVsZW1lbnQpIHsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmFjdGlvbnNMaXN0LmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIGVsZW0gPSB0aGlzLmFjdGlvbnNMaXN0LmNoaWxkcmVuW2ldOwogICAgICAgIGlmIChlbGVtZW50ID09PSBlbGVtKSB7CiAgICAgICAgICB0aGlzLmZvY3VzZWRJdGVtID0gaTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInVwZGF0ZUZvY3VzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVGb2N1cyhmcm9tUmlnaHQpIHsKICAgICAgX2dldChfZ2V0UHJvdG90eXBlT2YoTWVudS5wcm90b3R5cGUpLCAidXBkYXRlRm9jdXMiLCB0aGlzKS5jYWxsKHRoaXMsIGZyb21SaWdodCwgdHJ1ZSwgdHJ1ZSk7CiAgICAgIGlmICh0eXBlb2YgdGhpcy5mb2N1c2VkSXRlbSAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAvLyBXb3JrYXJvdW5kIGZvciAjODAwNDcgY2F1c2VkIGJ5IGFuIGlzc3VlIGluIGNocm9taXVtCiAgICAgICAgLy8gaHR0cHM6Ly9idWdzLmNocm9taXVtLm9yZy9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9NDE0MjgzCiAgICAgICAgLy8gV2hlbiB0aGF0J3MgZml4ZWQsIGp1c3QgY2FsbCB0aGlzLnNjcm9sbGFibGVFbGVtZW50LnNjYW5Eb21Ob2RlKCkKICAgICAgICB0aGlzLnNjcm9sbGFibGVFbGVtZW50LnNldFNjcm9sbFBvc2l0aW9uKHsKICAgICAgICAgIHNjcm9sbFRvcDogTWF0aC5yb3VuZCh0aGlzLm1lbnVFbGVtZW50LnNjcm9sbFRvcCkKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImRvR2V0QWN0aW9uVmlld0l0ZW0iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRvR2V0QWN0aW9uVmlld0l0ZW0oYWN0aW9uLCBvcHRpb25zLCBwYXJlbnREYXRhKSB7CiAgICAgIGlmIChhY3Rpb24gaW5zdGFuY2VvZiBTZXBhcmF0b3IpIHsKICAgICAgICByZXR1cm4gbmV3IE1lbnVTZXBhcmF0b3JBY3Rpb25WaWV3SXRlbShvcHRpb25zLmNvbnRleHQsIGFjdGlvbiwgewogICAgICAgICAgaWNvbjogdHJ1ZQogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGFjdGlvbiBpbnN0YW5jZW9mIFN1Ym1lbnVBY3Rpb24pIHsKICAgICAgICB2YXIgbWVudUFjdGlvblZpZXdJdGVtID0gbmV3IFN1Ym1lbnVNZW51QWN0aW9uVmlld0l0ZW0oYWN0aW9uLCBhY3Rpb24uYWN0aW9ucywgcGFyZW50RGF0YSwgT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBvcHRpb25zKSwgewogICAgICAgICAgc3VibWVudUlkczogbmV3IFNldChbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KG9wdGlvbnMuc3VibWVudUlkcyB8fCBbXSksIFthY3Rpb24uaWRdKSkKICAgICAgICB9KSk7CiAgICAgICAgaWYgKG9wdGlvbnMuZW5hYmxlTW5lbW9uaWNzKSB7CiAgICAgICAgICB2YXIgbW5lbW9uaWMgPSBtZW51QWN0aW9uVmlld0l0ZW0uZ2V0TW5lbW9uaWMoKTsKICAgICAgICAgIGlmIChtbmVtb25pYyAmJiBtZW51QWN0aW9uVmlld0l0ZW0uaXNFbmFibGVkKCkpIHsKICAgICAgICAgICAgdmFyIGFjdGlvblZpZXdJdGVtcyA9IFtdOwogICAgICAgICAgICBpZiAodGhpcy5tbmVtb25pY3MuaGFzKG1uZW1vbmljKSkgewogICAgICAgICAgICAgIGFjdGlvblZpZXdJdGVtcyA9IHRoaXMubW5lbW9uaWNzLmdldChtbmVtb25pYyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYWN0aW9uVmlld0l0ZW1zLnB1c2gobWVudUFjdGlvblZpZXdJdGVtKTsKICAgICAgICAgICAgdGhpcy5tbmVtb25pY3Muc2V0KG1uZW1vbmljLCBhY3Rpb25WaWV3SXRlbXMpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gbWVudUFjdGlvblZpZXdJdGVtOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBtZW51SXRlbU9wdGlvbnMgPSB7CiAgICAgICAgICBlbmFibGVNbmVtb25pY3M6IG9wdGlvbnMuZW5hYmxlTW5lbW9uaWNzLAogICAgICAgICAgdXNlRXZlbnRBc0NvbnRleHQ6IG9wdGlvbnMudXNlRXZlbnRBc0NvbnRleHQKICAgICAgICB9OwogICAgICAgIGlmIChvcHRpb25zLmdldEtleUJpbmRpbmcpIHsKICAgICAgICAgIHZhciBrZXliaW5kaW5nID0gb3B0aW9ucy5nZXRLZXlCaW5kaW5nKGFjdGlvbik7CiAgICAgICAgICBpZiAoa2V5YmluZGluZykgewogICAgICAgICAgICB2YXIga2V5YmluZGluZ0xhYmVsID0ga2V5YmluZGluZy5nZXRMYWJlbCgpOwogICAgICAgICAgICBpZiAoa2V5YmluZGluZ0xhYmVsKSB7CiAgICAgICAgICAgICAgbWVudUl0ZW1PcHRpb25zLmtleWJpbmRpbmcgPSBrZXliaW5kaW5nTGFiZWw7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdmFyIF9tZW51QWN0aW9uVmlld0l0ZW0gPSBuZXcgQmFzZU1lbnVBY3Rpb25WaWV3SXRlbShvcHRpb25zLmNvbnRleHQsIGFjdGlvbiwgbWVudUl0ZW1PcHRpb25zKTsKICAgICAgICBpZiAob3B0aW9ucy5lbmFibGVNbmVtb25pY3MpIHsKICAgICAgICAgIHZhciBfbW5lbW9uaWMgPSBfbWVudUFjdGlvblZpZXdJdGVtLmdldE1uZW1vbmljKCk7CiAgICAgICAgICBpZiAoX21uZW1vbmljICYmIF9tZW51QWN0aW9uVmlld0l0ZW0uaXNFbmFibGVkKCkpIHsKICAgICAgICAgICAgdmFyIF9hY3Rpb25WaWV3SXRlbXMgPSBbXTsKICAgICAgICAgICAgaWYgKHRoaXMubW5lbW9uaWNzLmhhcyhfbW5lbW9uaWMpKSB7CiAgICAgICAgICAgICAgX2FjdGlvblZpZXdJdGVtcyA9IHRoaXMubW5lbW9uaWNzLmdldChfbW5lbW9uaWMpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIF9hY3Rpb25WaWV3SXRlbXMucHVzaChfbWVudUFjdGlvblZpZXdJdGVtKTsKICAgICAgICAgICAgdGhpcy5tbmVtb25pY3Muc2V0KF9tbmVtb25pYywgX2FjdGlvblZpZXdJdGVtcyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBfbWVudUFjdGlvblZpZXdJdGVtOwogICAgICB9CiAgICB9CiAgfV0pOwogIHJldHVybiBNZW51Owp9KEFjdGlvbkJhcik7CnZhciBCYXNlTWVudUFjdGlvblZpZXdJdGVtID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQmFzZUFjdGlvblZpZXdJdGVtKSB7CiAgX2luaGVyaXRzKEJhc2VNZW51QWN0aW9uVmlld0l0ZW0sIF9CYXNlQWN0aW9uVmlld0l0ZW0pOwogIHZhciBfc3VwZXIyID0gX2NyZWF0ZVN1cGVyKEJhc2VNZW51QWN0aW9uVmlld0l0ZW0pOwogIGZ1bmN0aW9uIEJhc2VNZW51QWN0aW9uVmlld0l0ZW0oY3R4LCBhY3Rpb24pIHsKICAgIHZhciBfdGhpczI7CiAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDoge307CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQmFzZU1lbnVBY3Rpb25WaWV3SXRlbSk7CiAgICBvcHRpb25zLmlzTWVudSA9IHRydWU7CiAgICBfdGhpczIgPSBfc3VwZXIyLmNhbGwodGhpcywgYWN0aW9uLCBhY3Rpb24sIG9wdGlvbnMpOwogICAgX3RoaXMyLm9wdGlvbnMgPSBvcHRpb25zOwogICAgX3RoaXMyLm9wdGlvbnMuaWNvbiA9IG9wdGlvbnMuaWNvbiAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5pY29uIDogZmFsc2U7CiAgICBfdGhpczIub3B0aW9ucy5sYWJlbCA9IG9wdGlvbnMubGFiZWwgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMubGFiZWwgOiB0cnVlOwogICAgX3RoaXMyLmNzc0NsYXNzID0gJyc7CiAgICAvLyBTZXQgbW5lbW9uaWMKICAgIGlmIChfdGhpczIub3B0aW9ucy5sYWJlbCAmJiBvcHRpb25zLmVuYWJsZU1uZW1vbmljcykgewogICAgICB2YXIgbGFiZWwgPSBfdGhpczIuZ2V0QWN0aW9uKCkubGFiZWw7CiAgICAgIGlmIChsYWJlbCkgewogICAgICAgIHZhciBtYXRjaGVzID0gTUVOVV9NTkVNT05JQ19SRUdFWC5leGVjKGxhYmVsKTsKICAgICAgICBpZiAobWF0Y2hlcykgewogICAgICAgICAgX3RoaXMyLm1uZW1vbmljID0gKCEhbWF0Y2hlc1sxXSA/IG1hdGNoZXNbMV0gOiBtYXRjaGVzWzNdKS50b0xvY2FsZUxvd2VyQ2FzZSgpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLy8gQWRkIG1vdXNlIHVwIGxpc3RlbmVyIGxhdGVyIHRvIGF2b2lkIGFjY2lkZW50YWwgY2xpY2tzCiAgICBfdGhpczIucnVuT25jZVRvRW5hYmxlTW91c2VVcCA9IG5ldyBSdW5PbmNlU2NoZWR1bGVyKGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCFfdGhpczIuZWxlbWVudCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBfdGhpczIuX3JlZ2lzdGVyKGFkZERpc3Bvc2FibGVMaXN0ZW5lcihfdGhpczIuZWxlbWVudCwgRXZlbnRUeXBlLk1PVVNFX1VQLCBmdW5jdGlvbiAoZSkgewogICAgICAgIC8vIHJlbW92ZWQgZGVmYXVsdCBwcmV2ZW50aW9uIGFzIGl0IGNvbmZsaWN0cwogICAgICAgIC8vIHdpdGggQmFzZUFjdGlvblZpZXdJdGVtICMxMDE1MzcKICAgICAgICAvLyBhZGQgYmFjayBpZiBpc3N1ZXMgYXJpc2UgYW5kIGxpbmsgbmV3IGlzc3VlCiAgICAgICAgRXZlbnRIZWxwZXIuc3RvcChlLCB0cnVlKTsKICAgICAgICAvLyBTZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvQWRkLW9ucy9XZWJFeHRlbnNpb25zL0ludGVyYWN0X3dpdGhfdGhlX2NsaXBib2FyZAogICAgICAgIC8vID4gV3JpdGluZyB0byB0aGUgY2xpcGJvYXJkCiAgICAgICAgLy8gPiBZb3UgY2FuIHVzZSB0aGUgImN1dCIgYW5kICJjb3B5IiBjb21tYW5kcyB3aXRob3V0IGFueSBzcGVjaWFsCiAgICAgICAgLy8gcGVybWlzc2lvbiBpZiB5b3UgYXJlIHVzaW5nIHRoZW0gaW4gYSBzaG9ydC1saXZlZCBldmVudCBoYW5kbGVyCiAgICAgICAgLy8gZm9yIGEgdXNlciBhY3Rpb24gKGZvciBleGFtcGxlLCBhIGNsaWNrIGhhbmRsZXIpLgogICAgICAgIC8vID0+IHRvIGdldCB0aGUgQ29weSBhbmQgUGFzdGUgY29udGV4dCBtZW51IGFjdGlvbnMgd29ya2luZyBvbiBGaXJlZm94LAogICAgICAgIC8vIHRoZXJlIHNob3VsZCBiZSBubyB0aW1lb3V0IGhlcmUKICAgICAgICBpZiAoaXNGaXJlZm94KSB7CiAgICAgICAgICB2YXIgbW91c2VFdmVudCA9IG5ldyBTdGFuZGFyZE1vdXNlRXZlbnQoZSk7CiAgICAgICAgICAvLyBBbGxvd2luZyByaWdodCBjbGljayB0byB0cmlnZ2VyIHRoZSBldmVudCBjYXVzZXMgdGhlIGlzc3VlIGRlc2NyaWJlZCBiZWxvdywKICAgICAgICAgIC8vIGJ1dCBzaW5jZSB0aGUgc29sdXRpb24gYmVsb3cgZG9lcyBub3Qgd29yayBpbiBGRiwgd2UgbXVzdCBkaXNhYmxlIHJpZ2h0IGNsaWNrCiAgICAgICAgICBpZiAobW91c2VFdmVudC5yaWdodEJ1dHRvbikgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBfdGhpczIub25DbGljayhlKTsKICAgICAgICB9CiAgICAgICAgLy8gSW4gYWxsIG90aGVyIGNhc2VzLCBzZXQgdGltZW91dCB0byBhbGxvdyBjb250ZXh0IG1lbnUgY2FuY2VsbGF0aW9uIHRvIHRyaWdnZXIKICAgICAgICAvLyBvdGhlcndpc2UgdGhlIGFjdGlvbiB3aWxsIGRlc3Ryb3kgdGhlIG1lbnUgYW5kIGEgc2Vjb25kIGNvbnRleHQgbWVudQogICAgICAgIC8vIHdpbGwgc3RpbGwgdHJpZ2dlciBmb3IgcmlnaHQgY2xpY2suCiAgICAgICAgZWxzZSB7CiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgX3RoaXMyLm9uQ2xpY2soZSk7CiAgICAgICAgICB9LCAwKTsKICAgICAgICB9CiAgICAgIH0pKTsKICAgICAgX3RoaXMyLl9yZWdpc3RlcihhZGREaXNwb3NhYmxlTGlzdGVuZXIoX3RoaXMyLmVsZW1lbnQsIEV2ZW50VHlwZS5DT05URVhUX01FTlUsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgRXZlbnRIZWxwZXIuc3RvcChlLCB0cnVlKTsKICAgICAgfSkpOwogICAgfSwgMTAwKTsKICAgIF90aGlzMi5fcmVnaXN0ZXIoX3RoaXMyLnJ1bk9uY2VUb0VuYWJsZU1vdXNlVXApOwogICAgcmV0dXJuIF90aGlzMjsKICB9CiAgX2NyZWF0ZUNsYXNzKEJhc2VNZW51QWN0aW9uVmlld0l0ZW0sIFt7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcihjb250YWluZXIpIHsKICAgICAgX2dldChfZ2V0UHJvdG90eXBlT2YoQmFzZU1lbnVBY3Rpb25WaWV3SXRlbS5wcm90b3R5cGUpLCAicmVuZGVyIiwgdGhpcykuY2FsbCh0aGlzLCBjb250YWluZXIpOwogICAgICBpZiAoIXRoaXMuZWxlbWVudCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjsKICAgICAgdGhpcy5pdGVtID0gYXBwZW5kKHRoaXMuZWxlbWVudCwgJCgnYS5hY3Rpb24tbWVudS1pdGVtJykpOwogICAgICBpZiAodGhpcy5fYWN0aW9uLmlkID09PSBTZXBhcmF0b3IuSUQpIHsKICAgICAgICAvLyBBIHNlcGFyYXRvciBpcyBhIHByZXNlbnRhdGlvbiBpdGVtCiAgICAgICAgdGhpcy5pdGVtLnNldEF0dHJpYnV0ZSgncm9sZScsICdwcmVzZW50YXRpb24nKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLml0ZW0uc2V0QXR0cmlidXRlKCdyb2xlJywgJ21lbnVpdGVtJyk7CiAgICAgICAgaWYgKHRoaXMubW5lbW9uaWMpIHsKICAgICAgICAgIHRoaXMuaXRlbS5zZXRBdHRyaWJ1dGUoJ2FyaWEta2V5c2hvcnRjdXRzJywgIiIuY29uY2F0KHRoaXMubW5lbW9uaWMpKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgdGhpcy5jaGVjayA9IGFwcGVuZCh0aGlzLml0ZW0sICQoJ3NwYW4ubWVudS1pdGVtLWNoZWNrJyArIENvZGljb24ubWVudVNlbGVjdGlvbi5jc3NTZWxlY3RvcikpOwogICAgICB0aGlzLmNoZWNrLnNldEF0dHJpYnV0ZSgncm9sZScsICdub25lJyk7CiAgICAgIHRoaXMubGFiZWwgPSBhcHBlbmQodGhpcy5pdGVtLCAkKCdzcGFuLmFjdGlvbi1sYWJlbCcpKTsKICAgICAgaWYgKHRoaXMub3B0aW9ucy5sYWJlbCAmJiB0aGlzLm9wdGlvbnMua2V5YmluZGluZykgewogICAgICAgIGFwcGVuZCh0aGlzLml0ZW0sICQoJ3NwYW4ua2V5YmluZGluZycpKS50ZXh0Q29udGVudCA9IHRoaXMub3B0aW9ucy5rZXliaW5kaW5nOwogICAgICB9CiAgICAgIC8vIEFkZHMgbW91c2UgdXAgbGlzdGVuZXIgdG8gYWN0dWFsbHkgcnVuIHRoZSBhY3Rpb24KICAgICAgdGhpcy5ydW5PbmNlVG9FbmFibGVNb3VzZVVwLnNjaGVkdWxlKCk7CiAgICAgIHRoaXMudXBkYXRlQ2xhc3MoKTsKICAgICAgdGhpcy51cGRhdGVMYWJlbCgpOwogICAgICB0aGlzLnVwZGF0ZVRvb2x0aXAoKTsKICAgICAgdGhpcy51cGRhdGVFbmFibGVkKCk7CiAgICAgIHRoaXMudXBkYXRlQ2hlY2tlZCgpOwogICAgfQogIH0sIHsKICAgIGtleTogImJsdXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGJsdXIoKSB7CiAgICAgIF9nZXQoX2dldFByb3RvdHlwZU9mKEJhc2VNZW51QWN0aW9uVmlld0l0ZW0ucHJvdG90eXBlKSwgImJsdXIiLCB0aGlzKS5jYWxsKHRoaXMpOwogICAgICB0aGlzLmFwcGx5U3R5bGUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJmb2N1cyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZm9jdXMoKSB7CiAgICAgIF9nZXQoX2dldFByb3RvdHlwZU9mKEJhc2VNZW51QWN0aW9uVmlld0l0ZW0ucHJvdG90eXBlKSwgImZvY3VzIiwgdGhpcykuY2FsbCh0aGlzKTsKICAgICAgaWYgKHRoaXMuaXRlbSkgewogICAgICAgIHRoaXMuaXRlbS5mb2N1cygpOwogICAgICB9CiAgICAgIHRoaXMuYXBwbHlTdHlsZSgpOwogICAgfQogIH0sIHsKICAgIGtleTogInVwZGF0ZVBvc2l0aW9uSW5TZXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZVBvc2l0aW9uSW5TZXQocG9zLCBzZXRTaXplKSB7CiAgICAgIGlmICh0aGlzLml0ZW0pIHsKICAgICAgICB0aGlzLml0ZW0uc2V0QXR0cmlidXRlKCdhcmlhLXBvc2luc2V0JywgIiIuY29uY2F0KHBvcykpOwogICAgICAgIHRoaXMuaXRlbS5zZXRBdHRyaWJ1dGUoJ2FyaWEtc2V0c2l6ZScsICIiLmNvbmNhdChzZXRTaXplKSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJ1cGRhdGVMYWJlbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlTGFiZWwoKSB7CiAgICAgIHZhciBfYTsKICAgICAgaWYgKCF0aGlzLmxhYmVsKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmICh0aGlzLm9wdGlvbnMubGFiZWwpIHsKICAgICAgICBjbGVhck5vZGUodGhpcy5sYWJlbCk7CiAgICAgICAgdmFyIGxhYmVsID0gc3RyaXBJY29ucyh0aGlzLmdldEFjdGlvbigpLmxhYmVsKTsKICAgICAgICBpZiAobGFiZWwpIHsKICAgICAgICAgIHZhciBjbGVhbkxhYmVsID0gY2xlYW5NbmVtb25pYyhsYWJlbCk7CiAgICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5lbmFibGVNbmVtb25pY3MpIHsKICAgICAgICAgICAgbGFiZWwgPSBjbGVhbkxhYmVsOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5sYWJlbC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBjbGVhbkxhYmVsLnJlcGxhY2UoLyYmL2csICcmJykpOwogICAgICAgICAgdmFyIG1hdGNoZXMgPSBNRU5VX01ORU1PTklDX1JFR0VYLmV4ZWMobGFiZWwpOwogICAgICAgICAgaWYgKG1hdGNoZXMpIHsKICAgICAgICAgICAgbGFiZWwgPSBzdHJpbmdzLmVzY2FwZShsYWJlbCk7CiAgICAgICAgICAgIC8vIFRoaXMgaXMgZ2xvYmFsLCByZXNldCBpdAogICAgICAgICAgICBNRU5VX0VTQ0FQRURfTU5FTU9OSUNfUkVHRVgubGFzdEluZGV4ID0gMDsKICAgICAgICAgICAgdmFyIGVzY01hdGNoID0gTUVOVV9FU0NBUEVEX01ORU1PTklDX1JFR0VYLmV4ZWMobGFiZWwpOwogICAgICAgICAgICAvLyBXZSBjYW4ndCB1c2UgbmVnYXRpdmUgbG9va2JlaGluZCBzbyBpZiB3ZSBtYXRjaCBvdXIgbmVnYXRpdmUgYW5kIHNraXAKICAgICAgICAgICAgd2hpbGUgKGVzY01hdGNoICYmIGVzY01hdGNoWzFdKSB7CiAgICAgICAgICAgICAgZXNjTWF0Y2ggPSBNRU5VX0VTQ0FQRURfTU5FTU9OSUNfUkVHRVguZXhlYyhsYWJlbCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFyIHJlcGxhY2VEb3VibGVFc2NhcGVzID0gZnVuY3Rpb24gcmVwbGFjZURvdWJsZUVzY2FwZXMoc3RyKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHN0ci5yZXBsYWNlKC8mYW1wOyZhbXA7L2csICcmYW1wOycpOwogICAgICAgICAgICB9OwogICAgICAgICAgICBpZiAoZXNjTWF0Y2gpIHsKICAgICAgICAgICAgICB0aGlzLmxhYmVsLmFwcGVuZChzdHJpbmdzLmx0cmltKHJlcGxhY2VEb3VibGVFc2NhcGVzKGxhYmVsLnN1YnN0cigwLCBlc2NNYXRjaC5pbmRleCkpLCAnICcpLCAkKCd1JywgewogICAgICAgICAgICAgICAgJ2FyaWEtaGlkZGVuJzogJ3RydWUnCiAgICAgICAgICAgICAgfSwgZXNjTWF0Y2hbM10pLCBzdHJpbmdzLnJ0cmltKHJlcGxhY2VEb3VibGVFc2NhcGVzKGxhYmVsLnN1YnN0cihlc2NNYXRjaC5pbmRleCArIGVzY01hdGNoWzBdLmxlbmd0aCkpLCAnICcpKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLmxhYmVsLmlubmVyVGV4dCA9IHJlcGxhY2VEb3VibGVFc2NhcGVzKGxhYmVsKS50cmltKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgKF9hID0gdGhpcy5pdGVtKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc2V0QXR0cmlidXRlKCdhcmlhLWtleXNob3J0Y3V0cycsICghIW1hdGNoZXNbMV0gPyBtYXRjaGVzWzFdIDogbWF0Y2hlc1szXSkudG9Mb2NhbGVMb3dlckNhc2UoKSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLmxhYmVsLmlubmVyVGV4dCA9IGxhYmVsLnJlcGxhY2UoLyYmL2csICcmJykudHJpbSgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInVwZGF0ZVRvb2x0aXAiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZVRvb2x0aXAoKSB7CiAgICAgIC8vIG1lbnVzIHNob3VsZCBmdW5jdGlvbiBsaWtlIG5hdGl2ZSBtZW51cyBhbmQgdGhleSBkbyBub3QgaGF2ZSB0b29sdGlwcwogICAgfQogIH0sIHsKICAgIGtleTogInVwZGF0ZUNsYXNzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVDbGFzcygpIHsKICAgICAgaWYgKHRoaXMuY3NzQ2xhc3MgJiYgdGhpcy5pdGVtKSB7CiAgICAgICAgdmFyIF90aGlzJGl0ZW0kY2xhc3NMaXN0OwogICAgICAgIChfdGhpcyRpdGVtJGNsYXNzTGlzdCA9IHRoaXMuaXRlbS5jbGFzc0xpc3QpLnJlbW92ZS5hcHBseShfdGhpcyRpdGVtJGNsYXNzTGlzdCwgX3RvQ29uc3VtYWJsZUFycmF5KHRoaXMuY3NzQ2xhc3Muc3BsaXQoJyAnKSkpOwogICAgICB9CiAgICAgIGlmICh0aGlzLm9wdGlvbnMuaWNvbiAmJiB0aGlzLmxhYmVsKSB7CiAgICAgICAgdGhpcy5jc3NDbGFzcyA9IHRoaXMuZ2V0QWN0aW9uKCkuY2xhc3MgfHwgJyc7CiAgICAgICAgdGhpcy5sYWJlbC5jbGFzc0xpc3QuYWRkKCdpY29uJyk7CiAgICAgICAgaWYgKHRoaXMuY3NzQ2xhc3MpIHsKICAgICAgICAgIHZhciBfdGhpcyRsYWJlbCRjbGFzc0xpc3Q7CiAgICAgICAgICAoX3RoaXMkbGFiZWwkY2xhc3NMaXN0ID0gdGhpcy5sYWJlbC5jbGFzc0xpc3QpLmFkZC5hcHBseShfdGhpcyRsYWJlbCRjbGFzc0xpc3QsIF90b0NvbnN1bWFibGVBcnJheSh0aGlzLmNzc0NsYXNzLnNwbGl0KCcgJykpKTsKICAgICAgICB9CiAgICAgICAgdGhpcy51cGRhdGVFbmFibGVkKCk7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5sYWJlbCkgewogICAgICAgIHRoaXMubGFiZWwuY2xhc3NMaXN0LnJlbW92ZSgnaWNvbicpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAidXBkYXRlRW5hYmxlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlRW5hYmxlZCgpIHsKICAgICAgaWYgKHRoaXMuZ2V0QWN0aW9uKCkuZW5hYmxlZCkgewogICAgICAgIGlmICh0aGlzLmVsZW1lbnQpIHsKICAgICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdkaXNhYmxlZCcpOwogICAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1kaXNhYmxlZCcpOwogICAgICAgIH0KICAgICAgICBpZiAodGhpcy5pdGVtKSB7CiAgICAgICAgICB0aGlzLml0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnZGlzYWJsZWQnKTsKICAgICAgICAgIHRoaXMuaXRlbS5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtZGlzYWJsZWQnKTsKICAgICAgICAgIHRoaXMuaXRlbS50YWJJbmRleCA9IDA7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmICh0aGlzLmVsZW1lbnQpIHsKICAgICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdkaXNhYmxlZCcpOwogICAgICAgICAgdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1kaXNhYmxlZCcsICd0cnVlJyk7CiAgICAgICAgfQogICAgICAgIGlmICh0aGlzLml0ZW0pIHsKICAgICAgICAgIHRoaXMuaXRlbS5jbGFzc0xpc3QuYWRkKCdkaXNhYmxlZCcpOwogICAgICAgICAgdGhpcy5pdGVtLnNldEF0dHJpYnV0ZSgnYXJpYS1kaXNhYmxlZCcsICd0cnVlJyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAidXBkYXRlQ2hlY2tlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlQ2hlY2tlZCgpIHsKICAgICAgaWYgKCF0aGlzLml0ZW0pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdmFyIGNoZWNrZWQgPSB0aGlzLmdldEFjdGlvbigpLmNoZWNrZWQ7CiAgICAgIHRoaXMuaXRlbS5jbGFzc0xpc3QudG9nZ2xlKCdjaGVja2VkJywgISFjaGVja2VkKTsKICAgICAgaWYgKGNoZWNrZWQgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHRoaXMuaXRlbS5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnbWVudWl0ZW1jaGVja2JveCcpOwogICAgICAgIHRoaXMuaXRlbS5zZXRBdHRyaWJ1dGUoJ2FyaWEtY2hlY2tlZCcsIGNoZWNrZWQgPyAndHJ1ZScgOiAnZmFsc2UnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLml0ZW0uc2V0QXR0cmlidXRlKCdyb2xlJywgJ21lbnVpdGVtJyk7CiAgICAgICAgdGhpcy5pdGVtLnNldEF0dHJpYnV0ZSgnYXJpYS1jaGVja2VkJywgJycpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0TW5lbW9uaWMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldE1uZW1vbmljKCkgewogICAgICByZXR1cm4gdGhpcy5tbmVtb25pYzsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhcHBseVN0eWxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhcHBseVN0eWxlKCkgewogICAgICBpZiAoIXRoaXMubWVudVN0eWxlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHZhciBpc1NlbGVjdGVkID0gdGhpcy5lbGVtZW50ICYmIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2ZvY3VzZWQnKTsKICAgICAgdmFyIGZnQ29sb3IgPSBpc1NlbGVjdGVkICYmIHRoaXMubWVudVN0eWxlLnNlbGVjdGlvbkZvcmVncm91bmRDb2xvciA/IHRoaXMubWVudVN0eWxlLnNlbGVjdGlvbkZvcmVncm91bmRDb2xvciA6IHRoaXMubWVudVN0eWxlLmZvcmVncm91bmRDb2xvcjsKICAgICAgdmFyIGJnQ29sb3IgPSBpc1NlbGVjdGVkICYmIHRoaXMubWVudVN0eWxlLnNlbGVjdGlvbkJhY2tncm91bmRDb2xvciA/IHRoaXMubWVudVN0eWxlLnNlbGVjdGlvbkJhY2tncm91bmRDb2xvciA6IHVuZGVmaW5lZDsKICAgICAgdmFyIG91dGxpbmUgPSBpc1NlbGVjdGVkICYmIHRoaXMubWVudVN0eWxlLnNlbGVjdGlvbkJvcmRlckNvbG9yID8gIjFweCBzb2xpZCAiLmNvbmNhdCh0aGlzLm1lbnVTdHlsZS5zZWxlY3Rpb25Cb3JkZXJDb2xvcikgOiAnJzsKICAgICAgdmFyIG91dGxpbmVPZmZzZXQgPSBpc1NlbGVjdGVkICYmIHRoaXMubWVudVN0eWxlLnNlbGVjdGlvbkJvcmRlckNvbG9yID8gIi0xcHgiIDogJyc7CiAgICAgIGlmICh0aGlzLml0ZW0pIHsKICAgICAgICB0aGlzLml0ZW0uc3R5bGUuY29sb3IgPSBmZ0NvbG9yID8gZmdDb2xvci50b1N0cmluZygpIDogJyc7CiAgICAgICAgdGhpcy5pdGVtLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGJnQ29sb3IgPyBiZ0NvbG9yLnRvU3RyaW5nKCkgOiAnJzsKICAgICAgICB0aGlzLml0ZW0uc3R5bGUub3V0bGluZSA9IG91dGxpbmU7CiAgICAgICAgdGhpcy5pdGVtLnN0eWxlLm91dGxpbmVPZmZzZXQgPSBvdXRsaW5lT2Zmc2V0OwogICAgICB9CiAgICAgIGlmICh0aGlzLmNoZWNrKSB7CiAgICAgICAgdGhpcy5jaGVjay5zdHlsZS5jb2xvciA9IGZnQ29sb3IgPyBmZ0NvbG9yLnRvU3RyaW5nKCkgOiAnJzsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInN0eWxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzdHlsZShfc3R5bGUyKSB7CiAgICAgIHRoaXMubWVudVN0eWxlID0gX3N0eWxlMjsKICAgICAgdGhpcy5hcHBseVN0eWxlKCk7CiAgICB9CiAgfV0pOwogIHJldHVybiBCYXNlTWVudUFjdGlvblZpZXdJdGVtOwp9KEJhc2VBY3Rpb25WaWV3SXRlbSk7CnZhciBTdWJtZW51TWVudUFjdGlvblZpZXdJdGVtID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQmFzZU1lbnVBY3Rpb25WaWV3SXQpIHsKICBfaW5oZXJpdHMoU3VibWVudU1lbnVBY3Rpb25WaWV3SXRlbSwgX0Jhc2VNZW51QWN0aW9uVmlld0l0KTsKICB2YXIgX3N1cGVyMyA9IF9jcmVhdGVTdXBlcihTdWJtZW51TWVudUFjdGlvblZpZXdJdGVtKTsKICBmdW5jdGlvbiBTdWJtZW51TWVudUFjdGlvblZpZXdJdGVtKGFjdGlvbiwgc3VibWVudUFjdGlvbnMsIHBhcmVudERhdGEsIHN1Ym1lbnVPcHRpb25zKSB7CiAgICB2YXIgX3RoaXMzOwogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFN1Ym1lbnVNZW51QWN0aW9uVmlld0l0ZW0pOwogICAgX3RoaXMzID0gX3N1cGVyMy5jYWxsKHRoaXMsIGFjdGlvbiwgYWN0aW9uLCBzdWJtZW51T3B0aW9ucyk7CiAgICBfdGhpczMuc3VibWVudUFjdGlvbnMgPSBzdWJtZW51QWN0aW9uczsKICAgIF90aGlzMy5wYXJlbnREYXRhID0gcGFyZW50RGF0YTsKICAgIF90aGlzMy5zdWJtZW51T3B0aW9ucyA9IHN1Ym1lbnVPcHRpb25zOwogICAgX3RoaXMzLm15c3VibWVudSA9IG51bGw7CiAgICBfdGhpczMuc3VibWVudURpc3Bvc2FibGVzID0gX3RoaXMzLl9yZWdpc3RlcihuZXcgRGlzcG9zYWJsZVN0b3JlKCkpOwogICAgX3RoaXMzLm1vdXNlT3ZlciA9IGZhbHNlOwogICAgX3RoaXMzLmV4cGFuZERpcmVjdGlvbiA9IHN1Ym1lbnVPcHRpb25zICYmIHN1Ym1lbnVPcHRpb25zLmV4cGFuZERpcmVjdGlvbiAhPT0gdW5kZWZpbmVkID8gc3VibWVudU9wdGlvbnMuZXhwYW5kRGlyZWN0aW9uIDogRGlyZWN0aW9uLlJpZ2h0OwogICAgX3RoaXMzLnNob3dTY2hlZHVsZXIgPSBuZXcgUnVuT25jZVNjaGVkdWxlcihmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChfdGhpczMubW91c2VPdmVyKSB7CiAgICAgICAgX3RoaXMzLmNsZWFudXBFeGlzdGluZ1N1Ym1lbnUoZmFsc2UpOwogICAgICAgIF90aGlzMy5jcmVhdGVTdWJtZW51KGZhbHNlKTsKICAgICAgfQogICAgfSwgMjUwKTsKICAgIF90aGlzMy5oaWRlU2NoZWR1bGVyID0gbmV3IFJ1bk9uY2VTY2hlZHVsZXIoZnVuY3Rpb24gKCkgewogICAgICBpZiAoX3RoaXMzLmVsZW1lbnQgJiYgIWlzQW5jZXN0b3IoZ2V0QWN0aXZlRWxlbWVudCgpLCBfdGhpczMuZWxlbWVudCkgJiYgX3RoaXMzLnBhcmVudERhdGEuc3VibWVudSA9PT0gX3RoaXMzLm15c3VibWVudSkgewogICAgICAgIF90aGlzMy5wYXJlbnREYXRhLnBhcmVudC5mb2N1cyhmYWxzZSk7CiAgICAgICAgX3RoaXMzLmNsZWFudXBFeGlzdGluZ1N1Ym1lbnUodHJ1ZSk7CiAgICAgIH0KICAgIH0sIDc1MCk7CiAgICByZXR1cm4gX3RoaXMzOwogIH0KICBfY3JlYXRlQ2xhc3MoU3VibWVudU1lbnVBY3Rpb25WaWV3SXRlbSwgW3sKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKGNvbnRhaW5lcikgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKICAgICAgX2dldChfZ2V0UHJvdG90eXBlT2YoU3VibWVudU1lbnVBY3Rpb25WaWV3SXRlbS5wcm90b3R5cGUpLCAicmVuZGVyIiwgdGhpcykuY2FsbCh0aGlzLCBjb250YWluZXIpOwogICAgICBpZiAoIXRoaXMuZWxlbWVudCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAodGhpcy5pdGVtKSB7CiAgICAgICAgdGhpcy5pdGVtLmNsYXNzTGlzdC5hZGQoJ21vbmFjby1zdWJtZW51LWl0ZW0nKTsKICAgICAgICB0aGlzLml0ZW0udGFiSW5kZXggPSAwOwogICAgICAgIHRoaXMuaXRlbS5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGFzcG9wdXAnLCAndHJ1ZScpOwogICAgICAgIHRoaXMudXBkYXRlQXJpYUV4cGFuZGVkKCdmYWxzZScpOwogICAgICAgIHRoaXMuc3VibWVudUluZGljYXRvciA9IGFwcGVuZCh0aGlzLml0ZW0sICQoJ3NwYW4uc3VibWVudS1pbmRpY2F0b3InICsgQ29kaWNvbi5tZW51U3VibWVudS5jc3NTZWxlY3RvcikpOwogICAgICAgIHRoaXMuc3VibWVudUluZGljYXRvci5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgJ3RydWUnKTsKICAgICAgfQogICAgICB0aGlzLl9yZWdpc3RlcihhZGREaXNwb3NhYmxlTGlzdGVuZXIodGhpcy5lbGVtZW50LCBFdmVudFR5cGUuS0VZX1VQLCBmdW5jdGlvbiAoZSkgewogICAgICAgIHZhciBldmVudCA9IG5ldyBTdGFuZGFyZEtleWJvYXJkRXZlbnQoZSk7CiAgICAgICAgaWYgKGV2ZW50LmVxdWFscygxNyAvKiBLZXlDb2RlLlJpZ2h0QXJyb3cgKi8pIHx8IGV2ZW50LmVxdWFscygzIC8qIEtleUNvZGUuRW50ZXIgKi8pKSB7CiAgICAgICAgICBFdmVudEhlbHBlci5zdG9wKGUsIHRydWUpOwogICAgICAgICAgX3RoaXM0LmNyZWF0ZVN1Ym1lbnUodHJ1ZSk7CiAgICAgICAgfQogICAgICB9KSk7CiAgICAgIHRoaXMuX3JlZ2lzdGVyKGFkZERpc3Bvc2FibGVMaXN0ZW5lcih0aGlzLmVsZW1lbnQsIEV2ZW50VHlwZS5LRVlfRE9XTiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICB2YXIgZXZlbnQgPSBuZXcgU3RhbmRhcmRLZXlib2FyZEV2ZW50KGUpOwogICAgICAgIGlmIChnZXRBY3RpdmVFbGVtZW50KCkgPT09IF90aGlzNC5pdGVtKSB7CiAgICAgICAgICBpZiAoZXZlbnQuZXF1YWxzKDE3IC8qIEtleUNvZGUuUmlnaHRBcnJvdyAqLykgfHwgZXZlbnQuZXF1YWxzKDMgLyogS2V5Q29kZS5FbnRlciAqLykpIHsKICAgICAgICAgICAgRXZlbnRIZWxwZXIuc3RvcChlLCB0cnVlKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pKTsKICAgICAgdGhpcy5fcmVnaXN0ZXIoYWRkRGlzcG9zYWJsZUxpc3RlbmVyKHRoaXMuZWxlbWVudCwgRXZlbnRUeXBlLk1PVVNFX09WRVIsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgaWYgKCFfdGhpczQubW91c2VPdmVyKSB7CiAgICAgICAgICBfdGhpczQubW91c2VPdmVyID0gdHJ1ZTsKICAgICAgICAgIF90aGlzNC5zaG93U2NoZWR1bGVyLnNjaGVkdWxlKCk7CiAgICAgICAgfQogICAgICB9KSk7CiAgICAgIHRoaXMuX3JlZ2lzdGVyKGFkZERpc3Bvc2FibGVMaXN0ZW5lcih0aGlzLmVsZW1lbnQsIEV2ZW50VHlwZS5NT1VTRV9MRUFWRSwgZnVuY3Rpb24gKGUpIHsKICAgICAgICBfdGhpczQubW91c2VPdmVyID0gZmFsc2U7CiAgICAgIH0pKTsKICAgICAgdGhpcy5fcmVnaXN0ZXIoYWRkRGlzcG9zYWJsZUxpc3RlbmVyKHRoaXMuZWxlbWVudCwgRXZlbnRUeXBlLkZPQ1VTX09VVCwgZnVuY3Rpb24gKGUpIHsKICAgICAgICBpZiAoX3RoaXM0LmVsZW1lbnQgJiYgIWlzQW5jZXN0b3IoZ2V0QWN0aXZlRWxlbWVudCgpLCBfdGhpczQuZWxlbWVudCkpIHsKICAgICAgICAgIF90aGlzNC5oaWRlU2NoZWR1bGVyLnNjaGVkdWxlKCk7CiAgICAgICAgfQogICAgICB9KSk7CiAgICAgIHRoaXMuX3JlZ2lzdGVyKHRoaXMucGFyZW50RGF0YS5wYXJlbnQub25TY3JvbGwoZnVuY3Rpb24gKCkgewogICAgICAgIGlmIChfdGhpczQucGFyZW50RGF0YS5zdWJtZW51ID09PSBfdGhpczQubXlzdWJtZW51KSB7CiAgICAgICAgICBfdGhpczQucGFyZW50RGF0YS5wYXJlbnQuZm9jdXMoZmFsc2UpOwogICAgICAgICAgX3RoaXM0LmNsZWFudXBFeGlzdGluZ1N1Ym1lbnUodHJ1ZSk7CiAgICAgICAgfQogICAgICB9KSk7CiAgICB9CiAgfSwgewogICAga2V5OiAidXBkYXRlRW5hYmxlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlRW5hYmxlZCgpIHsKICAgICAgLy8gb3ZlcnJpZGUgb24gc3VibWVudSBlbnRyeQogICAgICAvLyBuYXRpdmUgbWVudXMgZG8gbm90IG9ic2VydmUgZW5hYmxlbWVudCBvbiBzdW1iZW51cwogICAgICAvLyB3ZSBtaW1pYyB0aGF0IGJlaGF2aW9yCiAgICB9CiAgfSwgewogICAga2V5OiAib25DbGljayIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25DbGljayhlKSB7CiAgICAgIC8vIHN0b3AgY2xpY2tpbmcgZnJvbSB0cnlpbmcgdG8gcnVuIGFuIGFjdGlvbgogICAgICBFdmVudEhlbHBlci5zdG9wKGUsIHRydWUpOwogICAgICB0aGlzLmNsZWFudXBFeGlzdGluZ1N1Ym1lbnUoZmFsc2UpOwogICAgICB0aGlzLmNyZWF0ZVN1Ym1lbnUodHJ1ZSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY2xlYW51cEV4aXN0aW5nU3VibWVudSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xlYW51cEV4aXN0aW5nU3VibWVudShmb3JjZSkgewogICAgICBpZiAodGhpcy5wYXJlbnREYXRhLnN1Ym1lbnUgJiYgKGZvcmNlIHx8IHRoaXMucGFyZW50RGF0YS5zdWJtZW51ICE9PSB0aGlzLm15c3VibWVudSkpIHsKICAgICAgICAvLyBkaXNwb3NhbCBtYXkgdGhyb3cgaWYgdGhlIHN1Ym1lbnUgaGFzIGFscmVhZHkgYmVlbiByZW1vdmVkCiAgICAgICAgdHJ5IHsKICAgICAgICAgIHRoaXMucGFyZW50RGF0YS5zdWJtZW51LmRpc3Bvc2UoKTsKICAgICAgICB9IGNhdGNoIChfYSkge30KICAgICAgICB0aGlzLnBhcmVudERhdGEuc3VibWVudSA9IHVuZGVmaW5lZDsKICAgICAgICB0aGlzLnVwZGF0ZUFyaWFFeHBhbmRlZCgnZmFsc2UnKTsKICAgICAgICBpZiAodGhpcy5zdWJtZW51Q29udGFpbmVyKSB7CiAgICAgICAgICB0aGlzLnN1Ym1lbnVEaXNwb3NhYmxlcy5jbGVhcigpOwogICAgICAgICAgdGhpcy5zdWJtZW51Q29udGFpbmVyID0gdW5kZWZpbmVkOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImNhbGN1bGF0ZVN1Ym1lbnVNZW51TGF5b3V0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjYWxjdWxhdGVTdWJtZW51TWVudUxheW91dCh3aW5kb3dEaW1lbnNpb25zLCBzdWJtZW51LCBlbnRyeSwgZXhwYW5kRGlyZWN0aW9uKSB7CiAgICAgIHZhciByZXQgPSB7CiAgICAgICAgdG9wOiAwLAogICAgICAgIGxlZnQ6IDAKICAgICAgfTsKICAgICAgLy8gU3RhcnQgd2l0aCBob3Jpem9udGFsCiAgICAgIHJldC5sZWZ0ID0gbGF5b3V0KHdpbmRvd0RpbWVuc2lvbnMud2lkdGgsIHN1Ym1lbnUud2lkdGgsIHsKICAgICAgICBwb3NpdGlvbjogZXhwYW5kRGlyZWN0aW9uID09PSBEaXJlY3Rpb24uUmlnaHQgPyAwIC8qIExheW91dEFuY2hvclBvc2l0aW9uLkJlZm9yZSAqLyA6IDEgLyogTGF5b3V0QW5jaG9yUG9zaXRpb24uQWZ0ZXIgKi8sCiAgICAgICAgb2Zmc2V0OiBlbnRyeS5sZWZ0LAogICAgICAgIHNpemU6IGVudHJ5LndpZHRoCiAgICAgIH0pOwogICAgICAvLyBXZSBkb24ndCBoYXZlIGVub3VnaCByb29tIHRvIGxheW91dCB0aGUgbWVudSBmdWxseSwgc28gd2UgYXJlIG92ZXJsYXBwaW5nIHRoZSBtZW51CiAgICAgIGlmIChyZXQubGVmdCA+PSBlbnRyeS5sZWZ0ICYmIHJldC5sZWZ0IDwgZW50cnkubGVmdCArIGVudHJ5LndpZHRoKSB7CiAgICAgICAgaWYgKGVudHJ5LmxlZnQgKyAxMCArIHN1Ym1lbnUud2lkdGggPD0gd2luZG93RGltZW5zaW9ucy53aWR0aCkgewogICAgICAgICAgcmV0LmxlZnQgPSBlbnRyeS5sZWZ0ICsgMTA7CiAgICAgICAgfQogICAgICAgIGVudHJ5LnRvcCArPSAxMDsKICAgICAgICBlbnRyeS5oZWlnaHQgPSAwOwogICAgICB9CiAgICAgIC8vIE5vdyB0aGF0IHdlIGhhdmUgYSBob3Jpem9udGFsIHBvc2l0aW9uLCB0cnkgbGF5b3V0IHZlcnRpY2FsbHkKICAgICAgcmV0LnRvcCA9IGxheW91dCh3aW5kb3dEaW1lbnNpb25zLmhlaWdodCwgc3VibWVudS5oZWlnaHQsIHsKICAgICAgICBwb3NpdGlvbjogMCAvKiBMYXlvdXRBbmNob3JQb3NpdGlvbi5CZWZvcmUgKi8sCiAgICAgICAgb2Zmc2V0OiBlbnRyeS50b3AsCiAgICAgICAgc2l6ZTogMAogICAgICB9KTsKICAgICAgLy8gV2UgZGlkbid0IGhhdmUgZW5vdWdoIHJvb20gYmVsb3csIGJ1dCB3ZSBkaWQgYWJvdmUsIHNvIHdlIHNoaWZ0IGRvd24gdG8gYWxpZ24gdGhlIG1lbnUKICAgICAgaWYgKHJldC50b3AgKyBzdWJtZW51LmhlaWdodCA9PT0gZW50cnkudG9wICYmIHJldC50b3AgKyBlbnRyeS5oZWlnaHQgKyBzdWJtZW51LmhlaWdodCA8PSB3aW5kb3dEaW1lbnNpb25zLmhlaWdodCkgewogICAgICAgIHJldC50b3AgKz0gZW50cnkuaGVpZ2h0OwogICAgICB9CiAgICAgIHJldHVybiByZXQ7CiAgICB9CiAgfSwgewogICAga2V5OiAiY3JlYXRlU3VibWVudSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlU3VibWVudSgpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CiAgICAgIHZhciBzZWxlY3RGaXJzdEl0ZW0gPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHRydWU7CiAgICAgIGlmICghdGhpcy5lbGVtZW50KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmICghdGhpcy5wYXJlbnREYXRhLnN1Ym1lbnUpIHsKICAgICAgICB0aGlzLnVwZGF0ZUFyaWFFeHBhbmRlZCgndHJ1ZScpOwogICAgICAgIHRoaXMuc3VibWVudUNvbnRhaW5lciA9IGFwcGVuZCh0aGlzLmVsZW1lbnQsICQoJ2Rpdi5tb25hY28tc3VibWVudScpKTsKICAgICAgICB0aGlzLnN1Ym1lbnVDb250YWluZXIuY2xhc3NMaXN0LmFkZCgnbWVudWJhci1tZW51LWl0ZW1zLWhvbGRlcicsICdjb250ZXh0LXZpZXcnKTsKICAgICAgICAvLyBTZXQgdGhlIHRvcCB2YWx1ZSBvZiB0aGUgbWVudSBjb250YWluZXIgYmVmb3JlIGNvbnN0cnVjdGlvbgogICAgICAgIC8vIFRoaXMgYWxsb3dzIHRoZSBtZW51IGNvbnN0cnVjdG9yIHRvIGNhbGN1bGF0ZSB0aGUgcHJvcGVyIG1heCBoZWlnaHQKICAgICAgICB2YXIgY29tcHV0ZWRTdHlsZXMgPSBnZXRDb21wdXRlZFN0eWxlKHRoaXMucGFyZW50RGF0YS5wYXJlbnQuZG9tTm9kZSk7CiAgICAgICAgdmFyIHBhZGRpbmdUb3AgPSBwYXJzZUZsb2F0KGNvbXB1dGVkU3R5bGVzLnBhZGRpbmdUb3AgfHwgJzAnKSB8fCAwOwogICAgICAgIC8vIHRoaXMuc3VibWVudUNvbnRhaW5lci5zdHlsZS50b3AgPSBgJHt0aGlzLmVsZW1lbnQub2Zmc2V0VG9wIC0gdGhpcy5wYXJlbnREYXRhLnBhcmVudC5zY3JvbGxPZmZzZXQgLSBwYWRkaW5nVG9wfXB4YDsKICAgICAgICB0aGlzLnN1Ym1lbnVDb250YWluZXIuc3R5bGUuekluZGV4ID0gJzEnOwogICAgICAgIHRoaXMuc3VibWVudUNvbnRhaW5lci5zdHlsZS5wb3NpdGlvbiA9ICdmaXhlZCc7CiAgICAgICAgdGhpcy5zdWJtZW51Q29udGFpbmVyLnN0eWxlLnRvcCA9ICcwJzsKICAgICAgICB0aGlzLnN1Ym1lbnVDb250YWluZXIuc3R5bGUubGVmdCA9ICcwJzsKICAgICAgICB0aGlzLnBhcmVudERhdGEuc3VibWVudSA9IG5ldyBNZW51KHRoaXMuc3VibWVudUNvbnRhaW5lciwgdGhpcy5zdWJtZW51QWN0aW9ucy5sZW5ndGggPyB0aGlzLnN1Ym1lbnVBY3Rpb25zIDogW25ldyBFbXB0eVN1Ym1lbnVBY3Rpb24oKV0sIHRoaXMuc3VibWVudU9wdGlvbnMpOwogICAgICAgIGlmICh0aGlzLm1lbnVTdHlsZSkgewogICAgICAgICAgdGhpcy5wYXJlbnREYXRhLnN1Ym1lbnUuc3R5bGUodGhpcy5tZW51U3R5bGUpOwogICAgICAgIH0KICAgICAgICAvLyBsYXlvdXQgc3VibWVudQogICAgICAgIHZhciBlbnRyeUJveCA9IHRoaXMuZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICB2YXIgZW50cnlCb3hVcGRhdGVkID0gewogICAgICAgICAgdG9wOiBlbnRyeUJveC50b3AgLSBwYWRkaW5nVG9wLAogICAgICAgICAgbGVmdDogZW50cnlCb3gubGVmdCwKICAgICAgICAgIGhlaWdodDogZW50cnlCb3guaGVpZ2h0ICsgMiAqIHBhZGRpbmdUb3AsCiAgICAgICAgICB3aWR0aDogZW50cnlCb3gud2lkdGgKICAgICAgICB9OwogICAgICAgIHZhciB2aWV3Qm94ID0gdGhpcy5zdWJtZW51Q29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgIHZhciBfdGhpcyRjYWxjdWxhdGVTdWJtZW4gPSB0aGlzLmNhbGN1bGF0ZVN1Ym1lbnVNZW51TGF5b3V0KG5ldyBEaW1lbnNpb24od2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCksIERpbWVuc2lvbi5saWZ0KHZpZXdCb3gpLCBlbnRyeUJveFVwZGF0ZWQsIHRoaXMuZXhwYW5kRGlyZWN0aW9uKSwKICAgICAgICAgIHRvcCA9IF90aGlzJGNhbGN1bGF0ZVN1Ym1lbi50b3AsCiAgICAgICAgICBsZWZ0ID0gX3RoaXMkY2FsY3VsYXRlU3VibWVuLmxlZnQ7CiAgICAgICAgLy8gc3VidHJhY3Qgb2Zmc2V0cyBjYXVzZWQgYnkgdHJhbnNmb3JtIHBhcmVudAogICAgICAgIHRoaXMuc3VibWVudUNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gIiIuY29uY2F0KGxlZnQgLSB2aWV3Qm94LmxlZnQsICJweCIpOwogICAgICAgIHRoaXMuc3VibWVudUNvbnRhaW5lci5zdHlsZS50b3AgPSAiIi5jb25jYXQodG9wIC0gdmlld0JveC50b3AsICJweCIpOwogICAgICAgIHRoaXMuc3VibWVudURpc3Bvc2FibGVzLmFkZChhZGREaXNwb3NhYmxlTGlzdGVuZXIodGhpcy5zdWJtZW51Q29udGFpbmVyLCBFdmVudFR5cGUuS0VZX1VQLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgdmFyIGV2ZW50ID0gbmV3IFN0YW5kYXJkS2V5Ym9hcmRFdmVudChlKTsKICAgICAgICAgIGlmIChldmVudC5lcXVhbHMoMTUgLyogS2V5Q29kZS5MZWZ0QXJyb3cgKi8pKSB7CiAgICAgICAgICAgIEV2ZW50SGVscGVyLnN0b3AoZSwgdHJ1ZSk7CiAgICAgICAgICAgIF90aGlzNS5wYXJlbnREYXRhLnBhcmVudC5mb2N1cygpOwogICAgICAgICAgICBfdGhpczUuY2xlYW51cEV4aXN0aW5nU3VibWVudSh0cnVlKTsKICAgICAgICAgIH0KICAgICAgICB9KSk7CiAgICAgICAgdGhpcy5zdWJtZW51RGlzcG9zYWJsZXMuYWRkKGFkZERpc3Bvc2FibGVMaXN0ZW5lcih0aGlzLnN1Ym1lbnVDb250YWluZXIsIEV2ZW50VHlwZS5LRVlfRE9XTiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHZhciBldmVudCA9IG5ldyBTdGFuZGFyZEtleWJvYXJkRXZlbnQoZSk7CiAgICAgICAgICBpZiAoZXZlbnQuZXF1YWxzKDE1IC8qIEtleUNvZGUuTGVmdEFycm93ICovKSkgewogICAgICAgICAgICBFdmVudEhlbHBlci5zdG9wKGUsIHRydWUpOwogICAgICAgICAgfQogICAgICAgIH0pKTsKICAgICAgICB0aGlzLnN1Ym1lbnVEaXNwb3NhYmxlcy5hZGQodGhpcy5wYXJlbnREYXRhLnN1Ym1lbnUub25EaWRDYW5jZWwoZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXM1LnBhcmVudERhdGEucGFyZW50LmZvY3VzKCk7CiAgICAgICAgICBfdGhpczUuY2xlYW51cEV4aXN0aW5nU3VibWVudSh0cnVlKTsKICAgICAgICB9KSk7CiAgICAgICAgdGhpcy5wYXJlbnREYXRhLnN1Ym1lbnUuZm9jdXMoc2VsZWN0Rmlyc3RJdGVtKTsKICAgICAgICB0aGlzLm15c3VibWVudSA9IHRoaXMucGFyZW50RGF0YS5zdWJtZW51OwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucGFyZW50RGF0YS5zdWJtZW51LmZvY3VzKGZhbHNlKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInVwZGF0ZUFyaWFFeHBhbmRlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlQXJpYUV4cGFuZGVkKHZhbHVlKSB7CiAgICAgIHZhciBfYTsKICAgICAgaWYgKHRoaXMuaXRlbSkgewogICAgICAgIChfYSA9IHRoaXMuaXRlbSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsIHZhbHVlKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImFwcGx5U3R5bGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGx5U3R5bGUoKSB7CiAgICAgIHZhciBfYTsKICAgICAgX2dldChfZ2V0UHJvdG90eXBlT2YoU3VibWVudU1lbnVBY3Rpb25WaWV3SXRlbS5wcm90b3R5cGUpLCAiYXBwbHlTdHlsZSIsIHRoaXMpLmNhbGwodGhpcyk7CiAgICAgIGlmICghdGhpcy5tZW51U3R5bGUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdmFyIGlzU2VsZWN0ZWQgPSB0aGlzLmVsZW1lbnQgJiYgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnZm9jdXNlZCcpOwogICAgICB2YXIgZmdDb2xvciA9IGlzU2VsZWN0ZWQgJiYgdGhpcy5tZW51U3R5bGUuc2VsZWN0aW9uRm9yZWdyb3VuZENvbG9yID8gdGhpcy5tZW51U3R5bGUuc2VsZWN0aW9uRm9yZWdyb3VuZENvbG9yIDogdGhpcy5tZW51U3R5bGUuZm9yZWdyb3VuZENvbG9yOwogICAgICBpZiAodGhpcy5zdWJtZW51SW5kaWNhdG9yKSB7CiAgICAgICAgdGhpcy5zdWJtZW51SW5kaWNhdG9yLnN0eWxlLmNvbG9yID0gZmdDb2xvciA/ICIiLmNvbmNhdChmZ0NvbG9yKSA6ICcnOwogICAgICB9CiAgICAgIChfYSA9IHRoaXMucGFyZW50RGF0YS5zdWJtZW51KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc3R5bGUodGhpcy5tZW51U3R5bGUpOwogICAgfQogIH0sIHsKICAgIGtleTogImRpc3Bvc2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7CiAgICAgIF9nZXQoX2dldFByb3RvdHlwZU9mKFN1Ym1lbnVNZW51QWN0aW9uVmlld0l0ZW0ucHJvdG90eXBlKSwgImRpc3Bvc2UiLCB0aGlzKS5jYWxsKHRoaXMpOwogICAgICB0aGlzLmhpZGVTY2hlZHVsZXIuZGlzcG9zZSgpOwogICAgICBpZiAodGhpcy5teXN1Ym1lbnUpIHsKICAgICAgICB0aGlzLm15c3VibWVudS5kaXNwb3NlKCk7CiAgICAgICAgdGhpcy5teXN1Ym1lbnUgPSBudWxsOwogICAgICB9CiAgICAgIGlmICh0aGlzLnN1Ym1lbnVDb250YWluZXIpIHsKICAgICAgICB0aGlzLnN1Ym1lbnVDb250YWluZXIgPSB1bmRlZmluZWQ7CiAgICAgIH0KICAgIH0KICB9XSk7CiAgcmV0dXJuIFN1Ym1lbnVNZW51QWN0aW9uVmlld0l0ZW07Cn0oQmFzZU1lbnVBY3Rpb25WaWV3SXRlbSk7CnZhciBNZW51U2VwYXJhdG9yQWN0aW9uVmlld0l0ZW0gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9BY3Rpb25WaWV3SXRlbSkgewogIF9pbmhlcml0cyhNZW51U2VwYXJhdG9yQWN0aW9uVmlld0l0ZW0sIF9BY3Rpb25WaWV3SXRlbSk7CiAgdmFyIF9zdXBlcjQgPSBfY3JlYXRlU3VwZXIoTWVudVNlcGFyYXRvckFjdGlvblZpZXdJdGVtKTsKICBmdW5jdGlvbiBNZW51U2VwYXJhdG9yQWN0aW9uVmlld0l0ZW0oKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTWVudVNlcGFyYXRvckFjdGlvblZpZXdJdGVtKTsKICAgIHJldHVybiBfc3VwZXI0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfQogIF9jcmVhdGVDbGFzcyhNZW51U2VwYXJhdG9yQWN0aW9uVmlld0l0ZW0sIFt7CiAgICBrZXk6ICJzdHlsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3R5bGUoX3N0eWxlMykgewogICAgICBpZiAodGhpcy5sYWJlbCkgewogICAgICAgIHRoaXMubGFiZWwuc3R5bGUuYm9yZGVyQm90dG9tQ29sb3IgPSBfc3R5bGUzLnNlcGFyYXRvckNvbG9yID8gIiIuY29uY2F0KF9zdHlsZTMuc2VwYXJhdG9yQ29sb3IpIDogJyc7CiAgICAgIH0KICAgIH0KICB9XSk7CiAgcmV0dXJuIE1lbnVTZXBhcmF0b3JBY3Rpb25WaWV3SXRlbTsKfShBY3Rpb25WaWV3SXRlbSk7CmV4cG9ydCBmdW5jdGlvbiBjbGVhbk1uZW1vbmljKGxhYmVsKSB7CiAgdmFyIHJlZ2V4ID0gTUVOVV9NTkVNT05JQ19SRUdFWDsKICB2YXIgbWF0Y2hlcyA9IHJlZ2V4LmV4ZWMobGFiZWwpOwogIGlmICghbWF0Y2hlcykgewogICAgcmV0dXJuIGxhYmVsOwogIH0KICB2YXIgbW5lbW9uaWNJblRleHQgPSAhbWF0Y2hlc1sxXTsKICByZXR1cm4gbGFiZWwucmVwbGFjZShyZWdleCwgbW5lbW9uaWNJblRleHQgPyAnJDIkMycgOiAnJykudHJpbSgpOwp9CmZ1bmN0aW9uIGdldE1lbnVXaWRnZXRDU1Moc3R5bGUsIGlzRm9yU2hhZG93RG9tKSB7CiAgdmFyIHJlc3VsdCA9IC8qIGNzcyAqLyJcbi5tb25hY28tbWVudSB7XG5cdGZvbnQtc2l6ZTogMTNweDtcblx0Ym9yZGVyLXJhZGl1czogNXB4O1xuXHRtaW4td2lkdGg6IDE2MHB4O1xufVxuXG4iLmNvbmNhdChmb3JtYXRSdWxlKENvZGljb24ubWVudVNlbGVjdGlvbiksICJcbiIpLmNvbmNhdChmb3JtYXRSdWxlKENvZGljb24ubWVudVN1Ym1lbnUpLCAiXG5cbi5tb25hY28tbWVudSAubW9uYWNvLWFjdGlvbi1iYXIge1xuXHR0ZXh0LWFsaWduOiByaWdodDtcblx0b3ZlcmZsb3c6IGhpZGRlbjtcblx0d2hpdGUtc3BhY2U6IG5vd3JhcDtcbn1cblxuLm1vbmFjby1tZW51IC5tb25hY28tYWN0aW9uLWJhciAuYWN0aW9ucy1jb250YWluZXIge1xuXHRkaXNwbGF5OiBmbGV4O1xuXHRtYXJnaW46IDAgYXV0bztcblx0cGFkZGluZzogMDtcblx0d2lkdGg6IDEwMCU7XG5cdGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7XG59XG5cbi5tb25hY28tbWVudSAubW9uYWNvLWFjdGlvbi1iYXIudmVydGljYWwgLmFjdGlvbnMtY29udGFpbmVyIHtcblx0ZGlzcGxheTogaW5saW5lLWJsb2NrO1xufVxuXG4ubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyLnJldmVyc2UgLmFjdGlvbnMtY29udGFpbmVyIHtcblx0ZmxleC1kaXJlY3Rpb246IHJvdy1yZXZlcnNlO1xufVxuXG4ubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyIC5hY3Rpb24taXRlbSB7XG5cdGN1cnNvcjogcG9pbnRlcjtcblx0ZGlzcGxheTogaW5saW5lLWJsb2NrO1xuXHR0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gNTBtcyBlYXNlO1xuXHRwb3NpdGlvbjogcmVsYXRpdmU7ICAvKiBETyBOT1QgUkVNT1ZFIC0gdGhpcyBpcyB0aGUga2V5IHRvIHByZXZlbnRpbmcgdGhlIGdob3N0aW5nIGljb24gYnVnIGluIENocm9tZSA0MiAqL1xufVxuXG4ubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyIC5hY3Rpb24taXRlbS5kaXNhYmxlZCB7XG5cdGN1cnNvcjogZGVmYXVsdDtcbn1cblxuLm1vbmFjby1tZW51IC5tb25hY28tYWN0aW9uLWJhci5hbmltYXRlZCAuYWN0aW9uLWl0ZW0uYWN0aXZlIHtcblx0dHJhbnNmb3JtOiBzY2FsZSgxLjI3MjAxOTY0OSwgMS4yNzIwMTk2NDkpOyAvKiAxLjI3MjAxOTY0OSA9IFx1MjIxQVx1MDNDNiAqL1xufVxuXG4ubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyIC5hY3Rpb24taXRlbSAuaWNvbixcbi5tb25hY28tbWVudSAubW9uYWNvLWFjdGlvbi1iYXIgLmFjdGlvbi1pdGVtIC5jb2RpY29uIHtcblx0ZGlzcGxheTogaW5saW5lLWJsb2NrO1xufVxuXG4ubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyIC5hY3Rpb24taXRlbSAuY29kaWNvbiB7XG5cdGRpc3BsYXk6IGZsZXg7XG5cdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG59XG5cbi5tb25hY28tbWVudSAubW9uYWNvLWFjdGlvbi1iYXIgLmFjdGlvbi1sYWJlbCB7XG5cdGZvbnQtc2l6ZTogMTFweDtcblx0bWFyZ2luLXJpZ2h0OiA0cHg7XG59XG5cbi5tb25hY28tbWVudSAubW9uYWNvLWFjdGlvbi1iYXIgLmFjdGlvbi1pdGVtLmRpc2FibGVkIC5hY3Rpb24tbGFiZWwsXG4ubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyIC5hY3Rpb24taXRlbS5kaXNhYmxlZCAuYWN0aW9uLWxhYmVsOmhvdmVyIHtcblx0Y29sb3I6IHZhcigtLXZzY29kZS1kaXNhYmxlZEZvcmVncm91bmQpO1xufVxuXG4vKiBWZXJ0aWNhbCBhY3Rpb25zICovXG5cbi5tb25hY28tbWVudSAubW9uYWNvLWFjdGlvbi1iYXIudmVydGljYWwge1xuXHR0ZXh0LWFsaWduOiBsZWZ0O1xufVxuXG4ubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyLnZlcnRpY2FsIC5hY3Rpb24taXRlbSB7XG5cdGRpc3BsYXk6IGJsb2NrO1xufVxuXG4ubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyLnZlcnRpY2FsIC5hY3Rpb24tbGFiZWwuc2VwYXJhdG9yIHtcblx0ZGlzcGxheTogYmxvY2s7XG5cdGJvcmRlci1ib3R0b206IDFweCBzb2xpZCB2YXIoLS12c2NvZGUtbWVudS1zZXBhcmF0b3JCYWNrZ3JvdW5kKTtcblx0cGFkZGluZy10b3A6IDFweDtcblx0cGFkZGluZzogMzBweDtcbn1cblxuLm1vbmFjby1tZW51IC5zZWNvbmRhcnktYWN0aW9ucyAubW9uYWNvLWFjdGlvbi1iYXIgLmFjdGlvbi1sYWJlbCB7XG5cdG1hcmdpbi1sZWZ0OiA2cHg7XG59XG5cbi8qIEFjdGlvbiBJdGVtcyAqL1xuLm1vbmFjby1tZW51IC5tb25hY28tYWN0aW9uLWJhciAuYWN0aW9uLWl0ZW0uc2VsZWN0LWNvbnRhaW5lciB7XG5cdG92ZXJmbG93OiBoaWRkZW47IC8qIHNvbWVob3cgdGhlIGRyb3Bkb3duIG92ZXJmbG93cyBpdHMgY29udGFpbmVyLCB3ZSBwcmV2ZW50IGl0IGhlcmUgdG8gbm90IHB1c2ggKi9cblx0ZmxleDogMTtcblx0bWF4LXdpZHRoOiAxNzBweDtcblx0bWluLXdpZHRoOiA2MHB4O1xuXHRkaXNwbGF5OiBmbGV4O1xuXHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0bWFyZ2luLXJpZ2h0OiAxMHB4O1xufVxuXG4ubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyLnZlcnRpY2FsIHtcblx0bWFyZ2luLWxlZnQ6IDA7XG5cdG92ZXJmbG93OiB2aXNpYmxlO1xufVxuXG4ubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyLnZlcnRpY2FsIC5hY3Rpb25zLWNvbnRhaW5lciB7XG5cdGRpc3BsYXk6IGJsb2NrO1xufVxuXG4ubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyLnZlcnRpY2FsIC5hY3Rpb24taXRlbSB7XG5cdHBhZGRpbmc6IDA7XG5cdHRyYW5zZm9ybTogbm9uZTtcblx0ZGlzcGxheTogZmxleDtcbn1cblxuLm1vbmFjby1tZW51IC5tb25hY28tYWN0aW9uLWJhci52ZXJ0aWNhbCAuYWN0aW9uLWl0ZW0uYWN0aXZlIHtcblx0dHJhbnNmb3JtOiBub25lO1xufVxuXG4ubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyLnZlcnRpY2FsIC5hY3Rpb24tbWVudS1pdGVtIHtcblx0ZmxleDogMSAxIGF1dG87XG5cdGRpc3BsYXk6IGZsZXg7XG5cdGhlaWdodDogMmVtO1xuXHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRwb3NpdGlvbjogcmVsYXRpdmU7XG59XG5cbi5tb25hY28tbWVudSAubW9uYWNvLWFjdGlvbi1iYXIudmVydGljYWwgLmFjdGlvbi1tZW51LWl0ZW06aG92ZXIgLmtleWJpbmRpbmcsXG4ubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyLnZlcnRpY2FsIC5hY3Rpb24tbWVudS1pdGVtOmZvY3VzIC5rZXliaW5kaW5nIHtcblx0b3BhY2l0eTogdW5zZXQ7XG59XG5cbi5tb25hY28tbWVudSAubW9uYWNvLWFjdGlvbi1iYXIudmVydGljYWwgLmFjdGlvbi1sYWJlbCB7XG5cdGZsZXg6IDEgMSBhdXRvO1xuXHR0ZXh0LWRlY29yYXRpb246IG5vbmU7XG5cdHBhZGRpbmc6IDAgMWVtO1xuXHRiYWNrZ3JvdW5kOiBub25lO1xuXHRmb250LXNpemU6IDEycHg7XG5cdGxpbmUtaGVpZ2h0OiAxO1xufVxuXG4ubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyLnZlcnRpY2FsIC5rZXliaW5kaW5nLFxuLm1vbmFjby1tZW51IC5tb25hY28tYWN0aW9uLWJhci52ZXJ0aWNhbCAuc3VibWVudS1pbmRpY2F0b3Ige1xuXHRkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG5cdGZsZXg6IDIgMSBhdXRvO1xuXHRwYWRkaW5nOiAwIDFlbTtcblx0dGV4dC1hbGlnbjogcmlnaHQ7XG5cdGZvbnQtc2l6ZTogMTJweDtcblx0bGluZS1oZWlnaHQ6IDE7XG59XG5cbi5tb25hY28tbWVudSAubW9uYWNvLWFjdGlvbi1iYXIudmVydGljYWwgLnN1Ym1lbnUtaW5kaWNhdG9yIHtcblx0aGVpZ2h0OiAxMDAlO1xufVxuXG4ubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyLnZlcnRpY2FsIC5zdWJtZW51LWluZGljYXRvci5jb2RpY29uIHtcblx0Zm9udC1zaXplOiAxNnB4ICFpbXBvcnRhbnQ7XG5cdGRpc3BsYXk6IGZsZXg7XG5cdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG59XG5cbi5tb25hY28tbWVudSAubW9uYWNvLWFjdGlvbi1iYXIudmVydGljYWwgLnN1Ym1lbnUtaW5kaWNhdG9yLmNvZGljb246OmJlZm9yZSB7XG5cdG1hcmdpbi1sZWZ0OiBhdXRvO1xuXHRtYXJnaW4tcmlnaHQ6IC0yMHB4O1xufVxuXG4ubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyLnZlcnRpY2FsIC5hY3Rpb24taXRlbS5kaXNhYmxlZCAua2V5YmluZGluZyxcbi5tb25hY28tbWVudSAubW9uYWNvLWFjdGlvbi1iYXIudmVydGljYWwgLmFjdGlvbi1pdGVtLmRpc2FibGVkIC5zdWJtZW51LWluZGljYXRvciB7XG5cdG9wYWNpdHk6IDAuNDtcbn1cblxuLm1vbmFjby1tZW51IC5tb25hY28tYWN0aW9uLWJhci52ZXJ0aWNhbCAuYWN0aW9uLWxhYmVsOm5vdCguc2VwYXJhdG9yKSB7XG5cdGRpc3BsYXk6IGlubGluZS1ibG9jaztcblx0Ym94LXNpemluZzogYm9yZGVyLWJveDtcblx0bWFyZ2luOiAwO1xufVxuXG4ubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyLnZlcnRpY2FsIC5hY3Rpb24taXRlbSB7XG5cdHBvc2l0aW9uOiBzdGF0aWM7XG5cdG92ZXJmbG93OiB2aXNpYmxlO1xufVxuXG4ubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyLnZlcnRpY2FsIC5hY3Rpb24taXRlbSAubW9uYWNvLXN1Ym1lbnUge1xuXHRwb3NpdGlvbjogYWJzb2x1dGU7XG59XG5cbi5tb25hY28tbWVudSAubW9uYWNvLWFjdGlvbi1iYXIudmVydGljYWwgLmFjdGlvbi1sYWJlbC5zZXBhcmF0b3Ige1xuXHR3aWR0aDogMTAwJTtcblx0aGVpZ2h0OiAwcHggIWltcG9ydGFudDtcblx0b3BhY2l0eTogMTtcbn1cblxuLm1vbmFjby1tZW51IC5tb25hY28tYWN0aW9uLWJhci52ZXJ0aWNhbCAuYWN0aW9uLWxhYmVsLnNlcGFyYXRvci50ZXh0IHtcblx0cGFkZGluZzogMC43ZW0gMWVtIDAuMWVtIDFlbTtcblx0Zm9udC13ZWlnaHQ6IGJvbGQ7XG5cdG9wYWNpdHk6IDE7XG59XG5cbi5tb25hY28tbWVudSAubW9uYWNvLWFjdGlvbi1iYXIudmVydGljYWwgLmFjdGlvbi1sYWJlbDpob3ZlciB7XG5cdGNvbG9yOiBpbmhlcml0O1xufVxuXG4ubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyLnZlcnRpY2FsIC5tZW51LWl0ZW0tY2hlY2sge1xuXHRwb3NpdGlvbjogYWJzb2x1dGU7XG5cdHZpc2liaWxpdHk6IGhpZGRlbjtcblx0d2lkdGg6IDFlbTtcblx0aGVpZ2h0OiAxMDAlO1xufVxuXG4ubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyLnZlcnRpY2FsIC5hY3Rpb24tbWVudS1pdGVtLmNoZWNrZWQgLm1lbnUtaXRlbS1jaGVjayB7XG5cdHZpc2liaWxpdHk6IHZpc2libGU7XG5cdGRpc3BsYXk6IGZsZXg7XG5cdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdGp1c3RpZnktY29udGVudDogY2VudGVyO1xufVxuXG4vKiBDb250ZXh0IE1lbnUgKi9cblxuLmNvbnRleHQtdmlldy5tb25hY28tbWVudS1jb250YWluZXIge1xuXHRvdXRsaW5lOiAwO1xuXHRib3JkZXI6IG5vbmU7XG5cdGFuaW1hdGlvbjogZmFkZUluIDAuMDgzcyBsaW5lYXI7XG5cdC13ZWJraXQtYXBwLXJlZ2lvbjogbm8tZHJhZztcbn1cblxuLmNvbnRleHQtdmlldy5tb25hY28tbWVudS1jb250YWluZXIgOmZvY3VzLFxuLmNvbnRleHQtdmlldy5tb25hY28tbWVudS1jb250YWluZXIgLm1vbmFjby1hY3Rpb24tYmFyLnZlcnRpY2FsOmZvY3VzLFxuLmNvbnRleHQtdmlldy5tb25hY28tbWVudS1jb250YWluZXIgLm1vbmFjby1hY3Rpb24tYmFyLnZlcnRpY2FsIDpmb2N1cyB7XG5cdG91dGxpbmU6IDA7XG59XG5cbi5oYy1ibGFjayAuY29udGV4dC12aWV3Lm1vbmFjby1tZW51LWNvbnRhaW5lcixcbi5oYy1saWdodCAuY29udGV4dC12aWV3Lm1vbmFjby1tZW51LWNvbnRhaW5lcixcbjpob3N0LWNvbnRleHQoLmhjLWJsYWNrKSAuY29udGV4dC12aWV3Lm1vbmFjby1tZW51LWNvbnRhaW5lcixcbjpob3N0LWNvbnRleHQoLmhjLWxpZ2h0KSAuY29udGV4dC12aWV3Lm1vbmFjby1tZW51LWNvbnRhaW5lciB7XG5cdGJveC1zaGFkb3c6IG5vbmU7XG59XG5cbi5oYy1ibGFjayAubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyLnZlcnRpY2FsIC5hY3Rpb24taXRlbS5mb2N1c2VkLFxuLmhjLWxpZ2h0IC5tb25hY28tbWVudSAubW9uYWNvLWFjdGlvbi1iYXIudmVydGljYWwgLmFjdGlvbi1pdGVtLmZvY3VzZWQsXG46aG9zdC1jb250ZXh0KC5oYy1ibGFjaykgLm1vbmFjby1tZW51IC5tb25hY28tYWN0aW9uLWJhci52ZXJ0aWNhbCAuYWN0aW9uLWl0ZW0uZm9jdXNlZCxcbjpob3N0LWNvbnRleHQoLmhjLWxpZ2h0KSAubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyLnZlcnRpY2FsIC5hY3Rpb24taXRlbS5mb2N1c2VkIHtcblx0YmFja2dyb3VuZDogbm9uZTtcbn1cblxuLyogVmVydGljYWwgQWN0aW9uIEJhciBTdHlsZXMgKi9cblxuLm1vbmFjby1tZW51IC5tb25hY28tYWN0aW9uLWJhci52ZXJ0aWNhbCB7XG5cdHBhZGRpbmc6IC42ZW0gMDtcbn1cblxuLm1vbmFjby1tZW51IC5tb25hY28tYWN0aW9uLWJhci52ZXJ0aWNhbCAuYWN0aW9uLW1lbnUtaXRlbSB7XG5cdGhlaWdodDogMmVtO1xufVxuXG4ubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyLnZlcnRpY2FsIC5hY3Rpb24tbGFiZWw6bm90KC5zZXBhcmF0b3IpLFxuLm1vbmFjby1tZW51IC5tb25hY28tYWN0aW9uLWJhci52ZXJ0aWNhbCAua2V5YmluZGluZyB7XG5cdGZvbnQtc2l6ZTogaW5oZXJpdDtcblx0cGFkZGluZzogMCAyZW07XG59XG5cbi5tb25hY28tbWVudSAubW9uYWNvLWFjdGlvbi1iYXIudmVydGljYWwgLm1lbnUtaXRlbS1jaGVjayB7XG5cdGZvbnQtc2l6ZTogaW5oZXJpdDtcblx0d2lkdGg6IDJlbTtcbn1cblxuLm1vbmFjby1tZW51IC5tb25hY28tYWN0aW9uLWJhci52ZXJ0aWNhbCAuYWN0aW9uLWxhYmVsLnNlcGFyYXRvciB7XG5cdGZvbnQtc2l6ZTogaW5oZXJpdDtcblx0bWFyZ2luOiA1cHggMCAhaW1wb3J0YW50O1xuXHRwYWRkaW5nOiAwO1xuXHRib3JkZXItcmFkaXVzOiAwO1xufVxuXG4ubGludXggLm1vbmFjby1tZW51IC5tb25hY28tYWN0aW9uLWJhci52ZXJ0aWNhbCAuYWN0aW9uLWxhYmVsLnNlcGFyYXRvcixcbjpob3N0LWNvbnRleHQoLmxpbnV4KSAubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyLnZlcnRpY2FsIC5hY3Rpb24tbGFiZWwuc2VwYXJhdG9yIHtcblx0bWFyZ2luLWxlZnQ6IDA7XG5cdG1hcmdpbi1yaWdodDogMDtcbn1cblxuLm1vbmFjby1tZW51IC5tb25hY28tYWN0aW9uLWJhci52ZXJ0aWNhbCAuc3VibWVudS1pbmRpY2F0b3Ige1xuXHRmb250LXNpemU6IDYwJTtcblx0cGFkZGluZzogMCAxLjhlbTtcbn1cblxuLmxpbnV4IC5tb25hY28tbWVudSAubW9uYWNvLWFjdGlvbi1iYXIudmVydGljYWwgLnN1Ym1lbnUtaW5kaWNhdG9yIHtcbjpob3N0LWNvbnRleHQoLmxpbnV4KSAubW9uYWNvLW1lbnUgLm1vbmFjby1hY3Rpb24tYmFyLnZlcnRpY2FsIC5zdWJtZW51LWluZGljYXRvciB7XG5cdGhlaWdodDogMTAwJTtcblx0bWFzay1zaXplOiAxMHB4IDEwcHg7XG5cdC13ZWJraXQtbWFzay1zaXplOiAxMHB4IDEwcHg7XG59XG5cbi5tb25hY28tbWVudSAuYWN0aW9uLWl0ZW0ge1xuXHRjdXJzb3I6IGRlZmF1bHQ7XG59Iik7CiAgaWYgKGlzRm9yU2hhZG93RG9tKSB7CiAgICAvLyBPbmx5IGRlZmluZSBzY3JvbGxiYXIgc3R5bGVzIHdoZW4gdXNlZCBpbnNpZGUgc2hhZG93IGRvbSwKICAgIC8vIG90aGVyd2lzZSBsZWF2ZSB0aGVpciBzdHlsaW5nIHRvIHRoZSBnbG9iYWwgd29ya2JlbmNoIHN0eWxpbmcuCiAgICByZXN1bHQgKz0gIlxuXHRcdFx0LyogQXJyb3dzICovXG5cdFx0XHQubW9uYWNvLXNjcm9sbGFibGUtZWxlbWVudCA+IC5zY3JvbGxiYXIgPiAuc2NyYSB7XG5cdFx0XHRcdGN1cnNvcjogcG9pbnRlcjtcblx0XHRcdFx0Zm9udC1zaXplOiAxMXB4ICFpbXBvcnRhbnQ7XG5cdFx0XHR9XG5cblx0XHRcdC5tb25hY28tc2Nyb2xsYWJsZS1lbGVtZW50ID4gLnZpc2libGUge1xuXHRcdFx0XHRvcGFjaXR5OiAxO1xuXG5cdFx0XHRcdC8qIEJhY2tncm91bmQgcnVsZSBhZGRlZCBmb3IgSUU5IC0gdG8gYWxsb3cgY2xpY2tzIG9uIGRvbSBub2RlICovXG5cdFx0XHRcdGJhY2tncm91bmQ6cmdiYSgwLDAsMCwwKTtcblxuXHRcdFx0XHR0cmFuc2l0aW9uOiBvcGFjaXR5IDEwMG1zIGxpbmVhcjtcblx0XHRcdH1cblx0XHRcdC5tb25hY28tc2Nyb2xsYWJsZS1lbGVtZW50ID4gLmludmlzaWJsZSB7XG5cdFx0XHRcdG9wYWNpdHk6IDA7XG5cdFx0XHRcdHBvaW50ZXItZXZlbnRzOiBub25lO1xuXHRcdFx0fVxuXHRcdFx0Lm1vbmFjby1zY3JvbGxhYmxlLWVsZW1lbnQgPiAuaW52aXNpYmxlLmZhZGUge1xuXHRcdFx0XHR0cmFuc2l0aW9uOiBvcGFjaXR5IDgwMG1zIGxpbmVhcjtcblx0XHRcdH1cblxuXHRcdFx0LyogU2Nyb2xsYWJsZSBDb250ZW50IEluc2V0IFNoYWRvdyAqL1xuXHRcdFx0Lm1vbmFjby1zY3JvbGxhYmxlLWVsZW1lbnQgPiAuc2hhZG93IHtcblx0XHRcdFx0cG9zaXRpb246IGFic29sdXRlO1xuXHRcdFx0XHRkaXNwbGF5OiBub25lO1xuXHRcdFx0fVxuXHRcdFx0Lm1vbmFjby1zY3JvbGxhYmxlLWVsZW1lbnQgPiAuc2hhZG93LnRvcCB7XG5cdFx0XHRcdGRpc3BsYXk6IGJsb2NrO1xuXHRcdFx0XHR0b3A6IDA7XG5cdFx0XHRcdGxlZnQ6IDNweDtcblx0XHRcdFx0aGVpZ2h0OiAzcHg7XG5cdFx0XHRcdHdpZHRoOiAxMDAlO1xuXHRcdFx0fVxuXHRcdFx0Lm1vbmFjby1zY3JvbGxhYmxlLWVsZW1lbnQgPiAuc2hhZG93LmxlZnQge1xuXHRcdFx0XHRkaXNwbGF5OiBibG9jaztcblx0XHRcdFx0dG9wOiAzcHg7XG5cdFx0XHRcdGxlZnQ6IDA7XG5cdFx0XHRcdGhlaWdodDogMTAwJTtcblx0XHRcdFx0d2lkdGg6IDNweDtcblx0XHRcdH1cblx0XHRcdC5tb25hY28tc2Nyb2xsYWJsZS1lbGVtZW50ID4gLnNoYWRvdy50b3AtbGVmdC1jb3JuZXIge1xuXHRcdFx0XHRkaXNwbGF5OiBibG9jaztcblx0XHRcdFx0dG9wOiAwO1xuXHRcdFx0XHRsZWZ0OiAwO1xuXHRcdFx0XHRoZWlnaHQ6IDNweDtcblx0XHRcdFx0d2lkdGg6IDNweDtcblx0XHRcdH1cblx0XHQiOwogICAgLy8gU2Nyb2xsYmFycwogICAgdmFyIHNjcm9sbGJhclNoYWRvd0NvbG9yID0gc3R5bGUuc2Nyb2xsYmFyU2hhZG93OwogICAgaWYgKHNjcm9sbGJhclNoYWRvd0NvbG9yKSB7CiAgICAgIHJlc3VsdCArPSAiXG5cdFx0XHRcdC5tb25hY28tc2Nyb2xsYWJsZS1lbGVtZW50ID4gLnNoYWRvdy50b3Age1xuXHRcdFx0XHRcdGJveC1zaGFkb3c6ICIuY29uY2F0KHNjcm9sbGJhclNoYWRvd0NvbG9yLCAiIDAgNnB4IDZweCAtNnB4IGluc2V0O1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Lm1vbmFjby1zY3JvbGxhYmxlLWVsZW1lbnQgPiAuc2hhZG93LmxlZnQge1xuXHRcdFx0XHRcdGJveC1zaGFkb3c6ICIpLmNvbmNhdChzY3JvbGxiYXJTaGFkb3dDb2xvciwgIiA2cHggMCA2cHggLTZweCBpbnNldDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC5tb25hY28tc2Nyb2xsYWJsZS1lbGVtZW50ID4gLnNoYWRvdy50b3AubGVmdCB7XG5cdFx0XHRcdFx0Ym94LXNoYWRvdzogIikuY29uY2F0KHNjcm9sbGJhclNoYWRvd0NvbG9yLCAiIDZweCA2cHggNnB4IC02cHggaW5zZXQ7XG5cdFx0XHRcdH1cblx0XHRcdCIpOwogICAgfQogICAgdmFyIHNjcm9sbGJhclNsaWRlckJhY2tncm91bmRDb2xvciA9IHN0eWxlLnNjcm9sbGJhclNsaWRlckJhY2tncm91bmQ7CiAgICBpZiAoc2Nyb2xsYmFyU2xpZGVyQmFja2dyb3VuZENvbG9yKSB7CiAgICAgIHJlc3VsdCArPSAiXG5cdFx0XHRcdC5tb25hY28tc2Nyb2xsYWJsZS1lbGVtZW50ID4gLnNjcm9sbGJhciA+IC5zbGlkZXIge1xuXHRcdFx0XHRcdGJhY2tncm91bmQ6ICIuY29uY2F0KHNjcm9sbGJhclNsaWRlckJhY2tncm91bmRDb2xvciwgIjtcblx0XHRcdFx0fVxuXHRcdFx0Iik7CiAgICB9CiAgICB2YXIgc2Nyb2xsYmFyU2xpZGVySG92ZXJCYWNrZ3JvdW5kQ29sb3IgPSBzdHlsZS5zY3JvbGxiYXJTbGlkZXJIb3ZlckJhY2tncm91bmQ7CiAgICBpZiAoc2Nyb2xsYmFyU2xpZGVySG92ZXJCYWNrZ3JvdW5kQ29sb3IpIHsKICAgICAgcmVzdWx0ICs9ICJcblx0XHRcdFx0Lm1vbmFjby1zY3JvbGxhYmxlLWVsZW1lbnQgPiAuc2Nyb2xsYmFyID4gLnNsaWRlcjpob3ZlciB7XG5cdFx0XHRcdFx0YmFja2dyb3VuZDogIi5jb25jYXQoc2Nyb2xsYmFyU2xpZGVySG92ZXJCYWNrZ3JvdW5kQ29sb3IsICI7XG5cdFx0XHRcdH1cblx0XHRcdCIpOwogICAgfQogICAgdmFyIHNjcm9sbGJhclNsaWRlckFjdGl2ZUJhY2tncm91bmRDb2xvciA9IHN0eWxlLnNjcm9sbGJhclNsaWRlckFjdGl2ZUJhY2tncm91bmQ7CiAgICBpZiAoc2Nyb2xsYmFyU2xpZGVyQWN0aXZlQmFja2dyb3VuZENvbG9yKSB7CiAgICAgIHJlc3VsdCArPSAiXG5cdFx0XHRcdC5tb25hY28tc2Nyb2xsYWJsZS1lbGVtZW50ID4gLnNjcm9sbGJhciA+IC5zbGlkZXIuYWN0aXZlIHtcblx0XHRcdFx0XHRiYWNrZ3JvdW5kOiAiLmNvbmNhdChzY3JvbGxiYXJTbGlkZXJBY3RpdmVCYWNrZ3JvdW5kQ29sb3IsICI7XG5cdFx0XHRcdH1cblx0XHRcdCIpOwogICAgfQogIH0KICByZXR1cm4gcmVzdWx0Owp9"},{"version":3,"names":["isFirefox","EventType","TouchEventType","Gesture","$","addDisposableListener","append","clearNode","createStyleSheet","Dimension","EventHelper","getActiveElement","isAncestor","isInShadowDOM","StandardKeyboardEvent","StandardMouseEvent","ActionBar","ActionViewItem","BaseActionViewItem","formatRule","layout","DomScrollableElement","EmptySubmenuAction","Separator","SubmenuAction","RunOnceScheduler","Codicon","stripIcons","DisposableStore","isLinux","isMacintosh","strings","MENU_MNEMONIC_REGEX","MENU_ESCAPED_MNEMONIC_REGEX","Direction","Menu","container","actions","options","classList","add","setAttribute","menuElement","document","createElement","orientation","actionViewItemProvider","action","doGetActionViewItem","parentData","context","actionRunner","ariaLabel","ariaRole","focusOnlyEnabledItems","triggerKeys","keys","keyDown","actionsList","tabIndex","menuDisposables","_register","initializeOrUpdateStyleSheet","addTarget","KEY_DOWN","e","event","equals","preventDefault","enableMnemonics","key","toLocaleLowerCase","mnemonics","has","stop","get","length","SubmenuMenuActionViewItem","focusItemByElement","onClick","shift","push","set","focusedItem","viewItems","focusNext","focusPrevious","domNode","MOUSE_OUT","relatedTarget","undefined","updateFocus","stopPropagation","MOUSE_OVER","target","parentElement","contains","lastFocusedItem","setFocusedItem","Tap","initialTarget","parent","Map","scrollableElement","alwaysConsumeMouseWheel","horizontal","vertical","verticalScrollbarSize","handleMouseWheel","useShadows","scrollElement","getDomNode","style","position","Change","scrollTop","getScrollPosition","setScrollPosition","translationY","MOUSE_UP","maxHeight","Math","max","window","innerHeight","getBoundingClientRect","top","filter","a","_a","submenuIds","id","console","warn","icon","label","isMenu","appendChild","scanDomNode","item","MenuSeparatorActionViewItem","forEach","index","array","updatePositionInSet","styleSheet","globalStyleSheet","textContent","getMenuWidgetCSS","getContainer","fgColor","foregroundColor","bgColor","backgroundColor","border","borderColor","borderRadius","shadow","shadowColor","outline","color","boxShadow","BaseMenuActionViewItem","onScroll","element","i","children","elem","fromRight","round","menuActionViewItem","Object","assign","Set","mnemonic","getMnemonic","isEnabled","actionViewItems","menuItemOptions","useEventAsContext","getKeyBinding","keybinding","keybindingLabel","getLabel","ctx","cssClass","getAction","matches","exec","runOnceToEnableMouseUp","mouseEvent","rightButton","setTimeout","CONTEXT_MENU","_action","ID","check","menuSelection","cssSelector","schedule","updateClass","updateLabel","updateTooltip","updateEnabled","updateChecked","applyStyle","focus","pos","setSize","cleanLabel","cleanMnemonic","replace","escape","lastIndex","escMatch","replaceDoubleEscapes","str","ltrim","substr","rtrim","innerText","trim","remove","split","class","enabled","removeAttribute","checked","toggle","menuStyle","isSelected","selectionForegroundColor","selectionBackgroundColor","selectionBorderColor","outlineOffset","toString","submenuActions","submenuOptions","mysubmenu","submenuDisposables","mouseOver","expandDirection","Right","showScheduler","cleanupExistingSubmenu","createSubmenu","hideScheduler","submenu","updateAriaExpanded","submenuIndicator","menuSubmenu","KEY_UP","MOUSE_LEAVE","FOCUS_OUT","force","dispose","submenuContainer","clear","windowDimensions","entry","ret","left","width","offset","size","height","selectFirstItem","computedStyles","getComputedStyle","paddingTop","parseFloat","zIndex","entryBox","entryBoxUpdated","viewBox","calculateSubmenuMenuLayout","innerWidth","lift","onDidCancel","value","borderBottomColor","separatorColor","regex","mnemonicInText","isForShadowDom","result","scrollbarShadowColor","scrollbarShadow","scrollbarSliderBackgroundColor","scrollbarSliderBackground","scrollbarSliderHoverBackgroundColor","scrollbarSliderHoverBackground","scrollbarSliderActiveBackgroundColor","scrollbarSliderActiveBackground"],"sources":["/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/base/browser/ui/menu/menu.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { isFirefox } from '../../browser.js';\nimport { EventType as TouchEventType, Gesture } from '../../touch.js';\nimport { $, addDisposableListener, append, clearNode, createStyleSheet, Dimension, EventHelper, EventType, getActiveElement, isAncestor, isInShadowDOM } from '../../dom.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { StandardMouseEvent } from '../../mouseEvent.js';\nimport { ActionBar } from '../actionbar/actionbar.js';\nimport { ActionViewItem, BaseActionViewItem } from '../actionbar/actionViewItems.js';\nimport { formatRule } from '../codicons/codiconStyles.js';\nimport { layout } from '../contextview/contextview.js';\nimport { DomScrollableElement } from '../scrollbar/scrollableElement.js';\nimport { EmptySubmenuAction, Separator, SubmenuAction } from '../../../common/actions.js';\nimport { RunOnceScheduler } from '../../../common/async.js';\nimport { Codicon } from '../../../common/codicons.js';\nimport { stripIcons } from '../../../common/iconLabels.js';\nimport { DisposableStore } from '../../../common/lifecycle.js';\nimport { isLinux, isMacintosh } from '../../../common/platform.js';\nimport * as strings from '../../../common/strings.js';\nexport const MENU_MNEMONIC_REGEX = /\\(&([^\\s&])\\)|(^|[^&])&([^\\s&])/;\nexport const MENU_ESCAPED_MNEMONIC_REGEX = /(&amp;)?(&amp;)([^\\s&])/g;\nexport var Direction;\n(function (Direction) {\n    Direction[Direction[\"Right\"] = 0] = \"Right\";\n    Direction[Direction[\"Left\"] = 1] = \"Left\";\n})(Direction || (Direction = {}));\nexport class Menu extends ActionBar {\n    constructor(container, actions, options = {}) {\n        container.classList.add('monaco-menu-container');\n        container.setAttribute('role', 'presentation');\n        const menuElement = document.createElement('div');\n        menuElement.classList.add('monaco-menu');\n        menuElement.setAttribute('role', 'presentation');\n        super(menuElement, {\n            orientation: 1 /* ActionsOrientation.VERTICAL */,\n            actionViewItemProvider: action => this.doGetActionViewItem(action, options, parentData),\n            context: options.context,\n            actionRunner: options.actionRunner,\n            ariaLabel: options.ariaLabel,\n            ariaRole: 'menu',\n            focusOnlyEnabledItems: true,\n            triggerKeys: { keys: [3 /* KeyCode.Enter */, ...(isMacintosh || isLinux ? [10 /* KeyCode.Space */] : [])], keyDown: true }\n        });\n        this.menuElement = menuElement;\n        this.actionsList.tabIndex = 0;\n        this.menuDisposables = this._register(new DisposableStore());\n        this.initializeOrUpdateStyleSheet(container, {});\n        this._register(Gesture.addTarget(menuElement));\n        addDisposableListener(menuElement, EventType.KEY_DOWN, (e) => {\n            const event = new StandardKeyboardEvent(e);\n            // Stop tab navigation of menus\n            if (event.equals(2 /* KeyCode.Tab */)) {\n                e.preventDefault();\n            }\n        });\n        if (options.enableMnemonics) {\n            this.menuDisposables.add(addDisposableListener(menuElement, EventType.KEY_DOWN, (e) => {\n                const key = e.key.toLocaleLowerCase();\n                if (this.mnemonics.has(key)) {\n                    EventHelper.stop(e, true);\n                    const actions = this.mnemonics.get(key);\n                    if (actions.length === 1) {\n                        if (actions[0] instanceof SubmenuMenuActionViewItem && actions[0].container) {\n                            this.focusItemByElement(actions[0].container);\n                        }\n                        actions[0].onClick(e);\n                    }\n                    if (actions.length > 1) {\n                        const action = actions.shift();\n                        if (action && action.container) {\n                            this.focusItemByElement(action.container);\n                            actions.push(action);\n                        }\n                        this.mnemonics.set(key, actions);\n                    }\n                }\n            }));\n        }\n        if (isLinux) {\n            this._register(addDisposableListener(menuElement, EventType.KEY_DOWN, e => {\n                const event = new StandardKeyboardEvent(e);\n                if (event.equals(14 /* KeyCode.Home */) || event.equals(11 /* KeyCode.PageUp */)) {\n                    this.focusedItem = this.viewItems.length - 1;\n                    this.focusNext();\n                    EventHelper.stop(e, true);\n                }\n                else if (event.equals(13 /* KeyCode.End */) || event.equals(12 /* KeyCode.PageDown */)) {\n                    this.focusedItem = 0;\n                    this.focusPrevious();\n                    EventHelper.stop(e, true);\n                }\n            }));\n        }\n        this._register(addDisposableListener(this.domNode, EventType.MOUSE_OUT, e => {\n            const relatedTarget = e.relatedTarget;\n            if (!isAncestor(relatedTarget, this.domNode)) {\n                this.focusedItem = undefined;\n                this.updateFocus();\n                e.stopPropagation();\n            }\n        }));\n        this._register(addDisposableListener(this.actionsList, EventType.MOUSE_OVER, e => {\n            let target = e.target;\n            if (!target || !isAncestor(target, this.actionsList) || target === this.actionsList) {\n                return;\n            }\n            while (target.parentElement !== this.actionsList && target.parentElement !== null) {\n                target = target.parentElement;\n            }\n            if (target.classList.contains('action-item')) {\n                const lastFocusedItem = this.focusedItem;\n                this.setFocusedItem(target);\n                if (lastFocusedItem !== this.focusedItem) {\n                    this.updateFocus();\n                }\n            }\n        }));\n        // Support touch on actions list to focus items (needed for submenus)\n        this._register(Gesture.addTarget(this.actionsList));\n        this._register(addDisposableListener(this.actionsList, TouchEventType.Tap, e => {\n            let target = e.initialTarget;\n            if (!target || !isAncestor(target, this.actionsList) || target === this.actionsList) {\n                return;\n            }\n            while (target.parentElement !== this.actionsList && target.parentElement !== null) {\n                target = target.parentElement;\n            }\n            if (target.classList.contains('action-item')) {\n                const lastFocusedItem = this.focusedItem;\n                this.setFocusedItem(target);\n                if (lastFocusedItem !== this.focusedItem) {\n                    this.updateFocus();\n                }\n            }\n        }));\n        const parentData = {\n            parent: this\n        };\n        this.mnemonics = new Map();\n        // Scroll Logic\n        this.scrollableElement = this._register(new DomScrollableElement(menuElement, {\n            alwaysConsumeMouseWheel: true,\n            horizontal: 2 /* ScrollbarVisibility.Hidden */,\n            vertical: 3 /* ScrollbarVisibility.Visible */,\n            verticalScrollbarSize: 7,\n            handleMouseWheel: true,\n            useShadows: true\n        }));\n        const scrollElement = this.scrollableElement.getDomNode();\n        scrollElement.style.position = '';\n        // Support scroll on menu drag\n        this._register(addDisposableListener(menuElement, TouchEventType.Change, e => {\n            EventHelper.stop(e, true);\n            const scrollTop = this.scrollableElement.getScrollPosition().scrollTop;\n            this.scrollableElement.setScrollPosition({ scrollTop: scrollTop - e.translationY });\n        }));\n        this._register(addDisposableListener(scrollElement, EventType.MOUSE_UP, e => {\n            // Absorb clicks in menu dead space https://github.com/microsoft/vscode/issues/63575\n            // We do this on the scroll element so the scroll bar doesn't dismiss the menu either\n            e.preventDefault();\n        }));\n        menuElement.style.maxHeight = `${Math.max(10, window.innerHeight - container.getBoundingClientRect().top - 35)}px`;\n        actions = actions.filter(a => {\n            var _a;\n            if ((_a = options.submenuIds) === null || _a === void 0 ? void 0 : _a.has(a.id)) {\n                console.warn(`Found submenu cycle: ${a.id}`);\n                return false;\n            }\n            return true;\n        });\n        this.push(actions, { icon: true, label: true, isMenu: true });\n        container.appendChild(this.scrollableElement.getDomNode());\n        this.scrollableElement.scanDomNode();\n        this.viewItems.filter(item => !(item instanceof MenuSeparatorActionViewItem)).forEach((item, index, array) => {\n            item.updatePositionInSet(index + 1, array.length);\n        });\n    }\n    initializeOrUpdateStyleSheet(container, style) {\n        if (!this.styleSheet) {\n            if (isInShadowDOM(container)) {\n                this.styleSheet = createStyleSheet(container);\n            }\n            else {\n                if (!Menu.globalStyleSheet) {\n                    Menu.globalStyleSheet = createStyleSheet();\n                }\n                this.styleSheet = Menu.globalStyleSheet;\n            }\n        }\n        this.styleSheet.textContent = getMenuWidgetCSS(style, isInShadowDOM(container));\n    }\n    style(style) {\n        const container = this.getContainer();\n        this.initializeOrUpdateStyleSheet(container, style);\n        const fgColor = style.foregroundColor ? `${style.foregroundColor}` : '';\n        const bgColor = style.backgroundColor ? `${style.backgroundColor}` : '';\n        const border = style.borderColor ? `1px solid ${style.borderColor}` : '';\n        const borderRadius = '5px';\n        const shadow = style.shadowColor ? `0 2px 8px ${style.shadowColor}` : '';\n        container.style.outline = border;\n        container.style.borderRadius = borderRadius;\n        container.style.color = fgColor;\n        container.style.backgroundColor = bgColor;\n        container.style.boxShadow = shadow;\n        if (this.viewItems) {\n            this.viewItems.forEach(item => {\n                if (item instanceof BaseMenuActionViewItem || item instanceof MenuSeparatorActionViewItem) {\n                    item.style(style);\n                }\n            });\n        }\n    }\n    getContainer() {\n        return this.scrollableElement.getDomNode();\n    }\n    get onScroll() {\n        return this.scrollableElement.onScroll;\n    }\n    focusItemByElement(element) {\n        const lastFocusedItem = this.focusedItem;\n        this.setFocusedItem(element);\n        if (lastFocusedItem !== this.focusedItem) {\n            this.updateFocus();\n        }\n    }\n    setFocusedItem(element) {\n        for (let i = 0; i < this.actionsList.children.length; i++) {\n            const elem = this.actionsList.children[i];\n            if (element === elem) {\n                this.focusedItem = i;\n                break;\n            }\n        }\n    }\n    updateFocus(fromRight) {\n        super.updateFocus(fromRight, true, true);\n        if (typeof this.focusedItem !== 'undefined') {\n            // Workaround for #80047 caused by an issue in chromium\n            // https://bugs.chromium.org/p/chromium/issues/detail?id=414283\n            // When that's fixed, just call this.scrollableElement.scanDomNode()\n            this.scrollableElement.setScrollPosition({\n                scrollTop: Math.round(this.menuElement.scrollTop)\n            });\n        }\n    }\n    doGetActionViewItem(action, options, parentData) {\n        if (action instanceof Separator) {\n            return new MenuSeparatorActionViewItem(options.context, action, { icon: true });\n        }\n        else if (action instanceof SubmenuAction) {\n            const menuActionViewItem = new SubmenuMenuActionViewItem(action, action.actions, parentData, Object.assign(Object.assign({}, options), { submenuIds: new Set([...(options.submenuIds || []), action.id]) }));\n            if (options.enableMnemonics) {\n                const mnemonic = menuActionViewItem.getMnemonic();\n                if (mnemonic && menuActionViewItem.isEnabled()) {\n                    let actionViewItems = [];\n                    if (this.mnemonics.has(mnemonic)) {\n                        actionViewItems = this.mnemonics.get(mnemonic);\n                    }\n                    actionViewItems.push(menuActionViewItem);\n                    this.mnemonics.set(mnemonic, actionViewItems);\n                }\n            }\n            return menuActionViewItem;\n        }\n        else {\n            const menuItemOptions = { enableMnemonics: options.enableMnemonics, useEventAsContext: options.useEventAsContext };\n            if (options.getKeyBinding) {\n                const keybinding = options.getKeyBinding(action);\n                if (keybinding) {\n                    const keybindingLabel = keybinding.getLabel();\n                    if (keybindingLabel) {\n                        menuItemOptions.keybinding = keybindingLabel;\n                    }\n                }\n            }\n            const menuActionViewItem = new BaseMenuActionViewItem(options.context, action, menuItemOptions);\n            if (options.enableMnemonics) {\n                const mnemonic = menuActionViewItem.getMnemonic();\n                if (mnemonic && menuActionViewItem.isEnabled()) {\n                    let actionViewItems = [];\n                    if (this.mnemonics.has(mnemonic)) {\n                        actionViewItems = this.mnemonics.get(mnemonic);\n                    }\n                    actionViewItems.push(menuActionViewItem);\n                    this.mnemonics.set(mnemonic, actionViewItems);\n                }\n            }\n            return menuActionViewItem;\n        }\n    }\n}\nclass BaseMenuActionViewItem extends BaseActionViewItem {\n    constructor(ctx, action, options = {}) {\n        options.isMenu = true;\n        super(action, action, options);\n        this.options = options;\n        this.options.icon = options.icon !== undefined ? options.icon : false;\n        this.options.label = options.label !== undefined ? options.label : true;\n        this.cssClass = '';\n        // Set mnemonic\n        if (this.options.label && options.enableMnemonics) {\n            const label = this.getAction().label;\n            if (label) {\n                const matches = MENU_MNEMONIC_REGEX.exec(label);\n                if (matches) {\n                    this.mnemonic = (!!matches[1] ? matches[1] : matches[3]).toLocaleLowerCase();\n                }\n            }\n        }\n        // Add mouse up listener later to avoid accidental clicks\n        this.runOnceToEnableMouseUp = new RunOnceScheduler(() => {\n            if (!this.element) {\n                return;\n            }\n            this._register(addDisposableListener(this.element, EventType.MOUSE_UP, e => {\n                // removed default prevention as it conflicts\n                // with BaseActionViewItem #101537\n                // add back if issues arise and link new issue\n                EventHelper.stop(e, true);\n                // See https://developer.mozilla.org/en-US/Add-ons/WebExtensions/Interact_with_the_clipboard\n                // > Writing to the clipboard\n                // > You can use the \"cut\" and \"copy\" commands without any special\n                // permission if you are using them in a short-lived event handler\n                // for a user action (for example, a click handler).\n                // => to get the Copy and Paste context menu actions working on Firefox,\n                // there should be no timeout here\n                if (isFirefox) {\n                    const mouseEvent = new StandardMouseEvent(e);\n                    // Allowing right click to trigger the event causes the issue described below,\n                    // but since the solution below does not work in FF, we must disable right click\n                    if (mouseEvent.rightButton) {\n                        return;\n                    }\n                    this.onClick(e);\n                }\n                // In all other cases, set timeout to allow context menu cancellation to trigger\n                // otherwise the action will destroy the menu and a second context menu\n                // will still trigger for right click.\n                else {\n                    setTimeout(() => {\n                        this.onClick(e);\n                    }, 0);\n                }\n            }));\n            this._register(addDisposableListener(this.element, EventType.CONTEXT_MENU, e => {\n                EventHelper.stop(e, true);\n            }));\n        }, 100);\n        this._register(this.runOnceToEnableMouseUp);\n    }\n    render(container) {\n        super.render(container);\n        if (!this.element) {\n            return;\n        }\n        this.container = container;\n        this.item = append(this.element, $('a.action-menu-item'));\n        if (this._action.id === Separator.ID) {\n            // A separator is a presentation item\n            this.item.setAttribute('role', 'presentation');\n        }\n        else {\n            this.item.setAttribute('role', 'menuitem');\n            if (this.mnemonic) {\n                this.item.setAttribute('aria-keyshortcuts', `${this.mnemonic}`);\n            }\n        }\n        this.check = append(this.item, $('span.menu-item-check' + Codicon.menuSelection.cssSelector));\n        this.check.setAttribute('role', 'none');\n        this.label = append(this.item, $('span.action-label'));\n        if (this.options.label && this.options.keybinding) {\n            append(this.item, $('span.keybinding')).textContent = this.options.keybinding;\n        }\n        // Adds mouse up listener to actually run the action\n        this.runOnceToEnableMouseUp.schedule();\n        this.updateClass();\n        this.updateLabel();\n        this.updateTooltip();\n        this.updateEnabled();\n        this.updateChecked();\n    }\n    blur() {\n        super.blur();\n        this.applyStyle();\n    }\n    focus() {\n        super.focus();\n        if (this.item) {\n            this.item.focus();\n        }\n        this.applyStyle();\n    }\n    updatePositionInSet(pos, setSize) {\n        if (this.item) {\n            this.item.setAttribute('aria-posinset', `${pos}`);\n            this.item.setAttribute('aria-setsize', `${setSize}`);\n        }\n    }\n    updateLabel() {\n        var _a;\n        if (!this.label) {\n            return;\n        }\n        if (this.options.label) {\n            clearNode(this.label);\n            let label = stripIcons(this.getAction().label);\n            if (label) {\n                const cleanLabel = cleanMnemonic(label);\n                if (!this.options.enableMnemonics) {\n                    label = cleanLabel;\n                }\n                this.label.setAttribute('aria-label', cleanLabel.replace(/&&/g, '&'));\n                const matches = MENU_MNEMONIC_REGEX.exec(label);\n                if (matches) {\n                    label = strings.escape(label);\n                    // This is global, reset it\n                    MENU_ESCAPED_MNEMONIC_REGEX.lastIndex = 0;\n                    let escMatch = MENU_ESCAPED_MNEMONIC_REGEX.exec(label);\n                    // We can't use negative lookbehind so if we match our negative and skip\n                    while (escMatch && escMatch[1]) {\n                        escMatch = MENU_ESCAPED_MNEMONIC_REGEX.exec(label);\n                    }\n                    const replaceDoubleEscapes = (str) => str.replace(/&amp;&amp;/g, '&amp;');\n                    if (escMatch) {\n                        this.label.append(strings.ltrim(replaceDoubleEscapes(label.substr(0, escMatch.index)), ' '), $('u', { 'aria-hidden': 'true' }, escMatch[3]), strings.rtrim(replaceDoubleEscapes(label.substr(escMatch.index + escMatch[0].length)), ' '));\n                    }\n                    else {\n                        this.label.innerText = replaceDoubleEscapes(label).trim();\n                    }\n                    (_a = this.item) === null || _a === void 0 ? void 0 : _a.setAttribute('aria-keyshortcuts', (!!matches[1] ? matches[1] : matches[3]).toLocaleLowerCase());\n                }\n                else {\n                    this.label.innerText = label.replace(/&&/g, '&').trim();\n                }\n            }\n        }\n    }\n    updateTooltip() {\n        // menus should function like native menus and they do not have tooltips\n    }\n    updateClass() {\n        if (this.cssClass && this.item) {\n            this.item.classList.remove(...this.cssClass.split(' '));\n        }\n        if (this.options.icon && this.label) {\n            this.cssClass = this.getAction().class || '';\n            this.label.classList.add('icon');\n            if (this.cssClass) {\n                this.label.classList.add(...this.cssClass.split(' '));\n            }\n            this.updateEnabled();\n        }\n        else if (this.label) {\n            this.label.classList.remove('icon');\n        }\n    }\n    updateEnabled() {\n        if (this.getAction().enabled) {\n            if (this.element) {\n                this.element.classList.remove('disabled');\n                this.element.removeAttribute('aria-disabled');\n            }\n            if (this.item) {\n                this.item.classList.remove('disabled');\n                this.item.removeAttribute('aria-disabled');\n                this.item.tabIndex = 0;\n            }\n        }\n        else {\n            if (this.element) {\n                this.element.classList.add('disabled');\n                this.element.setAttribute('aria-disabled', 'true');\n            }\n            if (this.item) {\n                this.item.classList.add('disabled');\n                this.item.setAttribute('aria-disabled', 'true');\n            }\n        }\n    }\n    updateChecked() {\n        if (!this.item) {\n            return;\n        }\n        const checked = this.getAction().checked;\n        this.item.classList.toggle('checked', !!checked);\n        if (checked !== undefined) {\n            this.item.setAttribute('role', 'menuitemcheckbox');\n            this.item.setAttribute('aria-checked', checked ? 'true' : 'false');\n        }\n        else {\n            this.item.setAttribute('role', 'menuitem');\n            this.item.setAttribute('aria-checked', '');\n        }\n    }\n    getMnemonic() {\n        return this.mnemonic;\n    }\n    applyStyle() {\n        if (!this.menuStyle) {\n            return;\n        }\n        const isSelected = this.element && this.element.classList.contains('focused');\n        const fgColor = isSelected && this.menuStyle.selectionForegroundColor ? this.menuStyle.selectionForegroundColor : this.menuStyle.foregroundColor;\n        const bgColor = isSelected && this.menuStyle.selectionBackgroundColor ? this.menuStyle.selectionBackgroundColor : undefined;\n        const outline = isSelected && this.menuStyle.selectionBorderColor ? `1px solid ${this.menuStyle.selectionBorderColor}` : '';\n        const outlineOffset = isSelected && this.menuStyle.selectionBorderColor ? `-1px` : '';\n        if (this.item) {\n            this.item.style.color = fgColor ? fgColor.toString() : '';\n            this.item.style.backgroundColor = bgColor ? bgColor.toString() : '';\n            this.item.style.outline = outline;\n            this.item.style.outlineOffset = outlineOffset;\n        }\n        if (this.check) {\n            this.check.style.color = fgColor ? fgColor.toString() : '';\n        }\n    }\n    style(style) {\n        this.menuStyle = style;\n        this.applyStyle();\n    }\n}\nclass SubmenuMenuActionViewItem extends BaseMenuActionViewItem {\n    constructor(action, submenuActions, parentData, submenuOptions) {\n        super(action, action, submenuOptions);\n        this.submenuActions = submenuActions;\n        this.parentData = parentData;\n        this.submenuOptions = submenuOptions;\n        this.mysubmenu = null;\n        this.submenuDisposables = this._register(new DisposableStore());\n        this.mouseOver = false;\n        this.expandDirection = submenuOptions && submenuOptions.expandDirection !== undefined ? submenuOptions.expandDirection : Direction.Right;\n        this.showScheduler = new RunOnceScheduler(() => {\n            if (this.mouseOver) {\n                this.cleanupExistingSubmenu(false);\n                this.createSubmenu(false);\n            }\n        }, 250);\n        this.hideScheduler = new RunOnceScheduler(() => {\n            if (this.element && (!isAncestor(getActiveElement(), this.element) && this.parentData.submenu === this.mysubmenu)) {\n                this.parentData.parent.focus(false);\n                this.cleanupExistingSubmenu(true);\n            }\n        }, 750);\n    }\n    render(container) {\n        super.render(container);\n        if (!this.element) {\n            return;\n        }\n        if (this.item) {\n            this.item.classList.add('monaco-submenu-item');\n            this.item.tabIndex = 0;\n            this.item.setAttribute('aria-haspopup', 'true');\n            this.updateAriaExpanded('false');\n            this.submenuIndicator = append(this.item, $('span.submenu-indicator' + Codicon.menuSubmenu.cssSelector));\n            this.submenuIndicator.setAttribute('aria-hidden', 'true');\n        }\n        this._register(addDisposableListener(this.element, EventType.KEY_UP, e => {\n            const event = new StandardKeyboardEvent(e);\n            if (event.equals(17 /* KeyCode.RightArrow */) || event.equals(3 /* KeyCode.Enter */)) {\n                EventHelper.stop(e, true);\n                this.createSubmenu(true);\n            }\n        }));\n        this._register(addDisposableListener(this.element, EventType.KEY_DOWN, e => {\n            const event = new StandardKeyboardEvent(e);\n            if (getActiveElement() === this.item) {\n                if (event.equals(17 /* KeyCode.RightArrow */) || event.equals(3 /* KeyCode.Enter */)) {\n                    EventHelper.stop(e, true);\n                }\n            }\n        }));\n        this._register(addDisposableListener(this.element, EventType.MOUSE_OVER, e => {\n            if (!this.mouseOver) {\n                this.mouseOver = true;\n                this.showScheduler.schedule();\n            }\n        }));\n        this._register(addDisposableListener(this.element, EventType.MOUSE_LEAVE, e => {\n            this.mouseOver = false;\n        }));\n        this._register(addDisposableListener(this.element, EventType.FOCUS_OUT, e => {\n            if (this.element && !isAncestor(getActiveElement(), this.element)) {\n                this.hideScheduler.schedule();\n            }\n        }));\n        this._register(this.parentData.parent.onScroll(() => {\n            if (this.parentData.submenu === this.mysubmenu) {\n                this.parentData.parent.focus(false);\n                this.cleanupExistingSubmenu(true);\n            }\n        }));\n    }\n    updateEnabled() {\n        // override on submenu entry\n        // native menus do not observe enablement on sumbenus\n        // we mimic that behavior\n    }\n    onClick(e) {\n        // stop clicking from trying to run an action\n        EventHelper.stop(e, true);\n        this.cleanupExistingSubmenu(false);\n        this.createSubmenu(true);\n    }\n    cleanupExistingSubmenu(force) {\n        if (this.parentData.submenu && (force || (this.parentData.submenu !== this.mysubmenu))) {\n            // disposal may throw if the submenu has already been removed\n            try {\n                this.parentData.submenu.dispose();\n            }\n            catch (_a) { }\n            this.parentData.submenu = undefined;\n            this.updateAriaExpanded('false');\n            if (this.submenuContainer) {\n                this.submenuDisposables.clear();\n                this.submenuContainer = undefined;\n            }\n        }\n    }\n    calculateSubmenuMenuLayout(windowDimensions, submenu, entry, expandDirection) {\n        const ret = { top: 0, left: 0 };\n        // Start with horizontal\n        ret.left = layout(windowDimensions.width, submenu.width, { position: expandDirection === Direction.Right ? 0 /* LayoutAnchorPosition.Before */ : 1 /* LayoutAnchorPosition.After */, offset: entry.left, size: entry.width });\n        // We don't have enough room to layout the menu fully, so we are overlapping the menu\n        if (ret.left >= entry.left && ret.left < entry.left + entry.width) {\n            if (entry.left + 10 + submenu.width <= windowDimensions.width) {\n                ret.left = entry.left + 10;\n            }\n            entry.top += 10;\n            entry.height = 0;\n        }\n        // Now that we have a horizontal position, try layout vertically\n        ret.top = layout(windowDimensions.height, submenu.height, { position: 0 /* LayoutAnchorPosition.Before */, offset: entry.top, size: 0 });\n        // We didn't have enough room below, but we did above, so we shift down to align the menu\n        if (ret.top + submenu.height === entry.top && ret.top + entry.height + submenu.height <= windowDimensions.height) {\n            ret.top += entry.height;\n        }\n        return ret;\n    }\n    createSubmenu(selectFirstItem = true) {\n        if (!this.element) {\n            return;\n        }\n        if (!this.parentData.submenu) {\n            this.updateAriaExpanded('true');\n            this.submenuContainer = append(this.element, $('div.monaco-submenu'));\n            this.submenuContainer.classList.add('menubar-menu-items-holder', 'context-view');\n            // Set the top value of the menu container before construction\n            // This allows the menu constructor to calculate the proper max height\n            const computedStyles = getComputedStyle(this.parentData.parent.domNode);\n            const paddingTop = parseFloat(computedStyles.paddingTop || '0') || 0;\n            // this.submenuContainer.style.top = `${this.element.offsetTop - this.parentData.parent.scrollOffset - paddingTop}px`;\n            this.submenuContainer.style.zIndex = '1';\n            this.submenuContainer.style.position = 'fixed';\n            this.submenuContainer.style.top = '0';\n            this.submenuContainer.style.left = '0';\n            this.parentData.submenu = new Menu(this.submenuContainer, this.submenuActions.length ? this.submenuActions : [new EmptySubmenuAction()], this.submenuOptions);\n            if (this.menuStyle) {\n                this.parentData.submenu.style(this.menuStyle);\n            }\n            // layout submenu\n            const entryBox = this.element.getBoundingClientRect();\n            const entryBoxUpdated = {\n                top: entryBox.top - paddingTop,\n                left: entryBox.left,\n                height: entryBox.height + 2 * paddingTop,\n                width: entryBox.width\n            };\n            const viewBox = this.submenuContainer.getBoundingClientRect();\n            const { top, left } = this.calculateSubmenuMenuLayout(new Dimension(window.innerWidth, window.innerHeight), Dimension.lift(viewBox), entryBoxUpdated, this.expandDirection);\n            // subtract offsets caused by transform parent\n            this.submenuContainer.style.left = `${left - viewBox.left}px`;\n            this.submenuContainer.style.top = `${top - viewBox.top}px`;\n            this.submenuDisposables.add(addDisposableListener(this.submenuContainer, EventType.KEY_UP, e => {\n                const event = new StandardKeyboardEvent(e);\n                if (event.equals(15 /* KeyCode.LeftArrow */)) {\n                    EventHelper.stop(e, true);\n                    this.parentData.parent.focus();\n                    this.cleanupExistingSubmenu(true);\n                }\n            }));\n            this.submenuDisposables.add(addDisposableListener(this.submenuContainer, EventType.KEY_DOWN, e => {\n                const event = new StandardKeyboardEvent(e);\n                if (event.equals(15 /* KeyCode.LeftArrow */)) {\n                    EventHelper.stop(e, true);\n                }\n            }));\n            this.submenuDisposables.add(this.parentData.submenu.onDidCancel(() => {\n                this.parentData.parent.focus();\n                this.cleanupExistingSubmenu(true);\n            }));\n            this.parentData.submenu.focus(selectFirstItem);\n            this.mysubmenu = this.parentData.submenu;\n        }\n        else {\n            this.parentData.submenu.focus(false);\n        }\n    }\n    updateAriaExpanded(value) {\n        var _a;\n        if (this.item) {\n            (_a = this.item) === null || _a === void 0 ? void 0 : _a.setAttribute('aria-expanded', value);\n        }\n    }\n    applyStyle() {\n        var _a;\n        super.applyStyle();\n        if (!this.menuStyle) {\n            return;\n        }\n        const isSelected = this.element && this.element.classList.contains('focused');\n        const fgColor = isSelected && this.menuStyle.selectionForegroundColor ? this.menuStyle.selectionForegroundColor : this.menuStyle.foregroundColor;\n        if (this.submenuIndicator) {\n            this.submenuIndicator.style.color = fgColor ? `${fgColor}` : '';\n        }\n        (_a = this.parentData.submenu) === null || _a === void 0 ? void 0 : _a.style(this.menuStyle);\n    }\n    dispose() {\n        super.dispose();\n        this.hideScheduler.dispose();\n        if (this.mysubmenu) {\n            this.mysubmenu.dispose();\n            this.mysubmenu = null;\n        }\n        if (this.submenuContainer) {\n            this.submenuContainer = undefined;\n        }\n    }\n}\nclass MenuSeparatorActionViewItem extends ActionViewItem {\n    style(style) {\n        if (this.label) {\n            this.label.style.borderBottomColor = style.separatorColor ? `${style.separatorColor}` : '';\n        }\n    }\n}\nexport function cleanMnemonic(label) {\n    const regex = MENU_MNEMONIC_REGEX;\n    const matches = regex.exec(label);\n    if (!matches) {\n        return label;\n    }\n    const mnemonicInText = !matches[1];\n    return label.replace(regex, mnemonicInText ? '$2$3' : '').trim();\n}\nfunction getMenuWidgetCSS(style, isForShadowDom) {\n    let result = /* css */ `\n.monaco-menu {\n\tfont-size: 13px;\n\tborder-radius: 5px;\n\tmin-width: 160px;\n}\n\n${formatRule(Codicon.menuSelection)}\n${formatRule(Codicon.menuSubmenu)}\n\n.monaco-menu .monaco-action-bar {\n\ttext-align: right;\n\toverflow: hidden;\n\twhite-space: nowrap;\n}\n\n.monaco-menu .monaco-action-bar .actions-container {\n\tdisplay: flex;\n\tmargin: 0 auto;\n\tpadding: 0;\n\twidth: 100%;\n\tjustify-content: flex-end;\n}\n\n.monaco-menu .monaco-action-bar.vertical .actions-container {\n\tdisplay: inline-block;\n}\n\n.monaco-menu .monaco-action-bar.reverse .actions-container {\n\tflex-direction: row-reverse;\n}\n\n.monaco-menu .monaco-action-bar .action-item {\n\tcursor: pointer;\n\tdisplay: inline-block;\n\ttransition: transform 50ms ease;\n\tposition: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */\n}\n\n.monaco-menu .monaco-action-bar .action-item.disabled {\n\tcursor: default;\n}\n\n.monaco-menu .monaco-action-bar.animated .action-item.active {\n\ttransform: scale(1.272019649, 1.272019649); /* 1.272019649 =  */\n}\n\n.monaco-menu .monaco-action-bar .action-item .icon,\n.monaco-menu .monaco-action-bar .action-item .codicon {\n\tdisplay: inline-block;\n}\n\n.monaco-menu .monaco-action-bar .action-item .codicon {\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.monaco-menu .monaco-action-bar .action-label {\n\tfont-size: 11px;\n\tmargin-right: 4px;\n}\n\n.monaco-menu .monaco-action-bar .action-item.disabled .action-label,\n.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {\n\tcolor: var(--vscode-disabledForeground);\n}\n\n/* Vertical actions */\n\n.monaco-menu .monaco-action-bar.vertical {\n\ttext-align: left;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tdisplay: block;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tdisplay: block;\n\tborder-bottom: 1px solid var(--vscode-menu-separatorBackground);\n\tpadding-top: 1px;\n\tpadding: 30px;\n}\n\n.monaco-menu .secondary-actions .monaco-action-bar .action-label {\n\tmargin-left: 6px;\n}\n\n/* Action Items */\n.monaco-menu .monaco-action-bar .action-item.select-container {\n\toverflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */\n\tflex: 1;\n\tmax-width: 170px;\n\tmin-width: 60px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tmargin-right: 10px;\n}\n\n.monaco-menu .monaco-action-bar.vertical {\n\tmargin-left: 0;\n\toverflow: visible;\n}\n\n.monaco-menu .monaco-action-bar.vertical .actions-container {\n\tdisplay: block;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tpadding: 0;\n\ttransform: none;\n\tdisplay: flex;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item.active {\n\ttransform: none;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item {\n\tflex: 1 1 auto;\n\tdisplay: flex;\n\theight: 2em;\n\talign-items: center;\n\tposition: relative;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item:hover .keybinding,\n.monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .keybinding {\n\topacity: unset;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label {\n\tflex: 1 1 auto;\n\ttext-decoration: none;\n\tpadding: 0 1em;\n\tbackground: none;\n\tfont-size: 12px;\n\tline-height: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .keybinding,\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\tdisplay: inline-block;\n\tflex: 2 1 auto;\n\tpadding: 0 1em;\n\ttext-align: right;\n\tfont-size: 12px;\n\tline-height: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\theight: 100%;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {\n\tfont-size: 16px !important;\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {\n\tmargin-left: auto;\n\tmargin-right: -20px;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,\n.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {\n\topacity: 0.4;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {\n\tdisplay: inline-block;\n\tbox-sizing: border-box;\n\tmargin: 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item {\n\tposition: static;\n\toverflow: visible;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {\n\tposition: absolute;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\twidth: 100%;\n\theight: 0px !important;\n\topacity: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {\n\tpadding: 0.7em 1em 0.1em 1em;\n\tfont-weight: bold;\n\topacity: 1;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:hover {\n\tcolor: inherit;\n}\n\n.monaco-menu .monaco-action-bar.vertical .menu-item-check {\n\tposition: absolute;\n\tvisibility: hidden;\n\twidth: 1em;\n\theight: 100%;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {\n\tvisibility: visible;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n\n/* Context Menu */\n\n.context-view.monaco-menu-container {\n\toutline: 0;\n\tborder: none;\n\tanimation: fadeIn 0.083s linear;\n\t-webkit-app-region: no-drag;\n}\n\n.context-view.monaco-menu-container :focus,\n.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,\n.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {\n\toutline: 0;\n}\n\n.hc-black .context-view.monaco-menu-container,\n.hc-light .context-view.monaco-menu-container,\n:host-context(.hc-black) .context-view.monaco-menu-container,\n:host-context(.hc-light) .context-view.monaco-menu-container {\n\tbox-shadow: none;\n}\n\n.hc-black .monaco-menu .monaco-action-bar.vertical .action-item.focused,\n.hc-light .monaco-menu .monaco-action-bar.vertical .action-item.focused,\n:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused,\n:host-context(.hc-light) .monaco-menu .monaco-action-bar.vertical .action-item.focused {\n\tbackground: none;\n}\n\n/* Vertical Action Bar Styles */\n\n.monaco-menu .monaco-action-bar.vertical {\n\tpadding: .6em 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-menu-item {\n\theight: 2em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),\n.monaco-menu .monaco-action-bar.vertical .keybinding {\n\tfont-size: inherit;\n\tpadding: 0 2em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .menu-item-check {\n\tfont-size: inherit;\n\twidth: 2em;\n}\n\n.monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tfont-size: inherit;\n\tmargin: 5px 0 !important;\n\tpadding: 0;\n\tborder-radius: 0;\n}\n\n.linux .monaco-menu .monaco-action-bar.vertical .action-label.separator,\n:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {\n\tmargin-left: 0;\n\tmargin-right: 0;\n}\n\n.monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\tfont-size: 60%;\n\tpadding: 0 1.8em;\n}\n\n.linux .monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {\n\theight: 100%;\n\tmask-size: 10px 10px;\n\t-webkit-mask-size: 10px 10px;\n}\n\n.monaco-menu .action-item {\n\tcursor: default;\n}`;\n    if (isForShadowDom) {\n        // Only define scrollbar styles when used inside shadow dom,\n        // otherwise leave their styling to the global workbench styling.\n        result += `\n\t\t\t/* Arrows */\n\t\t\t.monaco-scrollable-element > .scrollbar > .scra {\n\t\t\t\tcursor: pointer;\n\t\t\t\tfont-size: 11px !important;\n\t\t\t}\n\n\t\t\t.monaco-scrollable-element > .visible {\n\t\t\t\topacity: 1;\n\n\t\t\t\t/* Background rule added for IE9 - to allow clicks on dom node */\n\t\t\t\tbackground:rgba(0,0,0,0);\n\n\t\t\t\ttransition: opacity 100ms linear;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .invisible {\n\t\t\t\topacity: 0;\n\t\t\t\tpointer-events: none;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .invisible.fade {\n\t\t\t\ttransition: opacity 800ms linear;\n\t\t\t}\n\n\t\t\t/* Scrollable Content Inset Shadow */\n\t\t\t.monaco-scrollable-element > .shadow {\n\t\t\t\tposition: absolute;\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .shadow.top {\n\t\t\t\tdisplay: block;\n\t\t\t\ttop: 0;\n\t\t\t\tleft: 3px;\n\t\t\t\theight: 3px;\n\t\t\t\twidth: 100%;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .shadow.left {\n\t\t\t\tdisplay: block;\n\t\t\t\ttop: 3px;\n\t\t\t\tleft: 0;\n\t\t\t\theight: 100%;\n\t\t\t\twidth: 3px;\n\t\t\t}\n\t\t\t.monaco-scrollable-element > .shadow.top-left-corner {\n\t\t\t\tdisplay: block;\n\t\t\t\ttop: 0;\n\t\t\t\tleft: 0;\n\t\t\t\theight: 3px;\n\t\t\t\twidth: 3px;\n\t\t\t}\n\t\t`;\n        // Scrollbars\n        const scrollbarShadowColor = style.scrollbarShadow;\n        if (scrollbarShadowColor) {\n            result += `\n\t\t\t\t.monaco-scrollable-element > .shadow.top {\n\t\t\t\t\tbox-shadow: ${scrollbarShadowColor} 0 6px 6px -6px inset;\n\t\t\t\t}\n\n\t\t\t\t.monaco-scrollable-element > .shadow.left {\n\t\t\t\t\tbox-shadow: ${scrollbarShadowColor} 6px 0 6px -6px inset;\n\t\t\t\t}\n\n\t\t\t\t.monaco-scrollable-element > .shadow.top.left {\n\t\t\t\t\tbox-shadow: ${scrollbarShadowColor} 6px 6px 6px -6px inset;\n\t\t\t\t}\n\t\t\t`;\n        }\n        const scrollbarSliderBackgroundColor = style.scrollbarSliderBackground;\n        if (scrollbarSliderBackgroundColor) {\n            result += `\n\t\t\t\t.monaco-scrollable-element > .scrollbar > .slider {\n\t\t\t\t\tbackground: ${scrollbarSliderBackgroundColor};\n\t\t\t\t}\n\t\t\t`;\n        }\n        const scrollbarSliderHoverBackgroundColor = style.scrollbarSliderHoverBackground;\n        if (scrollbarSliderHoverBackgroundColor) {\n            result += `\n\t\t\t\t.monaco-scrollable-element > .scrollbar > .slider:hover {\n\t\t\t\t\tbackground: ${scrollbarSliderHoverBackgroundColor};\n\t\t\t\t}\n\t\t\t`;\n        }\n        const scrollbarSliderActiveBackgroundColor = style.scrollbarSliderActiveBackground;\n        if (scrollbarSliderActiveBackgroundColor) {\n            result += `\n\t\t\t\t.monaco-scrollable-element > .scrollbar > .slider.active {\n\t\t\t\t\tbackground: ${scrollbarSliderActiveBackgroundColor};\n\t\t\t\t}\n\t\t\t`;\n        }\n    }\n    return result;\n}\n"],"mappings":"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"}]}