{"remainingRequest":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/thread-loader/dist/cjs.js!/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js!/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lines/viewLines.js","dependencies":[{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lines/viewLines.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/babel.config.js","mtime":1668271197000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlci5qcyI7CmltcG9ydCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXNzZXJ0VGhpc0luaXRpYWxpemVkLmpzIjsKaW1wb3J0IF9nZXQgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9nZXQuanMiOwppbXBvcnQgX2dldFByb3RvdHlwZU9mIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZ2V0UHJvdG90eXBlT2YuanMiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vaW5oZXJpdHMuanMiOwppbXBvcnQgX2NyZWF0ZVN1cGVyIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlU3VwZXIuanMiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2suanMiOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5lcnJvci5jYXVzZS5qcyI7Ci8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAqICBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uCiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwppbXBvcnQgJy4vdmlld0xpbmVzLmNzcyc7CmltcG9ydCAqIGFzIHBsYXRmb3JtIGZyb20gJy4uLy4uLy4uLy4uL2Jhc2UvY29tbW9uL3BsYXRmb3JtLmpzJzsKaW1wb3J0IHsgUnVuT25jZVNjaGVkdWxlciB9IGZyb20gJy4uLy4uLy4uLy4uL2Jhc2UvY29tbW9uL2FzeW5jLmpzJzsKaW1wb3J0IHsgYXBwbHlGb250SW5mbyB9IGZyb20gJy4uLy4uL2NvbmZpZy9kb21Gb250SW5mby5qcyc7CmltcG9ydCB7IFZpc2libGVMaW5lc0NvbGxlY3Rpb24gfSBmcm9tICcuLi8uLi92aWV3L3ZpZXdMYXllci5qcyc7CmltcG9ydCB7IFBhcnRGaW5nZXJwcmludHMsIFZpZXdQYXJ0IH0gZnJvbSAnLi4vLi4vdmlldy92aWV3UGFydC5qcyc7CmltcG9ydCB7IERvbVJlYWRpbmdDb250ZXh0LCBWaWV3TGluZSwgVmlld0xpbmVPcHRpb25zIH0gZnJvbSAnLi92aWV3TGluZS5qcyc7CmltcG9ydCB7IFBvc2l0aW9uIH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL2NvcmUvcG9zaXRpb24uanMnOwppbXBvcnQgeyBSYW5nZSB9IGZyb20gJy4uLy4uLy4uL2NvbW1vbi9jb3JlL3JhbmdlLmpzJzsKaW1wb3J0IHsgTGluZVZpc2libGVSYW5nZXMsIEhvcml6b250YWxQb3NpdGlvbiwgSG9yaXpvbnRhbFJhbmdlIH0gZnJvbSAnLi4vLi4vdmlldy9yZW5kZXJpbmdDb250ZXh0LmpzJzsKaW1wb3J0IHsgTU9VU0VfQ1VSU09SX1RFWFRfQ1NTX0NMQVNTX05BTUUgfSBmcm9tICcuLi8uLi8uLi8uLi9iYXNlL2Jyb3dzZXIvdWkvbW91c2VDdXJzb3IvbW91c2VDdXJzb3IuanMnOwp2YXIgTGFzdFJlbmRlcmVkRGF0YSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gTGFzdFJlbmRlcmVkRGF0YSgpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBMYXN0UmVuZGVyZWREYXRhKTsKICAgIHRoaXMuX2N1cnJlbnRWaXNpYmxlUmFuZ2UgPSBuZXcgUmFuZ2UoMSwgMSwgMSwgMSk7CiAgfQogIF9jcmVhdGVDbGFzcyhMYXN0UmVuZGVyZWREYXRhLCBbewogICAga2V5OiAiZ2V0Q3VycmVudFZpc2libGVSYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q3VycmVudFZpc2libGVSYW5nZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2N1cnJlbnRWaXNpYmxlUmFuZ2U7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0Q3VycmVudFZpc2libGVSYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0Q3VycmVudFZpc2libGVSYW5nZShjdXJyZW50VmlzaWJsZVJhbmdlKSB7CiAgICAgIHRoaXMuX2N1cnJlbnRWaXNpYmxlUmFuZ2UgPSBjdXJyZW50VmlzaWJsZVJhbmdlOwogICAgfQogIH1dKTsKICByZXR1cm4gTGFzdFJlbmRlcmVkRGF0YTsKfSgpOwp2YXIgSG9yaXpvbnRhbFJldmVhbFJhbmdlUmVxdWVzdCA9IC8qI19fUFVSRV9fKi9fY3JlYXRlQ2xhc3MoZnVuY3Rpb24gSG9yaXpvbnRhbFJldmVhbFJhbmdlUmVxdWVzdChtaW5pbWFsUmV2ZWFsLCBsaW5lTnVtYmVyLCBzdGFydENvbHVtbiwgZW5kQ29sdW1uLCBzdGFydFNjcm9sbFRvcCwgc3RvcFNjcm9sbFRvcCwgc2Nyb2xsVHlwZSkgewogIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBIb3Jpem9udGFsUmV2ZWFsUmFuZ2VSZXF1ZXN0KTsKICB0aGlzLm1pbmltYWxSZXZlYWwgPSBtaW5pbWFsUmV2ZWFsOwogIHRoaXMubGluZU51bWJlciA9IGxpbmVOdW1iZXI7CiAgdGhpcy5zdGFydENvbHVtbiA9IHN0YXJ0Q29sdW1uOwogIHRoaXMuZW5kQ29sdW1uID0gZW5kQ29sdW1uOwogIHRoaXMuc3RhcnRTY3JvbGxUb3AgPSBzdGFydFNjcm9sbFRvcDsKICB0aGlzLnN0b3BTY3JvbGxUb3AgPSBzdG9wU2Nyb2xsVG9wOwogIHRoaXMuc2Nyb2xsVHlwZSA9IHNjcm9sbFR5cGU7CiAgdGhpcy50eXBlID0gJ3JhbmdlJzsKICB0aGlzLm1pbkxpbmVOdW1iZXIgPSBsaW5lTnVtYmVyOwogIHRoaXMubWF4TGluZU51bWJlciA9IGxpbmVOdW1iZXI7Cn0pOwp2YXIgSG9yaXpvbnRhbFJldmVhbFNlbGVjdGlvbnNSZXF1ZXN0ID0gLyojX19QVVJFX18qL19jcmVhdGVDbGFzcyhmdW5jdGlvbiBIb3Jpem9udGFsUmV2ZWFsU2VsZWN0aW9uc1JlcXVlc3QobWluaW1hbFJldmVhbCwgc2VsZWN0aW9ucywgc3RhcnRTY3JvbGxUb3AsIHN0b3BTY3JvbGxUb3AsIHNjcm9sbFR5cGUpIHsKICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSG9yaXpvbnRhbFJldmVhbFNlbGVjdGlvbnNSZXF1ZXN0KTsKICB0aGlzLm1pbmltYWxSZXZlYWwgPSBtaW5pbWFsUmV2ZWFsOwogIHRoaXMuc2VsZWN0aW9ucyA9IHNlbGVjdGlvbnM7CiAgdGhpcy5zdGFydFNjcm9sbFRvcCA9IHN0YXJ0U2Nyb2xsVG9wOwogIHRoaXMuc3RvcFNjcm9sbFRvcCA9IHN0b3BTY3JvbGxUb3A7CiAgdGhpcy5zY3JvbGxUeXBlID0gc2Nyb2xsVHlwZTsKICB0aGlzLnR5cGUgPSAnc2VsZWN0aW9ucyc7CiAgdmFyIG1pbkxpbmVOdW1iZXIgPSBzZWxlY3Rpb25zWzBdLnN0YXJ0TGluZU51bWJlcjsKICB2YXIgbWF4TGluZU51bWJlciA9IHNlbGVjdGlvbnNbMF0uZW5kTGluZU51bWJlcjsKICBmb3IgKHZhciBpID0gMSwgbGVuID0gc2VsZWN0aW9ucy5sZW5ndGg7IGkgPCBsZW47IGkrKykgewogICAgdmFyIHNlbGVjdGlvbiA9IHNlbGVjdGlvbnNbaV07CiAgICBtaW5MaW5lTnVtYmVyID0gTWF0aC5taW4obWluTGluZU51bWJlciwgc2VsZWN0aW9uLnN0YXJ0TGluZU51bWJlcik7CiAgICBtYXhMaW5lTnVtYmVyID0gTWF0aC5tYXgobWF4TGluZU51bWJlciwgc2VsZWN0aW9uLmVuZExpbmVOdW1iZXIpOwogIH0KICB0aGlzLm1pbkxpbmVOdW1iZXIgPSBtaW5MaW5lTnVtYmVyOwogIHRoaXMubWF4TGluZU51bWJlciA9IG1heExpbmVOdW1iZXI7Cn0pOwpleHBvcnQgdmFyIFZpZXdMaW5lcyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1ZpZXdQYXJ0KSB7CiAgX2luaGVyaXRzKFZpZXdMaW5lcywgX1ZpZXdQYXJ0KTsKICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKFZpZXdMaW5lcyk7CiAgZnVuY3Rpb24gVmlld0xpbmVzKGNvbnRleHQsIGxpbmVzQ29udGVudCkgewogICAgdmFyIF90aGlzOwogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZpZXdMaW5lcyk7CiAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGNvbnRleHQpOwogICAgX3RoaXMuX2xpbmVzQ29udGVudCA9IGxpbmVzQ29udGVudDsKICAgIF90aGlzLl90ZXh0UmFuZ2VSZXN0aW5nU3BvdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgX3RoaXMuX3Zpc2libGVMaW5lcyA9IG5ldyBWaXNpYmxlTGluZXNDb2xsZWN0aW9uKF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpKTsKICAgIF90aGlzLmRvbU5vZGUgPSBfdGhpcy5fdmlzaWJsZUxpbmVzLmRvbU5vZGU7CiAgICB2YXIgY29uZiA9IF90aGlzLl9jb250ZXh0LmNvbmZpZ3VyYXRpb247CiAgICB2YXIgb3B0aW9ucyA9IF90aGlzLl9jb250ZXh0LmNvbmZpZ3VyYXRpb24ub3B0aW9uczsKICAgIHZhciBmb250SW5mbyA9IG9wdGlvbnMuZ2V0KDQ2IC8qIEVkaXRvck9wdGlvbi5mb250SW5mbyAqLyk7CiAgICB2YXIgd3JhcHBpbmdJbmZvID0gb3B0aW9ucy5nZXQoMTM0IC8qIEVkaXRvck9wdGlvbi53cmFwcGluZ0luZm8gKi8pOwogICAgdmFyIGxheW91dEluZm8gPSBvcHRpb25zLmdldCgxMzMgLyogRWRpdG9yT3B0aW9uLmxheW91dEluZm8gKi8pOwogICAgX3RoaXMuX2xpbmVIZWlnaHQgPSBvcHRpb25zLmdldCg2MSAvKiBFZGl0b3JPcHRpb24ubGluZUhlaWdodCAqLyk7CiAgICBfdGhpcy5fdHlwaWNhbEhhbGZ3aWR0aENoYXJhY3RlcldpZHRoID0gZm9udEluZm8udHlwaWNhbEhhbGZ3aWR0aENoYXJhY3RlcldpZHRoOwogICAgX3RoaXMuX2lzVmlld3BvcnRXcmFwcGluZyA9IHdyYXBwaW5nSW5mby5pc1ZpZXdwb3J0V3JhcHBpbmc7CiAgICBfdGhpcy5fcmV2ZWFsSG9yaXpvbnRhbFJpZ2h0UGFkZGluZyA9IG9wdGlvbnMuZ2V0KDkxIC8qIEVkaXRvck9wdGlvbi5yZXZlYWxIb3Jpem9udGFsUmlnaHRQYWRkaW5nICovKTsKICAgIF90aGlzLl9ob3Jpem9udGFsU2Nyb2xsYmFySGVpZ2h0ID0gbGF5b3V0SW5mby5ob3Jpem9udGFsU2Nyb2xsYmFySGVpZ2h0OwogICAgX3RoaXMuX2N1cnNvclN1cnJvdW5kaW5nTGluZXMgPSBvcHRpb25zLmdldCgyNSAvKiBFZGl0b3JPcHRpb24uY3Vyc29yU3Vycm91bmRpbmdMaW5lcyAqLyk7CiAgICBfdGhpcy5fY3Vyc29yU3Vycm91bmRpbmdMaW5lc1N0eWxlID0gb3B0aW9ucy5nZXQoMjYgLyogRWRpdG9yT3B0aW9uLmN1cnNvclN1cnJvdW5kaW5nTGluZXNTdHlsZSAqLyk7CiAgICBfdGhpcy5fY2FuVXNlTGF5ZXJIaW50aW5nID0gIW9wdGlvbnMuZ2V0KDI4IC8qIEVkaXRvck9wdGlvbi5kaXNhYmxlTGF5ZXJIaW50aW5nICovKTsKICAgIF90aGlzLl92aWV3TGluZU9wdGlvbnMgPSBuZXcgVmlld0xpbmVPcHRpb25zKGNvbmYsIF90aGlzLl9jb250ZXh0LnRoZW1lLnR5cGUpOwogICAgUGFydEZpbmdlcnByaW50cy53cml0ZShfdGhpcy5kb21Ob2RlLCA3IC8qIFBhcnRGaW5nZXJwcmludC5WaWV3TGluZXMgKi8pOwogICAgX3RoaXMuZG9tTm9kZS5zZXRDbGFzc05hbWUoInZpZXctbGluZXMgIi5jb25jYXQoTU9VU0VfQ1VSU09SX1RFWFRfQ1NTX0NMQVNTX05BTUUpKTsKICAgIGFwcGx5Rm9udEluZm8oX3RoaXMuZG9tTm9kZSwgZm9udEluZm8pOwogICAgLy8gLS0tIHdpZHRoICYgaGVpZ2h0CiAgICBfdGhpcy5fbWF4TGluZVdpZHRoID0gMDsKICAgIF90aGlzLl9hc3luY1VwZGF0ZUxpbmVXaWR0aHMgPSBuZXcgUnVuT25jZVNjaGVkdWxlcihmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzLl91cGRhdGVMaW5lV2lkdGhzU2xvdygpOwogICAgfSwgMjAwKTsKICAgIF90aGlzLl9hc3luY0NoZWNrTW9ub3NwYWNlRm9udEFzc3VtcHRpb25zID0gbmV3IFJ1bk9uY2VTY2hlZHVsZXIoZnVuY3Rpb24gKCkgewogICAgICBfdGhpcy5fY2hlY2tNb25vc3BhY2VGb250QXNzdW1wdGlvbnMoKTsKICAgIH0sIDIwMDApOwogICAgX3RoaXMuX2xhc3RSZW5kZXJlZERhdGEgPSBuZXcgTGFzdFJlbmRlcmVkRGF0YSgpOwogICAgX3RoaXMuX2hvcml6b250YWxSZXZlYWxSZXF1ZXN0ID0gbnVsbDsKICAgIHJldHVybiBfdGhpczsKICB9CiAgX2NyZWF0ZUNsYXNzKFZpZXdMaW5lcywgW3sKICAgIGtleTogImRpc3Bvc2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7CiAgICAgIHRoaXMuX2FzeW5jVXBkYXRlTGluZVdpZHRocy5kaXNwb3NlKCk7CiAgICAgIHRoaXMuX2FzeW5jQ2hlY2tNb25vc3BhY2VGb250QXNzdW1wdGlvbnMuZGlzcG9zZSgpOwogICAgICBfZ2V0KF9nZXRQcm90b3R5cGVPZihWaWV3TGluZXMucHJvdG90eXBlKSwgImRpc3Bvc2UiLCB0aGlzKS5jYWxsKHRoaXMpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldERvbU5vZGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldERvbU5vZGUoKSB7CiAgICAgIHJldHVybiB0aGlzLmRvbU5vZGU7CiAgICB9CiAgICAvLyAtLS0tIGJlZ2luIElWaXNpYmxlTGluZXNIb3N0CiAgfSwgewogICAga2V5OiAiY3JlYXRlVmlzaWJsZUxpbmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZVZpc2libGVMaW5lKCkgewogICAgICByZXR1cm4gbmV3IFZpZXdMaW5lKHRoaXMuX3ZpZXdMaW5lT3B0aW9ucyk7CiAgICB9CiAgICAvLyAtLS0tIGVuZCBJVmlzaWJsZUxpbmVzSG9zdAogICAgLy8gLS0tLSBiZWdpbiB2aWV3IGV2ZW50IGhhbmRsZXJzCiAgfSwgewogICAga2V5OiAib25Db25maWd1cmF0aW9uQ2hhbmdlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25Db25maWd1cmF0aW9uQ2hhbmdlZChlKSB7CiAgICAgIHRoaXMuX3Zpc2libGVMaW5lcy5vbkNvbmZpZ3VyYXRpb25DaGFuZ2VkKGUpOwogICAgICBpZiAoZS5oYXNDaGFuZ2VkKDEzNCAvKiBFZGl0b3JPcHRpb24ud3JhcHBpbmdJbmZvICovKSkgewogICAgICAgIHRoaXMuX21heExpbmVXaWR0aCA9IDA7CiAgICAgIH0KICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLl9jb250ZXh0LmNvbmZpZ3VyYXRpb24ub3B0aW9uczsKICAgICAgdmFyIGZvbnRJbmZvID0gb3B0aW9ucy5nZXQoNDYgLyogRWRpdG9yT3B0aW9uLmZvbnRJbmZvICovKTsKICAgICAgdmFyIHdyYXBwaW5nSW5mbyA9IG9wdGlvbnMuZ2V0KDEzNCAvKiBFZGl0b3JPcHRpb24ud3JhcHBpbmdJbmZvICovKTsKICAgICAgdmFyIGxheW91dEluZm8gPSBvcHRpb25zLmdldCgxMzMgLyogRWRpdG9yT3B0aW9uLmxheW91dEluZm8gKi8pOwogICAgICB0aGlzLl9saW5lSGVpZ2h0ID0gb3B0aW9ucy5nZXQoNjEgLyogRWRpdG9yT3B0aW9uLmxpbmVIZWlnaHQgKi8pOwogICAgICB0aGlzLl90eXBpY2FsSGFsZndpZHRoQ2hhcmFjdGVyV2lkdGggPSBmb250SW5mby50eXBpY2FsSGFsZndpZHRoQ2hhcmFjdGVyV2lkdGg7CiAgICAgIHRoaXMuX2lzVmlld3BvcnRXcmFwcGluZyA9IHdyYXBwaW5nSW5mby5pc1ZpZXdwb3J0V3JhcHBpbmc7CiAgICAgIHRoaXMuX3JldmVhbEhvcml6b250YWxSaWdodFBhZGRpbmcgPSBvcHRpb25zLmdldCg5MSAvKiBFZGl0b3JPcHRpb24ucmV2ZWFsSG9yaXpvbnRhbFJpZ2h0UGFkZGluZyAqLyk7CiAgICAgIHRoaXMuX2hvcml6b250YWxTY3JvbGxiYXJIZWlnaHQgPSBsYXlvdXRJbmZvLmhvcml6b250YWxTY3JvbGxiYXJIZWlnaHQ7CiAgICAgIHRoaXMuX2N1cnNvclN1cnJvdW5kaW5nTGluZXMgPSBvcHRpb25zLmdldCgyNSAvKiBFZGl0b3JPcHRpb24uY3Vyc29yU3Vycm91bmRpbmdMaW5lcyAqLyk7CiAgICAgIHRoaXMuX2N1cnNvclN1cnJvdW5kaW5nTGluZXNTdHlsZSA9IG9wdGlvbnMuZ2V0KDI2IC8qIEVkaXRvck9wdGlvbi5jdXJzb3JTdXJyb3VuZGluZ0xpbmVzU3R5bGUgKi8pOwogICAgICB0aGlzLl9jYW5Vc2VMYXllckhpbnRpbmcgPSAhb3B0aW9ucy5nZXQoMjggLyogRWRpdG9yT3B0aW9uLmRpc2FibGVMYXllckhpbnRpbmcgKi8pOwogICAgICBhcHBseUZvbnRJbmZvKHRoaXMuZG9tTm9kZSwgZm9udEluZm8pOwogICAgICB0aGlzLl9vbk9wdGlvbnNNYXliZUNoYW5nZWQoKTsKICAgICAgaWYgKGUuaGFzQ2hhbmdlZCgxMzMgLyogRWRpdG9yT3B0aW9uLmxheW91dEluZm8gKi8pKSB7CiAgICAgICAgdGhpcy5fbWF4TGluZVdpZHRoID0gMDsKICAgICAgfQogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfb25PcHRpb25zTWF5YmVDaGFuZ2VkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25PcHRpb25zTWF5YmVDaGFuZ2VkKCkgewogICAgICB2YXIgY29uZiA9IHRoaXMuX2NvbnRleHQuY29uZmlndXJhdGlvbjsKICAgICAgdmFyIG5ld1ZpZXdMaW5lT3B0aW9ucyA9IG5ldyBWaWV3TGluZU9wdGlvbnMoY29uZiwgdGhpcy5fY29udGV4dC50aGVtZS50eXBlKTsKICAgICAgaWYgKCF0aGlzLl92aWV3TGluZU9wdGlvbnMuZXF1YWxzKG5ld1ZpZXdMaW5lT3B0aW9ucykpIHsKICAgICAgICB0aGlzLl92aWV3TGluZU9wdGlvbnMgPSBuZXdWaWV3TGluZU9wdGlvbnM7CiAgICAgICAgdmFyIHN0YXJ0TGluZU51bWJlciA9IHRoaXMuX3Zpc2libGVMaW5lcy5nZXRTdGFydExpbmVOdW1iZXIoKTsKICAgICAgICB2YXIgZW5kTGluZU51bWJlciA9IHRoaXMuX3Zpc2libGVMaW5lcy5nZXRFbmRMaW5lTnVtYmVyKCk7CiAgICAgICAgZm9yICh2YXIgbGluZU51bWJlciA9IHN0YXJ0TGluZU51bWJlcjsgbGluZU51bWJlciA8PSBlbmRMaW5lTnVtYmVyOyBsaW5lTnVtYmVyKyspIHsKICAgICAgICAgIHZhciBsaW5lID0gdGhpcy5fdmlzaWJsZUxpbmVzLmdldFZpc2libGVMaW5lKGxpbmVOdW1iZXIpOwogICAgICAgICAgbGluZS5vbk9wdGlvbnNDaGFuZ2VkKHRoaXMuX3ZpZXdMaW5lT3B0aW9ucyk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvbkN1cnNvclN0YXRlQ2hhbmdlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25DdXJzb3JTdGF0ZUNoYW5nZWQoZSkgewogICAgICB2YXIgcmVuZFN0YXJ0TGluZU51bWJlciA9IHRoaXMuX3Zpc2libGVMaW5lcy5nZXRTdGFydExpbmVOdW1iZXIoKTsKICAgICAgdmFyIHJlbmRFbmRMaW5lTnVtYmVyID0gdGhpcy5fdmlzaWJsZUxpbmVzLmdldEVuZExpbmVOdW1iZXIoKTsKICAgICAgdmFyIHIgPSBmYWxzZTsKICAgICAgZm9yICh2YXIgbGluZU51bWJlciA9IHJlbmRTdGFydExpbmVOdW1iZXI7IGxpbmVOdW1iZXIgPD0gcmVuZEVuZExpbmVOdW1iZXI7IGxpbmVOdW1iZXIrKykgewogICAgICAgIHIgPSB0aGlzLl92aXNpYmxlTGluZXMuZ2V0VmlzaWJsZUxpbmUobGluZU51bWJlcikub25TZWxlY3Rpb25DaGFuZ2VkKCkgfHwgcjsKICAgICAgfQogICAgICByZXR1cm4gcjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvbkRlY29yYXRpb25zQ2hhbmdlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25EZWNvcmF0aW9uc0NoYW5nZWQoZSkgewogICAgICBpZiAodHJ1ZSAvKmUuaW5saW5lRGVjb3JhdGlvbnNDaGFuZ2VkKi8pIHsKICAgICAgICB2YXIgcmVuZFN0YXJ0TGluZU51bWJlciA9IHRoaXMuX3Zpc2libGVMaW5lcy5nZXRTdGFydExpbmVOdW1iZXIoKTsKICAgICAgICB2YXIgcmVuZEVuZExpbmVOdW1iZXIgPSB0aGlzLl92aXNpYmxlTGluZXMuZ2V0RW5kTGluZU51bWJlcigpOwogICAgICAgIGZvciAodmFyIGxpbmVOdW1iZXIgPSByZW5kU3RhcnRMaW5lTnVtYmVyOyBsaW5lTnVtYmVyIDw9IHJlbmRFbmRMaW5lTnVtYmVyOyBsaW5lTnVtYmVyKyspIHsKICAgICAgICAgIHRoaXMuX3Zpc2libGVMaW5lcy5nZXRWaXNpYmxlTGluZShsaW5lTnVtYmVyKS5vbkRlY29yYXRpb25zQ2hhbmdlZCgpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvbkZsdXNoZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uRmx1c2hlZChlKSB7CiAgICAgIHZhciBzaG91bGRSZW5kZXIgPSB0aGlzLl92aXNpYmxlTGluZXMub25GbHVzaGVkKGUpOwogICAgICB0aGlzLl9tYXhMaW5lV2lkdGggPSAwOwogICAgICByZXR1cm4gc2hvdWxkUmVuZGVyOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uTGluZXNDaGFuZ2VkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkxpbmVzQ2hhbmdlZChlKSB7CiAgICAgIHJldHVybiB0aGlzLl92aXNpYmxlTGluZXMub25MaW5lc0NoYW5nZWQoZSk7CiAgICB9CiAgfSwgewogICAga2V5OiAib25MaW5lc0RlbGV0ZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uTGluZXNEZWxldGVkKGUpIHsKICAgICAgcmV0dXJuIHRoaXMuX3Zpc2libGVMaW5lcy5vbkxpbmVzRGVsZXRlZChlKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvbkxpbmVzSW5zZXJ0ZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uTGluZXNJbnNlcnRlZChlKSB7CiAgICAgIHJldHVybiB0aGlzLl92aXNpYmxlTGluZXMub25MaW5lc0luc2VydGVkKGUpOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uUmV2ZWFsUmFuZ2VSZXF1ZXN0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvblJldmVhbFJhbmdlUmVxdWVzdChlKSB7CiAgICAgIC8vIFVzaW5nIHRoZSBmdXR1cmUgdmlld3BvcnQgaGVyZSBpbiBvcmRlciB0byBoYW5kbGUgbXVsdGlwbGUKICAgICAgLy8gaW5jb21pbmcgcmV2ZWFsIHJhbmdlIHJlcXVlc3RzIHRoYXQgbWlnaHQgYWxsIGRlc2lyZSB0byBiZSBhbmltYXRlZAogICAgICB2YXIgZGVzaXJlZFNjcm9sbFRvcCA9IHRoaXMuX2NvbXB1dGVTY3JvbGxUb3BUb1JldmVhbFJhbmdlKHRoaXMuX2NvbnRleHQudmlld0xheW91dC5nZXRGdXR1cmVWaWV3cG9ydCgpLCBlLnNvdXJjZSwgZS5taW5pbWFsUmV2ZWFsLCBlLnJhbmdlLCBlLnNlbGVjdGlvbnMsIGUudmVydGljYWxUeXBlKTsKICAgICAgaWYgKGRlc2lyZWRTY3JvbGxUb3AgPT09IC0xKSB7CiAgICAgICAgLy8gbWFya2VyIHRvIGFib3J0IHRoZSByZXZlYWwgcmFuZ2UgcmVxdWVzdAogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICAvLyB2YWxpZGF0ZSB0aGUgbmV3IGRlc2lyZWQgc2Nyb2xsIHRvcAogICAgICB2YXIgbmV3U2Nyb2xsUG9zaXRpb24gPSB0aGlzLl9jb250ZXh0LnZpZXdMYXlvdXQudmFsaWRhdGVTY3JvbGxQb3NpdGlvbih7CiAgICAgICAgc2Nyb2xsVG9wOiBkZXNpcmVkU2Nyb2xsVG9wCiAgICAgIH0pOwogICAgICBpZiAoZS5yZXZlYWxIb3Jpem9udGFsKSB7CiAgICAgICAgaWYgKGUucmFuZ2UgJiYgZS5yYW5nZS5zdGFydExpbmVOdW1iZXIgIT09IGUucmFuZ2UuZW5kTGluZU51bWJlcikgewogICAgICAgICAgLy8gVHdvIG9yIG1vcmUgbGluZXM/ID0+IHNjcm9sbCB0byBiYXNlIChUaGF0J3MgaG93IHlvdSBzZWUgbW9zdCBvZiB0aGUgdHdvIGxpbmVzKQogICAgICAgICAgbmV3U2Nyb2xsUG9zaXRpb24gPSB7CiAgICAgICAgICAgIHNjcm9sbFRvcDogbmV3U2Nyb2xsUG9zaXRpb24uc2Nyb2xsVG9wLAogICAgICAgICAgICBzY3JvbGxMZWZ0OiAwCiAgICAgICAgICB9OwogICAgICAgIH0gZWxzZSBpZiAoZS5yYW5nZSkgewogICAgICAgICAgLy8gV2UgZG9uJ3QgbmVjZXNzYXJpbHkga25vdyB0aGUgaG9yaXpvbnRhbCBvZmZzZXQgb2YgdGhpcyByYW5nZSBzaW5jZSB0aGUgbGluZSBtaWdodCBub3QgYmUgaW4gdGhlIHZpZXcuLi4KICAgICAgICAgIHRoaXMuX2hvcml6b250YWxSZXZlYWxSZXF1ZXN0ID0gbmV3IEhvcml6b250YWxSZXZlYWxSYW5nZVJlcXVlc3QoZS5taW5pbWFsUmV2ZWFsLCBlLnJhbmdlLnN0YXJ0TGluZU51bWJlciwgZS5yYW5nZS5zdGFydENvbHVtbiwgZS5yYW5nZS5lbmRDb2x1bW4sIHRoaXMuX2NvbnRleHQudmlld0xheW91dC5nZXRDdXJyZW50U2Nyb2xsVG9wKCksIG5ld1Njcm9sbFBvc2l0aW9uLnNjcm9sbFRvcCwgZS5zY3JvbGxUeXBlKTsKICAgICAgICB9IGVsc2UgaWYgKGUuc2VsZWN0aW9ucyAmJiBlLnNlbGVjdGlvbnMubGVuZ3RoID4gMCkgewogICAgICAgICAgdGhpcy5faG9yaXpvbnRhbFJldmVhbFJlcXVlc3QgPSBuZXcgSG9yaXpvbnRhbFJldmVhbFNlbGVjdGlvbnNSZXF1ZXN0KGUubWluaW1hbFJldmVhbCwgZS5zZWxlY3Rpb25zLCB0aGlzLl9jb250ZXh0LnZpZXdMYXlvdXQuZ2V0Q3VycmVudFNjcm9sbFRvcCgpLCBuZXdTY3JvbGxQb3NpdGlvbi5zY3JvbGxUb3AsIGUuc2Nyb2xsVHlwZSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuX2hvcml6b250YWxSZXZlYWxSZXF1ZXN0ID0gbnVsbDsKICAgICAgfQogICAgICB2YXIgc2Nyb2xsVG9wRGVsdGEgPSBNYXRoLmFicyh0aGlzLl9jb250ZXh0LnZpZXdMYXlvdXQuZ2V0Q3VycmVudFNjcm9sbFRvcCgpIC0gbmV3U2Nyb2xsUG9zaXRpb24uc2Nyb2xsVG9wKTsKICAgICAgdmFyIHNjcm9sbFR5cGUgPSBzY3JvbGxUb3BEZWx0YSA8PSB0aGlzLl9saW5lSGVpZ2h0ID8gMSAvKiBTY3JvbGxUeXBlLkltbWVkaWF0ZSAqLyA6IGUuc2Nyb2xsVHlwZTsKICAgICAgdGhpcy5fY29udGV4dC52aWV3TW9kZWwudmlld0xheW91dC5zZXRTY3JvbGxQb3NpdGlvbihuZXdTY3JvbGxQb3NpdGlvbiwgc2Nyb2xsVHlwZSk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uU2Nyb2xsQ2hhbmdlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25TY3JvbGxDaGFuZ2VkKGUpIHsKICAgICAgaWYgKHRoaXMuX2hvcml6b250YWxSZXZlYWxSZXF1ZXN0ICYmIGUuc2Nyb2xsTGVmdENoYW5nZWQpIHsKICAgICAgICAvLyBjYW5jZWwgYW55IG91dHN0YW5kaW5nIGhvcml6b250YWwgcmV2ZWFsIHJlcXVlc3QgaWYgc29tZW9uZSBlbHNlIHNjcm9sbHMgaG9yaXpvbnRhbGx5LgogICAgICAgIHRoaXMuX2hvcml6b250YWxSZXZlYWxSZXF1ZXN0ID0gbnVsbDsKICAgICAgfQogICAgICBpZiAodGhpcy5faG9yaXpvbnRhbFJldmVhbFJlcXVlc3QgJiYgZS5zY3JvbGxUb3BDaGFuZ2VkKSB7CiAgICAgICAgdmFyIG1pbiA9IE1hdGgubWluKHRoaXMuX2hvcml6b250YWxSZXZlYWxSZXF1ZXN0LnN0YXJ0U2Nyb2xsVG9wLCB0aGlzLl9ob3Jpem9udGFsUmV2ZWFsUmVxdWVzdC5zdG9wU2Nyb2xsVG9wKTsKICAgICAgICB2YXIgbWF4ID0gTWF0aC5tYXgodGhpcy5faG9yaXpvbnRhbFJldmVhbFJlcXVlc3Quc3RhcnRTY3JvbGxUb3AsIHRoaXMuX2hvcml6b250YWxSZXZlYWxSZXF1ZXN0LnN0b3BTY3JvbGxUb3ApOwogICAgICAgIGlmIChlLnNjcm9sbFRvcCA8IG1pbiB8fCBlLnNjcm9sbFRvcCA+IG1heCkgewogICAgICAgICAgLy8gY2FuY2VsIGFueSBvdXRzdGFuZGluZyBob3Jpem9udGFsIHJldmVhbCByZXF1ZXN0IGlmIHNvbWVvbmUgZWxzZSBzY3JvbGxzIHZlcnRpY2FsbHkuCiAgICAgICAgICB0aGlzLl9ob3Jpem9udGFsUmV2ZWFsUmVxdWVzdCA9IG51bGw7CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMuZG9tTm9kZS5zZXRXaWR0aChlLnNjcm9sbFdpZHRoKTsKICAgICAgcmV0dXJuIHRoaXMuX3Zpc2libGVMaW5lcy5vblNjcm9sbENoYW5nZWQoZSkgfHwgdHJ1ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvblRva2Vuc0NoYW5nZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uVG9rZW5zQ2hhbmdlZChlKSB7CiAgICAgIHJldHVybiB0aGlzLl92aXNpYmxlTGluZXMub25Ub2tlbnNDaGFuZ2VkKGUpOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uWm9uZXNDaGFuZ2VkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvblpvbmVzQ2hhbmdlZChlKSB7CiAgICAgIHRoaXMuX2NvbnRleHQudmlld01vZGVsLnZpZXdMYXlvdXQuc2V0TWF4TGluZVdpZHRoKHRoaXMuX21heExpbmVXaWR0aCk7CiAgICAgIHJldHVybiB0aGlzLl92aXNpYmxlTGluZXMub25ab25lc0NoYW5nZWQoZSk7CiAgICB9CiAgfSwgewogICAga2V5OiAib25UaGVtZUNoYW5nZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uVGhlbWVDaGFuZ2VkKGUpIHsKICAgICAgcmV0dXJuIHRoaXMuX29uT3B0aW9uc01heWJlQ2hhbmdlZCgpOwogICAgfQogICAgLy8gLS0tLSBlbmQgdmlldyBldmVudCBoYW5kbGVycwogICAgLy8gLS0tLS0tLS0tLS0gSEVMUEVSUyBGT1IgT1RIRVJTCiAgfSwgewogICAga2V5OiAiZ2V0UG9zaXRpb25Gcm9tRE9NSW5mbyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UG9zaXRpb25Gcm9tRE9NSW5mbyhzcGFuTm9kZSwgb2Zmc2V0KSB7CiAgICAgIHZhciB2aWV3TGluZURvbU5vZGUgPSB0aGlzLl9nZXRWaWV3TGluZURvbU5vZGUoc3Bhbk5vZGUpOwogICAgICBpZiAodmlld0xpbmVEb21Ob2RlID09PSBudWxsKSB7CiAgICAgICAgLy8gQ291bGRuJ3QgZmluZCB2aWV3IGxpbmUgbm9kZQogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICAgIHZhciBsaW5lTnVtYmVyID0gdGhpcy5fZ2V0TGluZU51bWJlckZvcih2aWV3TGluZURvbU5vZGUpOwogICAgICBpZiAobGluZU51bWJlciA9PT0gLTEpIHsKICAgICAgICAvLyBDb3VsZG4ndCBmaW5kIHZpZXcgbGluZSBub2RlCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgICAgaWYgKGxpbmVOdW1iZXIgPCAxIHx8IGxpbmVOdW1iZXIgPiB0aGlzLl9jb250ZXh0LnZpZXdNb2RlbC5nZXRMaW5lQ291bnQoKSkgewogICAgICAgIC8vIGxpbmVOdW1iZXIgaXMgb3V0c2lkZSByYW5nZQogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICAgIGlmICh0aGlzLl9jb250ZXh0LnZpZXdNb2RlbC5nZXRMaW5lTWF4Q29sdW1uKGxpbmVOdW1iZXIpID09PSAxKSB7CiAgICAgICAgLy8gTGluZSBpcyBlbXB0eQogICAgICAgIHJldHVybiBuZXcgUG9zaXRpb24obGluZU51bWJlciwgMSk7CiAgICAgIH0KICAgICAgdmFyIHJlbmRTdGFydExpbmVOdW1iZXIgPSB0aGlzLl92aXNpYmxlTGluZXMuZ2V0U3RhcnRMaW5lTnVtYmVyKCk7CiAgICAgIHZhciByZW5kRW5kTGluZU51bWJlciA9IHRoaXMuX3Zpc2libGVMaW5lcy5nZXRFbmRMaW5lTnVtYmVyKCk7CiAgICAgIGlmIChsaW5lTnVtYmVyIDwgcmVuZFN0YXJ0TGluZU51bWJlciB8fCBsaW5lTnVtYmVyID4gcmVuZEVuZExpbmVOdW1iZXIpIHsKICAgICAgICAvLyBDb3VsZG4ndCBmaW5kIGxpbmUKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgICB2YXIgY29sdW1uID0gdGhpcy5fdmlzaWJsZUxpbmVzLmdldFZpc2libGVMaW5lKGxpbmVOdW1iZXIpLmdldENvbHVtbk9mTm9kZU9mZnNldChsaW5lTnVtYmVyLCBzcGFuTm9kZSwgb2Zmc2V0KTsKICAgICAgdmFyIG1pbkNvbHVtbiA9IHRoaXMuX2NvbnRleHQudmlld01vZGVsLmdldExpbmVNaW5Db2x1bW4obGluZU51bWJlcik7CiAgICAgIGlmIChjb2x1bW4gPCBtaW5Db2x1bW4pIHsKICAgICAgICBjb2x1bW4gPSBtaW5Db2x1bW47CiAgICAgIH0KICAgICAgcmV0dXJuIG5ldyBQb3NpdGlvbihsaW5lTnVtYmVyLCBjb2x1bW4pOwogICAgfQogIH0sIHsKICAgIGtleTogIl9nZXRWaWV3TGluZURvbU5vZGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9nZXRWaWV3TGluZURvbU5vZGUobm9kZSkgewogICAgICB3aGlsZSAobm9kZSAmJiBub2RlLm5vZGVUeXBlID09PSAxKSB7CiAgICAgICAgaWYgKG5vZGUuY2xhc3NOYW1lID09PSBWaWV3TGluZS5DTEFTU19OQU1FKSB7CiAgICAgICAgICByZXR1cm4gbm9kZTsKICAgICAgICB9CiAgICAgICAgbm9kZSA9IG5vZGUucGFyZW50RWxlbWVudDsKICAgICAgfQogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIC8qKgogICAgICogQHJldHVybnMgdGhlIGxpbmUgbnVtYmVyIG9mIHRoaXMgdmlldyBsaW5lIGRvbSBub2RlLgogICAgICovCiAgfSwgewogICAga2V5OiAiX2dldExpbmVOdW1iZXJGb3IiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9nZXRMaW5lTnVtYmVyRm9yKGRvbU5vZGUpIHsKICAgICAgdmFyIHN0YXJ0TGluZU51bWJlciA9IHRoaXMuX3Zpc2libGVMaW5lcy5nZXRTdGFydExpbmVOdW1iZXIoKTsKICAgICAgdmFyIGVuZExpbmVOdW1iZXIgPSB0aGlzLl92aXNpYmxlTGluZXMuZ2V0RW5kTGluZU51bWJlcigpOwogICAgICBmb3IgKHZhciBsaW5lTnVtYmVyID0gc3RhcnRMaW5lTnVtYmVyOyBsaW5lTnVtYmVyIDw9IGVuZExpbmVOdW1iZXI7IGxpbmVOdW1iZXIrKykgewogICAgICAgIHZhciBsaW5lID0gdGhpcy5fdmlzaWJsZUxpbmVzLmdldFZpc2libGVMaW5lKGxpbmVOdW1iZXIpOwogICAgICAgIGlmIChkb21Ob2RlID09PSBsaW5lLmdldERvbU5vZGUoKSkgewogICAgICAgICAgcmV0dXJuIGxpbmVOdW1iZXI7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiAtMTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRMaW5lV2lkdGgiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldExpbmVXaWR0aChsaW5lTnVtYmVyKSB7CiAgICAgIHZhciByZW5kU3RhcnRMaW5lTnVtYmVyID0gdGhpcy5fdmlzaWJsZUxpbmVzLmdldFN0YXJ0TGluZU51bWJlcigpOwogICAgICB2YXIgcmVuZEVuZExpbmVOdW1iZXIgPSB0aGlzLl92aXNpYmxlTGluZXMuZ2V0RW5kTGluZU51bWJlcigpOwogICAgICBpZiAobGluZU51bWJlciA8IHJlbmRTdGFydExpbmVOdW1iZXIgfHwgbGluZU51bWJlciA+IHJlbmRFbmRMaW5lTnVtYmVyKSB7CiAgICAgICAgLy8gQ291bGRuJ3QgZmluZCBsaW5lCiAgICAgICAgcmV0dXJuIC0xOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLl92aXNpYmxlTGluZXMuZ2V0VmlzaWJsZUxpbmUobGluZU51bWJlcikuZ2V0V2lkdGgoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJsaW5lc1Zpc2libGVSYW5nZXNGb3JSYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbGluZXNWaXNpYmxlUmFuZ2VzRm9yUmFuZ2UoX3JhbmdlLCBpbmNsdWRlTmV3TGluZXMpIHsKICAgICAgaWYgKHRoaXMuc2hvdWxkUmVuZGVyKCkpIHsKICAgICAgICAvLyBDYW5ub3QgcmVhZCBmcm9tIHRoZSBET00gYmVjYXVzZSBpdCBpcyBkaXJ0eQogICAgICAgIC8vIGkuZS4gdGhlIG1vZGVsICYgdGhlIGRvbSBhcmUgb3V0IG9mIHN5bmMsIHNvIEknZCBiZSByZWFkaW5nIHNvbWV0aGluZyBzdGFsZQogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICAgIHZhciBvcmlnaW5hbEVuZExpbmVOdW1iZXIgPSBfcmFuZ2UuZW5kTGluZU51bWJlcjsKICAgICAgdmFyIHJhbmdlID0gUmFuZ2UuaW50ZXJzZWN0UmFuZ2VzKF9yYW5nZSwgdGhpcy5fbGFzdFJlbmRlcmVkRGF0YS5nZXRDdXJyZW50VmlzaWJsZVJhbmdlKCkpOwogICAgICBpZiAoIXJhbmdlKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgICAgdmFyIHZpc2libGVSYW5nZXMgPSBbXTsKICAgICAgdmFyIHZpc2libGVSYW5nZXNMZW4gPSAwOwogICAgICB2YXIgZG9tUmVhZGluZ0NvbnRleHQgPSBuZXcgRG9tUmVhZGluZ0NvbnRleHQodGhpcy5kb21Ob2RlLmRvbU5vZGUsIHRoaXMuX3RleHRSYW5nZVJlc3RpbmdTcG90KTsKICAgICAgdmFyIG5leHRMaW5lTW9kZWxMaW5lTnVtYmVyID0gMDsKICAgICAgaWYgKGluY2x1ZGVOZXdMaW5lcykgewogICAgICAgIG5leHRMaW5lTW9kZWxMaW5lTnVtYmVyID0gdGhpcy5fY29udGV4dC52aWV3TW9kZWwuY29vcmRpbmF0ZXNDb252ZXJ0ZXIuY29udmVydFZpZXdQb3NpdGlvblRvTW9kZWxQb3NpdGlvbihuZXcgUG9zaXRpb24ocmFuZ2Uuc3RhcnRMaW5lTnVtYmVyLCAxKSkubGluZU51bWJlcjsKICAgICAgfQogICAgICB2YXIgcmVuZFN0YXJ0TGluZU51bWJlciA9IHRoaXMuX3Zpc2libGVMaW5lcy5nZXRTdGFydExpbmVOdW1iZXIoKTsKICAgICAgdmFyIHJlbmRFbmRMaW5lTnVtYmVyID0gdGhpcy5fdmlzaWJsZUxpbmVzLmdldEVuZExpbmVOdW1iZXIoKTsKICAgICAgZm9yICh2YXIgbGluZU51bWJlciA9IHJhbmdlLnN0YXJ0TGluZU51bWJlcjsgbGluZU51bWJlciA8PSByYW5nZS5lbmRMaW5lTnVtYmVyOyBsaW5lTnVtYmVyKyspIHsKICAgICAgICBpZiAobGluZU51bWJlciA8IHJlbmRTdGFydExpbmVOdW1iZXIgfHwgbGluZU51bWJlciA+IHJlbmRFbmRMaW5lTnVtYmVyKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgICAgdmFyIHN0YXJ0Q29sdW1uID0gbGluZU51bWJlciA9PT0gcmFuZ2Uuc3RhcnRMaW5lTnVtYmVyID8gcmFuZ2Uuc3RhcnRDb2x1bW4gOiAxOwogICAgICAgIHZhciBlbmRDb2x1bW4gPSBsaW5lTnVtYmVyID09PSByYW5nZS5lbmRMaW5lTnVtYmVyID8gcmFuZ2UuZW5kQ29sdW1uIDogdGhpcy5fY29udGV4dC52aWV3TW9kZWwuZ2V0TGluZU1heENvbHVtbihsaW5lTnVtYmVyKTsKICAgICAgICB2YXIgdmlzaWJsZVJhbmdlc0ZvckxpbmUgPSB0aGlzLl92aXNpYmxlTGluZXMuZ2V0VmlzaWJsZUxpbmUobGluZU51bWJlcikuZ2V0VmlzaWJsZVJhbmdlc0ZvclJhbmdlKGxpbmVOdW1iZXIsIHN0YXJ0Q29sdW1uLCBlbmRDb2x1bW4sIGRvbVJlYWRpbmdDb250ZXh0KTsKICAgICAgICBpZiAoIXZpc2libGVSYW5nZXNGb3JMaW5lKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgICAgaWYgKGluY2x1ZGVOZXdMaW5lcyAmJiBsaW5lTnVtYmVyIDwgb3JpZ2luYWxFbmRMaW5lTnVtYmVyKSB7CiAgICAgICAgICB2YXIgY3VycmVudExpbmVNb2RlbExpbmVOdW1iZXIgPSBuZXh0TGluZU1vZGVsTGluZU51bWJlcjsKICAgICAgICAgIG5leHRMaW5lTW9kZWxMaW5lTnVtYmVyID0gdGhpcy5fY29udGV4dC52aWV3TW9kZWwuY29vcmRpbmF0ZXNDb252ZXJ0ZXIuY29udmVydFZpZXdQb3NpdGlvblRvTW9kZWxQb3NpdGlvbihuZXcgUG9zaXRpb24obGluZU51bWJlciArIDEsIDEpKS5saW5lTnVtYmVyOwogICAgICAgICAgaWYgKGN1cnJlbnRMaW5lTW9kZWxMaW5lTnVtYmVyICE9PSBuZXh0TGluZU1vZGVsTGluZU51bWJlcikgewogICAgICAgICAgICB2aXNpYmxlUmFuZ2VzRm9yTGluZS5yYW5nZXNbdmlzaWJsZVJhbmdlc0ZvckxpbmUucmFuZ2VzLmxlbmd0aCAtIDFdLndpZHRoICs9IHRoaXMuX3R5cGljYWxIYWxmd2lkdGhDaGFyYWN0ZXJXaWR0aDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdmlzaWJsZVJhbmdlc1t2aXNpYmxlUmFuZ2VzTGVuKytdID0gbmV3IExpbmVWaXNpYmxlUmFuZ2VzKHZpc2libGVSYW5nZXNGb3JMaW5lLm91dHNpZGVSZW5kZXJlZExpbmUsIGxpbmVOdW1iZXIsIEhvcml6b250YWxSYW5nZS5mcm9tKHZpc2libGVSYW5nZXNGb3JMaW5lLnJhbmdlcykpOwogICAgICB9CiAgICAgIGlmICh2aXNpYmxlUmFuZ2VzTGVuID09PSAwKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgICAgcmV0dXJuIHZpc2libGVSYW5nZXM7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3Zpc2libGVSYW5nZXNGb3JMaW5lUmFuZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF92aXNpYmxlUmFuZ2VzRm9yTGluZVJhbmdlKGxpbmVOdW1iZXIsIHN0YXJ0Q29sdW1uLCBlbmRDb2x1bW4pIHsKICAgICAgaWYgKHRoaXMuc2hvdWxkUmVuZGVyKCkpIHsKICAgICAgICAvLyBDYW5ub3QgcmVhZCBmcm9tIHRoZSBET00gYmVjYXVzZSBpdCBpcyBkaXJ0eQogICAgICAgIC8vIGkuZS4gdGhlIG1vZGVsICYgdGhlIGRvbSBhcmUgb3V0IG9mIHN5bmMsIHNvIEknZCBiZSByZWFkaW5nIHNvbWV0aGluZyBzdGFsZQogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICAgIGlmIChsaW5lTnVtYmVyIDwgdGhpcy5fdmlzaWJsZUxpbmVzLmdldFN0YXJ0TGluZU51bWJlcigpIHx8IGxpbmVOdW1iZXIgPiB0aGlzLl92aXNpYmxlTGluZXMuZ2V0RW5kTGluZU51bWJlcigpKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMuX3Zpc2libGVMaW5lcy5nZXRWaXNpYmxlTGluZShsaW5lTnVtYmVyKS5nZXRWaXNpYmxlUmFuZ2VzRm9yUmFuZ2UobGluZU51bWJlciwgc3RhcnRDb2x1bW4sIGVuZENvbHVtbiwgbmV3IERvbVJlYWRpbmdDb250ZXh0KHRoaXMuZG9tTm9kZS5kb21Ob2RlLCB0aGlzLl90ZXh0UmFuZ2VSZXN0aW5nU3BvdCkpOwogICAgfQogIH0sIHsKICAgIGtleTogInZpc2libGVSYW5nZUZvclBvc2l0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB2aXNpYmxlUmFuZ2VGb3JQb3NpdGlvbihwb3NpdGlvbikgewogICAgICB2YXIgdmlzaWJsZVJhbmdlcyA9IHRoaXMuX3Zpc2libGVSYW5nZXNGb3JMaW5lUmFuZ2UocG9zaXRpb24ubGluZU51bWJlciwgcG9zaXRpb24uY29sdW1uLCBwb3NpdGlvbi5jb2x1bW4pOwogICAgICBpZiAoIXZpc2libGVSYW5nZXMpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgICByZXR1cm4gbmV3IEhvcml6b250YWxQb3NpdGlvbih2aXNpYmxlUmFuZ2VzLm91dHNpZGVSZW5kZXJlZExpbmUsIHZpc2libGVSYW5nZXMucmFuZ2VzWzBdLmxlZnQpOwogICAgfQogICAgLy8gLS0tIGltcGxlbWVudGF0aW9uCiAgfSwgewogICAga2V5OiAidXBkYXRlTGluZVdpZHRocyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlTGluZVdpZHRocygpIHsKICAgICAgdGhpcy5fdXBkYXRlTGluZVdpZHRocyhmYWxzZSk7CiAgICB9CiAgICAvKioKICAgICAqIFVwZGF0ZXMgdGhlIG1heCBsaW5lIHdpZHRoIGlmIGl0IGlzIGZhc3QgdG8gY29tcHV0ZS4KICAgICAqIFJldHVybnMgdHJ1ZSBpZiBhbGwgbGluZXMgd2VyZSB0YWtlbiBpbnRvIGFjY291bnQuCiAgICAgKiBSZXR1cm5zIGZhbHNlIGlmIHNvbWUgbGluZXMgbmVlZCB0byBiZSByZWV2YWx1YXRlZCAoaW4gYSBzbG93IGZhc2hpb24pLgogICAgICovCiAgfSwgewogICAga2V5OiAiX3VwZGF0ZUxpbmVXaWR0aHNGYXN0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfdXBkYXRlTGluZVdpZHRoc0Zhc3QoKSB7CiAgICAgIHJldHVybiB0aGlzLl91cGRhdGVMaW5lV2lkdGhzKHRydWUpOwogICAgfQogIH0sIHsKICAgIGtleTogIl91cGRhdGVMaW5lV2lkdGhzU2xvdyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3VwZGF0ZUxpbmVXaWR0aHNTbG93KCkgewogICAgICB0aGlzLl91cGRhdGVMaW5lV2lkdGhzKGZhbHNlKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfdXBkYXRlTGluZVdpZHRocyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX3VwZGF0ZUxpbmVXaWR0aHMoZmFzdCkgewogICAgICB2YXIgcmVuZFN0YXJ0TGluZU51bWJlciA9IHRoaXMuX3Zpc2libGVMaW5lcy5nZXRTdGFydExpbmVOdW1iZXIoKTsKICAgICAgdmFyIHJlbmRFbmRMaW5lTnVtYmVyID0gdGhpcy5fdmlzaWJsZUxpbmVzLmdldEVuZExpbmVOdW1iZXIoKTsKICAgICAgdmFyIGxvY2FsTWF4TGluZVdpZHRoID0gMTsKICAgICAgdmFyIGFsbFdpZHRoc0NvbXB1dGVkID0gdHJ1ZTsKICAgICAgZm9yICh2YXIgbGluZU51bWJlciA9IHJlbmRTdGFydExpbmVOdW1iZXI7IGxpbmVOdW1iZXIgPD0gcmVuZEVuZExpbmVOdW1iZXI7IGxpbmVOdW1iZXIrKykgewogICAgICAgIHZhciB2aXNpYmxlTGluZSA9IHRoaXMuX3Zpc2libGVMaW5lcy5nZXRWaXNpYmxlTGluZShsaW5lTnVtYmVyKTsKICAgICAgICBpZiAoZmFzdCAmJiAhdmlzaWJsZUxpbmUuZ2V0V2lkdGhJc0Zhc3QoKSkgewogICAgICAgICAgLy8gQ2Fubm90IGNvbXB1dGUgd2lkdGggaW4gYSBmYXN0IHdheSBmb3IgdGhpcyBsaW5lCiAgICAgICAgICBhbGxXaWR0aHNDb21wdXRlZCA9IGZhbHNlOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIGxvY2FsTWF4TGluZVdpZHRoID0gTWF0aC5tYXgobG9jYWxNYXhMaW5lV2lkdGgsIHZpc2libGVMaW5lLmdldFdpZHRoKCkpOwogICAgICB9CiAgICAgIGlmIChhbGxXaWR0aHNDb21wdXRlZCAmJiByZW5kU3RhcnRMaW5lTnVtYmVyID09PSAxICYmIHJlbmRFbmRMaW5lTnVtYmVyID09PSB0aGlzLl9jb250ZXh0LnZpZXdNb2RlbC5nZXRMaW5lQ291bnQoKSkgewogICAgICAgIC8vIHdlIGtub3cgdGhlIG1heCBsaW5lIHdpZHRoIGZvciBhbGwgdGhlIGxpbmVzCiAgICAgICAgdGhpcy5fbWF4TGluZVdpZHRoID0gMDsKICAgICAgfQogICAgICB0aGlzLl9lbnN1cmVNYXhMaW5lV2lkdGgobG9jYWxNYXhMaW5lV2lkdGgpOwogICAgICByZXR1cm4gYWxsV2lkdGhzQ29tcHV0ZWQ7CiAgICB9CiAgfSwgewogICAga2V5OiAiX2NoZWNrTW9ub3NwYWNlRm9udEFzc3VtcHRpb25zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfY2hlY2tNb25vc3BhY2VGb250QXNzdW1wdGlvbnMoKSB7CiAgICAgIC8vIFByb2JsZW1zIHdpdGggbW9ub3NwYWNlIGFzc3VtcHRpb25zIGFyZSBtb3JlIGFwcGFyZW50IGZvciBsb25nZXIgbGluZXMsCiAgICAgIC8vIGFzIHNtYWxsIHJvdW5kaW5nIGVycm9ycyBzdGFydCB0byBzdW0gdXAsIHNvIHdlIHdpbGwgc2VsZWN0IHRoZSBsb25nZXN0CiAgICAgIC8vIGxpbmUgZm9yIGEgY2xvc2VyIGluc3BlY3Rpb24KICAgICAgdmFyIGxvbmdlc3RMaW5lTnVtYmVyID0gLTE7CiAgICAgIHZhciBsb25nZXN0V2lkdGggPSAtMTsKICAgICAgdmFyIHJlbmRTdGFydExpbmVOdW1iZXIgPSB0aGlzLl92aXNpYmxlTGluZXMuZ2V0U3RhcnRMaW5lTnVtYmVyKCk7CiAgICAgIHZhciByZW5kRW5kTGluZU51bWJlciA9IHRoaXMuX3Zpc2libGVMaW5lcy5nZXRFbmRMaW5lTnVtYmVyKCk7CiAgICAgIGZvciAodmFyIGxpbmVOdW1iZXIgPSByZW5kU3RhcnRMaW5lTnVtYmVyOyBsaW5lTnVtYmVyIDw9IHJlbmRFbmRMaW5lTnVtYmVyOyBsaW5lTnVtYmVyKyspIHsKICAgICAgICB2YXIgdmlzaWJsZUxpbmUgPSB0aGlzLl92aXNpYmxlTGluZXMuZ2V0VmlzaWJsZUxpbmUobGluZU51bWJlcik7CiAgICAgICAgaWYgKHZpc2libGVMaW5lLm5lZWRzTW9ub3NwYWNlRm9udENoZWNrKCkpIHsKICAgICAgICAgIHZhciBsaW5lV2lkdGggPSB2aXNpYmxlTGluZS5nZXRXaWR0aCgpOwogICAgICAgICAgaWYgKGxpbmVXaWR0aCA+IGxvbmdlc3RXaWR0aCkgewogICAgICAgICAgICBsb25nZXN0V2lkdGggPSBsaW5lV2lkdGg7CiAgICAgICAgICAgIGxvbmdlc3RMaW5lTnVtYmVyID0gbGluZU51bWJlcjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGxvbmdlc3RMaW5lTnVtYmVyID09PSAtMSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoIXRoaXMuX3Zpc2libGVMaW5lcy5nZXRWaXNpYmxlTGluZShsb25nZXN0TGluZU51bWJlcikubW9ub3NwYWNlQXNzdW1wdGlvbnNBcmVWYWxpZCgpKSB7CiAgICAgICAgZm9yICh2YXIgX2xpbmVOdW1iZXIgPSByZW5kU3RhcnRMaW5lTnVtYmVyOyBfbGluZU51bWJlciA8PSByZW5kRW5kTGluZU51bWJlcjsgX2xpbmVOdW1iZXIrKykgewogICAgICAgICAgdmFyIF92aXNpYmxlTGluZSA9IHRoaXMuX3Zpc2libGVMaW5lcy5nZXRWaXNpYmxlTGluZShfbGluZU51bWJlcik7CiAgICAgICAgICBfdmlzaWJsZUxpbmUub25Nb25vc3BhY2VBc3N1bXB0aW9uc0ludmFsaWRhdGVkKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAicHJlcGFyZVJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcHJlcGFyZVJlbmRlcigpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdOb3Qgc3VwcG9ydGVkJyk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignTm90IHN1cHBvcnRlZCcpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlclRleHQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlclRleHQodmlld3BvcnREYXRhKSB7CiAgICAgIC8vICgxKSByZW5kZXIgbGluZXMgLSBlbnN1cmVzIGxpbmVzIGFyZSBpbiB0aGUgRE9NCiAgICAgIHRoaXMuX3Zpc2libGVMaW5lcy5yZW5kZXJMaW5lcyh2aWV3cG9ydERhdGEpOwogICAgICB0aGlzLl9sYXN0UmVuZGVyZWREYXRhLnNldEN1cnJlbnRWaXNpYmxlUmFuZ2Uodmlld3BvcnREYXRhLnZpc2libGVSYW5nZSk7CiAgICAgIHRoaXMuZG9tTm9kZS5zZXRXaWR0aCh0aGlzLl9jb250ZXh0LnZpZXdMYXlvdXQuZ2V0U2Nyb2xsV2lkdGgoKSk7CiAgICAgIHRoaXMuZG9tTm9kZS5zZXRIZWlnaHQoTWF0aC5taW4odGhpcy5fY29udGV4dC52aWV3TGF5b3V0LmdldFNjcm9sbEhlaWdodCgpLCAxMDAwMDAwKSk7CiAgICAgIC8vICgyKSBjb21wdXRlIGhvcml6b250YWwgc2Nyb2xsIHBvc2l0aW9uOgogICAgICAvLyAgLSB0aGlzIG11c3QgaGFwcGVuIGFmdGVyIHRoZSBsaW5lcyBhcmUgaW4gdGhlIERPTSBzaW5jZSBpdCBtaWdodCBuZWVkIGEgbGluZSB0aGF0IHJlbmRlcmVkIGp1c3Qgbm93CiAgICAgIC8vICAtIGl0IG1pZ2h0IGNoYW5nZSBgc2Nyb2xsV2lkdGhgIGFuZCBgc2Nyb2xsTGVmdGAKICAgICAgaWYgKHRoaXMuX2hvcml6b250YWxSZXZlYWxSZXF1ZXN0KSB7CiAgICAgICAgdmFyIGhvcml6b250YWxSZXZlYWxSZXF1ZXN0ID0gdGhpcy5faG9yaXpvbnRhbFJldmVhbFJlcXVlc3Q7CiAgICAgICAgLy8gQ2hlY2sgdGhhdCB3ZSBoYXZlIHRoZSBsaW5lIHRoYXQgY29udGFpbnMgdGhlIGhvcml6b250YWwgcmFuZ2UgaW4gdGhlIHZpZXdwb3J0CiAgICAgICAgaWYgKHZpZXdwb3J0RGF0YS5zdGFydExpbmVOdW1iZXIgPD0gaG9yaXpvbnRhbFJldmVhbFJlcXVlc3QubWluTGluZU51bWJlciAmJiBob3Jpem9udGFsUmV2ZWFsUmVxdWVzdC5tYXhMaW5lTnVtYmVyIDw9IHZpZXdwb3J0RGF0YS5lbmRMaW5lTnVtYmVyKSB7CiAgICAgICAgICB0aGlzLl9ob3Jpem9udGFsUmV2ZWFsUmVxdWVzdCA9IG51bGw7CiAgICAgICAgICAvLyBhbGxvdyBgdmlzaWJsZVJhbmdlc0ZvclJhbmdlMmAgdG8gd29yawogICAgICAgICAgdGhpcy5vbkRpZFJlbmRlcigpOwogICAgICAgICAgLy8gY29tcHV0ZSBuZXcgc2Nyb2xsIHBvc2l0aW9uCiAgICAgICAgICB2YXIgbmV3U2Nyb2xsTGVmdCA9IHRoaXMuX2NvbXB1dGVTY3JvbGxMZWZ0VG9SZXZlYWwoaG9yaXpvbnRhbFJldmVhbFJlcXVlc3QpOwogICAgICAgICAgaWYgKG5ld1Njcm9sbExlZnQpIHsKICAgICAgICAgICAgaWYgKCF0aGlzLl9pc1ZpZXdwb3J0V3JhcHBpbmcpIHsKICAgICAgICAgICAgICAvLyBlbnN1cmUgYHNjcm9sbFdpZHRoYCBpcyBsYXJnZSBlbm91Z2gKICAgICAgICAgICAgICB0aGlzLl9lbnN1cmVNYXhMaW5lV2lkdGgobmV3U2Nyb2xsTGVmdC5tYXhIb3Jpem9udGFsT2Zmc2V0KTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBzZXQgYHNjcm9sbExlZnRgCiAgICAgICAgICAgIHRoaXMuX2NvbnRleHQudmlld01vZGVsLnZpZXdMYXlvdXQuc2V0U2Nyb2xsUG9zaXRpb24oewogICAgICAgICAgICAgIHNjcm9sbExlZnQ6IG5ld1Njcm9sbExlZnQuc2Nyb2xsTGVmdAogICAgICAgICAgICB9LCBob3Jpem9udGFsUmV2ZWFsUmVxdWVzdC5zY3JvbGxUeXBlKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgLy8gVXBkYXRlIG1heCBsaW5lIHdpZHRoIChub3Qgc28gaW1wb3J0YW50LCBpdCBpcyBqdXN0IHNvIHRoZSBob3Jpem9udGFsIHNjcm9sbGJhciBkb2Vzbid0IGdldCB0b28gc21hbGwpCiAgICAgIGlmICghdGhpcy5fdXBkYXRlTGluZVdpZHRoc0Zhc3QoKSkgewogICAgICAgIC8vIENvbXB1dGluZyB0aGUgd2lkdGggb2Ygc29tZSBsaW5lcyB3b3VsZCBiZSBzbG93ID0+IGRlbGF5IGl0CiAgICAgICAgdGhpcy5fYXN5bmNVcGRhdGVMaW5lV2lkdGhzLnNjaGVkdWxlKCk7CiAgICAgIH0KICAgICAgaWYgKHBsYXRmb3JtLmlzTGludXggJiYgIXRoaXMuX2FzeW5jQ2hlY2tNb25vc3BhY2VGb250QXNzdW1wdGlvbnMuaXNTY2hlZHVsZWQoKSkgewogICAgICAgIHZhciByZW5kU3RhcnRMaW5lTnVtYmVyID0gdGhpcy5fdmlzaWJsZUxpbmVzLmdldFN0YXJ0TGluZU51bWJlcigpOwogICAgICAgIHZhciByZW5kRW5kTGluZU51bWJlciA9IHRoaXMuX3Zpc2libGVMaW5lcy5nZXRFbmRMaW5lTnVtYmVyKCk7CiAgICAgICAgZm9yICh2YXIgbGluZU51bWJlciA9IHJlbmRTdGFydExpbmVOdW1iZXI7IGxpbmVOdW1iZXIgPD0gcmVuZEVuZExpbmVOdW1iZXI7IGxpbmVOdW1iZXIrKykgewogICAgICAgICAgdmFyIHZpc2libGVMaW5lID0gdGhpcy5fdmlzaWJsZUxpbmVzLmdldFZpc2libGVMaW5lKGxpbmVOdW1iZXIpOwogICAgICAgICAgaWYgKHZpc2libGVMaW5lLm5lZWRzTW9ub3NwYWNlRm9udENoZWNrKCkpIHsKICAgICAgICAgICAgdGhpcy5fYXN5bmNDaGVja01vbm9zcGFjZUZvbnRBc3N1bXB0aW9ucy5zY2hlZHVsZSgpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgLy8gKDMpIGhhbmRsZSBzY3JvbGxpbmcKICAgICAgdGhpcy5fbGluZXNDb250ZW50LnNldExheWVySGludGluZyh0aGlzLl9jYW5Vc2VMYXllckhpbnRpbmcpOwogICAgICB0aGlzLl9saW5lc0NvbnRlbnQuc2V0Q29udGFpbignc3RyaWN0Jyk7CiAgICAgIHZhciBhZGp1c3RlZFNjcm9sbFRvcCA9IHRoaXMuX2NvbnRleHQudmlld0xheW91dC5nZXRDdXJyZW50U2Nyb2xsVG9wKCkgLSB2aWV3cG9ydERhdGEuYmlnTnVtYmVyc0RlbHRhOwogICAgICB0aGlzLl9saW5lc0NvbnRlbnQuc2V0VG9wKC1hZGp1c3RlZFNjcm9sbFRvcCk7CiAgICAgIHRoaXMuX2xpbmVzQ29udGVudC5zZXRMZWZ0KC10aGlzLl9jb250ZXh0LnZpZXdMYXlvdXQuZ2V0Q3VycmVudFNjcm9sbExlZnQoKSk7CiAgICB9CiAgICAvLyAtLS0gd2lkdGgKICB9LCB7CiAgICBrZXk6ICJfZW5zdXJlTWF4TGluZVdpZHRoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZW5zdXJlTWF4TGluZVdpZHRoKGxpbmVXaWR0aCkgewogICAgICB2YXIgaUxpbmVXaWR0aCA9IE1hdGguY2VpbChsaW5lV2lkdGgpOwogICAgICBpZiAodGhpcy5fbWF4TGluZVdpZHRoIDwgaUxpbmVXaWR0aCkgewogICAgICAgIHRoaXMuX21heExpbmVXaWR0aCA9IGlMaW5lV2lkdGg7CiAgICAgICAgdGhpcy5fY29udGV4dC52aWV3TW9kZWwudmlld0xheW91dC5zZXRNYXhMaW5lV2lkdGgodGhpcy5fbWF4TGluZVdpZHRoKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogIl9jb21wdXRlU2Nyb2xsVG9wVG9SZXZlYWxSYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2NvbXB1dGVTY3JvbGxUb3BUb1JldmVhbFJhbmdlKHZpZXdwb3J0LCBzb3VyY2UsIG1pbmltYWxSZXZlYWwsIHJhbmdlLCBzZWxlY3Rpb25zLCB2ZXJ0aWNhbFR5cGUpIHsKICAgICAgdmFyIHZpZXdwb3J0U3RhcnRZID0gdmlld3BvcnQudG9wOwogICAgICB2YXIgdmlld3BvcnRIZWlnaHQgPSB2aWV3cG9ydC5oZWlnaHQ7CiAgICAgIHZhciB2aWV3cG9ydEVuZFkgPSB2aWV3cG9ydFN0YXJ0WSArIHZpZXdwb3J0SGVpZ2h0OwogICAgICB2YXIgYm94SXNTaW5nbGVSYW5nZTsKICAgICAgdmFyIGJveFN0YXJ0WTsKICAgICAgdmFyIGJveEVuZFk7CiAgICAgIGlmIChzZWxlY3Rpb25zICYmIHNlbGVjdGlvbnMubGVuZ3RoID4gMCkgewogICAgICAgIHZhciBtaW5MaW5lTnVtYmVyID0gc2VsZWN0aW9uc1swXS5zdGFydExpbmVOdW1iZXI7CiAgICAgICAgdmFyIG1heExpbmVOdW1iZXIgPSBzZWxlY3Rpb25zWzBdLmVuZExpbmVOdW1iZXI7CiAgICAgICAgZm9yICh2YXIgaSA9IDEsIGxlbiA9IHNlbGVjdGlvbnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICAgIHZhciBzZWxlY3Rpb24gPSBzZWxlY3Rpb25zW2ldOwogICAgICAgICAgbWluTGluZU51bWJlciA9IE1hdGgubWluKG1pbkxpbmVOdW1iZXIsIHNlbGVjdGlvbi5zdGFydExpbmVOdW1iZXIpOwogICAgICAgICAgbWF4TGluZU51bWJlciA9IE1hdGgubWF4KG1heExpbmVOdW1iZXIsIHNlbGVjdGlvbi5lbmRMaW5lTnVtYmVyKTsKICAgICAgICB9CiAgICAgICAgYm94SXNTaW5nbGVSYW5nZSA9IGZhbHNlOwogICAgICAgIGJveFN0YXJ0WSA9IHRoaXMuX2NvbnRleHQudmlld0xheW91dC5nZXRWZXJ0aWNhbE9mZnNldEZvckxpbmVOdW1iZXIobWluTGluZU51bWJlcik7CiAgICAgICAgYm94RW5kWSA9IHRoaXMuX2NvbnRleHQudmlld0xheW91dC5nZXRWZXJ0aWNhbE9mZnNldEZvckxpbmVOdW1iZXIobWF4TGluZU51bWJlcikgKyB0aGlzLl9saW5lSGVpZ2h0OwogICAgICB9IGVsc2UgaWYgKHJhbmdlKSB7CiAgICAgICAgYm94SXNTaW5nbGVSYW5nZSA9IHRydWU7CiAgICAgICAgYm94U3RhcnRZID0gdGhpcy5fY29udGV4dC52aWV3TGF5b3V0LmdldFZlcnRpY2FsT2Zmc2V0Rm9yTGluZU51bWJlcihyYW5nZS5zdGFydExpbmVOdW1iZXIpOwogICAgICAgIGJveEVuZFkgPSB0aGlzLl9jb250ZXh0LnZpZXdMYXlvdXQuZ2V0VmVydGljYWxPZmZzZXRGb3JMaW5lTnVtYmVyKHJhbmdlLmVuZExpbmVOdW1iZXIpICsgdGhpcy5fbGluZUhlaWdodDsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gLTE7CiAgICAgIH0KICAgICAgdmFyIHNob3VsZElnbm9yZVNjcm9sbE9mZiA9IChzb3VyY2UgPT09ICdtb3VzZScgfHwgbWluaW1hbFJldmVhbCkgJiYgdGhpcy5fY3Vyc29yU3Vycm91bmRpbmdMaW5lc1N0eWxlID09PSAnZGVmYXVsdCc7CiAgICAgIGlmICghc2hvdWxkSWdub3JlU2Nyb2xsT2ZmKSB7CiAgICAgICAgdmFyIGNvbnRleHQgPSBNYXRoLm1pbih2aWV3cG9ydEhlaWdodCAvIHRoaXMuX2xpbmVIZWlnaHQgLyAyLCB0aGlzLl9jdXJzb3JTdXJyb3VuZGluZ0xpbmVzKTsKICAgICAgICBib3hTdGFydFkgLT0gY29udGV4dCAqIHRoaXMuX2xpbmVIZWlnaHQ7CiAgICAgICAgYm94RW5kWSArPSBNYXRoLm1heCgwLCBjb250ZXh0IC0gMSkgKiB0aGlzLl9saW5lSGVpZ2h0OwogICAgICB9IGVsc2UgewogICAgICAgIGlmICghbWluaW1hbFJldmVhbCkgewogICAgICAgICAgLy8gUmV2ZWFsIG9uZSBtb3JlIGxpbmUgYWJvdmUgKHRoaXMgY2FzZSBpcyBoaXQgd2hlbiBkcmFnZ2luZykKICAgICAgICAgIGJveFN0YXJ0WSAtPSB0aGlzLl9saW5lSGVpZ2h0OwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAodmVydGljYWxUeXBlID09PSAwIC8qIHZpZXdFdmVudHMuVmVydGljYWxSZXZlYWxUeXBlLlNpbXBsZSAqLyB8fCB2ZXJ0aWNhbFR5cGUgPT09IDQgLyogdmlld0V2ZW50cy5WZXJ0aWNhbFJldmVhbFR5cGUuQm90dG9tICovKSB7CiAgICAgICAgLy8gUmV2ZWFsIG9uZSBsaW5lIG1vcmUgd2hlbiB0aGUgbGFzdCBsaW5lIHdvdWxkIGJlIGNvdmVyZWQgYnkgdGhlIHNjcm9sbGJhciAtIGFycm93IGRvd24gY2FzZSBvciByZXZlYWxpbmcgYSBsaW5lIGV4cGxpY2l0bHkgYXQgYm90dG9tCiAgICAgICAgYm94RW5kWSArPSBtaW5pbWFsUmV2ZWFsID8gdGhpcy5faG9yaXpvbnRhbFNjcm9sbGJhckhlaWdodCA6IHRoaXMuX2xpbmVIZWlnaHQ7CiAgICAgIH0KICAgICAgdmFyIG5ld1Njcm9sbFRvcDsKICAgICAgaWYgKGJveEVuZFkgLSBib3hTdGFydFkgPiB2aWV3cG9ydEhlaWdodCkgewogICAgICAgIC8vIHRoZSBib3ggaXMgbGFyZ2VyIHRoYW4gdGhlIHZpZXdwb3J0IC4uLiBzY3JvbGwgdG8gaXRzIHRvcAogICAgICAgIGlmICghYm94SXNTaW5nbGVSYW5nZSkgewogICAgICAgICAgLy8gZG8gbm90IHJldmVhbCBtdWx0aXBsZSBjdXJzb3JzIGlmIHRoZXJlIGFyZSBtb3JlIHRoYW4gZml0IHRoZSB2aWV3cG9ydAogICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIH0KICAgICAgICBuZXdTY3JvbGxUb3AgPSBib3hTdGFydFk7CiAgICAgIH0gZWxzZSBpZiAodmVydGljYWxUeXBlID09PSA1IC8qIHZpZXdFdmVudHMuVmVydGljYWxSZXZlYWxUeXBlLk5lYXJUb3AgKi8gfHwgdmVydGljYWxUeXBlID09PSA2IC8qIHZpZXdFdmVudHMuVmVydGljYWxSZXZlYWxUeXBlLk5lYXJUb3BJZk91dHNpZGVWaWV3cG9ydCAqLykgewogICAgICAgIGlmICh2ZXJ0aWNhbFR5cGUgPT09IDYgLyogdmlld0V2ZW50cy5WZXJ0aWNhbFJldmVhbFR5cGUuTmVhclRvcElmT3V0c2lkZVZpZXdwb3J0ICovICYmIHZpZXdwb3J0U3RhcnRZIDw9IGJveFN0YXJ0WSAmJiBib3hFbmRZIDw9IHZpZXdwb3J0RW5kWSkgewogICAgICAgICAgLy8gQm94IGlzIGFscmVhZHkgaW4gdGhlIHZpZXdwb3J0Li4uIGRvIG5vdGhpbmcKICAgICAgICAgIG5ld1Njcm9sbFRvcCA9IHZpZXdwb3J0U3RhcnRZOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBXZSB3YW50IGEgZ2FwIHRoYXQgaXMgMjAlIG9mIHRoZSB2aWV3cG9ydCwgYnV0IHdpdGggYSBtaW5pbXVtIG9mIDUgbGluZXMKICAgICAgICAgIHZhciBkZXNpcmVkR2FwQWJvdmUgPSBNYXRoLm1heCg1ICogdGhpcy5fbGluZUhlaWdodCwgdmlld3BvcnRIZWlnaHQgKiAwLjIpOwogICAgICAgICAgLy8gVHJ5IHRvIHNjcm9sbCBqdXN0IGFib3ZlIHRoZSBib3ggd2l0aCB0aGUgZGVzaXJlZCBnYXAKICAgICAgICAgIHZhciBkZXNpcmVkU2Nyb2xsVG9wID0gYm94U3RhcnRZIC0gZGVzaXJlZEdhcEFib3ZlOwogICAgICAgICAgLy8gQnV0IGVuc3VyZSB0aGF0IHRoZSBib3ggaXMgbm90IHB1c2hlZCBvdXQgb2Ygdmlld3BvcnQKICAgICAgICAgIHZhciBtaW5TY3JvbGxUb3AgPSBib3hFbmRZIC0gdmlld3BvcnRIZWlnaHQ7CiAgICAgICAgICBuZXdTY3JvbGxUb3AgPSBNYXRoLm1heChtaW5TY3JvbGxUb3AsIGRlc2lyZWRTY3JvbGxUb3ApOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh2ZXJ0aWNhbFR5cGUgPT09IDEgLyogdmlld0V2ZW50cy5WZXJ0aWNhbFJldmVhbFR5cGUuQ2VudGVyICovIHx8IHZlcnRpY2FsVHlwZSA9PT0gMiAvKiB2aWV3RXZlbnRzLlZlcnRpY2FsUmV2ZWFsVHlwZS5DZW50ZXJJZk91dHNpZGVWaWV3cG9ydCAqLykgewogICAgICAgIGlmICh2ZXJ0aWNhbFR5cGUgPT09IDIgLyogdmlld0V2ZW50cy5WZXJ0aWNhbFJldmVhbFR5cGUuQ2VudGVySWZPdXRzaWRlVmlld3BvcnQgKi8gJiYgdmlld3BvcnRTdGFydFkgPD0gYm94U3RhcnRZICYmIGJveEVuZFkgPD0gdmlld3BvcnRFbmRZKSB7CiAgICAgICAgICAvLyBCb3ggaXMgYWxyZWFkeSBpbiB0aGUgdmlld3BvcnQuLi4gZG8gbm90aGluZwogICAgICAgICAgbmV3U2Nyb2xsVG9wID0gdmlld3BvcnRTdGFydFk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIEJveCBpcyBvdXRzaWRlIHRoZSB2aWV3cG9ydC4uLiBjZW50ZXIgaXQKICAgICAgICAgIHZhciBib3hNaWRkbGVZID0gKGJveFN0YXJ0WSArIGJveEVuZFkpIC8gMjsKICAgICAgICAgIG5ld1Njcm9sbFRvcCA9IE1hdGgubWF4KDAsIGJveE1pZGRsZVkgLSB2aWV3cG9ydEhlaWdodCAvIDIpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBuZXdTY3JvbGxUb3AgPSB0aGlzLl9jb21wdXRlTWluaW11bVNjcm9sbGluZyh2aWV3cG9ydFN0YXJ0WSwgdmlld3BvcnRFbmRZLCBib3hTdGFydFksIGJveEVuZFksIHZlcnRpY2FsVHlwZSA9PT0gMyAvKiB2aWV3RXZlbnRzLlZlcnRpY2FsUmV2ZWFsVHlwZS5Ub3AgKi8sIHZlcnRpY2FsVHlwZSA9PT0gNCAvKiB2aWV3RXZlbnRzLlZlcnRpY2FsUmV2ZWFsVHlwZS5Cb3R0b20gKi8pOwogICAgICB9CgogICAgICByZXR1cm4gbmV3U2Nyb2xsVG9wOwogICAgfQogIH0sIHsKICAgIGtleTogIl9jb21wdXRlU2Nyb2xsTGVmdFRvUmV2ZWFsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfY29tcHV0ZVNjcm9sbExlZnRUb1JldmVhbChob3Jpem9udGFsUmV2ZWFsUmVxdWVzdCkgewogICAgICB2YXIgdmlld3BvcnQgPSB0aGlzLl9jb250ZXh0LnZpZXdMYXlvdXQuZ2V0Q3VycmVudFZpZXdwb3J0KCk7CiAgICAgIHZhciB2aWV3cG9ydFN0YXJ0WCA9IHZpZXdwb3J0LmxlZnQ7CiAgICAgIHZhciB2aWV3cG9ydEVuZFggPSB2aWV3cG9ydFN0YXJ0WCArIHZpZXdwb3J0LndpZHRoOwogICAgICB2YXIgYm94U3RhcnRYID0gMTA3Mzc0MTgyNCAvKiBDb25zdGFudHMuTUFYX1NBRkVfU01BTExfSU5URUdFUiAqLzsKICAgICAgdmFyIGJveEVuZFggPSAwOwogICAgICBpZiAoaG9yaXpvbnRhbFJldmVhbFJlcXVlc3QudHlwZSA9PT0gJ3JhbmdlJykgewogICAgICAgIHZhciB2aXNpYmxlUmFuZ2VzID0gdGhpcy5fdmlzaWJsZVJhbmdlc0ZvckxpbmVSYW5nZShob3Jpem9udGFsUmV2ZWFsUmVxdWVzdC5saW5lTnVtYmVyLCBob3Jpem9udGFsUmV2ZWFsUmVxdWVzdC5zdGFydENvbHVtbiwgaG9yaXpvbnRhbFJldmVhbFJlcXVlc3QuZW5kQ29sdW1uKTsKICAgICAgICBpZiAoIXZpc2libGVSYW5nZXMpIHsKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgICB2YXIgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodmlzaWJsZVJhbmdlcy5yYW5nZXMpLAogICAgICAgICAgX3N0ZXA7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgIHZhciB2aXNpYmxlUmFuZ2UgPSBfc3RlcC52YWx1ZTsKICAgICAgICAgICAgYm94U3RhcnRYID0gTWF0aC5taW4oYm94U3RhcnRYLCBNYXRoLnJvdW5kKHZpc2libGVSYW5nZS5sZWZ0KSk7CiAgICAgICAgICAgIGJveEVuZFggPSBNYXRoLm1heChib3hFbmRYLCBNYXRoLnJvdW5kKHZpc2libGVSYW5nZS5sZWZ0ICsgdmlzaWJsZVJhbmdlLndpZHRoKSk7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBfaXRlcmF0b3IuZShlcnIpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBfaXRlcmF0b3IuZigpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgX2l0ZXJhdG9yMiA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKGhvcml6b250YWxSZXZlYWxSZXF1ZXN0LnNlbGVjdGlvbnMpLAogICAgICAgICAgX3N0ZXAyOwogICAgICAgIHRyeSB7CiAgICAgICAgICBmb3IgKF9pdGVyYXRvcjIucygpOyAhKF9zdGVwMiA9IF9pdGVyYXRvcjIubigpKS5kb25lOykgewogICAgICAgICAgICB2YXIgc2VsZWN0aW9uID0gX3N0ZXAyLnZhbHVlOwogICAgICAgICAgICBpZiAoc2VsZWN0aW9uLnN0YXJ0TGluZU51bWJlciAhPT0gc2VsZWN0aW9uLmVuZExpbmVOdW1iZXIpIHsKICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgX3Zpc2libGVSYW5nZXMgPSB0aGlzLl92aXNpYmxlUmFuZ2VzRm9yTGluZVJhbmdlKHNlbGVjdGlvbi5zdGFydExpbmVOdW1iZXIsIHNlbGVjdGlvbi5zdGFydENvbHVtbiwgc2VsZWN0aW9uLmVuZENvbHVtbik7CiAgICAgICAgICAgIGlmICghX3Zpc2libGVSYW5nZXMpIHsKICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgX2l0ZXJhdG9yMyA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKF92aXNpYmxlUmFuZ2VzLnJhbmdlcyksCiAgICAgICAgICAgICAgX3N0ZXAzOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGZvciAoX2l0ZXJhdG9yMy5zKCk7ICEoX3N0ZXAzID0gX2l0ZXJhdG9yMy5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgICAgICB2YXIgX3Zpc2libGVSYW5nZSA9IF9zdGVwMy52YWx1ZTsKICAgICAgICAgICAgICAgIGJveFN0YXJ0WCA9IE1hdGgubWluKGJveFN0YXJ0WCwgTWF0aC5yb3VuZChfdmlzaWJsZVJhbmdlLmxlZnQpKTsKICAgICAgICAgICAgICAgIGJveEVuZFggPSBNYXRoLm1heChib3hFbmRYLCBNYXRoLnJvdW5kKF92aXNpYmxlUmFuZ2UubGVmdCArIF92aXNpYmxlUmFuZ2Uud2lkdGgpKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgIF9pdGVyYXRvcjMuZShlcnIpOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgIF9pdGVyYXRvcjMuZigpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBfaXRlcmF0b3IyLmUoZXJyKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgX2l0ZXJhdG9yMi5mKCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICghaG9yaXpvbnRhbFJldmVhbFJlcXVlc3QubWluaW1hbFJldmVhbCkgewogICAgICAgIGJveFN0YXJ0WCA9IE1hdGgubWF4KDAsIGJveFN0YXJ0WCAtIFZpZXdMaW5lcy5IT1JJWk9OVEFMX0VYVFJBX1BYKTsKICAgICAgICBib3hFbmRYICs9IHRoaXMuX3JldmVhbEhvcml6b250YWxSaWdodFBhZGRpbmc7CiAgICAgIH0KICAgICAgaWYgKGhvcml6b250YWxSZXZlYWxSZXF1ZXN0LnR5cGUgPT09ICdzZWxlY3Rpb25zJyAmJiBib3hFbmRYIC0gYm94U3RhcnRYID4gdmlld3BvcnQud2lkdGgpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgICB2YXIgbmV3U2Nyb2xsTGVmdCA9IHRoaXMuX2NvbXB1dGVNaW5pbXVtU2Nyb2xsaW5nKHZpZXdwb3J0U3RhcnRYLCB2aWV3cG9ydEVuZFgsIGJveFN0YXJ0WCwgYm94RW5kWCk7CiAgICAgIHJldHVybiB7CiAgICAgICAgc2Nyb2xsTGVmdDogbmV3U2Nyb2xsTGVmdCwKICAgICAgICBtYXhIb3Jpem9udGFsT2Zmc2V0OiBib3hFbmRYCiAgICAgIH07CiAgICB9CiAgfSwgewogICAga2V5OiAiX2NvbXB1dGVNaW5pbXVtU2Nyb2xsaW5nIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfY29tcHV0ZU1pbmltdW1TY3JvbGxpbmcodmlld3BvcnRTdGFydCwgdmlld3BvcnRFbmQsIGJveFN0YXJ0LCBib3hFbmQsIHJldmVhbEF0U3RhcnQsIHJldmVhbEF0RW5kKSB7CiAgICAgIHZpZXdwb3J0U3RhcnQgPSB2aWV3cG9ydFN0YXJ0IHwgMDsKICAgICAgdmlld3BvcnRFbmQgPSB2aWV3cG9ydEVuZCB8IDA7CiAgICAgIGJveFN0YXJ0ID0gYm94U3RhcnQgfCAwOwogICAgICBib3hFbmQgPSBib3hFbmQgfCAwOwogICAgICByZXZlYWxBdFN0YXJ0ID0gISFyZXZlYWxBdFN0YXJ0OwogICAgICByZXZlYWxBdEVuZCA9ICEhcmV2ZWFsQXRFbmQ7CiAgICAgIHZhciB2aWV3cG9ydExlbmd0aCA9IHZpZXdwb3J0RW5kIC0gdmlld3BvcnRTdGFydDsKICAgICAgdmFyIGJveExlbmd0aCA9IGJveEVuZCAtIGJveFN0YXJ0OwogICAgICBpZiAoYm94TGVuZ3RoIDwgdmlld3BvcnRMZW5ndGgpIHsKICAgICAgICAvLyBUaGUgYm94IHdvdWxkIGZpdCBpbiB0aGUgdmlld3BvcnQKICAgICAgICBpZiAocmV2ZWFsQXRTdGFydCkgewogICAgICAgICAgcmV0dXJuIGJveFN0YXJ0OwogICAgICAgIH0KICAgICAgICBpZiAocmV2ZWFsQXRFbmQpIHsKICAgICAgICAgIHJldHVybiBNYXRoLm1heCgwLCBib3hFbmQgLSB2aWV3cG9ydExlbmd0aCk7CiAgICAgICAgfQogICAgICAgIGlmIChib3hTdGFydCA8IHZpZXdwb3J0U3RhcnQpIHsKICAgICAgICAgIC8vIFRoZSBib3ggaXMgYWJvdmUgdGhlIHZpZXdwb3J0CiAgICAgICAgICByZXR1cm4gYm94U3RhcnQ7CiAgICAgICAgfSBlbHNlIGlmIChib3hFbmQgPiB2aWV3cG9ydEVuZCkgewogICAgICAgICAgLy8gVGhlIGJveCBpcyBiZWxvdyB0aGUgdmlld3BvcnQKICAgICAgICAgIHJldHVybiBNYXRoLm1heCgwLCBib3hFbmQgLSB2aWV3cG9ydExlbmd0aCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIFRoZSBib3ggd291bGQgbm90IGZpdCBpbiB0aGUgdmlld3BvcnQKICAgICAgICAvLyBSZXZlYWwgdGhlIGJlZ2lubmluZyBvZiB0aGUgYm94CiAgICAgICAgcmV0dXJuIGJveFN0YXJ0OwogICAgICB9CiAgICAgIHJldHVybiB2aWV3cG9ydFN0YXJ0OwogICAgfQogIH1dKTsKICByZXR1cm4gVmlld0xpbmVzOwp9KFZpZXdQYXJ0KTsKLyoqCiAqIEFkZHMgdGhpcyBhbW91bnQgb2YgcGl4ZWxzIHRvIHRoZSByaWdodCBvZiBsaW5lcyAobm8tb25lIHdhbnRzIHRvIHR5cGUgbmVhciB0aGUgZWRnZSBvZiB0aGUgdmlld3BvcnQpCiAqLwpWaWV3TGluZXMuSE9SSVpPTlRBTF9FWFRSQV9QWCA9IDMwOw=="},{"version":3,"names":["platform","RunOnceScheduler","applyFontInfo","VisibleLinesCollection","PartFingerprints","ViewPart","DomReadingContext","ViewLine","ViewLineOptions","Position","Range","LineVisibleRanges","HorizontalPosition","HorizontalRange","MOUSE_CURSOR_TEXT_CSS_CLASS_NAME","LastRenderedData","_currentVisibleRange","currentVisibleRange","HorizontalRevealRangeRequest","minimalReveal","lineNumber","startColumn","endColumn","startScrollTop","stopScrollTop","scrollType","type","minLineNumber","maxLineNumber","HorizontalRevealSelectionsRequest","selections","startLineNumber","endLineNumber","i","len","length","selection","Math","min","max","ViewLines","context","linesContent","_linesContent","_textRangeRestingSpot","document","createElement","_visibleLines","domNode","conf","_context","configuration","options","fontInfo","get","wrappingInfo","layoutInfo","_lineHeight","_typicalHalfwidthCharacterWidth","typicalHalfwidthCharacterWidth","_isViewportWrapping","isViewportWrapping","_revealHorizontalRightPadding","_horizontalScrollbarHeight","horizontalScrollbarHeight","_cursorSurroundingLines","_cursorSurroundingLinesStyle","_canUseLayerHinting","_viewLineOptions","theme","write","setClassName","_maxLineWidth","_asyncUpdateLineWidths","_updateLineWidthsSlow","_asyncCheckMonospaceFontAssumptions","_checkMonospaceFontAssumptions","_lastRenderedData","_horizontalRevealRequest","dispose","e","onConfigurationChanged","hasChanged","_onOptionsMaybeChanged","newViewLineOptions","equals","getStartLineNumber","getEndLineNumber","line","getVisibleLine","onOptionsChanged","rendStartLineNumber","rendEndLineNumber","r","onSelectionChanged","onDecorationsChanged","shouldRender","onFlushed","onLinesChanged","onLinesDeleted","onLinesInserted","desiredScrollTop","_computeScrollTopToRevealRange","viewLayout","getFutureViewport","source","range","verticalType","newScrollPosition","validateScrollPosition","scrollTop","revealHorizontal","scrollLeft","getCurrentScrollTop","scrollTopDelta","abs","viewModel","setScrollPosition","scrollLeftChanged","scrollTopChanged","setWidth","scrollWidth","onScrollChanged","onTokensChanged","setMaxLineWidth","onZonesChanged","spanNode","offset","viewLineDomNode","_getViewLineDomNode","_getLineNumberFor","getLineCount","getLineMaxColumn","column","getColumnOfNodeOffset","minColumn","getLineMinColumn","node","nodeType","className","CLASS_NAME","parentElement","getDomNode","getWidth","_range","includeNewLines","originalEndLineNumber","intersectRanges","getCurrentVisibleRange","visibleRanges","visibleRangesLen","domReadingContext","nextLineModelLineNumber","coordinatesConverter","convertViewPositionToModelPosition","visibleRangesForLine","getVisibleRangesForRange","currentLineModelLineNumber","ranges","width","outsideRenderedLine","from","position","_visibleRangesForLineRange","left","_updateLineWidths","fast","localMaxLineWidth","allWidthsComputed","visibleLine","getWidthIsFast","_ensureMaxLineWidth","longestLineNumber","longestWidth","needsMonospaceFontCheck","lineWidth","monospaceAssumptionsAreValid","onMonospaceAssumptionsInvalidated","Error","viewportData","renderLines","setCurrentVisibleRange","visibleRange","getScrollWidth","setHeight","getScrollHeight","horizontalRevealRequest","onDidRender","newScrollLeft","_computeScrollLeftToReveal","maxHorizontalOffset","_updateLineWidthsFast","schedule","isLinux","isScheduled","setLayerHinting","setContain","adjustedScrollTop","bigNumbersDelta","setTop","setLeft","getCurrentScrollLeft","iLineWidth","ceil","viewport","viewportStartY","top","viewportHeight","height","viewportEndY","boxIsSingleRange","boxStartY","boxEndY","getVerticalOffsetForLineNumber","shouldIgnoreScrollOff","newScrollTop","desiredGapAbove","minScrollTop","boxMiddleY","_computeMinimumScrolling","getCurrentViewport","viewportStartX","viewportEndX","boxStartX","boxEndX","round","HORIZONTAL_EXTRA_PX","viewportStart","viewportEnd","boxStart","boxEnd","revealAtStart","revealAtEnd","viewportLength","boxLength"],"sources":["/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lines/viewLines.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './viewLines.css';\nimport * as platform from '../../../../base/common/platform.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { applyFontInfo } from '../../config/domFontInfo.js';\nimport { VisibleLinesCollection } from '../../view/viewLayer.js';\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\nimport { DomReadingContext, ViewLine, ViewLineOptions } from './viewLine.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { LineVisibleRanges, HorizontalPosition, HorizontalRange } from '../../view/renderingContext.js';\nimport { MOUSE_CURSOR_TEXT_CSS_CLASS_NAME } from '../../../../base/browser/ui/mouseCursor/mouseCursor.js';\nclass LastRenderedData {\n    constructor() {\n        this._currentVisibleRange = new Range(1, 1, 1, 1);\n    }\n    getCurrentVisibleRange() {\n        return this._currentVisibleRange;\n    }\n    setCurrentVisibleRange(currentVisibleRange) {\n        this._currentVisibleRange = currentVisibleRange;\n    }\n}\nclass HorizontalRevealRangeRequest {\n    constructor(minimalReveal, lineNumber, startColumn, endColumn, startScrollTop, stopScrollTop, scrollType) {\n        this.minimalReveal = minimalReveal;\n        this.lineNumber = lineNumber;\n        this.startColumn = startColumn;\n        this.endColumn = endColumn;\n        this.startScrollTop = startScrollTop;\n        this.stopScrollTop = stopScrollTop;\n        this.scrollType = scrollType;\n        this.type = 'range';\n        this.minLineNumber = lineNumber;\n        this.maxLineNumber = lineNumber;\n    }\n}\nclass HorizontalRevealSelectionsRequest {\n    constructor(minimalReveal, selections, startScrollTop, stopScrollTop, scrollType) {\n        this.minimalReveal = minimalReveal;\n        this.selections = selections;\n        this.startScrollTop = startScrollTop;\n        this.stopScrollTop = stopScrollTop;\n        this.scrollType = scrollType;\n        this.type = 'selections';\n        let minLineNumber = selections[0].startLineNumber;\n        let maxLineNumber = selections[0].endLineNumber;\n        for (let i = 1, len = selections.length; i < len; i++) {\n            const selection = selections[i];\n            minLineNumber = Math.min(minLineNumber, selection.startLineNumber);\n            maxLineNumber = Math.max(maxLineNumber, selection.endLineNumber);\n        }\n        this.minLineNumber = minLineNumber;\n        this.maxLineNumber = maxLineNumber;\n    }\n}\nexport class ViewLines extends ViewPart {\n    constructor(context, linesContent) {\n        super(context);\n        this._linesContent = linesContent;\n        this._textRangeRestingSpot = document.createElement('div');\n        this._visibleLines = new VisibleLinesCollection(this);\n        this.domNode = this._visibleLines.domNode;\n        const conf = this._context.configuration;\n        const options = this._context.configuration.options;\n        const fontInfo = options.get(46 /* EditorOption.fontInfo */);\n        const wrappingInfo = options.get(134 /* EditorOption.wrappingInfo */);\n        const layoutInfo = options.get(133 /* EditorOption.layoutInfo */);\n        this._lineHeight = options.get(61 /* EditorOption.lineHeight */);\n        this._typicalHalfwidthCharacterWidth = fontInfo.typicalHalfwidthCharacterWidth;\n        this._isViewportWrapping = wrappingInfo.isViewportWrapping;\n        this._revealHorizontalRightPadding = options.get(91 /* EditorOption.revealHorizontalRightPadding */);\n        this._horizontalScrollbarHeight = layoutInfo.horizontalScrollbarHeight;\n        this._cursorSurroundingLines = options.get(25 /* EditorOption.cursorSurroundingLines */);\n        this._cursorSurroundingLinesStyle = options.get(26 /* EditorOption.cursorSurroundingLinesStyle */);\n        this._canUseLayerHinting = !options.get(28 /* EditorOption.disableLayerHinting */);\n        this._viewLineOptions = new ViewLineOptions(conf, this._context.theme.type);\n        PartFingerprints.write(this.domNode, 7 /* PartFingerprint.ViewLines */);\n        this.domNode.setClassName(`view-lines ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`);\n        applyFontInfo(this.domNode, fontInfo);\n        // --- width & height\n        this._maxLineWidth = 0;\n        this._asyncUpdateLineWidths = new RunOnceScheduler(() => {\n            this._updateLineWidthsSlow();\n        }, 200);\n        this._asyncCheckMonospaceFontAssumptions = new RunOnceScheduler(() => {\n            this._checkMonospaceFontAssumptions();\n        }, 2000);\n        this._lastRenderedData = new LastRenderedData();\n        this._horizontalRevealRequest = null;\n    }\n    dispose() {\n        this._asyncUpdateLineWidths.dispose();\n        this._asyncCheckMonospaceFontAssumptions.dispose();\n        super.dispose();\n    }\n    getDomNode() {\n        return this.domNode;\n    }\n    // ---- begin IVisibleLinesHost\n    createVisibleLine() {\n        return new ViewLine(this._viewLineOptions);\n    }\n    // ---- end IVisibleLinesHost\n    // ---- begin view event handlers\n    onConfigurationChanged(e) {\n        this._visibleLines.onConfigurationChanged(e);\n        if (e.hasChanged(134 /* EditorOption.wrappingInfo */)) {\n            this._maxLineWidth = 0;\n        }\n        const options = this._context.configuration.options;\n        const fontInfo = options.get(46 /* EditorOption.fontInfo */);\n        const wrappingInfo = options.get(134 /* EditorOption.wrappingInfo */);\n        const layoutInfo = options.get(133 /* EditorOption.layoutInfo */);\n        this._lineHeight = options.get(61 /* EditorOption.lineHeight */);\n        this._typicalHalfwidthCharacterWidth = fontInfo.typicalHalfwidthCharacterWidth;\n        this._isViewportWrapping = wrappingInfo.isViewportWrapping;\n        this._revealHorizontalRightPadding = options.get(91 /* EditorOption.revealHorizontalRightPadding */);\n        this._horizontalScrollbarHeight = layoutInfo.horizontalScrollbarHeight;\n        this._cursorSurroundingLines = options.get(25 /* EditorOption.cursorSurroundingLines */);\n        this._cursorSurroundingLinesStyle = options.get(26 /* EditorOption.cursorSurroundingLinesStyle */);\n        this._canUseLayerHinting = !options.get(28 /* EditorOption.disableLayerHinting */);\n        applyFontInfo(this.domNode, fontInfo);\n        this._onOptionsMaybeChanged();\n        if (e.hasChanged(133 /* EditorOption.layoutInfo */)) {\n            this._maxLineWidth = 0;\n        }\n        return true;\n    }\n    _onOptionsMaybeChanged() {\n        const conf = this._context.configuration;\n        const newViewLineOptions = new ViewLineOptions(conf, this._context.theme.type);\n        if (!this._viewLineOptions.equals(newViewLineOptions)) {\n            this._viewLineOptions = newViewLineOptions;\n            const startLineNumber = this._visibleLines.getStartLineNumber();\n            const endLineNumber = this._visibleLines.getEndLineNumber();\n            for (let lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\n                const line = this._visibleLines.getVisibleLine(lineNumber);\n                line.onOptionsChanged(this._viewLineOptions);\n            }\n            return true;\n        }\n        return false;\n    }\n    onCursorStateChanged(e) {\n        const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n        const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n        let r = false;\n        for (let lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\n            r = this._visibleLines.getVisibleLine(lineNumber).onSelectionChanged() || r;\n        }\n        return r;\n    }\n    onDecorationsChanged(e) {\n        if (true /*e.inlineDecorationsChanged*/) {\n            const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n            const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n            for (let lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\n                this._visibleLines.getVisibleLine(lineNumber).onDecorationsChanged();\n            }\n        }\n        return true;\n    }\n    onFlushed(e) {\n        const shouldRender = this._visibleLines.onFlushed(e);\n        this._maxLineWidth = 0;\n        return shouldRender;\n    }\n    onLinesChanged(e) {\n        return this._visibleLines.onLinesChanged(e);\n    }\n    onLinesDeleted(e) {\n        return this._visibleLines.onLinesDeleted(e);\n    }\n    onLinesInserted(e) {\n        return this._visibleLines.onLinesInserted(e);\n    }\n    onRevealRangeRequest(e) {\n        // Using the future viewport here in order to handle multiple\n        // incoming reveal range requests that might all desire to be animated\n        const desiredScrollTop = this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(), e.source, e.minimalReveal, e.range, e.selections, e.verticalType);\n        if (desiredScrollTop === -1) {\n            // marker to abort the reveal range request\n            return false;\n        }\n        // validate the new desired scroll top\n        let newScrollPosition = this._context.viewLayout.validateScrollPosition({ scrollTop: desiredScrollTop });\n        if (e.revealHorizontal) {\n            if (e.range && e.range.startLineNumber !== e.range.endLineNumber) {\n                // Two or more lines? => scroll to base (That's how you see most of the two lines)\n                newScrollPosition = {\n                    scrollTop: newScrollPosition.scrollTop,\n                    scrollLeft: 0\n                };\n            }\n            else if (e.range) {\n                // We don't necessarily know the horizontal offset of this range since the line might not be in the view...\n                this._horizontalRevealRequest = new HorizontalRevealRangeRequest(e.minimalReveal, e.range.startLineNumber, e.range.startColumn, e.range.endColumn, this._context.viewLayout.getCurrentScrollTop(), newScrollPosition.scrollTop, e.scrollType);\n            }\n            else if (e.selections && e.selections.length > 0) {\n                this._horizontalRevealRequest = new HorizontalRevealSelectionsRequest(e.minimalReveal, e.selections, this._context.viewLayout.getCurrentScrollTop(), newScrollPosition.scrollTop, e.scrollType);\n            }\n        }\n        else {\n            this._horizontalRevealRequest = null;\n        }\n        const scrollTopDelta = Math.abs(this._context.viewLayout.getCurrentScrollTop() - newScrollPosition.scrollTop);\n        const scrollType = (scrollTopDelta <= this._lineHeight ? 1 /* ScrollType.Immediate */ : e.scrollType);\n        this._context.viewModel.viewLayout.setScrollPosition(newScrollPosition, scrollType);\n        return true;\n    }\n    onScrollChanged(e) {\n        if (this._horizontalRevealRequest && e.scrollLeftChanged) {\n            // cancel any outstanding horizontal reveal request if someone else scrolls horizontally.\n            this._horizontalRevealRequest = null;\n        }\n        if (this._horizontalRevealRequest && e.scrollTopChanged) {\n            const min = Math.min(this._horizontalRevealRequest.startScrollTop, this._horizontalRevealRequest.stopScrollTop);\n            const max = Math.max(this._horizontalRevealRequest.startScrollTop, this._horizontalRevealRequest.stopScrollTop);\n            if (e.scrollTop < min || e.scrollTop > max) {\n                // cancel any outstanding horizontal reveal request if someone else scrolls vertically.\n                this._horizontalRevealRequest = null;\n            }\n        }\n        this.domNode.setWidth(e.scrollWidth);\n        return this._visibleLines.onScrollChanged(e) || true;\n    }\n    onTokensChanged(e) {\n        return this._visibleLines.onTokensChanged(e);\n    }\n    onZonesChanged(e) {\n        this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth);\n        return this._visibleLines.onZonesChanged(e);\n    }\n    onThemeChanged(e) {\n        return this._onOptionsMaybeChanged();\n    }\n    // ---- end view event handlers\n    // ----------- HELPERS FOR OTHERS\n    getPositionFromDOMInfo(spanNode, offset) {\n        const viewLineDomNode = this._getViewLineDomNode(spanNode);\n        if (viewLineDomNode === null) {\n            // Couldn't find view line node\n            return null;\n        }\n        const lineNumber = this._getLineNumberFor(viewLineDomNode);\n        if (lineNumber === -1) {\n            // Couldn't find view line node\n            return null;\n        }\n        if (lineNumber < 1 || lineNumber > this._context.viewModel.getLineCount()) {\n            // lineNumber is outside range\n            return null;\n        }\n        if (this._context.viewModel.getLineMaxColumn(lineNumber) === 1) {\n            // Line is empty\n            return new Position(lineNumber, 1);\n        }\n        const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n        const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n        if (lineNumber < rendStartLineNumber || lineNumber > rendEndLineNumber) {\n            // Couldn't find line\n            return null;\n        }\n        let column = this._visibleLines.getVisibleLine(lineNumber).getColumnOfNodeOffset(lineNumber, spanNode, offset);\n        const minColumn = this._context.viewModel.getLineMinColumn(lineNumber);\n        if (column < minColumn) {\n            column = minColumn;\n        }\n        return new Position(lineNumber, column);\n    }\n    _getViewLineDomNode(node) {\n        while (node && node.nodeType === 1) {\n            if (node.className === ViewLine.CLASS_NAME) {\n                return node;\n            }\n            node = node.parentElement;\n        }\n        return null;\n    }\n    /**\n     * @returns the line number of this view line dom node.\n     */\n    _getLineNumberFor(domNode) {\n        const startLineNumber = this._visibleLines.getStartLineNumber();\n        const endLineNumber = this._visibleLines.getEndLineNumber();\n        for (let lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\n            const line = this._visibleLines.getVisibleLine(lineNumber);\n            if (domNode === line.getDomNode()) {\n                return lineNumber;\n            }\n        }\n        return -1;\n    }\n    getLineWidth(lineNumber) {\n        const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n        const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n        if (lineNumber < rendStartLineNumber || lineNumber > rendEndLineNumber) {\n            // Couldn't find line\n            return -1;\n        }\n        return this._visibleLines.getVisibleLine(lineNumber).getWidth();\n    }\n    linesVisibleRangesForRange(_range, includeNewLines) {\n        if (this.shouldRender()) {\n            // Cannot read from the DOM because it is dirty\n            // i.e. the model & the dom are out of sync, so I'd be reading something stale\n            return null;\n        }\n        const originalEndLineNumber = _range.endLineNumber;\n        const range = Range.intersectRanges(_range, this._lastRenderedData.getCurrentVisibleRange());\n        if (!range) {\n            return null;\n        }\n        const visibleRanges = [];\n        let visibleRangesLen = 0;\n        const domReadingContext = new DomReadingContext(this.domNode.domNode, this._textRangeRestingSpot);\n        let nextLineModelLineNumber = 0;\n        if (includeNewLines) {\n            nextLineModelLineNumber = this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position(range.startLineNumber, 1)).lineNumber;\n        }\n        const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n        const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n        for (let lineNumber = range.startLineNumber; lineNumber <= range.endLineNumber; lineNumber++) {\n            if (lineNumber < rendStartLineNumber || lineNumber > rendEndLineNumber) {\n                continue;\n            }\n            const startColumn = lineNumber === range.startLineNumber ? range.startColumn : 1;\n            const endColumn = lineNumber === range.endLineNumber ? range.endColumn : this._context.viewModel.getLineMaxColumn(lineNumber);\n            const visibleRangesForLine = this._visibleLines.getVisibleLine(lineNumber).getVisibleRangesForRange(lineNumber, startColumn, endColumn, domReadingContext);\n            if (!visibleRangesForLine) {\n                continue;\n            }\n            if (includeNewLines && lineNumber < originalEndLineNumber) {\n                const currentLineModelLineNumber = nextLineModelLineNumber;\n                nextLineModelLineNumber = this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position(lineNumber + 1, 1)).lineNumber;\n                if (currentLineModelLineNumber !== nextLineModelLineNumber) {\n                    visibleRangesForLine.ranges[visibleRangesForLine.ranges.length - 1].width += this._typicalHalfwidthCharacterWidth;\n                }\n            }\n            visibleRanges[visibleRangesLen++] = new LineVisibleRanges(visibleRangesForLine.outsideRenderedLine, lineNumber, HorizontalRange.from(visibleRangesForLine.ranges));\n        }\n        if (visibleRangesLen === 0) {\n            return null;\n        }\n        return visibleRanges;\n    }\n    _visibleRangesForLineRange(lineNumber, startColumn, endColumn) {\n        if (this.shouldRender()) {\n            // Cannot read from the DOM because it is dirty\n            // i.e. the model & the dom are out of sync, so I'd be reading something stale\n            return null;\n        }\n        if (lineNumber < this._visibleLines.getStartLineNumber() || lineNumber > this._visibleLines.getEndLineNumber()) {\n            return null;\n        }\n        return this._visibleLines.getVisibleLine(lineNumber).getVisibleRangesForRange(lineNumber, startColumn, endColumn, new DomReadingContext(this.domNode.domNode, this._textRangeRestingSpot));\n    }\n    visibleRangeForPosition(position) {\n        const visibleRanges = this._visibleRangesForLineRange(position.lineNumber, position.column, position.column);\n        if (!visibleRanges) {\n            return null;\n        }\n        return new HorizontalPosition(visibleRanges.outsideRenderedLine, visibleRanges.ranges[0].left);\n    }\n    // --- implementation\n    updateLineWidths() {\n        this._updateLineWidths(false);\n    }\n    /**\n     * Updates the max line width if it is fast to compute.\n     * Returns true if all lines were taken into account.\n     * Returns false if some lines need to be reevaluated (in a slow fashion).\n     */\n    _updateLineWidthsFast() {\n        return this._updateLineWidths(true);\n    }\n    _updateLineWidthsSlow() {\n        this._updateLineWidths(false);\n    }\n    _updateLineWidths(fast) {\n        const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n        const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n        let localMaxLineWidth = 1;\n        let allWidthsComputed = true;\n        for (let lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\n            const visibleLine = this._visibleLines.getVisibleLine(lineNumber);\n            if (fast && !visibleLine.getWidthIsFast()) {\n                // Cannot compute width in a fast way for this line\n                allWidthsComputed = false;\n                continue;\n            }\n            localMaxLineWidth = Math.max(localMaxLineWidth, visibleLine.getWidth());\n        }\n        if (allWidthsComputed && rendStartLineNumber === 1 && rendEndLineNumber === this._context.viewModel.getLineCount()) {\n            // we know the max line width for all the lines\n            this._maxLineWidth = 0;\n        }\n        this._ensureMaxLineWidth(localMaxLineWidth);\n        return allWidthsComputed;\n    }\n    _checkMonospaceFontAssumptions() {\n        // Problems with monospace assumptions are more apparent for longer lines,\n        // as small rounding errors start to sum up, so we will select the longest\n        // line for a closer inspection\n        let longestLineNumber = -1;\n        let longestWidth = -1;\n        const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n        const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n        for (let lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\n            const visibleLine = this._visibleLines.getVisibleLine(lineNumber);\n            if (visibleLine.needsMonospaceFontCheck()) {\n                const lineWidth = visibleLine.getWidth();\n                if (lineWidth > longestWidth) {\n                    longestWidth = lineWidth;\n                    longestLineNumber = lineNumber;\n                }\n            }\n        }\n        if (longestLineNumber === -1) {\n            return;\n        }\n        if (!this._visibleLines.getVisibleLine(longestLineNumber).monospaceAssumptionsAreValid()) {\n            for (let lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\n                const visibleLine = this._visibleLines.getVisibleLine(lineNumber);\n                visibleLine.onMonospaceAssumptionsInvalidated();\n            }\n        }\n    }\n    prepareRender() {\n        throw new Error('Not supported');\n    }\n    render() {\n        throw new Error('Not supported');\n    }\n    renderText(viewportData) {\n        // (1) render lines - ensures lines are in the DOM\n        this._visibleLines.renderLines(viewportData);\n        this._lastRenderedData.setCurrentVisibleRange(viewportData.visibleRange);\n        this.domNode.setWidth(this._context.viewLayout.getScrollWidth());\n        this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(), 1000000));\n        // (2) compute horizontal scroll position:\n        //  - this must happen after the lines are in the DOM since it might need a line that rendered just now\n        //  - it might change `scrollWidth` and `scrollLeft`\n        if (this._horizontalRevealRequest) {\n            const horizontalRevealRequest = this._horizontalRevealRequest;\n            // Check that we have the line that contains the horizontal range in the viewport\n            if (viewportData.startLineNumber <= horizontalRevealRequest.minLineNumber && horizontalRevealRequest.maxLineNumber <= viewportData.endLineNumber) {\n                this._horizontalRevealRequest = null;\n                // allow `visibleRangesForRange2` to work\n                this.onDidRender();\n                // compute new scroll position\n                const newScrollLeft = this._computeScrollLeftToReveal(horizontalRevealRequest);\n                if (newScrollLeft) {\n                    if (!this._isViewportWrapping) {\n                        // ensure `scrollWidth` is large enough\n                        this._ensureMaxLineWidth(newScrollLeft.maxHorizontalOffset);\n                    }\n                    // set `scrollLeft`\n                    this._context.viewModel.viewLayout.setScrollPosition({\n                        scrollLeft: newScrollLeft.scrollLeft\n                    }, horizontalRevealRequest.scrollType);\n                }\n            }\n        }\n        // Update max line width (not so important, it is just so the horizontal scrollbar doesn't get too small)\n        if (!this._updateLineWidthsFast()) {\n            // Computing the width of some lines would be slow => delay it\n            this._asyncUpdateLineWidths.schedule();\n        }\n        if (platform.isLinux && !this._asyncCheckMonospaceFontAssumptions.isScheduled()) {\n            const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n            const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n            for (let lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\n                const visibleLine = this._visibleLines.getVisibleLine(lineNumber);\n                if (visibleLine.needsMonospaceFontCheck()) {\n                    this._asyncCheckMonospaceFontAssumptions.schedule();\n                    break;\n                }\n            }\n        }\n        // (3) handle scrolling\n        this._linesContent.setLayerHinting(this._canUseLayerHinting);\n        this._linesContent.setContain('strict');\n        const adjustedScrollTop = this._context.viewLayout.getCurrentScrollTop() - viewportData.bigNumbersDelta;\n        this._linesContent.setTop(-adjustedScrollTop);\n        this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft());\n    }\n    // --- width\n    _ensureMaxLineWidth(lineWidth) {\n        const iLineWidth = Math.ceil(lineWidth);\n        if (this._maxLineWidth < iLineWidth) {\n            this._maxLineWidth = iLineWidth;\n            this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth);\n        }\n    }\n    _computeScrollTopToRevealRange(viewport, source, minimalReveal, range, selections, verticalType) {\n        const viewportStartY = viewport.top;\n        const viewportHeight = viewport.height;\n        const viewportEndY = viewportStartY + viewportHeight;\n        let boxIsSingleRange;\n        let boxStartY;\n        let boxEndY;\n        if (selections && selections.length > 0) {\n            let minLineNumber = selections[0].startLineNumber;\n            let maxLineNumber = selections[0].endLineNumber;\n            for (let i = 1, len = selections.length; i < len; i++) {\n                const selection = selections[i];\n                minLineNumber = Math.min(minLineNumber, selection.startLineNumber);\n                maxLineNumber = Math.max(maxLineNumber, selection.endLineNumber);\n            }\n            boxIsSingleRange = false;\n            boxStartY = this._context.viewLayout.getVerticalOffsetForLineNumber(minLineNumber);\n            boxEndY = this._context.viewLayout.getVerticalOffsetForLineNumber(maxLineNumber) + this._lineHeight;\n        }\n        else if (range) {\n            boxIsSingleRange = true;\n            boxStartY = this._context.viewLayout.getVerticalOffsetForLineNumber(range.startLineNumber);\n            boxEndY = this._context.viewLayout.getVerticalOffsetForLineNumber(range.endLineNumber) + this._lineHeight;\n        }\n        else {\n            return -1;\n        }\n        const shouldIgnoreScrollOff = (source === 'mouse' || minimalReveal) && this._cursorSurroundingLinesStyle === 'default';\n        if (!shouldIgnoreScrollOff) {\n            const context = Math.min((viewportHeight / this._lineHeight) / 2, this._cursorSurroundingLines);\n            boxStartY -= context * this._lineHeight;\n            boxEndY += Math.max(0, (context - 1)) * this._lineHeight;\n        }\n        else {\n            if (!minimalReveal) {\n                // Reveal one more line above (this case is hit when dragging)\n                boxStartY -= this._lineHeight;\n            }\n        }\n        if (verticalType === 0 /* viewEvents.VerticalRevealType.Simple */ || verticalType === 4 /* viewEvents.VerticalRevealType.Bottom */) {\n            // Reveal one line more when the last line would be covered by the scrollbar - arrow down case or revealing a line explicitly at bottom\n            boxEndY += (minimalReveal ? this._horizontalScrollbarHeight : this._lineHeight);\n        }\n        let newScrollTop;\n        if (boxEndY - boxStartY > viewportHeight) {\n            // the box is larger than the viewport ... scroll to its top\n            if (!boxIsSingleRange) {\n                // do not reveal multiple cursors if there are more than fit the viewport\n                return -1;\n            }\n            newScrollTop = boxStartY;\n        }\n        else if (verticalType === 5 /* viewEvents.VerticalRevealType.NearTop */ || verticalType === 6 /* viewEvents.VerticalRevealType.NearTopIfOutsideViewport */) {\n            if (verticalType === 6 /* viewEvents.VerticalRevealType.NearTopIfOutsideViewport */ && viewportStartY <= boxStartY && boxEndY <= viewportEndY) {\n                // Box is already in the viewport... do nothing\n                newScrollTop = viewportStartY;\n            }\n            else {\n                // We want a gap that is 20% of the viewport, but with a minimum of 5 lines\n                const desiredGapAbove = Math.max(5 * this._lineHeight, viewportHeight * 0.2);\n                // Try to scroll just above the box with the desired gap\n                const desiredScrollTop = boxStartY - desiredGapAbove;\n                // But ensure that the box is not pushed out of viewport\n                const minScrollTop = boxEndY - viewportHeight;\n                newScrollTop = Math.max(minScrollTop, desiredScrollTop);\n            }\n        }\n        else if (verticalType === 1 /* viewEvents.VerticalRevealType.Center */ || verticalType === 2 /* viewEvents.VerticalRevealType.CenterIfOutsideViewport */) {\n            if (verticalType === 2 /* viewEvents.VerticalRevealType.CenterIfOutsideViewport */ && viewportStartY <= boxStartY && boxEndY <= viewportEndY) {\n                // Box is already in the viewport... do nothing\n                newScrollTop = viewportStartY;\n            }\n            else {\n                // Box is outside the viewport... center it\n                const boxMiddleY = (boxStartY + boxEndY) / 2;\n                newScrollTop = Math.max(0, boxMiddleY - viewportHeight / 2);\n            }\n        }\n        else {\n            newScrollTop = this._computeMinimumScrolling(viewportStartY, viewportEndY, boxStartY, boxEndY, verticalType === 3 /* viewEvents.VerticalRevealType.Top */, verticalType === 4 /* viewEvents.VerticalRevealType.Bottom */);\n        }\n        return newScrollTop;\n    }\n    _computeScrollLeftToReveal(horizontalRevealRequest) {\n        const viewport = this._context.viewLayout.getCurrentViewport();\n        const viewportStartX = viewport.left;\n        const viewportEndX = viewportStartX + viewport.width;\n        let boxStartX = 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */;\n        let boxEndX = 0;\n        if (horizontalRevealRequest.type === 'range') {\n            const visibleRanges = this._visibleRangesForLineRange(horizontalRevealRequest.lineNumber, horizontalRevealRequest.startColumn, horizontalRevealRequest.endColumn);\n            if (!visibleRanges) {\n                return null;\n            }\n            for (const visibleRange of visibleRanges.ranges) {\n                boxStartX = Math.min(boxStartX, Math.round(visibleRange.left));\n                boxEndX = Math.max(boxEndX, Math.round(visibleRange.left + visibleRange.width));\n            }\n        }\n        else {\n            for (const selection of horizontalRevealRequest.selections) {\n                if (selection.startLineNumber !== selection.endLineNumber) {\n                    return null;\n                }\n                const visibleRanges = this._visibleRangesForLineRange(selection.startLineNumber, selection.startColumn, selection.endColumn);\n                if (!visibleRanges) {\n                    return null;\n                }\n                for (const visibleRange of visibleRanges.ranges) {\n                    boxStartX = Math.min(boxStartX, Math.round(visibleRange.left));\n                    boxEndX = Math.max(boxEndX, Math.round(visibleRange.left + visibleRange.width));\n                }\n            }\n        }\n        if (!horizontalRevealRequest.minimalReveal) {\n            boxStartX = Math.max(0, boxStartX - ViewLines.HORIZONTAL_EXTRA_PX);\n            boxEndX += this._revealHorizontalRightPadding;\n        }\n        if (horizontalRevealRequest.type === 'selections' && boxEndX - boxStartX > viewport.width) {\n            return null;\n        }\n        const newScrollLeft = this._computeMinimumScrolling(viewportStartX, viewportEndX, boxStartX, boxEndX);\n        return {\n            scrollLeft: newScrollLeft,\n            maxHorizontalOffset: boxEndX\n        };\n    }\n    _computeMinimumScrolling(viewportStart, viewportEnd, boxStart, boxEnd, revealAtStart, revealAtEnd) {\n        viewportStart = viewportStart | 0;\n        viewportEnd = viewportEnd | 0;\n        boxStart = boxStart | 0;\n        boxEnd = boxEnd | 0;\n        revealAtStart = !!revealAtStart;\n        revealAtEnd = !!revealAtEnd;\n        const viewportLength = viewportEnd - viewportStart;\n        const boxLength = boxEnd - boxStart;\n        if (boxLength < viewportLength) {\n            // The box would fit in the viewport\n            if (revealAtStart) {\n                return boxStart;\n            }\n            if (revealAtEnd) {\n                return Math.max(0, boxEnd - viewportLength);\n            }\n            if (boxStart < viewportStart) {\n                // The box is above the viewport\n                return boxStart;\n            }\n            else if (boxEnd > viewportEnd) {\n                // The box is below the viewport\n                return Math.max(0, boxEnd - viewportLength);\n            }\n        }\n        else {\n            // The box would not fit in the viewport\n            // Reveal the beginning of the box\n            return boxStart;\n        }\n        return viewportStart;\n    }\n}\n/**\n * Adds this amount of pixels to the right of lines (no-one wants to type near the edge of the viewport)\n */\nViewLines.HORIZONTAL_EXTRA_PX = 30;\n"],"mappings":";;;;;;;;;AAAA;AACA;AACA;AACA;AACA,OAAO,iBAAiB;AACxB,OAAO,KAAKA,QAAQ,MAAM,qCAAqC;AAC/D,SAASC,gBAAgB,QAAQ,kCAAkC;AACnE,SAASC,aAAa,QAAQ,6BAA6B;AAC3D,SAASC,sBAAsB,QAAQ,yBAAyB;AAChE,SAASC,gBAAgB,EAAEC,QAAQ,QAAQ,wBAAwB;AACnE,SAASC,iBAAiB,EAAEC,QAAQ,EAAEC,eAAe,QAAQ,eAAe;AAC5E,SAASC,QAAQ,QAAQ,kCAAkC;AAC3D,SAASC,KAAK,QAAQ,+BAA+B;AACrD,SAASC,iBAAiB,EAAEC,kBAAkB,EAAEC,eAAe,QAAQ,gCAAgC;AACvG,SAASC,gCAAgC,QAAQ,wDAAwD;AAAC,IACpGC,gBAAgB;EAClB,4BAAc;IAAA;IACV,IAAI,CAACC,oBAAoB,GAAG,IAAIN,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACrD;EAAC;IAAA;IAAA,OACD,kCAAyB;MACrB,OAAO,IAAI,CAACM,oBAAoB;IACpC;EAAC;IAAA;IAAA,OACD,gCAAuBC,mBAAmB,EAAE;MACxC,IAAI,CAACD,oBAAoB,GAAGC,mBAAmB;IACnD;EAAC;EAAA;AAAA;AAAA,IAECC,4BAA4B,6BAC9B,sCAAYC,aAAa,EAAEC,UAAU,EAAEC,WAAW,EAAEC,SAAS,EAAEC,cAAc,EAAEC,aAAa,EAAEC,UAAU,EAAE;EAAA;EACtG,IAAI,CAACN,aAAa,GAAGA,aAAa;EAClC,IAAI,CAACC,UAAU,GAAGA,UAAU;EAC5B,IAAI,CAACC,WAAW,GAAGA,WAAW;EAC9B,IAAI,CAACC,SAAS,GAAGA,SAAS;EAC1B,IAAI,CAACC,cAAc,GAAGA,cAAc;EACpC,IAAI,CAACC,aAAa,GAAGA,aAAa;EAClC,IAAI,CAACC,UAAU,GAAGA,UAAU;EAC5B,IAAI,CAACC,IAAI,GAAG,OAAO;EACnB,IAAI,CAACC,aAAa,GAAGP,UAAU;EAC/B,IAAI,CAACQ,aAAa,GAAGR,UAAU;AACnC,CAAC;AAAA,IAECS,iCAAiC,6BACnC,2CAAYV,aAAa,EAAEW,UAAU,EAAEP,cAAc,EAAEC,aAAa,EAAEC,UAAU,EAAE;EAAA;EAC9E,IAAI,CAACN,aAAa,GAAGA,aAAa;EAClC,IAAI,CAACW,UAAU,GAAGA,UAAU;EAC5B,IAAI,CAACP,cAAc,GAAGA,cAAc;EACpC,IAAI,CAACC,aAAa,GAAGA,aAAa;EAClC,IAAI,CAACC,UAAU,GAAGA,UAAU;EAC5B,IAAI,CAACC,IAAI,GAAG,YAAY;EACxB,IAAIC,aAAa,GAAGG,UAAU,CAAC,CAAC,CAAC,CAACC,eAAe;EACjD,IAAIH,aAAa,GAAGE,UAAU,CAAC,CAAC,CAAC,CAACE,aAAa;EAC/C,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEC,GAAG,GAAGJ,UAAU,CAACK,MAAM,EAAEF,CAAC,GAAGC,GAAG,EAAED,CAAC,EAAE,EAAE;IACnD,IAAMG,SAAS,GAAGN,UAAU,CAACG,CAAC,CAAC;IAC/BN,aAAa,GAAGU,IAAI,CAACC,GAAG,CAACX,aAAa,EAAES,SAAS,CAACL,eAAe,CAAC;IAClEH,aAAa,GAAGS,IAAI,CAACE,GAAG,CAACX,aAAa,EAAEQ,SAAS,CAACJ,aAAa,CAAC;EACpE;EACA,IAAI,CAACL,aAAa,GAAGA,aAAa;EAClC,IAAI,CAACC,aAAa,GAAGA,aAAa;AACtC,CAAC;AAEL,WAAaY,SAAS;EAAA;EAAA;EAClB,mBAAYC,OAAO,EAAEC,YAAY,EAAE;IAAA;IAAA;IAC/B,0BAAMD,OAAO;IACb,MAAKE,aAAa,GAAGD,YAAY;IACjC,MAAKE,qBAAqB,GAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;IAC1D,MAAKC,aAAa,GAAG,IAAI5C,sBAAsB,+BAAM;IACrD,MAAK6C,OAAO,GAAG,MAAKD,aAAa,CAACC,OAAO;IACzC,IAAMC,IAAI,GAAG,MAAKC,QAAQ,CAACC,aAAa;IACxC,IAAMC,OAAO,GAAG,MAAKF,QAAQ,CAACC,aAAa,CAACC,OAAO;IACnD,IAAMC,QAAQ,GAAGD,OAAO,CAACE,GAAG,CAAC,EAAE,CAAC,4BAA4B;IAC5D,IAAMC,YAAY,GAAGH,OAAO,CAACE,GAAG,CAAC,GAAG,CAAC,gCAAgC;IACrE,IAAME,UAAU,GAAGJ,OAAO,CAACE,GAAG,CAAC,GAAG,CAAC,8BAA8B;IACjE,MAAKG,WAAW,GAAGL,OAAO,CAACE,GAAG,CAAC,EAAE,CAAC,8BAA8B;IAChE,MAAKI,+BAA+B,GAAGL,QAAQ,CAACM,8BAA8B;IAC9E,MAAKC,mBAAmB,GAAGL,YAAY,CAACM,kBAAkB;IAC1D,MAAKC,6BAA6B,GAAGV,OAAO,CAACE,GAAG,CAAC,EAAE,CAAC,gDAAgD;IACpG,MAAKS,0BAA0B,GAAGP,UAAU,CAACQ,yBAAyB;IACtE,MAAKC,uBAAuB,GAAGb,OAAO,CAACE,GAAG,CAAC,EAAE,CAAC,0CAA0C;IACxF,MAAKY,4BAA4B,GAAGd,OAAO,CAACE,GAAG,CAAC,EAAE,CAAC,+CAA+C;IAClG,MAAKa,mBAAmB,GAAG,CAACf,OAAO,CAACE,GAAG,CAAC,EAAE,CAAC,uCAAuC;IAClF,MAAKc,gBAAgB,GAAG,IAAI5D,eAAe,CAACyC,IAAI,EAAE,MAAKC,QAAQ,CAACmB,KAAK,CAAC3C,IAAI,CAAC;IAC3EtB,gBAAgB,CAACkE,KAAK,CAAC,MAAKtB,OAAO,EAAE,CAAC,CAAC,gCAAgC;IACvE,MAAKA,OAAO,CAACuB,YAAY,sBAAezD,gCAAgC,EAAG;IAC3EZ,aAAa,CAAC,MAAK8C,OAAO,EAAEK,QAAQ,CAAC;IACrC;IACA,MAAKmB,aAAa,GAAG,CAAC;IACtB,MAAKC,sBAAsB,GAAG,IAAIxE,gBAAgB,CAAC,YAAM;MACrD,MAAKyE,qBAAqB,EAAE;IAChC,CAAC,EAAE,GAAG,CAAC;IACP,MAAKC,mCAAmC,GAAG,IAAI1E,gBAAgB,CAAC,YAAM;MAClE,MAAK2E,8BAA8B,EAAE;IACzC,CAAC,EAAE,IAAI,CAAC;IACR,MAAKC,iBAAiB,GAAG,IAAI9D,gBAAgB,EAAE;IAC/C,MAAK+D,wBAAwB,GAAG,IAAI;IAAC;EACzC;EAAC;IAAA;IAAA,OACD,mBAAU;MACN,IAAI,CAACL,sBAAsB,CAACM,OAAO,EAAE;MACrC,IAAI,CAACJ,mCAAmC,CAACI,OAAO,EAAE;MAClD;IACJ;EAAC;IAAA;IAAA,OACD,sBAAa;MACT,OAAO,IAAI,CAAC/B,OAAO;IACvB;IACA;EAAA;IAAA;IAAA,OACA,6BAAoB;MAChB,OAAO,IAAIzC,QAAQ,CAAC,IAAI,CAAC6D,gBAAgB,CAAC;IAC9C;IACA;IACA;EAAA;IAAA;IAAA,OACA,gCAAuBY,CAAC,EAAE;MACtB,IAAI,CAACjC,aAAa,CAACkC,sBAAsB,CAACD,CAAC,CAAC;MAC5C,IAAIA,CAAC,CAACE,UAAU,CAAC,GAAG,CAAC,gCAAgC,EAAE;QACnD,IAAI,CAACV,aAAa,GAAG,CAAC;MAC1B;MACA,IAAMpB,OAAO,GAAG,IAAI,CAACF,QAAQ,CAACC,aAAa,CAACC,OAAO;MACnD,IAAMC,QAAQ,GAAGD,OAAO,CAACE,GAAG,CAAC,EAAE,CAAC,4BAA4B;MAC5D,IAAMC,YAAY,GAAGH,OAAO,CAACE,GAAG,CAAC,GAAG,CAAC,gCAAgC;MACrE,IAAME,UAAU,GAAGJ,OAAO,CAACE,GAAG,CAAC,GAAG,CAAC,8BAA8B;MACjE,IAAI,CAACG,WAAW,GAAGL,OAAO,CAACE,GAAG,CAAC,EAAE,CAAC,8BAA8B;MAChE,IAAI,CAACI,+BAA+B,GAAGL,QAAQ,CAACM,8BAA8B;MAC9E,IAAI,CAACC,mBAAmB,GAAGL,YAAY,CAACM,kBAAkB;MAC1D,IAAI,CAACC,6BAA6B,GAAGV,OAAO,CAACE,GAAG,CAAC,EAAE,CAAC,gDAAgD;MACpG,IAAI,CAACS,0BAA0B,GAAGP,UAAU,CAACQ,yBAAyB;MACtE,IAAI,CAACC,uBAAuB,GAAGb,OAAO,CAACE,GAAG,CAAC,EAAE,CAAC,0CAA0C;MACxF,IAAI,CAACY,4BAA4B,GAAGd,OAAO,CAACE,GAAG,CAAC,EAAE,CAAC,+CAA+C;MAClG,IAAI,CAACa,mBAAmB,GAAG,CAACf,OAAO,CAACE,GAAG,CAAC,EAAE,CAAC,uCAAuC;MAClFpD,aAAa,CAAC,IAAI,CAAC8C,OAAO,EAAEK,QAAQ,CAAC;MACrC,IAAI,CAAC8B,sBAAsB,EAAE;MAC7B,IAAIH,CAAC,CAACE,UAAU,CAAC,GAAG,CAAC,8BAA8B,EAAE;QACjD,IAAI,CAACV,aAAa,GAAG,CAAC;MAC1B;MACA,OAAO,IAAI;IACf;EAAC;IAAA;IAAA,OACD,kCAAyB;MACrB,IAAMvB,IAAI,GAAG,IAAI,CAACC,QAAQ,CAACC,aAAa;MACxC,IAAMiC,kBAAkB,GAAG,IAAI5E,eAAe,CAACyC,IAAI,EAAE,IAAI,CAACC,QAAQ,CAACmB,KAAK,CAAC3C,IAAI,CAAC;MAC9E,IAAI,CAAC,IAAI,CAAC0C,gBAAgB,CAACiB,MAAM,CAACD,kBAAkB,CAAC,EAAE;QACnD,IAAI,CAAChB,gBAAgB,GAAGgB,kBAAkB;QAC1C,IAAMrD,eAAe,GAAG,IAAI,CAACgB,aAAa,CAACuC,kBAAkB,EAAE;QAC/D,IAAMtD,aAAa,GAAG,IAAI,CAACe,aAAa,CAACwC,gBAAgB,EAAE;QAC3D,KAAK,IAAInE,UAAU,GAAGW,eAAe,EAAEX,UAAU,IAAIY,aAAa,EAAEZ,UAAU,EAAE,EAAE;UAC9E,IAAMoE,IAAI,GAAG,IAAI,CAACzC,aAAa,CAAC0C,cAAc,CAACrE,UAAU,CAAC;UAC1DoE,IAAI,CAACE,gBAAgB,CAAC,IAAI,CAACtB,gBAAgB,CAAC;QAChD;QACA,OAAO,IAAI;MACf;MACA,OAAO,KAAK;IAChB;EAAC;IAAA;IAAA,OACD,8BAAqBY,CAAC,EAAE;MACpB,IAAMW,mBAAmB,GAAG,IAAI,CAAC5C,aAAa,CAACuC,kBAAkB,EAAE;MACnE,IAAMM,iBAAiB,GAAG,IAAI,CAAC7C,aAAa,CAACwC,gBAAgB,EAAE;MAC/D,IAAIM,CAAC,GAAG,KAAK;MACb,KAAK,IAAIzE,UAAU,GAAGuE,mBAAmB,EAAEvE,UAAU,IAAIwE,iBAAiB,EAAExE,UAAU,EAAE,EAAE;QACtFyE,CAAC,GAAG,IAAI,CAAC9C,aAAa,CAAC0C,cAAc,CAACrE,UAAU,CAAC,CAAC0E,kBAAkB,EAAE,IAAID,CAAC;MAC/E;MACA,OAAOA,CAAC;IACZ;EAAC;IAAA;IAAA,OACD,8BAAqBb,CAAC,EAAE;MACpB,IAAI,IAAI,CAAC,gCAAgC;QACrC,IAAMW,mBAAmB,GAAG,IAAI,CAAC5C,aAAa,CAACuC,kBAAkB,EAAE;QACnE,IAAMM,iBAAiB,GAAG,IAAI,CAAC7C,aAAa,CAACwC,gBAAgB,EAAE;QAC/D,KAAK,IAAInE,UAAU,GAAGuE,mBAAmB,EAAEvE,UAAU,IAAIwE,iBAAiB,EAAExE,UAAU,EAAE,EAAE;UACtF,IAAI,CAAC2B,aAAa,CAAC0C,cAAc,CAACrE,UAAU,CAAC,CAAC2E,oBAAoB,EAAE;QACxE;MACJ;MACA,OAAO,IAAI;IACf;EAAC;IAAA;IAAA,OACD,mBAAUf,CAAC,EAAE;MACT,IAAMgB,YAAY,GAAG,IAAI,CAACjD,aAAa,CAACkD,SAAS,CAACjB,CAAC,CAAC;MACpD,IAAI,CAACR,aAAa,GAAG,CAAC;MACtB,OAAOwB,YAAY;IACvB;EAAC;IAAA;IAAA,OACD,wBAAehB,CAAC,EAAE;MACd,OAAO,IAAI,CAACjC,aAAa,CAACmD,cAAc,CAAClB,CAAC,CAAC;IAC/C;EAAC;IAAA;IAAA,OACD,wBAAeA,CAAC,EAAE;MACd,OAAO,IAAI,CAACjC,aAAa,CAACoD,cAAc,CAACnB,CAAC,CAAC;IAC/C;EAAC;IAAA;IAAA,OACD,yBAAgBA,CAAC,EAAE;MACf,OAAO,IAAI,CAACjC,aAAa,CAACqD,eAAe,CAACpB,CAAC,CAAC;IAChD;EAAC;IAAA;IAAA,OACD,8BAAqBA,CAAC,EAAE;MACpB;MACA;MACA,IAAMqB,gBAAgB,GAAG,IAAI,CAACC,8BAA8B,CAAC,IAAI,CAACpD,QAAQ,CAACqD,UAAU,CAACC,iBAAiB,EAAE,EAAExB,CAAC,CAACyB,MAAM,EAAEzB,CAAC,CAAC7D,aAAa,EAAE6D,CAAC,CAAC0B,KAAK,EAAE1B,CAAC,CAAClD,UAAU,EAAEkD,CAAC,CAAC2B,YAAY,CAAC;MAC5K,IAAIN,gBAAgB,KAAK,CAAC,CAAC,EAAE;QACzB;QACA,OAAO,KAAK;MAChB;MACA;MACA,IAAIO,iBAAiB,GAAG,IAAI,CAAC1D,QAAQ,CAACqD,UAAU,CAACM,sBAAsB,CAAC;QAAEC,SAAS,EAAET;MAAiB,CAAC,CAAC;MACxG,IAAIrB,CAAC,CAAC+B,gBAAgB,EAAE;QACpB,IAAI/B,CAAC,CAAC0B,KAAK,IAAI1B,CAAC,CAAC0B,KAAK,CAAC3E,eAAe,KAAKiD,CAAC,CAAC0B,KAAK,CAAC1E,aAAa,EAAE;UAC9D;UACA4E,iBAAiB,GAAG;YAChBE,SAAS,EAAEF,iBAAiB,CAACE,SAAS;YACtCE,UAAU,EAAE;UAChB,CAAC;QACL,CAAC,MACI,IAAIhC,CAAC,CAAC0B,KAAK,EAAE;UACd;UACA,IAAI,CAAC5B,wBAAwB,GAAG,IAAI5D,4BAA4B,CAAC8D,CAAC,CAAC7D,aAAa,EAAE6D,CAAC,CAAC0B,KAAK,CAAC3E,eAAe,EAAEiD,CAAC,CAAC0B,KAAK,CAACrF,WAAW,EAAE2D,CAAC,CAAC0B,KAAK,CAACpF,SAAS,EAAE,IAAI,CAAC4B,QAAQ,CAACqD,UAAU,CAACU,mBAAmB,EAAE,EAAEL,iBAAiB,CAACE,SAAS,EAAE9B,CAAC,CAACvD,UAAU,CAAC;QACjP,CAAC,MACI,IAAIuD,CAAC,CAAClD,UAAU,IAAIkD,CAAC,CAAClD,UAAU,CAACK,MAAM,GAAG,CAAC,EAAE;UAC9C,IAAI,CAAC2C,wBAAwB,GAAG,IAAIjD,iCAAiC,CAACmD,CAAC,CAAC7D,aAAa,EAAE6D,CAAC,CAAClD,UAAU,EAAE,IAAI,CAACoB,QAAQ,CAACqD,UAAU,CAACU,mBAAmB,EAAE,EAAEL,iBAAiB,CAACE,SAAS,EAAE9B,CAAC,CAACvD,UAAU,CAAC;QACnM;MACJ,CAAC,MACI;QACD,IAAI,CAACqD,wBAAwB,GAAG,IAAI;MACxC;MACA,IAAMoC,cAAc,GAAG7E,IAAI,CAAC8E,GAAG,CAAC,IAAI,CAACjE,QAAQ,CAACqD,UAAU,CAACU,mBAAmB,EAAE,GAAGL,iBAAiB,CAACE,SAAS,CAAC;MAC7G,IAAMrF,UAAU,GAAIyF,cAAc,IAAI,IAAI,CAACzD,WAAW,GAAG,CAAC,CAAC,6BAA6BuB,CAAC,CAACvD,UAAW;MACrG,IAAI,CAACyB,QAAQ,CAACkE,SAAS,CAACb,UAAU,CAACc,iBAAiB,CAACT,iBAAiB,EAAEnF,UAAU,CAAC;MACnF,OAAO,IAAI;IACf;EAAC;IAAA;IAAA,OACD,yBAAgBuD,CAAC,EAAE;MACf,IAAI,IAAI,CAACF,wBAAwB,IAAIE,CAAC,CAACsC,iBAAiB,EAAE;QACtD;QACA,IAAI,CAACxC,wBAAwB,GAAG,IAAI;MACxC;MACA,IAAI,IAAI,CAACA,wBAAwB,IAAIE,CAAC,CAACuC,gBAAgB,EAAE;QACrD,IAAMjF,GAAG,GAAGD,IAAI,CAACC,GAAG,CAAC,IAAI,CAACwC,wBAAwB,CAACvD,cAAc,EAAE,IAAI,CAACuD,wBAAwB,CAACtD,aAAa,CAAC;QAC/G,IAAMe,GAAG,GAAGF,IAAI,CAACE,GAAG,CAAC,IAAI,CAACuC,wBAAwB,CAACvD,cAAc,EAAE,IAAI,CAACuD,wBAAwB,CAACtD,aAAa,CAAC;QAC/G,IAAIwD,CAAC,CAAC8B,SAAS,GAAGxE,GAAG,IAAI0C,CAAC,CAAC8B,SAAS,GAAGvE,GAAG,EAAE;UACxC;UACA,IAAI,CAACuC,wBAAwB,GAAG,IAAI;QACxC;MACJ;MACA,IAAI,CAAC9B,OAAO,CAACwE,QAAQ,CAACxC,CAAC,CAACyC,WAAW,CAAC;MACpC,OAAO,IAAI,CAAC1E,aAAa,CAAC2E,eAAe,CAAC1C,CAAC,CAAC,IAAI,IAAI;IACxD;EAAC;IAAA;IAAA,OACD,yBAAgBA,CAAC,EAAE;MACf,OAAO,IAAI,CAACjC,aAAa,CAAC4E,eAAe,CAAC3C,CAAC,CAAC;IAChD;EAAC;IAAA;IAAA,OACD,wBAAeA,CAAC,EAAE;MACd,IAAI,CAAC9B,QAAQ,CAACkE,SAAS,CAACb,UAAU,CAACqB,eAAe,CAAC,IAAI,CAACpD,aAAa,CAAC;MACtE,OAAO,IAAI,CAACzB,aAAa,CAAC8E,cAAc,CAAC7C,CAAC,CAAC;IAC/C;EAAC;IAAA;IAAA,OACD,wBAAeA,CAAC,EAAE;MACd,OAAO,IAAI,CAACG,sBAAsB,EAAE;IACxC;IACA;IACA;EAAA;IAAA;IAAA,OACA,gCAAuB2C,QAAQ,EAAEC,MAAM,EAAE;MACrC,IAAMC,eAAe,GAAG,IAAI,CAACC,mBAAmB,CAACH,QAAQ,CAAC;MAC1D,IAAIE,eAAe,KAAK,IAAI,EAAE;QAC1B;QACA,OAAO,IAAI;MACf;MACA,IAAM5G,UAAU,GAAG,IAAI,CAAC8G,iBAAiB,CAACF,eAAe,CAAC;MAC1D,IAAI5G,UAAU,KAAK,CAAC,CAAC,EAAE;QACnB;QACA,OAAO,IAAI;MACf;MACA,IAAIA,UAAU,GAAG,CAAC,IAAIA,UAAU,GAAG,IAAI,CAAC8B,QAAQ,CAACkE,SAAS,CAACe,YAAY,EAAE,EAAE;QACvE;QACA,OAAO,IAAI;MACf;MACA,IAAI,IAAI,CAACjF,QAAQ,CAACkE,SAAS,CAACgB,gBAAgB,CAAChH,UAAU,CAAC,KAAK,CAAC,EAAE;QAC5D;QACA,OAAO,IAAIX,QAAQ,CAACW,UAAU,EAAE,CAAC,CAAC;MACtC;MACA,IAAMuE,mBAAmB,GAAG,IAAI,CAAC5C,aAAa,CAACuC,kBAAkB,EAAE;MACnE,IAAMM,iBAAiB,GAAG,IAAI,CAAC7C,aAAa,CAACwC,gBAAgB,EAAE;MAC/D,IAAInE,UAAU,GAAGuE,mBAAmB,IAAIvE,UAAU,GAAGwE,iBAAiB,EAAE;QACpE;QACA,OAAO,IAAI;MACf;MACA,IAAIyC,MAAM,GAAG,IAAI,CAACtF,aAAa,CAAC0C,cAAc,CAACrE,UAAU,CAAC,CAACkH,qBAAqB,CAAClH,UAAU,EAAE0G,QAAQ,EAAEC,MAAM,CAAC;MAC9G,IAAMQ,SAAS,GAAG,IAAI,CAACrF,QAAQ,CAACkE,SAAS,CAACoB,gBAAgB,CAACpH,UAAU,CAAC;MACtE,IAAIiH,MAAM,GAAGE,SAAS,EAAE;QACpBF,MAAM,GAAGE,SAAS;MACtB;MACA,OAAO,IAAI9H,QAAQ,CAACW,UAAU,EAAEiH,MAAM,CAAC;IAC3C;EAAC;IAAA;IAAA,OACD,6BAAoBI,IAAI,EAAE;MACtB,OAAOA,IAAI,IAAIA,IAAI,CAACC,QAAQ,KAAK,CAAC,EAAE;QAChC,IAAID,IAAI,CAACE,SAAS,KAAKpI,QAAQ,CAACqI,UAAU,EAAE;UACxC,OAAOH,IAAI;QACf;QACAA,IAAI,GAAGA,IAAI,CAACI,aAAa;MAC7B;MACA,OAAO,IAAI;IACf;IACA;AACJ;AACA;EAFI;IAAA;IAAA,OAGA,2BAAkB7F,OAAO,EAAE;MACvB,IAAMjB,eAAe,GAAG,IAAI,CAACgB,aAAa,CAACuC,kBAAkB,EAAE;MAC/D,IAAMtD,aAAa,GAAG,IAAI,CAACe,aAAa,CAACwC,gBAAgB,EAAE;MAC3D,KAAK,IAAInE,UAAU,GAAGW,eAAe,EAAEX,UAAU,IAAIY,aAAa,EAAEZ,UAAU,EAAE,EAAE;QAC9E,IAAMoE,IAAI,GAAG,IAAI,CAACzC,aAAa,CAAC0C,cAAc,CAACrE,UAAU,CAAC;QAC1D,IAAI4B,OAAO,KAAKwC,IAAI,CAACsD,UAAU,EAAE,EAAE;UAC/B,OAAO1H,UAAU;QACrB;MACJ;MACA,OAAO,CAAC,CAAC;IACb;EAAC;IAAA;IAAA,OACD,sBAAaA,UAAU,EAAE;MACrB,IAAMuE,mBAAmB,GAAG,IAAI,CAAC5C,aAAa,CAACuC,kBAAkB,EAAE;MACnE,IAAMM,iBAAiB,GAAG,IAAI,CAAC7C,aAAa,CAACwC,gBAAgB,EAAE;MAC/D,IAAInE,UAAU,GAAGuE,mBAAmB,IAAIvE,UAAU,GAAGwE,iBAAiB,EAAE;QACpE;QACA,OAAO,CAAC,CAAC;MACb;MACA,OAAO,IAAI,CAAC7C,aAAa,CAAC0C,cAAc,CAACrE,UAAU,CAAC,CAAC2H,QAAQ,EAAE;IACnE;EAAC;IAAA;IAAA,OACD,oCAA2BC,MAAM,EAAEC,eAAe,EAAE;MAChD,IAAI,IAAI,CAACjD,YAAY,EAAE,EAAE;QACrB;QACA;QACA,OAAO,IAAI;MACf;MACA,IAAMkD,qBAAqB,GAAGF,MAAM,CAAChH,aAAa;MAClD,IAAM0E,KAAK,GAAGhG,KAAK,CAACyI,eAAe,CAACH,MAAM,EAAE,IAAI,CAACnE,iBAAiB,CAACuE,sBAAsB,EAAE,CAAC;MAC5F,IAAI,CAAC1C,KAAK,EAAE;QACR,OAAO,IAAI;MACf;MACA,IAAM2C,aAAa,GAAG,EAAE;MACxB,IAAIC,gBAAgB,GAAG,CAAC;MACxB,IAAMC,iBAAiB,GAAG,IAAIjJ,iBAAiB,CAAC,IAAI,CAAC0C,OAAO,CAACA,OAAO,EAAE,IAAI,CAACJ,qBAAqB,CAAC;MACjG,IAAI4G,uBAAuB,GAAG,CAAC;MAC/B,IAAIP,eAAe,EAAE;QACjBO,uBAAuB,GAAG,IAAI,CAACtG,QAAQ,CAACkE,SAAS,CAACqC,oBAAoB,CAACC,kCAAkC,CAAC,IAAIjJ,QAAQ,CAACiG,KAAK,CAAC3E,eAAe,EAAE,CAAC,CAAC,CAAC,CAACX,UAAU;MAChK;MACA,IAAMuE,mBAAmB,GAAG,IAAI,CAAC5C,aAAa,CAACuC,kBAAkB,EAAE;MACnE,IAAMM,iBAAiB,GAAG,IAAI,CAAC7C,aAAa,CAACwC,gBAAgB,EAAE;MAC/D,KAAK,IAAInE,UAAU,GAAGsF,KAAK,CAAC3E,eAAe,EAAEX,UAAU,IAAIsF,KAAK,CAAC1E,aAAa,EAAEZ,UAAU,EAAE,EAAE;QAC1F,IAAIA,UAAU,GAAGuE,mBAAmB,IAAIvE,UAAU,GAAGwE,iBAAiB,EAAE;UACpE;QACJ;QACA,IAAMvE,WAAW,GAAGD,UAAU,KAAKsF,KAAK,CAAC3E,eAAe,GAAG2E,KAAK,CAACrF,WAAW,GAAG,CAAC;QAChF,IAAMC,SAAS,GAAGF,UAAU,KAAKsF,KAAK,CAAC1E,aAAa,GAAG0E,KAAK,CAACpF,SAAS,GAAG,IAAI,CAAC4B,QAAQ,CAACkE,SAAS,CAACgB,gBAAgB,CAAChH,UAAU,CAAC;QAC7H,IAAMuI,oBAAoB,GAAG,IAAI,CAAC5G,aAAa,CAAC0C,cAAc,CAACrE,UAAU,CAAC,CAACwI,wBAAwB,CAACxI,UAAU,EAAEC,WAAW,EAAEC,SAAS,EAAEiI,iBAAiB,CAAC;QAC1J,IAAI,CAACI,oBAAoB,EAAE;UACvB;QACJ;QACA,IAAIV,eAAe,IAAI7H,UAAU,GAAG8H,qBAAqB,EAAE;UACvD,IAAMW,0BAA0B,GAAGL,uBAAuB;UAC1DA,uBAAuB,GAAG,IAAI,CAACtG,QAAQ,CAACkE,SAAS,CAACqC,oBAAoB,CAACC,kCAAkC,CAAC,IAAIjJ,QAAQ,CAACW,UAAU,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC,CAACA,UAAU;UACrJ,IAAIyI,0BAA0B,KAAKL,uBAAuB,EAAE;YACxDG,oBAAoB,CAACG,MAAM,CAACH,oBAAoB,CAACG,MAAM,CAAC3H,MAAM,GAAG,CAAC,CAAC,CAAC4H,KAAK,IAAI,IAAI,CAACrG,+BAA+B;UACrH;QACJ;QACA2F,aAAa,CAACC,gBAAgB,EAAE,CAAC,GAAG,IAAI3I,iBAAiB,CAACgJ,oBAAoB,CAACK,mBAAmB,EAAE5I,UAAU,EAAEP,eAAe,CAACoJ,IAAI,CAACN,oBAAoB,CAACG,MAAM,CAAC,CAAC;MACtK;MACA,IAAIR,gBAAgB,KAAK,CAAC,EAAE;QACxB,OAAO,IAAI;MACf;MACA,OAAOD,aAAa;IACxB;EAAC;IAAA;IAAA,OACD,oCAA2BjI,UAAU,EAAEC,WAAW,EAAEC,SAAS,EAAE;MAC3D,IAAI,IAAI,CAAC0E,YAAY,EAAE,EAAE;QACrB;QACA;QACA,OAAO,IAAI;MACf;MACA,IAAI5E,UAAU,GAAG,IAAI,CAAC2B,aAAa,CAACuC,kBAAkB,EAAE,IAAIlE,UAAU,GAAG,IAAI,CAAC2B,aAAa,CAACwC,gBAAgB,EAAE,EAAE;QAC5G,OAAO,IAAI;MACf;MACA,OAAO,IAAI,CAACxC,aAAa,CAAC0C,cAAc,CAACrE,UAAU,CAAC,CAACwI,wBAAwB,CAACxI,UAAU,EAAEC,WAAW,EAAEC,SAAS,EAAE,IAAIhB,iBAAiB,CAAC,IAAI,CAAC0C,OAAO,CAACA,OAAO,EAAE,IAAI,CAACJ,qBAAqB,CAAC,CAAC;IAC9L;EAAC;IAAA;IAAA,OACD,iCAAwBsH,QAAQ,EAAE;MAC9B,IAAMb,aAAa,GAAG,IAAI,CAACc,0BAA0B,CAACD,QAAQ,CAAC9I,UAAU,EAAE8I,QAAQ,CAAC7B,MAAM,EAAE6B,QAAQ,CAAC7B,MAAM,CAAC;MAC5G,IAAI,CAACgB,aAAa,EAAE;QAChB,OAAO,IAAI;MACf;MACA,OAAO,IAAIzI,kBAAkB,CAACyI,aAAa,CAACW,mBAAmB,EAAEX,aAAa,CAACS,MAAM,CAAC,CAAC,CAAC,CAACM,IAAI,CAAC;IAClG;IACA;EAAA;IAAA;IAAA,OACA,4BAAmB;MACf,IAAI,CAACC,iBAAiB,CAAC,KAAK,CAAC;IACjC;IACA;AACJ;AACA;AACA;AACA;EAJI;IAAA;IAAA,OAKA,iCAAwB;MACpB,OAAO,IAAI,CAACA,iBAAiB,CAAC,IAAI,CAAC;IACvC;EAAC;IAAA;IAAA,OACD,iCAAwB;MACpB,IAAI,CAACA,iBAAiB,CAAC,KAAK,CAAC;IACjC;EAAC;IAAA;IAAA,OACD,2BAAkBC,IAAI,EAAE;MACpB,IAAM3E,mBAAmB,GAAG,IAAI,CAAC5C,aAAa,CAACuC,kBAAkB,EAAE;MACnE,IAAMM,iBAAiB,GAAG,IAAI,CAAC7C,aAAa,CAACwC,gBAAgB,EAAE;MAC/D,IAAIgF,iBAAiB,GAAG,CAAC;MACzB,IAAIC,iBAAiB,GAAG,IAAI;MAC5B,KAAK,IAAIpJ,UAAU,GAAGuE,mBAAmB,EAAEvE,UAAU,IAAIwE,iBAAiB,EAAExE,UAAU,EAAE,EAAE;QACtF,IAAMqJ,WAAW,GAAG,IAAI,CAAC1H,aAAa,CAAC0C,cAAc,CAACrE,UAAU,CAAC;QACjE,IAAIkJ,IAAI,IAAI,CAACG,WAAW,CAACC,cAAc,EAAE,EAAE;UACvC;UACAF,iBAAiB,GAAG,KAAK;UACzB;QACJ;QACAD,iBAAiB,GAAGlI,IAAI,CAACE,GAAG,CAACgI,iBAAiB,EAAEE,WAAW,CAAC1B,QAAQ,EAAE,CAAC;MAC3E;MACA,IAAIyB,iBAAiB,IAAI7E,mBAAmB,KAAK,CAAC,IAAIC,iBAAiB,KAAK,IAAI,CAAC1C,QAAQ,CAACkE,SAAS,CAACe,YAAY,EAAE,EAAE;QAChH;QACA,IAAI,CAAC3D,aAAa,GAAG,CAAC;MAC1B;MACA,IAAI,CAACmG,mBAAmB,CAACJ,iBAAiB,CAAC;MAC3C,OAAOC,iBAAiB;IAC5B;EAAC;IAAA;IAAA,OACD,0CAAiC;MAC7B;MACA;MACA;MACA,IAAII,iBAAiB,GAAG,CAAC,CAAC;MAC1B,IAAIC,YAAY,GAAG,CAAC,CAAC;MACrB,IAAMlF,mBAAmB,GAAG,IAAI,CAAC5C,aAAa,CAACuC,kBAAkB,EAAE;MACnE,IAAMM,iBAAiB,GAAG,IAAI,CAAC7C,aAAa,CAACwC,gBAAgB,EAAE;MAC/D,KAAK,IAAInE,UAAU,GAAGuE,mBAAmB,EAAEvE,UAAU,IAAIwE,iBAAiB,EAAExE,UAAU,EAAE,EAAE;QACtF,IAAMqJ,WAAW,GAAG,IAAI,CAAC1H,aAAa,CAAC0C,cAAc,CAACrE,UAAU,CAAC;QACjE,IAAIqJ,WAAW,CAACK,uBAAuB,EAAE,EAAE;UACvC,IAAMC,SAAS,GAAGN,WAAW,CAAC1B,QAAQ,EAAE;UACxC,IAAIgC,SAAS,GAAGF,YAAY,EAAE;YAC1BA,YAAY,GAAGE,SAAS;YACxBH,iBAAiB,GAAGxJ,UAAU;UAClC;QACJ;MACJ;MACA,IAAIwJ,iBAAiB,KAAK,CAAC,CAAC,EAAE;QAC1B;MACJ;MACA,IAAI,CAAC,IAAI,CAAC7H,aAAa,CAAC0C,cAAc,CAACmF,iBAAiB,CAAC,CAACI,4BAA4B,EAAE,EAAE;QACtF,KAAK,IAAI5J,WAAU,GAAGuE,mBAAmB,EAAEvE,WAAU,IAAIwE,iBAAiB,EAAExE,WAAU,EAAE,EAAE;UACtF,IAAMqJ,YAAW,GAAG,IAAI,CAAC1H,aAAa,CAAC0C,cAAc,CAACrE,WAAU,CAAC;UACjEqJ,YAAW,CAACQ,iCAAiC,EAAE;QACnD;MACJ;IACJ;EAAC;IAAA;IAAA,OACD,yBAAgB;MACZ,MAAM,IAAIC,KAAK,CAAC,eAAe,CAAC;IACpC;EAAC;IAAA;IAAA,OACD,kBAAS;MACL,MAAM,IAAIA,KAAK,CAAC,eAAe,CAAC;IACpC;EAAC;IAAA;IAAA,OACD,oBAAWC,YAAY,EAAE;MACrB;MACA,IAAI,CAACpI,aAAa,CAACqI,WAAW,CAACD,YAAY,CAAC;MAC5C,IAAI,CAACtG,iBAAiB,CAACwG,sBAAsB,CAACF,YAAY,CAACG,YAAY,CAAC;MACxE,IAAI,CAACtI,OAAO,CAACwE,QAAQ,CAAC,IAAI,CAACtE,QAAQ,CAACqD,UAAU,CAACgF,cAAc,EAAE,CAAC;MAChE,IAAI,CAACvI,OAAO,CAACwI,SAAS,CAACnJ,IAAI,CAACC,GAAG,CAAC,IAAI,CAACY,QAAQ,CAACqD,UAAU,CAACkF,eAAe,EAAE,EAAE,OAAO,CAAC,CAAC;MACrF;MACA;MACA;MACA,IAAI,IAAI,CAAC3G,wBAAwB,EAAE;QAC/B,IAAM4G,uBAAuB,GAAG,IAAI,CAAC5G,wBAAwB;QAC7D;QACA,IAAIqG,YAAY,CAACpJ,eAAe,IAAI2J,uBAAuB,CAAC/J,aAAa,IAAI+J,uBAAuB,CAAC9J,aAAa,IAAIuJ,YAAY,CAACnJ,aAAa,EAAE;UAC9I,IAAI,CAAC8C,wBAAwB,GAAG,IAAI;UACpC;UACA,IAAI,CAAC6G,WAAW,EAAE;UAClB;UACA,IAAMC,aAAa,GAAG,IAAI,CAACC,0BAA0B,CAACH,uBAAuB,CAAC;UAC9E,IAAIE,aAAa,EAAE;YACf,IAAI,CAAC,IAAI,CAAChI,mBAAmB,EAAE;cAC3B;cACA,IAAI,CAAC+G,mBAAmB,CAACiB,aAAa,CAACE,mBAAmB,CAAC;YAC/D;YACA;YACA,IAAI,CAAC5I,QAAQ,CAACkE,SAAS,CAACb,UAAU,CAACc,iBAAiB,CAAC;cACjDL,UAAU,EAAE4E,aAAa,CAAC5E;YAC9B,CAAC,EAAE0E,uBAAuB,CAACjK,UAAU,CAAC;UAC1C;QACJ;MACJ;MACA;MACA,IAAI,CAAC,IAAI,CAACsK,qBAAqB,EAAE,EAAE;QAC/B;QACA,IAAI,CAACtH,sBAAsB,CAACuH,QAAQ,EAAE;MAC1C;MACA,IAAIhM,QAAQ,CAACiM,OAAO,IAAI,CAAC,IAAI,CAACtH,mCAAmC,CAACuH,WAAW,EAAE,EAAE;QAC7E,IAAMvG,mBAAmB,GAAG,IAAI,CAAC5C,aAAa,CAACuC,kBAAkB,EAAE;QACnE,IAAMM,iBAAiB,GAAG,IAAI,CAAC7C,aAAa,CAACwC,gBAAgB,EAAE;QAC/D,KAAK,IAAInE,UAAU,GAAGuE,mBAAmB,EAAEvE,UAAU,IAAIwE,iBAAiB,EAAExE,UAAU,EAAE,EAAE;UACtF,IAAMqJ,WAAW,GAAG,IAAI,CAAC1H,aAAa,CAAC0C,cAAc,CAACrE,UAAU,CAAC;UACjE,IAAIqJ,WAAW,CAACK,uBAAuB,EAAE,EAAE;YACvC,IAAI,CAACnG,mCAAmC,CAACqH,QAAQ,EAAE;YACnD;UACJ;QACJ;MACJ;MACA;MACA,IAAI,CAACrJ,aAAa,CAACwJ,eAAe,CAAC,IAAI,CAAChI,mBAAmB,CAAC;MAC5D,IAAI,CAACxB,aAAa,CAACyJ,UAAU,CAAC,QAAQ,CAAC;MACvC,IAAMC,iBAAiB,GAAG,IAAI,CAACnJ,QAAQ,CAACqD,UAAU,CAACU,mBAAmB,EAAE,GAAGkE,YAAY,CAACmB,eAAe;MACvG,IAAI,CAAC3J,aAAa,CAAC4J,MAAM,CAAC,CAACF,iBAAiB,CAAC;MAC7C,IAAI,CAAC1J,aAAa,CAAC6J,OAAO,CAAC,CAAC,IAAI,CAACtJ,QAAQ,CAACqD,UAAU,CAACkG,oBAAoB,EAAE,CAAC;IAChF;IACA;EAAA;IAAA;IAAA,OACA,6BAAoB1B,SAAS,EAAE;MAC3B,IAAM2B,UAAU,GAAGrK,IAAI,CAACsK,IAAI,CAAC5B,SAAS,CAAC;MACvC,IAAI,IAAI,CAACvG,aAAa,GAAGkI,UAAU,EAAE;QACjC,IAAI,CAAClI,aAAa,GAAGkI,UAAU;QAC/B,IAAI,CAACxJ,QAAQ,CAACkE,SAAS,CAACb,UAAU,CAACqB,eAAe,CAAC,IAAI,CAACpD,aAAa,CAAC;MAC1E;IACJ;EAAC;IAAA;IAAA,OACD,wCAA+BoI,QAAQ,EAAEnG,MAAM,EAAEtF,aAAa,EAAEuF,KAAK,EAAE5E,UAAU,EAAE6E,YAAY,EAAE;MAC7F,IAAMkG,cAAc,GAAGD,QAAQ,CAACE,GAAG;MACnC,IAAMC,cAAc,GAAGH,QAAQ,CAACI,MAAM;MACtC,IAAMC,YAAY,GAAGJ,cAAc,GAAGE,cAAc;MACpD,IAAIG,gBAAgB;MACpB,IAAIC,SAAS;MACb,IAAIC,OAAO;MACX,IAAItL,UAAU,IAAIA,UAAU,CAACK,MAAM,GAAG,CAAC,EAAE;QACrC,IAAIR,aAAa,GAAGG,UAAU,CAAC,CAAC,CAAC,CAACC,eAAe;QACjD,IAAIH,aAAa,GAAGE,UAAU,CAAC,CAAC,CAAC,CAACE,aAAa;QAC/C,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEC,GAAG,GAAGJ,UAAU,CAACK,MAAM,EAAEF,CAAC,GAAGC,GAAG,EAAED,CAAC,EAAE,EAAE;UACnD,IAAMG,SAAS,GAAGN,UAAU,CAACG,CAAC,CAAC;UAC/BN,aAAa,GAAGU,IAAI,CAACC,GAAG,CAACX,aAAa,EAAES,SAAS,CAACL,eAAe,CAAC;UAClEH,aAAa,GAAGS,IAAI,CAACE,GAAG,CAACX,aAAa,EAAEQ,SAAS,CAACJ,aAAa,CAAC;QACpE;QACAkL,gBAAgB,GAAG,KAAK;QACxBC,SAAS,GAAG,IAAI,CAACjK,QAAQ,CAACqD,UAAU,CAAC8G,8BAA8B,CAAC1L,aAAa,CAAC;QAClFyL,OAAO,GAAG,IAAI,CAAClK,QAAQ,CAACqD,UAAU,CAAC8G,8BAA8B,CAACzL,aAAa,CAAC,GAAG,IAAI,CAAC6B,WAAW;MACvG,CAAC,MACI,IAAIiD,KAAK,EAAE;QACZwG,gBAAgB,GAAG,IAAI;QACvBC,SAAS,GAAG,IAAI,CAACjK,QAAQ,CAACqD,UAAU,CAAC8G,8BAA8B,CAAC3G,KAAK,CAAC3E,eAAe,CAAC;QAC1FqL,OAAO,GAAG,IAAI,CAAClK,QAAQ,CAACqD,UAAU,CAAC8G,8BAA8B,CAAC3G,KAAK,CAAC1E,aAAa,CAAC,GAAG,IAAI,CAACyB,WAAW;MAC7G,CAAC,MACI;QACD,OAAO,CAAC,CAAC;MACb;MACA,IAAM6J,qBAAqB,GAAG,CAAC7G,MAAM,KAAK,OAAO,IAAItF,aAAa,KAAK,IAAI,CAAC+C,4BAA4B,KAAK,SAAS;MACtH,IAAI,CAACoJ,qBAAqB,EAAE;QACxB,IAAM7K,OAAO,GAAGJ,IAAI,CAACC,GAAG,CAAEyK,cAAc,GAAG,IAAI,CAACtJ,WAAW,GAAI,CAAC,EAAE,IAAI,CAACQ,uBAAuB,CAAC;QAC/FkJ,SAAS,IAAI1K,OAAO,GAAG,IAAI,CAACgB,WAAW;QACvC2J,OAAO,IAAI/K,IAAI,CAACE,GAAG,CAAC,CAAC,EAAGE,OAAO,GAAG,CAAC,CAAE,GAAG,IAAI,CAACgB,WAAW;MAC5D,CAAC,MACI;QACD,IAAI,CAACtC,aAAa,EAAE;UAChB;UACAgM,SAAS,IAAI,IAAI,CAAC1J,WAAW;QACjC;MACJ;MACA,IAAIkD,YAAY,KAAK,CAAC,CAAC,8CAA8CA,YAAY,KAAK,CAAC,CAAC,4CAA4C;QAChI;QACAyG,OAAO,IAAKjM,aAAa,GAAG,IAAI,CAAC4C,0BAA0B,GAAG,IAAI,CAACN,WAAY;MACnF;MACA,IAAI8J,YAAY;MAChB,IAAIH,OAAO,GAAGD,SAAS,GAAGJ,cAAc,EAAE;QACtC;QACA,IAAI,CAACG,gBAAgB,EAAE;UACnB;UACA,OAAO,CAAC,CAAC;QACb;QACAK,YAAY,GAAGJ,SAAS;MAC5B,CAAC,MACI,IAAIxG,YAAY,KAAK,CAAC,CAAC,+CAA+CA,YAAY,KAAK,CAAC,CAAC,8DAA8D;QACxJ,IAAIA,YAAY,KAAK,CAAC,CAAC,gEAAgEkG,cAAc,IAAIM,SAAS,IAAIC,OAAO,IAAIH,YAAY,EAAE;UAC3I;UACAM,YAAY,GAAGV,cAAc;QACjC,CAAC,MACI;UACD;UACA,IAAMW,eAAe,GAAGnL,IAAI,CAACE,GAAG,CAAC,CAAC,GAAG,IAAI,CAACkB,WAAW,EAAEsJ,cAAc,GAAG,GAAG,CAAC;UAC5E;UACA,IAAM1G,gBAAgB,GAAG8G,SAAS,GAAGK,eAAe;UACpD;UACA,IAAMC,YAAY,GAAGL,OAAO,GAAGL,cAAc;UAC7CQ,YAAY,GAAGlL,IAAI,CAACE,GAAG,CAACkL,YAAY,EAAEpH,gBAAgB,CAAC;QAC3D;MACJ,CAAC,MACI,IAAIM,YAAY,KAAK,CAAC,CAAC,8CAA8CA,YAAY,KAAK,CAAC,CAAC,6DAA6D;QACtJ,IAAIA,YAAY,KAAK,CAAC,CAAC,+DAA+DkG,cAAc,IAAIM,SAAS,IAAIC,OAAO,IAAIH,YAAY,EAAE;UAC1I;UACAM,YAAY,GAAGV,cAAc;QACjC,CAAC,MACI;UACD;UACA,IAAMa,UAAU,GAAG,CAACP,SAAS,GAAGC,OAAO,IAAI,CAAC;UAC5CG,YAAY,GAAGlL,IAAI,CAACE,GAAG,CAAC,CAAC,EAAEmL,UAAU,GAAGX,cAAc,GAAG,CAAC,CAAC;QAC/D;MACJ,CAAC,MACI;QACDQ,YAAY,GAAG,IAAI,CAACI,wBAAwB,CAACd,cAAc,EAAEI,YAAY,EAAEE,SAAS,EAAEC,OAAO,EAAEzG,YAAY,KAAK,CAAC,CAAC,yCAAyCA,YAAY,KAAK,CAAC,CAAC,2CAA2C;MAC7N;;MACA,OAAO4G,YAAY;IACvB;EAAC;IAAA;IAAA,OACD,oCAA2B7B,uBAAuB,EAAE;MAChD,IAAMkB,QAAQ,GAAG,IAAI,CAAC1J,QAAQ,CAACqD,UAAU,CAACqH,kBAAkB,EAAE;MAC9D,IAAMC,cAAc,GAAGjB,QAAQ,CAACxC,IAAI;MACpC,IAAM0D,YAAY,GAAGD,cAAc,GAAGjB,QAAQ,CAAC7C,KAAK;MACpD,IAAIgE,SAAS,GAAG,UAAU,CAAC;MAC3B,IAAIC,OAAO,GAAG,CAAC;MACf,IAAItC,uBAAuB,CAAChK,IAAI,KAAK,OAAO,EAAE;QAC1C,IAAM2H,aAAa,GAAG,IAAI,CAACc,0BAA0B,CAACuB,uBAAuB,CAACtK,UAAU,EAAEsK,uBAAuB,CAACrK,WAAW,EAAEqK,uBAAuB,CAACpK,SAAS,CAAC;QACjK,IAAI,CAAC+H,aAAa,EAAE;UAChB,OAAO,IAAI;QACf;QAAC,2CAC0BA,aAAa,CAACS,MAAM;UAAA;QAAA;UAA/C,oDAAiD;YAAA,IAAtCwB,YAAY;YACnByC,SAAS,GAAG1L,IAAI,CAACC,GAAG,CAACyL,SAAS,EAAE1L,IAAI,CAAC4L,KAAK,CAAC3C,YAAY,CAAClB,IAAI,CAAC,CAAC;YAC9D4D,OAAO,GAAG3L,IAAI,CAACE,GAAG,CAACyL,OAAO,EAAE3L,IAAI,CAAC4L,KAAK,CAAC3C,YAAY,CAAClB,IAAI,GAAGkB,YAAY,CAACvB,KAAK,CAAC,CAAC;UACnF;QAAC;UAAA;QAAA;UAAA;QAAA;MACL,CAAC,MACI;QAAA,4CACuB2B,uBAAuB,CAAC5J,UAAU;UAAA;QAAA;UAA1D,uDAA4D;YAAA,IAAjDM,SAAS;YAChB,IAAIA,SAAS,CAACL,eAAe,KAAKK,SAAS,CAACJ,aAAa,EAAE;cACvD,OAAO,IAAI;YACf;YACA,IAAMqH,cAAa,GAAG,IAAI,CAACc,0BAA0B,CAAC/H,SAAS,CAACL,eAAe,EAAEK,SAAS,CAACf,WAAW,EAAEe,SAAS,CAACd,SAAS,CAAC;YAC5H,IAAI,CAAC+H,cAAa,EAAE;cAChB,OAAO,IAAI;YACf;YAAC,4CAC0BA,cAAa,CAACS,MAAM;cAAA;YAAA;cAA/C,uDAAiD;gBAAA,IAAtCwB,aAAY;gBACnByC,SAAS,GAAG1L,IAAI,CAACC,GAAG,CAACyL,SAAS,EAAE1L,IAAI,CAAC4L,KAAK,CAAC3C,aAAY,CAAClB,IAAI,CAAC,CAAC;gBAC9D4D,OAAO,GAAG3L,IAAI,CAACE,GAAG,CAACyL,OAAO,EAAE3L,IAAI,CAAC4L,KAAK,CAAC3C,aAAY,CAAClB,IAAI,GAAGkB,aAAY,CAACvB,KAAK,CAAC,CAAC;cACnF;YAAC;cAAA;YAAA;cAAA;YAAA;UACL;QAAC;UAAA;QAAA;UAAA;QAAA;MACL;MACA,IAAI,CAAC2B,uBAAuB,CAACvK,aAAa,EAAE;QACxC4M,SAAS,GAAG1L,IAAI,CAACE,GAAG,CAAC,CAAC,EAAEwL,SAAS,GAAGvL,SAAS,CAAC0L,mBAAmB,CAAC;QAClEF,OAAO,IAAI,IAAI,CAAClK,6BAA6B;MACjD;MACA,IAAI4H,uBAAuB,CAAChK,IAAI,KAAK,YAAY,IAAIsM,OAAO,GAAGD,SAAS,GAAGnB,QAAQ,CAAC7C,KAAK,EAAE;QACvF,OAAO,IAAI;MACf;MACA,IAAM6B,aAAa,GAAG,IAAI,CAAC+B,wBAAwB,CAACE,cAAc,EAAEC,YAAY,EAAEC,SAAS,EAAEC,OAAO,CAAC;MACrG,OAAO;QACHhH,UAAU,EAAE4E,aAAa;QACzBE,mBAAmB,EAAEkC;MACzB,CAAC;IACL;EAAC;IAAA;IAAA,OACD,kCAAyBG,aAAa,EAAEC,WAAW,EAAEC,QAAQ,EAAEC,MAAM,EAAEC,aAAa,EAAEC,WAAW,EAAE;MAC/FL,aAAa,GAAGA,aAAa,GAAG,CAAC;MACjCC,WAAW,GAAGA,WAAW,GAAG,CAAC;MAC7BC,QAAQ,GAAGA,QAAQ,GAAG,CAAC;MACvBC,MAAM,GAAGA,MAAM,GAAG,CAAC;MACnBC,aAAa,GAAG,CAAC,CAACA,aAAa;MAC/BC,WAAW,GAAG,CAAC,CAACA,WAAW;MAC3B,IAAMC,cAAc,GAAGL,WAAW,GAAGD,aAAa;MAClD,IAAMO,SAAS,GAAGJ,MAAM,GAAGD,QAAQ;MACnC,IAAIK,SAAS,GAAGD,cAAc,EAAE;QAC5B;QACA,IAAIF,aAAa,EAAE;UACf,OAAOF,QAAQ;QACnB;QACA,IAAIG,WAAW,EAAE;UACb,OAAOnM,IAAI,CAACE,GAAG,CAAC,CAAC,EAAE+L,MAAM,GAAGG,cAAc,CAAC;QAC/C;QACA,IAAIJ,QAAQ,GAAGF,aAAa,EAAE;UAC1B;UACA,OAAOE,QAAQ;QACnB,CAAC,MACI,IAAIC,MAAM,GAAGF,WAAW,EAAE;UAC3B;UACA,OAAO/L,IAAI,CAACE,GAAG,CAAC,CAAC,EAAE+L,MAAM,GAAGG,cAAc,CAAC;QAC/C;MACJ,CAAC,MACI;QACD;QACA;QACA,OAAOJ,QAAQ;MACnB;MACA,OAAOF,aAAa;IACxB;EAAC;EAAA;AAAA,EAvlB0B9N,QAAQ;AAylBvC;AACA;AACA;AACAmC,SAAS,CAAC0L,mBAAmB,GAAG,EAAE"}]}