{"remainingRequest":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js!/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/editor/common/cursor/cursorWordOperations.js","dependencies":[{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/editor/common/cursor/cursorWordOperations.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/babel.config.js","mtime":1668271197000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9pbmhlcml0cyBmcm9tICIvVXNlcnMveWFuamlhamlhL0Rlc2t0b3Avd29ya3NwYWNlL2F2dWUtZGF0YS1uZXcvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzLmpzIjsKaW1wb3J0IF9jcmVhdGVTdXBlciBmcm9tICIvVXNlcnMveWFuamlhamlhL0Rlc2t0b3Avd29ya3NwYWNlL2F2dWUtZGF0YS1uZXcvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZVN1cGVyLmpzIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvVXNlcnMveWFuamlhamlhL0Rlc2t0b3Avd29ya3NwYWNlL2F2dWUtZGF0YS1uZXcvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrLmpzIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICIvVXNlcnMveWFuamlhamlhL0Rlc2t0b3Avd29ya3NwYWNlL2F2dWUtZGF0YS1uZXcvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc29ydC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwovKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogKiAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiAqICBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLgogKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi8KaW1wb3J0ICogYXMgc3RyaW5ncyBmcm9tICcuLi8uLi8uLi9iYXNlL2NvbW1vbi9zdHJpbmdzLmpzJzsKaW1wb3J0IHsgU2luZ2xlQ3Vyc29yU3RhdGUgfSBmcm9tICcuLi9jdXJzb3JDb21tb24uanMnOwppbXBvcnQgeyBEZWxldGVPcGVyYXRpb25zIH0gZnJvbSAnLi9jdXJzb3JEZWxldGVPcGVyYXRpb25zLmpzJzsKaW1wb3J0IHsgZ2V0TWFwRm9yV29yZFNlcGFyYXRvcnMgfSBmcm9tICcuLi9jb3JlL3dvcmRDaGFyYWN0ZXJDbGFzc2lmaWVyLmpzJzsKaW1wb3J0IHsgUG9zaXRpb24gfSBmcm9tICcuLi9jb3JlL3Bvc2l0aW9uLmpzJzsKaW1wb3J0IHsgUmFuZ2UgfSBmcm9tICcuLi9jb3JlL3JhbmdlLmpzJzsKZXhwb3J0IHZhciBXb3JkT3BlcmF0aW9ucyA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gV29yZE9wZXJhdGlvbnMoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgV29yZE9wZXJhdGlvbnMpOwogIH0KICBfY3JlYXRlQ2xhc3MoV29yZE9wZXJhdGlvbnMsIG51bGwsIFt7CiAgICBrZXk6ICJfY3JlYXRlV29yZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2NyZWF0ZVdvcmQobGluZUNvbnRlbnQsIHdvcmRUeXBlLCBuZXh0Q2hhckNsYXNzLCBzdGFydCwgZW5kKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKCdXT1JEID09PiAnICsgc3RhcnQgKyAnID0+ICcgKyBlbmQgKyAnOjo6OiA8PDwnICsgbGluZUNvbnRlbnQuc3Vic3RyaW5nKHN0YXJ0LCBlbmQpICsgJz4+PicpOwogICAgICByZXR1cm4gewogICAgICAgIHN0YXJ0OiBzdGFydCwKICAgICAgICBlbmQ6IGVuZCwKICAgICAgICB3b3JkVHlwZTogd29yZFR5cGUsCiAgICAgICAgbmV4dENoYXJDbGFzczogbmV4dENoYXJDbGFzcwogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogIl9maW5kUHJldmlvdXNXb3JkT25MaW5lIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZmluZFByZXZpb3VzV29yZE9uTGluZSh3b3JkU2VwYXJhdG9ycywgbW9kZWwsIHBvc2l0aW9uKSB7CiAgICAgIHZhciBsaW5lQ29udGVudCA9IG1vZGVsLmdldExpbmVDb250ZW50KHBvc2l0aW9uLmxpbmVOdW1iZXIpOwogICAgICByZXR1cm4gdGhpcy5fZG9GaW5kUHJldmlvdXNXb3JkT25MaW5lKGxpbmVDb250ZW50LCB3b3JkU2VwYXJhdG9ycywgcG9zaXRpb24pOwogICAgfQogIH0sIHsKICAgIGtleTogIl9kb0ZpbmRQcmV2aW91c1dvcmRPbkxpbmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9kb0ZpbmRQcmV2aW91c1dvcmRPbkxpbmUobGluZUNvbnRlbnQsIHdvcmRTZXBhcmF0b3JzLCBwb3NpdGlvbikgewogICAgICB2YXIgd29yZFR5cGUgPSAwIC8qIFdvcmRUeXBlLk5vbmUgKi87CiAgICAgIGZvciAodmFyIGNoSW5kZXggPSBwb3NpdGlvbi5jb2x1bW4gLSAyOyBjaEluZGV4ID49IDA7IGNoSW5kZXgtLSkgewogICAgICAgIHZhciBjaENvZGUgPSBsaW5lQ29udGVudC5jaGFyQ29kZUF0KGNoSW5kZXgpOwogICAgICAgIHZhciBjaENsYXNzID0gd29yZFNlcGFyYXRvcnMuZ2V0KGNoQ29kZSk7CiAgICAgICAgaWYgKGNoQ2xhc3MgPT09IDAgLyogV29yZENoYXJhY3RlckNsYXNzLlJlZ3VsYXIgKi8pIHsKICAgICAgICAgIGlmICh3b3JkVHlwZSA9PT0gMiAvKiBXb3JkVHlwZS5TZXBhcmF0b3IgKi8pIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NyZWF0ZVdvcmQobGluZUNvbnRlbnQsIHdvcmRUeXBlLCBjaENsYXNzLCBjaEluZGV4ICsgMSwgdGhpcy5fZmluZEVuZE9mV29yZChsaW5lQ29udGVudCwgd29yZFNlcGFyYXRvcnMsIHdvcmRUeXBlLCBjaEluZGV4ICsgMSkpOwogICAgICAgICAgfQogICAgICAgICAgd29yZFR5cGUgPSAxIC8qIFdvcmRUeXBlLlJlZ3VsYXIgKi87CiAgICAgICAgfSBlbHNlIGlmIChjaENsYXNzID09PSAyIC8qIFdvcmRDaGFyYWN0ZXJDbGFzcy5Xb3JkU2VwYXJhdG9yICovKSB7CiAgICAgICAgICBpZiAod29yZFR5cGUgPT09IDEgLyogV29yZFR5cGUuUmVndWxhciAqLykgewogICAgICAgICAgICByZXR1cm4gdGhpcy5fY3JlYXRlV29yZChsaW5lQ29udGVudCwgd29yZFR5cGUsIGNoQ2xhc3MsIGNoSW5kZXggKyAxLCB0aGlzLl9maW5kRW5kT2ZXb3JkKGxpbmVDb250ZW50LCB3b3JkU2VwYXJhdG9ycywgd29yZFR5cGUsIGNoSW5kZXggKyAxKSk7CiAgICAgICAgICB9CiAgICAgICAgICB3b3JkVHlwZSA9IDIgLyogV29yZFR5cGUuU2VwYXJhdG9yICovOwogICAgICAgIH0gZWxzZSBpZiAoY2hDbGFzcyA9PT0gMSAvKiBXb3JkQ2hhcmFjdGVyQ2xhc3MuV2hpdGVzcGFjZSAqLykgewogICAgICAgICAgaWYgKHdvcmRUeXBlICE9PSAwIC8qIFdvcmRUeXBlLk5vbmUgKi8pIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NyZWF0ZVdvcmQobGluZUNvbnRlbnQsIHdvcmRUeXBlLCBjaENsYXNzLCBjaEluZGV4ICsgMSwgdGhpcy5fZmluZEVuZE9mV29yZChsaW5lQ29udGVudCwgd29yZFNlcGFyYXRvcnMsIHdvcmRUeXBlLCBjaEluZGV4ICsgMSkpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBpZiAod29yZFR5cGUgIT09IDAgLyogV29yZFR5cGUuTm9uZSAqLykgewogICAgICAgIHJldHVybiB0aGlzLl9jcmVhdGVXb3JkKGxpbmVDb250ZW50LCB3b3JkVHlwZSwgMSAvKiBXb3JkQ2hhcmFjdGVyQ2xhc3MuV2hpdGVzcGFjZSAqLywgMCwgdGhpcy5fZmluZEVuZE9mV29yZChsaW5lQ29udGVudCwgd29yZFNlcGFyYXRvcnMsIHdvcmRUeXBlLCAwKSk7CiAgICAgIH0KICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgfSwgewogICAga2V5OiAiX2ZpbmRFbmRPZldvcmQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9maW5kRW5kT2ZXb3JkKGxpbmVDb250ZW50LCB3b3JkU2VwYXJhdG9ycywgd29yZFR5cGUsIHN0YXJ0SW5kZXgpIHsKICAgICAgdmFyIGxlbiA9IGxpbmVDb250ZW50Lmxlbmd0aDsKICAgICAgZm9yICh2YXIgY2hJbmRleCA9IHN0YXJ0SW5kZXg7IGNoSW5kZXggPCBsZW47IGNoSW5kZXgrKykgewogICAgICAgIHZhciBjaENvZGUgPSBsaW5lQ29udGVudC5jaGFyQ29kZUF0KGNoSW5kZXgpOwogICAgICAgIHZhciBjaENsYXNzID0gd29yZFNlcGFyYXRvcnMuZ2V0KGNoQ29kZSk7CiAgICAgICAgaWYgKGNoQ2xhc3MgPT09IDEgLyogV29yZENoYXJhY3RlckNsYXNzLldoaXRlc3BhY2UgKi8pIHsKICAgICAgICAgIHJldHVybiBjaEluZGV4OwogICAgICAgIH0KICAgICAgICBpZiAod29yZFR5cGUgPT09IDEgLyogV29yZFR5cGUuUmVndWxhciAqLyAmJiBjaENsYXNzID09PSAyIC8qIFdvcmRDaGFyYWN0ZXJDbGFzcy5Xb3JkU2VwYXJhdG9yICovKSB7CiAgICAgICAgICByZXR1cm4gY2hJbmRleDsKICAgICAgICB9CiAgICAgICAgaWYgKHdvcmRUeXBlID09PSAyIC8qIFdvcmRUeXBlLlNlcGFyYXRvciAqLyAmJiBjaENsYXNzID09PSAwIC8qIFdvcmRDaGFyYWN0ZXJDbGFzcy5SZWd1bGFyICovKSB7CiAgICAgICAgICByZXR1cm4gY2hJbmRleDsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGxlbjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfZmluZE5leHRXb3JkT25MaW5lIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZmluZE5leHRXb3JkT25MaW5lKHdvcmRTZXBhcmF0b3JzLCBtb2RlbCwgcG9zaXRpb24pIHsKICAgICAgdmFyIGxpbmVDb250ZW50ID0gbW9kZWwuZ2V0TGluZUNvbnRlbnQocG9zaXRpb24ubGluZU51bWJlcik7CiAgICAgIHJldHVybiB0aGlzLl9kb0ZpbmROZXh0V29yZE9uTGluZShsaW5lQ29udGVudCwgd29yZFNlcGFyYXRvcnMsIHBvc2l0aW9uKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfZG9GaW5kTmV4dFdvcmRPbkxpbmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9kb0ZpbmROZXh0V29yZE9uTGluZShsaW5lQ29udGVudCwgd29yZFNlcGFyYXRvcnMsIHBvc2l0aW9uKSB7CiAgICAgIHZhciB3b3JkVHlwZSA9IDAgLyogV29yZFR5cGUuTm9uZSAqLzsKICAgICAgdmFyIGxlbiA9IGxpbmVDb250ZW50Lmxlbmd0aDsKICAgICAgZm9yICh2YXIgY2hJbmRleCA9IHBvc2l0aW9uLmNvbHVtbiAtIDE7IGNoSW5kZXggPCBsZW47IGNoSW5kZXgrKykgewogICAgICAgIHZhciBjaENvZGUgPSBsaW5lQ29udGVudC5jaGFyQ29kZUF0KGNoSW5kZXgpOwogICAgICAgIHZhciBjaENsYXNzID0gd29yZFNlcGFyYXRvcnMuZ2V0KGNoQ29kZSk7CiAgICAgICAgaWYgKGNoQ2xhc3MgPT09IDAgLyogV29yZENoYXJhY3RlckNsYXNzLlJlZ3VsYXIgKi8pIHsKICAgICAgICAgIGlmICh3b3JkVHlwZSA9PT0gMiAvKiBXb3JkVHlwZS5TZXBhcmF0b3IgKi8pIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NyZWF0ZVdvcmQobGluZUNvbnRlbnQsIHdvcmRUeXBlLCBjaENsYXNzLCB0aGlzLl9maW5kU3RhcnRPZldvcmQobGluZUNvbnRlbnQsIHdvcmRTZXBhcmF0b3JzLCB3b3JkVHlwZSwgY2hJbmRleCAtIDEpLCBjaEluZGV4KTsKICAgICAgICAgIH0KICAgICAgICAgIHdvcmRUeXBlID0gMSAvKiBXb3JkVHlwZS5SZWd1bGFyICovOwogICAgICAgIH0gZWxzZSBpZiAoY2hDbGFzcyA9PT0gMiAvKiBXb3JkQ2hhcmFjdGVyQ2xhc3MuV29yZFNlcGFyYXRvciAqLykgewogICAgICAgICAgaWYgKHdvcmRUeXBlID09PSAxIC8qIFdvcmRUeXBlLlJlZ3VsYXIgKi8pIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NyZWF0ZVdvcmQobGluZUNvbnRlbnQsIHdvcmRUeXBlLCBjaENsYXNzLCB0aGlzLl9maW5kU3RhcnRPZldvcmQobGluZUNvbnRlbnQsIHdvcmRTZXBhcmF0b3JzLCB3b3JkVHlwZSwgY2hJbmRleCAtIDEpLCBjaEluZGV4KTsKICAgICAgICAgIH0KICAgICAgICAgIHdvcmRUeXBlID0gMiAvKiBXb3JkVHlwZS5TZXBhcmF0b3IgKi87CiAgICAgICAgfSBlbHNlIGlmIChjaENsYXNzID09PSAxIC8qIFdvcmRDaGFyYWN0ZXJDbGFzcy5XaGl0ZXNwYWNlICovKSB7CiAgICAgICAgICBpZiAod29yZFR5cGUgIT09IDAgLyogV29yZFR5cGUuTm9uZSAqLykgewogICAgICAgICAgICByZXR1cm4gdGhpcy5fY3JlYXRlV29yZChsaW5lQ29udGVudCwgd29yZFR5cGUsIGNoQ2xhc3MsIHRoaXMuX2ZpbmRTdGFydE9mV29yZChsaW5lQ29udGVudCwgd29yZFNlcGFyYXRvcnMsIHdvcmRUeXBlLCBjaEluZGV4IC0gMSksIGNoSW5kZXgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBpZiAod29yZFR5cGUgIT09IDAgLyogV29yZFR5cGUuTm9uZSAqLykgewogICAgICAgIHJldHVybiB0aGlzLl9jcmVhdGVXb3JkKGxpbmVDb250ZW50LCB3b3JkVHlwZSwgMSAvKiBXb3JkQ2hhcmFjdGVyQ2xhc3MuV2hpdGVzcGFjZSAqLywgdGhpcy5fZmluZFN0YXJ0T2ZXb3JkKGxpbmVDb250ZW50LCB3b3JkU2VwYXJhdG9ycywgd29yZFR5cGUsIGxlbiAtIDEpLCBsZW4pOwogICAgICB9CiAgICAgIHJldHVybiBudWxsOwogICAgfQogIH0sIHsKICAgIGtleTogIl9maW5kU3RhcnRPZldvcmQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9maW5kU3RhcnRPZldvcmQobGluZUNvbnRlbnQsIHdvcmRTZXBhcmF0b3JzLCB3b3JkVHlwZSwgc3RhcnRJbmRleCkgewogICAgICBmb3IgKHZhciBjaEluZGV4ID0gc3RhcnRJbmRleDsgY2hJbmRleCA+PSAwOyBjaEluZGV4LS0pIHsKICAgICAgICB2YXIgY2hDb2RlID0gbGluZUNvbnRlbnQuY2hhckNvZGVBdChjaEluZGV4KTsKICAgICAgICB2YXIgY2hDbGFzcyA9IHdvcmRTZXBhcmF0b3JzLmdldChjaENvZGUpOwogICAgICAgIGlmIChjaENsYXNzID09PSAxIC8qIFdvcmRDaGFyYWN0ZXJDbGFzcy5XaGl0ZXNwYWNlICovKSB7CiAgICAgICAgICByZXR1cm4gY2hJbmRleCArIDE7CiAgICAgICAgfQogICAgICAgIGlmICh3b3JkVHlwZSA9PT0gMSAvKiBXb3JkVHlwZS5SZWd1bGFyICovICYmIGNoQ2xhc3MgPT09IDIgLyogV29yZENoYXJhY3RlckNsYXNzLldvcmRTZXBhcmF0b3IgKi8pIHsKICAgICAgICAgIHJldHVybiBjaEluZGV4ICsgMTsKICAgICAgICB9CiAgICAgICAgaWYgKHdvcmRUeXBlID09PSAyIC8qIFdvcmRUeXBlLlNlcGFyYXRvciAqLyAmJiBjaENsYXNzID09PSAwIC8qIFdvcmRDaGFyYWN0ZXJDbGFzcy5SZWd1bGFyICovKSB7CiAgICAgICAgICByZXR1cm4gY2hJbmRleCArIDE7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiAwOwogICAgfQogIH0sIHsKICAgIGtleTogIm1vdmVXb3JkTGVmdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbW92ZVdvcmRMZWZ0KHdvcmRTZXBhcmF0b3JzLCBtb2RlbCwgcG9zaXRpb24sIHdvcmROYXZpZ2F0aW9uVHlwZSkgewogICAgICB2YXIgbGluZU51bWJlciA9IHBvc2l0aW9uLmxpbmVOdW1iZXI7CiAgICAgIHZhciBjb2x1bW4gPSBwb3NpdGlvbi5jb2x1bW47CiAgICAgIGlmIChjb2x1bW4gPT09IDEpIHsKICAgICAgICBpZiAobGluZU51bWJlciA+IDEpIHsKICAgICAgICAgIGxpbmVOdW1iZXIgPSBsaW5lTnVtYmVyIC0gMTsKICAgICAgICAgIGNvbHVtbiA9IG1vZGVsLmdldExpbmVNYXhDb2x1bW4obGluZU51bWJlcik7CiAgICAgICAgfQogICAgICB9CiAgICAgIHZhciBwcmV2V29yZE9uTGluZSA9IFdvcmRPcGVyYXRpb25zLl9maW5kUHJldmlvdXNXb3JkT25MaW5lKHdvcmRTZXBhcmF0b3JzLCBtb2RlbCwgbmV3IFBvc2l0aW9uKGxpbmVOdW1iZXIsIGNvbHVtbikpOwogICAgICBpZiAod29yZE5hdmlnYXRpb25UeXBlID09PSAwIC8qIFdvcmROYXZpZ2F0aW9uVHlwZS5Xb3JkU3RhcnQgKi8pIHsKICAgICAgICByZXR1cm4gbmV3IFBvc2l0aW9uKGxpbmVOdW1iZXIsIHByZXZXb3JkT25MaW5lID8gcHJldldvcmRPbkxpbmUuc3RhcnQgKyAxIDogMSk7CiAgICAgIH0KICAgICAgaWYgKHdvcmROYXZpZ2F0aW9uVHlwZSA9PT0gMSAvKiBXb3JkTmF2aWdhdGlvblR5cGUuV29yZFN0YXJ0RmFzdCAqLykgewogICAgICAgIGlmIChwcmV2V29yZE9uTGluZSAmJiBwcmV2V29yZE9uTGluZS53b3JkVHlwZSA9PT0gMiAvKiBXb3JkVHlwZS5TZXBhcmF0b3IgKi8gJiYgcHJldldvcmRPbkxpbmUuZW5kIC0gcHJldldvcmRPbkxpbmUuc3RhcnQgPT09IDEgJiYgcHJldldvcmRPbkxpbmUubmV4dENoYXJDbGFzcyA9PT0gMCAvKiBXb3JkQ2hhcmFjdGVyQ2xhc3MuUmVndWxhciAqLykgewogICAgICAgICAgLy8gU2tpcCBvdmVyIGEgd29yZCBtYWRlIHVwIG9mIG9uZSBzaW5nbGUgc2VwYXJhdG9yIGFuZCBmb2xsb3dlZCBieSBhIHJlZ3VsYXIgY2hhcmFjdGVyCiAgICAgICAgICBwcmV2V29yZE9uTGluZSA9IFdvcmRPcGVyYXRpb25zLl9maW5kUHJldmlvdXNXb3JkT25MaW5lKHdvcmRTZXBhcmF0b3JzLCBtb2RlbCwgbmV3IFBvc2l0aW9uKGxpbmVOdW1iZXIsIHByZXZXb3JkT25MaW5lLnN0YXJ0ICsgMSkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbmV3IFBvc2l0aW9uKGxpbmVOdW1iZXIsIHByZXZXb3JkT25MaW5lID8gcHJldldvcmRPbkxpbmUuc3RhcnQgKyAxIDogMSk7CiAgICAgIH0KICAgICAgaWYgKHdvcmROYXZpZ2F0aW9uVHlwZSA9PT0gMyAvKiBXb3JkTmF2aWdhdGlvblR5cGUuV29yZEFjY2Vzc2liaWxpdHkgKi8pIHsKICAgICAgICB3aGlsZSAocHJldldvcmRPbkxpbmUgJiYgcHJldldvcmRPbkxpbmUud29yZFR5cGUgPT09IDIgLyogV29yZFR5cGUuU2VwYXJhdG9yICovKSB7CiAgICAgICAgICAvLyBTa2lwIG92ZXIgd29yZHMgbWFkZSB1cCBvZiBvbmx5IHNlcGFyYXRvcnMKICAgICAgICAgIHByZXZXb3JkT25MaW5lID0gV29yZE9wZXJhdGlvbnMuX2ZpbmRQcmV2aW91c1dvcmRPbkxpbmUod29yZFNlcGFyYXRvcnMsIG1vZGVsLCBuZXcgUG9zaXRpb24obGluZU51bWJlciwgcHJldldvcmRPbkxpbmUuc3RhcnQgKyAxKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBuZXcgUG9zaXRpb24obGluZU51bWJlciwgcHJldldvcmRPbkxpbmUgPyBwcmV2V29yZE9uTGluZS5zdGFydCArIDEgOiAxKTsKICAgICAgfQogICAgICAvLyBXZSBhcmUgc3RvcHBpbmcgYXQgdGhlIGVuZGluZyBvZiB3b3JkcwogICAgICBpZiAocHJldldvcmRPbkxpbmUgJiYgY29sdW1uIDw9IHByZXZXb3JkT25MaW5lLmVuZCArIDEpIHsKICAgICAgICBwcmV2V29yZE9uTGluZSA9IFdvcmRPcGVyYXRpb25zLl9maW5kUHJldmlvdXNXb3JkT25MaW5lKHdvcmRTZXBhcmF0b3JzLCBtb2RlbCwgbmV3IFBvc2l0aW9uKGxpbmVOdW1iZXIsIHByZXZXb3JkT25MaW5lLnN0YXJ0ICsgMSkpOwogICAgICB9CiAgICAgIHJldHVybiBuZXcgUG9zaXRpb24obGluZU51bWJlciwgcHJldldvcmRPbkxpbmUgPyBwcmV2V29yZE9uTGluZS5lbmQgKyAxIDogMSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX21vdmVXb3JkUGFydExlZnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9tb3ZlV29yZFBhcnRMZWZ0KG1vZGVsLCBwb3NpdGlvbikgewogICAgICB2YXIgbGluZU51bWJlciA9IHBvc2l0aW9uLmxpbmVOdW1iZXI7CiAgICAgIHZhciBtYXhDb2x1bW4gPSBtb2RlbC5nZXRMaW5lTWF4Q29sdW1uKGxpbmVOdW1iZXIpOwogICAgICBpZiAocG9zaXRpb24uY29sdW1uID09PSAxKSB7CiAgICAgICAgcmV0dXJuIGxpbmVOdW1iZXIgPiAxID8gbmV3IFBvc2l0aW9uKGxpbmVOdW1iZXIgLSAxLCBtb2RlbC5nZXRMaW5lTWF4Q29sdW1uKGxpbmVOdW1iZXIgLSAxKSkgOiBwb3NpdGlvbjsKICAgICAgfQogICAgICB2YXIgbGluZUNvbnRlbnQgPSBtb2RlbC5nZXRMaW5lQ29udGVudChsaW5lTnVtYmVyKTsKICAgICAgZm9yICh2YXIgY29sdW1uID0gcG9zaXRpb24uY29sdW1uIC0gMTsgY29sdW1uID4gMTsgY29sdW1uLS0pIHsKICAgICAgICB2YXIgbGVmdCA9IGxpbmVDb250ZW50LmNoYXJDb2RlQXQoY29sdW1uIC0gMik7CiAgICAgICAgdmFyIHJpZ2h0ID0gbGluZUNvbnRlbnQuY2hhckNvZGVBdChjb2x1bW4gLSAxKTsKICAgICAgICBpZiAobGVmdCA9PT0gOTUgLyogQ2hhckNvZGUuVW5kZXJsaW5lICovICYmIHJpZ2h0ICE9PSA5NSAvKiBDaGFyQ29kZS5VbmRlcmxpbmUgKi8pIHsKICAgICAgICAgIC8vIHNuYWtlX2Nhc2VfdmFyaWFibGVzCiAgICAgICAgICByZXR1cm4gbmV3IFBvc2l0aW9uKGxpbmVOdW1iZXIsIGNvbHVtbik7CiAgICAgICAgfQogICAgICAgIGlmICgoc3RyaW5ncy5pc0xvd2VyQXNjaWlMZXR0ZXIobGVmdCkgfHwgc3RyaW5ncy5pc0FzY2lpRGlnaXQobGVmdCkpICYmIHN0cmluZ3MuaXNVcHBlckFzY2lpTGV0dGVyKHJpZ2h0KSkgewogICAgICAgICAgLy8gY2FtZWxDYXNlVmFyaWFibGVzCiAgICAgICAgICByZXR1cm4gbmV3IFBvc2l0aW9uKGxpbmVOdW1iZXIsIGNvbHVtbik7CiAgICAgICAgfQogICAgICAgIGlmIChzdHJpbmdzLmlzVXBwZXJBc2NpaUxldHRlcihsZWZ0KSAmJiBzdHJpbmdzLmlzVXBwZXJBc2NpaUxldHRlcihyaWdodCkpIHsKICAgICAgICAgIC8vIHRoaXNJc0FDYW1lbENhc2VXaXRoT25lTGV0dGVyV29yZHMKICAgICAgICAgIGlmIChjb2x1bW4gKyAxIDwgbWF4Q29sdW1uKSB7CiAgICAgICAgICAgIHZhciByaWdodFJpZ2h0ID0gbGluZUNvbnRlbnQuY2hhckNvZGVBdChjb2x1bW4pOwogICAgICAgICAgICBpZiAoc3RyaW5ncy5pc0xvd2VyQXNjaWlMZXR0ZXIocmlnaHRSaWdodCkgfHwgc3RyaW5ncy5pc0FzY2lpRGlnaXQocmlnaHRSaWdodCkpIHsKICAgICAgICAgICAgICByZXR1cm4gbmV3IFBvc2l0aW9uKGxpbmVOdW1iZXIsIGNvbHVtbik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIG5ldyBQb3NpdGlvbihsaW5lTnVtYmVyLCAxKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJtb3ZlV29yZFJpZ2h0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtb3ZlV29yZFJpZ2h0KHdvcmRTZXBhcmF0b3JzLCBtb2RlbCwgcG9zaXRpb24sIHdvcmROYXZpZ2F0aW9uVHlwZSkgewogICAgICB2YXIgbGluZU51bWJlciA9IHBvc2l0aW9uLmxpbmVOdW1iZXI7CiAgICAgIHZhciBjb2x1bW4gPSBwb3NpdGlvbi5jb2x1bW47CiAgICAgIHZhciBtb3ZlZERvd24gPSBmYWxzZTsKICAgICAgaWYgKGNvbHVtbiA9PT0gbW9kZWwuZ2V0TGluZU1heENvbHVtbihsaW5lTnVtYmVyKSkgewogICAgICAgIGlmIChsaW5lTnVtYmVyIDwgbW9kZWwuZ2V0TGluZUNvdW50KCkpIHsKICAgICAgICAgIG1vdmVkRG93biA9IHRydWU7CiAgICAgICAgICBsaW5lTnVtYmVyID0gbGluZU51bWJlciArIDE7CiAgICAgICAgICBjb2x1bW4gPSAxOwogICAgICAgIH0KICAgICAgfQogICAgICB2YXIgbmV4dFdvcmRPbkxpbmUgPSBXb3JkT3BlcmF0aW9ucy5fZmluZE5leHRXb3JkT25MaW5lKHdvcmRTZXBhcmF0b3JzLCBtb2RlbCwgbmV3IFBvc2l0aW9uKGxpbmVOdW1iZXIsIGNvbHVtbikpOwogICAgICBpZiAod29yZE5hdmlnYXRpb25UeXBlID09PSAyIC8qIFdvcmROYXZpZ2F0aW9uVHlwZS5Xb3JkRW5kICovKSB7CiAgICAgICAgaWYgKG5leHRXb3JkT25MaW5lICYmIG5leHRXb3JkT25MaW5lLndvcmRUeXBlID09PSAyIC8qIFdvcmRUeXBlLlNlcGFyYXRvciAqLykgewogICAgICAgICAgaWYgKG5leHRXb3JkT25MaW5lLmVuZCAtIG5leHRXb3JkT25MaW5lLnN0YXJ0ID09PSAxICYmIG5leHRXb3JkT25MaW5lLm5leHRDaGFyQ2xhc3MgPT09IDAgLyogV29yZENoYXJhY3RlckNsYXNzLlJlZ3VsYXIgKi8pIHsKICAgICAgICAgICAgLy8gU2tpcCBvdmVyIGEgd29yZCBtYWRlIHVwIG9mIG9uZSBzaW5nbGUgc2VwYXJhdG9yIGFuZCBmb2xsb3dlZCBieSBhIHJlZ3VsYXIgY2hhcmFjdGVyCiAgICAgICAgICAgIG5leHRXb3JkT25MaW5lID0gV29yZE9wZXJhdGlvbnMuX2ZpbmROZXh0V29yZE9uTGluZSh3b3JkU2VwYXJhdG9ycywgbW9kZWwsIG5ldyBQb3NpdGlvbihsaW5lTnVtYmVyLCBuZXh0V29yZE9uTGluZS5lbmQgKyAxKSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChuZXh0V29yZE9uTGluZSkgewogICAgICAgICAgY29sdW1uID0gbmV4dFdvcmRPbkxpbmUuZW5kICsgMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29sdW1uID0gbW9kZWwuZ2V0TGluZU1heENvbHVtbihsaW5lTnVtYmVyKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAod29yZE5hdmlnYXRpb25UeXBlID09PSAzIC8qIFdvcmROYXZpZ2F0aW9uVHlwZS5Xb3JkQWNjZXNzaWJpbGl0eSAqLykgewogICAgICAgIGlmIChtb3ZlZERvd24pIHsKICAgICAgICAgIC8vIElmIHdlIG1vdmUgdG8gdGhlIG5leHQgbGluZSwgcHJldGVuZCB0aGF0IHRoZSBjdXJzb3IgaXMgcmlnaHQgYmVmb3JlIHRoZSBmaXJzdCBjaGFyYWN0ZXIuCiAgICAgICAgICAvLyBUaGlzIGlzIG5lZWRlZCB3aGVuIHRoZSBmaXJzdCB3b3JkIHN0YXJ0cyByaWdodCBhdCB0aGUgZmlyc3QgY2hhcmFjdGVyIC0gYW5kIGluIG9yZGVyIG5vdCB0byBtaXNzIGl0LAogICAgICAgICAgLy8gd2UgbmVlZCB0byBzdGFydCBiZWZvcmUuCiAgICAgICAgICBjb2x1bW4gPSAwOwogICAgICAgIH0KICAgICAgICB3aGlsZSAobmV4dFdvcmRPbkxpbmUgJiYgKG5leHRXb3JkT25MaW5lLndvcmRUeXBlID09PSAyIC8qIFdvcmRUeXBlLlNlcGFyYXRvciAqLyB8fCBuZXh0V29yZE9uTGluZS5zdGFydCArIDEgPD0gY29sdW1uKSkgewogICAgICAgICAgLy8gU2tpcCBvdmVyIGEgd29yZCBtYWRlIHVwIG9mIG9uZSBzaW5nbGUgc2VwYXJhdG9yCiAgICAgICAgICAvLyBBbHNvIHNraXAgb3ZlciB3b3JkIGlmIGl0IGJlZ2lucyBiZWZvcmUgY3VycmVudCBjdXJzb3IgcG9zaXRpb24gdG8gYXNjZXJ0YWluIHdlJ3JlIG1vdmluZyBmb3J3YXJkIGF0IGxlYXN0IDEgY2hhcmFjdGVyLgogICAgICAgICAgbmV4dFdvcmRPbkxpbmUgPSBXb3JkT3BlcmF0aW9ucy5fZmluZE5leHRXb3JkT25MaW5lKHdvcmRTZXBhcmF0b3JzLCBtb2RlbCwgbmV3IFBvc2l0aW9uKGxpbmVOdW1iZXIsIG5leHRXb3JkT25MaW5lLmVuZCArIDEpKTsKICAgICAgICB9CiAgICAgICAgaWYgKG5leHRXb3JkT25MaW5lKSB7CiAgICAgICAgICBjb2x1bW4gPSBuZXh0V29yZE9uTGluZS5zdGFydCArIDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbHVtbiA9IG1vZGVsLmdldExpbmVNYXhDb2x1bW4obGluZU51bWJlcik7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmIChuZXh0V29yZE9uTGluZSAmJiAhbW92ZWREb3duICYmIGNvbHVtbiA+PSBuZXh0V29yZE9uTGluZS5zdGFydCArIDEpIHsKICAgICAgICAgIG5leHRXb3JkT25MaW5lID0gV29yZE9wZXJhdGlvbnMuX2ZpbmROZXh0V29yZE9uTGluZSh3b3JkU2VwYXJhdG9ycywgbW9kZWwsIG5ldyBQb3NpdGlvbihsaW5lTnVtYmVyLCBuZXh0V29yZE9uTGluZS5lbmQgKyAxKSk7CiAgICAgICAgfQogICAgICAgIGlmIChuZXh0V29yZE9uTGluZSkgewogICAgICAgICAgY29sdW1uID0gbmV4dFdvcmRPbkxpbmUuc3RhcnQgKyAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb2x1bW4gPSBtb2RlbC5nZXRMaW5lTWF4Q29sdW1uKGxpbmVOdW1iZXIpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gbmV3IFBvc2l0aW9uKGxpbmVOdW1iZXIsIGNvbHVtbik7CiAgICB9CiAgfSwgewogICAga2V5OiAiX21vdmVXb3JkUGFydFJpZ2h0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfbW92ZVdvcmRQYXJ0UmlnaHQobW9kZWwsIHBvc2l0aW9uKSB7CiAgICAgIHZhciBsaW5lTnVtYmVyID0gcG9zaXRpb24ubGluZU51bWJlcjsKICAgICAgdmFyIG1heENvbHVtbiA9IG1vZGVsLmdldExpbmVNYXhDb2x1bW4obGluZU51bWJlcik7CiAgICAgIGlmIChwb3NpdGlvbi5jb2x1bW4gPT09IG1heENvbHVtbikgewogICAgICAgIHJldHVybiBsaW5lTnVtYmVyIDwgbW9kZWwuZ2V0TGluZUNvdW50KCkgPyBuZXcgUG9zaXRpb24obGluZU51bWJlciArIDEsIDEpIDogcG9zaXRpb247CiAgICAgIH0KICAgICAgdmFyIGxpbmVDb250ZW50ID0gbW9kZWwuZ2V0TGluZUNvbnRlbnQobGluZU51bWJlcik7CiAgICAgIGZvciAodmFyIGNvbHVtbiA9IHBvc2l0aW9uLmNvbHVtbiArIDE7IGNvbHVtbiA8IG1heENvbHVtbjsgY29sdW1uKyspIHsKICAgICAgICB2YXIgbGVmdCA9IGxpbmVDb250ZW50LmNoYXJDb2RlQXQoY29sdW1uIC0gMik7CiAgICAgICAgdmFyIHJpZ2h0ID0gbGluZUNvbnRlbnQuY2hhckNvZGVBdChjb2x1bW4gLSAxKTsKICAgICAgICBpZiAobGVmdCAhPT0gOTUgLyogQ2hhckNvZGUuVW5kZXJsaW5lICovICYmIHJpZ2h0ID09PSA5NSAvKiBDaGFyQ29kZS5VbmRlcmxpbmUgKi8pIHsKICAgICAgICAgIC8vIHNuYWtlX2Nhc2VfdmFyaWFibGVzCiAgICAgICAgICByZXR1cm4gbmV3IFBvc2l0aW9uKGxpbmVOdW1iZXIsIGNvbHVtbik7CiAgICAgICAgfQogICAgICAgIGlmICgoc3RyaW5ncy5pc0xvd2VyQXNjaWlMZXR0ZXIobGVmdCkgfHwgc3RyaW5ncy5pc0FzY2lpRGlnaXQobGVmdCkpICYmIHN0cmluZ3MuaXNVcHBlckFzY2lpTGV0dGVyKHJpZ2h0KSkgewogICAgICAgICAgLy8gY2FtZWxDYXNlVmFyaWFibGVzCiAgICAgICAgICByZXR1cm4gbmV3IFBvc2l0aW9uKGxpbmVOdW1iZXIsIGNvbHVtbik7CiAgICAgICAgfQogICAgICAgIGlmIChzdHJpbmdzLmlzVXBwZXJBc2NpaUxldHRlcihsZWZ0KSAmJiBzdHJpbmdzLmlzVXBwZXJBc2NpaUxldHRlcihyaWdodCkpIHsKICAgICAgICAgIC8vIHRoaXNJc0FDYW1lbENhc2VXaXRoT25lTGV0dGVyV29yZHMKICAgICAgICAgIGlmIChjb2x1bW4gKyAxIDwgbWF4Q29sdW1uKSB7CiAgICAgICAgICAgIHZhciByaWdodFJpZ2h0ID0gbGluZUNvbnRlbnQuY2hhckNvZGVBdChjb2x1bW4pOwogICAgICAgICAgICBpZiAoc3RyaW5ncy5pc0xvd2VyQXNjaWlMZXR0ZXIocmlnaHRSaWdodCkgfHwgc3RyaW5ncy5pc0FzY2lpRGlnaXQocmlnaHRSaWdodCkpIHsKICAgICAgICAgICAgICByZXR1cm4gbmV3IFBvc2l0aW9uKGxpbmVOdW1iZXIsIGNvbHVtbik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIG5ldyBQb3NpdGlvbihsaW5lTnVtYmVyLCBtYXhDb2x1bW4pOwogICAgfQogIH0sIHsKICAgIGtleTogIl9kZWxldGVXb3JkTGVmdFdoaXRlc3BhY2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxldGVXb3JkTGVmdFdoaXRlc3BhY2UobW9kZWwsIHBvc2l0aW9uKSB7CiAgICAgIHZhciBsaW5lQ29udGVudCA9IG1vZGVsLmdldExpbmVDb250ZW50KHBvc2l0aW9uLmxpbmVOdW1iZXIpOwogICAgICB2YXIgc3RhcnRJbmRleCA9IHBvc2l0aW9uLmNvbHVtbiAtIDI7CiAgICAgIHZhciBsYXN0Tm9uV2hpdGVzcGFjZSA9IHN0cmluZ3MubGFzdE5vbldoaXRlc3BhY2VJbmRleChsaW5lQ29udGVudCwgc3RhcnRJbmRleCk7CiAgICAgIGlmIChsYXN0Tm9uV2hpdGVzcGFjZSArIDEgPCBzdGFydEluZGV4KSB7CiAgICAgICAgcmV0dXJuIG5ldyBSYW5nZShwb3NpdGlvbi5saW5lTnVtYmVyLCBsYXN0Tm9uV2hpdGVzcGFjZSArIDIsIHBvc2l0aW9uLmxpbmVOdW1iZXIsIHBvc2l0aW9uLmNvbHVtbik7CiAgICAgIH0KICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGVsZXRlV29yZExlZnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRlbGV0ZVdvcmRMZWZ0KGN0eCwgd29yZE5hdmlnYXRpb25UeXBlKSB7CiAgICAgIHZhciB3b3JkU2VwYXJhdG9ycyA9IGN0eC53b3JkU2VwYXJhdG9yczsKICAgICAgdmFyIG1vZGVsID0gY3R4Lm1vZGVsOwogICAgICB2YXIgc2VsZWN0aW9uID0gY3R4LnNlbGVjdGlvbjsKICAgICAgdmFyIHdoaXRlc3BhY2VIZXVyaXN0aWNzID0gY3R4LndoaXRlc3BhY2VIZXVyaXN0aWNzOwogICAgICBpZiAoIXNlbGVjdGlvbi5pc0VtcHR5KCkpIHsKICAgICAgICByZXR1cm4gc2VsZWN0aW9uOwogICAgICB9CiAgICAgIGlmIChEZWxldGVPcGVyYXRpb25zLmlzQXV0b0Nsb3NpbmdQYWlyRGVsZXRlKGN0eC5hdXRvQ2xvc2luZ0RlbGV0ZSwgY3R4LmF1dG9DbG9zaW5nQnJhY2tldHMsIGN0eC5hdXRvQ2xvc2luZ1F1b3RlcywgY3R4LmF1dG9DbG9zaW5nUGFpcnMuYXV0b0Nsb3NpbmdQYWlyc09wZW5CeUVuZCwgY3R4Lm1vZGVsLCBbY3R4LnNlbGVjdGlvbl0sIGN0eC5hdXRvQ2xvc2VkQ2hhcmFjdGVycykpIHsKICAgICAgICB2YXIgX3Bvc2l0aW9uID0gY3R4LnNlbGVjdGlvbi5nZXRQb3NpdGlvbigpOwogICAgICAgIHJldHVybiBuZXcgUmFuZ2UoX3Bvc2l0aW9uLmxpbmVOdW1iZXIsIF9wb3NpdGlvbi5jb2x1bW4gLSAxLCBfcG9zaXRpb24ubGluZU51bWJlciwgX3Bvc2l0aW9uLmNvbHVtbiArIDEpOwogICAgICB9CiAgICAgIHZhciBwb3NpdGlvbiA9IG5ldyBQb3NpdGlvbihzZWxlY3Rpb24ucG9zaXRpb25MaW5lTnVtYmVyLCBzZWxlY3Rpb24ucG9zaXRpb25Db2x1bW4pOwogICAgICB2YXIgbGluZU51bWJlciA9IHBvc2l0aW9uLmxpbmVOdW1iZXI7CiAgICAgIHZhciBjb2x1bW4gPSBwb3NpdGlvbi5jb2x1bW47CiAgICAgIGlmIChsaW5lTnVtYmVyID09PSAxICYmIGNvbHVtbiA9PT0gMSkgewogICAgICAgIC8vIElnbm9yZSBkZWxldGluZyBhdCBiZWdpbm5pbmcgb2YgZmlsZQogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICAgIGlmICh3aGl0ZXNwYWNlSGV1cmlzdGljcykgewogICAgICAgIHZhciByID0gdGhpcy5fZGVsZXRlV29yZExlZnRXaGl0ZXNwYWNlKG1vZGVsLCBwb3NpdGlvbik7CiAgICAgICAgaWYgKHIpIHsKICAgICAgICAgIHJldHVybiByOwogICAgICAgIH0KICAgICAgfQogICAgICB2YXIgcHJldldvcmRPbkxpbmUgPSBXb3JkT3BlcmF0aW9ucy5fZmluZFByZXZpb3VzV29yZE9uTGluZSh3b3JkU2VwYXJhdG9ycywgbW9kZWwsIHBvc2l0aW9uKTsKICAgICAgaWYgKHdvcmROYXZpZ2F0aW9uVHlwZSA9PT0gMCAvKiBXb3JkTmF2aWdhdGlvblR5cGUuV29yZFN0YXJ0ICovKSB7CiAgICAgICAgaWYgKHByZXZXb3JkT25MaW5lKSB7CiAgICAgICAgICBjb2x1bW4gPSBwcmV2V29yZE9uTGluZS5zdGFydCArIDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChjb2x1bW4gPiAxKSB7CiAgICAgICAgICAgIGNvbHVtbiA9IDE7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsaW5lTnVtYmVyLS07CiAgICAgICAgICAgIGNvbHVtbiA9IG1vZGVsLmdldExpbmVNYXhDb2x1bW4obGluZU51bWJlcik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmIChwcmV2V29yZE9uTGluZSAmJiBjb2x1bW4gPD0gcHJldldvcmRPbkxpbmUuZW5kICsgMSkgewogICAgICAgICAgcHJldldvcmRPbkxpbmUgPSBXb3JkT3BlcmF0aW9ucy5fZmluZFByZXZpb3VzV29yZE9uTGluZSh3b3JkU2VwYXJhdG9ycywgbW9kZWwsIG5ldyBQb3NpdGlvbihsaW5lTnVtYmVyLCBwcmV2V29yZE9uTGluZS5zdGFydCArIDEpKTsKICAgICAgICB9CiAgICAgICAgaWYgKHByZXZXb3JkT25MaW5lKSB7CiAgICAgICAgICBjb2x1bW4gPSBwcmV2V29yZE9uTGluZS5lbmQgKyAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAoY29sdW1uID4gMSkgewogICAgICAgICAgICBjb2x1bW4gPSAxOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbGluZU51bWJlci0tOwogICAgICAgICAgICBjb2x1bW4gPSBtb2RlbC5nZXRMaW5lTWF4Q29sdW1uKGxpbmVOdW1iZXIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gbmV3IFJhbmdlKGxpbmVOdW1iZXIsIGNvbHVtbiwgcG9zaXRpb24ubGluZU51bWJlciwgcG9zaXRpb24uY29sdW1uKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkZWxldGVJbnNpZGVXb3JkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkZWxldGVJbnNpZGVXb3JkKHdvcmRTZXBhcmF0b3JzLCBtb2RlbCwgc2VsZWN0aW9uKSB7CiAgICAgIGlmICghc2VsZWN0aW9uLmlzRW1wdHkoKSkgewogICAgICAgIHJldHVybiBzZWxlY3Rpb247CiAgICAgIH0KICAgICAgdmFyIHBvc2l0aW9uID0gbmV3IFBvc2l0aW9uKHNlbGVjdGlvbi5wb3NpdGlvbkxpbmVOdW1iZXIsIHNlbGVjdGlvbi5wb3NpdGlvbkNvbHVtbik7CiAgICAgIHZhciByID0gdGhpcy5fZGVsZXRlSW5zaWRlV29yZFdoaXRlc3BhY2UobW9kZWwsIHBvc2l0aW9uKTsKICAgICAgaWYgKHIpIHsKICAgICAgICByZXR1cm4gcjsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5fZGVsZXRlSW5zaWRlV29yZERldGVybWluZURlbGV0ZVJhbmdlKHdvcmRTZXBhcmF0b3JzLCBtb2RlbCwgcG9zaXRpb24pOwogICAgfQogIH0sIHsKICAgIGtleTogIl9jaGFyQXRJc1doaXRlc3BhY2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9jaGFyQXRJc1doaXRlc3BhY2Uoc3RyLCBpbmRleCkgewogICAgICB2YXIgY2hhckNvZGUgPSBzdHIuY2hhckNvZGVBdChpbmRleCk7CiAgICAgIHJldHVybiBjaGFyQ29kZSA9PT0gMzIgLyogQ2hhckNvZGUuU3BhY2UgKi8gfHwgY2hhckNvZGUgPT09IDkgLyogQ2hhckNvZGUuVGFiICovOwogICAgfQogIH0sIHsKICAgIGtleTogIl9kZWxldGVJbnNpZGVXb3JkV2hpdGVzcGFjZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGV0ZUluc2lkZVdvcmRXaGl0ZXNwYWNlKG1vZGVsLCBwb3NpdGlvbikgewogICAgICB2YXIgbGluZUNvbnRlbnQgPSBtb2RlbC5nZXRMaW5lQ29udGVudChwb3NpdGlvbi5saW5lTnVtYmVyKTsKICAgICAgdmFyIGxpbmVDb250ZW50TGVuZ3RoID0gbGluZUNvbnRlbnQubGVuZ3RoOwogICAgICBpZiAobGluZUNvbnRlbnRMZW5ndGggPT09IDApIHsKICAgICAgICAvLyBlbXB0eSBsaW5lCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgICAgdmFyIGxlZnRJbmRleCA9IE1hdGgubWF4KHBvc2l0aW9uLmNvbHVtbiAtIDIsIDApOwogICAgICBpZiAoIXRoaXMuX2NoYXJBdElzV2hpdGVzcGFjZShsaW5lQ29udGVudCwgbGVmdEluZGV4KSkgewogICAgICAgIC8vIHRvdWNoZXMgYSBub24td2hpdGVzcGFjZSBjaGFyYWN0ZXIgdG8gdGhlIGxlZnQKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgICB2YXIgcmlnaHRJbmRleCA9IE1hdGgubWluKHBvc2l0aW9uLmNvbHVtbiAtIDEsIGxpbmVDb250ZW50TGVuZ3RoIC0gMSk7CiAgICAgIGlmICghdGhpcy5fY2hhckF0SXNXaGl0ZXNwYWNlKGxpbmVDb250ZW50LCByaWdodEluZGV4KSkgewogICAgICAgIC8vIHRvdWNoZXMgYSBub24td2hpdGVzcGFjZSBjaGFyYWN0ZXIgdG8gdGhlIHJpZ2h0CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgICAgLy8gd2FsayBvdmVyIHdoaXRlc3BhY2UgdG8gdGhlIGxlZnQKICAgICAgd2hpbGUgKGxlZnRJbmRleCA+IDAgJiYgdGhpcy5fY2hhckF0SXNXaGl0ZXNwYWNlKGxpbmVDb250ZW50LCBsZWZ0SW5kZXggLSAxKSkgewogICAgICAgIGxlZnRJbmRleC0tOwogICAgICB9CiAgICAgIC8vIHdhbGsgb3ZlciB3aGl0ZXNwYWNlIHRvIHRoZSByaWdodAogICAgICB3aGlsZSAocmlnaHRJbmRleCArIDEgPCBsaW5lQ29udGVudExlbmd0aCAmJiB0aGlzLl9jaGFyQXRJc1doaXRlc3BhY2UobGluZUNvbnRlbnQsIHJpZ2h0SW5kZXggKyAxKSkgewogICAgICAgIHJpZ2h0SW5kZXgrKzsKICAgICAgfQogICAgICByZXR1cm4gbmV3IFJhbmdlKHBvc2l0aW9uLmxpbmVOdW1iZXIsIGxlZnRJbmRleCArIDEsIHBvc2l0aW9uLmxpbmVOdW1iZXIsIHJpZ2h0SW5kZXggKyAyKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfZGVsZXRlSW5zaWRlV29yZERldGVybWluZURlbGV0ZVJhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlSW5zaWRlV29yZERldGVybWluZURlbGV0ZVJhbmdlKHdvcmRTZXBhcmF0b3JzLCBtb2RlbCwgcG9zaXRpb24pIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIGxpbmVDb250ZW50ID0gbW9kZWwuZ2V0TGluZUNvbnRlbnQocG9zaXRpb24ubGluZU51bWJlcik7CiAgICAgIHZhciBsaW5lTGVuZ3RoID0gbGluZUNvbnRlbnQubGVuZ3RoOwogICAgICBpZiAobGluZUxlbmd0aCA9PT0gMCkgewogICAgICAgIC8vIGVtcHR5IGxpbmUKICAgICAgICBpZiAocG9zaXRpb24ubGluZU51bWJlciA+IDEpIHsKICAgICAgICAgIHJldHVybiBuZXcgUmFuZ2UocG9zaXRpb24ubGluZU51bWJlciAtIDEsIG1vZGVsLmdldExpbmVNYXhDb2x1bW4ocG9zaXRpb24ubGluZU51bWJlciAtIDEpLCBwb3NpdGlvbi5saW5lTnVtYmVyLCAxKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKHBvc2l0aW9uLmxpbmVOdW1iZXIgPCBtb2RlbC5nZXRMaW5lQ291bnQoKSkgewogICAgICAgICAgICByZXR1cm4gbmV3IFJhbmdlKHBvc2l0aW9uLmxpbmVOdW1iZXIsIDEsIHBvc2l0aW9uLmxpbmVOdW1iZXIgKyAxLCAxKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIGVtcHR5IG1vZGVsCiAgICAgICAgICAgIHJldHVybiBuZXcgUmFuZ2UocG9zaXRpb24ubGluZU51bWJlciwgMSwgcG9zaXRpb24ubGluZU51bWJlciwgMSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHZhciB0b3VjaGVzV29yZCA9IGZ1bmN0aW9uIHRvdWNoZXNXb3JkKHdvcmQpIHsKICAgICAgICByZXR1cm4gd29yZC5zdGFydCArIDEgPD0gcG9zaXRpb24uY29sdW1uICYmIHBvc2l0aW9uLmNvbHVtbiA8PSB3b3JkLmVuZCArIDE7CiAgICAgIH07CiAgICAgIHZhciBjcmVhdGVSYW5nZVdpdGhQb3NpdGlvbiA9IGZ1bmN0aW9uIGNyZWF0ZVJhbmdlV2l0aFBvc2l0aW9uKHN0YXJ0Q29sdW1uLCBlbmRDb2x1bW4pIHsKICAgICAgICBzdGFydENvbHVtbiA9IE1hdGgubWluKHN0YXJ0Q29sdW1uLCBwb3NpdGlvbi5jb2x1bW4pOwogICAgICAgIGVuZENvbHVtbiA9IE1hdGgubWF4KGVuZENvbHVtbiwgcG9zaXRpb24uY29sdW1uKTsKICAgICAgICByZXR1cm4gbmV3IFJhbmdlKHBvc2l0aW9uLmxpbmVOdW1iZXIsIHN0YXJ0Q29sdW1uLCBwb3NpdGlvbi5saW5lTnVtYmVyLCBlbmRDb2x1bW4pOwogICAgICB9OwogICAgICB2YXIgZGVsZXRlV29yZEFuZEFkamFjZW50V2hpdGVzcGFjZSA9IGZ1bmN0aW9uIGRlbGV0ZVdvcmRBbmRBZGphY2VudFdoaXRlc3BhY2Uod29yZCkgewogICAgICAgIHZhciBzdGFydENvbHVtbiA9IHdvcmQuc3RhcnQgKyAxOwogICAgICAgIHZhciBlbmRDb2x1bW4gPSB3b3JkLmVuZCArIDE7CiAgICAgICAgdmFyIGV4cGFuZGVkVG9UaGVSaWdodCA9IGZhbHNlOwogICAgICAgIHdoaWxlIChlbmRDb2x1bW4gLSAxIDwgbGluZUxlbmd0aCAmJiBfdGhpcy5fY2hhckF0SXNXaGl0ZXNwYWNlKGxpbmVDb250ZW50LCBlbmRDb2x1bW4gLSAxKSkgewogICAgICAgICAgZXhwYW5kZWRUb1RoZVJpZ2h0ID0gdHJ1ZTsKICAgICAgICAgIGVuZENvbHVtbisrOwogICAgICAgIH0KICAgICAgICBpZiAoIWV4cGFuZGVkVG9UaGVSaWdodCkgewogICAgICAgICAgd2hpbGUgKHN0YXJ0Q29sdW1uID4gMSAmJiBfdGhpcy5fY2hhckF0SXNXaGl0ZXNwYWNlKGxpbmVDb250ZW50LCBzdGFydENvbHVtbiAtIDIpKSB7CiAgICAgICAgICAgIHN0YXJ0Q29sdW1uLS07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBjcmVhdGVSYW5nZVdpdGhQb3NpdGlvbihzdGFydENvbHVtbiwgZW5kQ29sdW1uKTsKICAgICAgfTsKICAgICAgdmFyIHByZXZXb3JkT25MaW5lID0gV29yZE9wZXJhdGlvbnMuX2ZpbmRQcmV2aW91c1dvcmRPbkxpbmUod29yZFNlcGFyYXRvcnMsIG1vZGVsLCBwb3NpdGlvbik7CiAgICAgIGlmIChwcmV2V29yZE9uTGluZSAmJiB0b3VjaGVzV29yZChwcmV2V29yZE9uTGluZSkpIHsKICAgICAgICByZXR1cm4gZGVsZXRlV29yZEFuZEFkamFjZW50V2hpdGVzcGFjZShwcmV2V29yZE9uTGluZSk7CiAgICAgIH0KICAgICAgdmFyIG5leHRXb3JkT25MaW5lID0gV29yZE9wZXJhdGlvbnMuX2ZpbmROZXh0V29yZE9uTGluZSh3b3JkU2VwYXJhdG9ycywgbW9kZWwsIHBvc2l0aW9uKTsKICAgICAgaWYgKG5leHRXb3JkT25MaW5lICYmIHRvdWNoZXNXb3JkKG5leHRXb3JkT25MaW5lKSkgewogICAgICAgIHJldHVybiBkZWxldGVXb3JkQW5kQWRqYWNlbnRXaGl0ZXNwYWNlKG5leHRXb3JkT25MaW5lKTsKICAgICAgfQogICAgICBpZiAocHJldldvcmRPbkxpbmUgJiYgbmV4dFdvcmRPbkxpbmUpIHsKICAgICAgICByZXR1cm4gY3JlYXRlUmFuZ2VXaXRoUG9zaXRpb24ocHJldldvcmRPbkxpbmUuZW5kICsgMSwgbmV4dFdvcmRPbkxpbmUuc3RhcnQgKyAxKTsKICAgICAgfQogICAgICBpZiAocHJldldvcmRPbkxpbmUpIHsKICAgICAgICByZXR1cm4gY3JlYXRlUmFuZ2VXaXRoUG9zaXRpb24ocHJldldvcmRPbkxpbmUuc3RhcnQgKyAxLCBwcmV2V29yZE9uTGluZS5lbmQgKyAxKTsKICAgICAgfQogICAgICBpZiAobmV4dFdvcmRPbkxpbmUpIHsKICAgICAgICByZXR1cm4gY3JlYXRlUmFuZ2VXaXRoUG9zaXRpb24obmV4dFdvcmRPbkxpbmUuc3RhcnQgKyAxLCBuZXh0V29yZE9uTGluZS5lbmQgKyAxKTsKICAgICAgfQogICAgICByZXR1cm4gY3JlYXRlUmFuZ2VXaXRoUG9zaXRpb24oMSwgbGluZUxlbmd0aCArIDEpOwogICAgfQogIH0sIHsKICAgIGtleTogIl9kZWxldGVXb3JkUGFydExlZnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxldGVXb3JkUGFydExlZnQobW9kZWwsIHNlbGVjdGlvbikgewogICAgICBpZiAoIXNlbGVjdGlvbi5pc0VtcHR5KCkpIHsKICAgICAgICByZXR1cm4gc2VsZWN0aW9uOwogICAgICB9CiAgICAgIHZhciBwb3MgPSBzZWxlY3Rpb24uZ2V0UG9zaXRpb24oKTsKICAgICAgdmFyIHRvUG9zaXRpb24gPSBXb3JkT3BlcmF0aW9ucy5fbW92ZVdvcmRQYXJ0TGVmdChtb2RlbCwgcG9zKTsKICAgICAgcmV0dXJuIG5ldyBSYW5nZShwb3MubGluZU51bWJlciwgcG9zLmNvbHVtbiwgdG9Qb3NpdGlvbi5saW5lTnVtYmVyLCB0b1Bvc2l0aW9uLmNvbHVtbik7CiAgICB9CiAgfSwgewogICAga2V5OiAiX2ZpbmRGaXJzdE5vbldoaXRlc3BhY2VDaGFyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZmluZEZpcnN0Tm9uV2hpdGVzcGFjZUNoYXIoc3RyLCBzdGFydEluZGV4KSB7CiAgICAgIHZhciBsZW4gPSBzdHIubGVuZ3RoOwogICAgICBmb3IgKHZhciBjaEluZGV4ID0gc3RhcnRJbmRleDsgY2hJbmRleCA8IGxlbjsgY2hJbmRleCsrKSB7CiAgICAgICAgdmFyIGNoID0gc3RyLmNoYXJBdChjaEluZGV4KTsKICAgICAgICBpZiAoY2ggIT09ICcgJyAmJiBjaCAhPT0gJ1x0JykgewogICAgICAgICAgcmV0dXJuIGNoSW5kZXg7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBsZW47CiAgICB9CiAgfSwgewogICAga2V5OiAiX2RlbGV0ZVdvcmRSaWdodFdoaXRlc3BhY2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxldGVXb3JkUmlnaHRXaGl0ZXNwYWNlKG1vZGVsLCBwb3NpdGlvbikgewogICAgICB2YXIgbGluZUNvbnRlbnQgPSBtb2RlbC5nZXRMaW5lQ29udGVudChwb3NpdGlvbi5saW5lTnVtYmVyKTsKICAgICAgdmFyIHN0YXJ0SW5kZXggPSBwb3NpdGlvbi5jb2x1bW4gLSAxOwogICAgICB2YXIgZmlyc3ROb25XaGl0ZXNwYWNlID0gdGhpcy5fZmluZEZpcnN0Tm9uV2hpdGVzcGFjZUNoYXIobGluZUNvbnRlbnQsIHN0YXJ0SW5kZXgpOwogICAgICBpZiAoc3RhcnRJbmRleCArIDEgPCBmaXJzdE5vbldoaXRlc3BhY2UpIHsKICAgICAgICAvLyBiaW5nbwogICAgICAgIHJldHVybiBuZXcgUmFuZ2UocG9zaXRpb24ubGluZU51bWJlciwgcG9zaXRpb24uY29sdW1uLCBwb3NpdGlvbi5saW5lTnVtYmVyLCBmaXJzdE5vbldoaXRlc3BhY2UgKyAxKTsKICAgICAgfQogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkZWxldGVXb3JkUmlnaHQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRlbGV0ZVdvcmRSaWdodChjdHgsIHdvcmROYXZpZ2F0aW9uVHlwZSkgewogICAgICB2YXIgd29yZFNlcGFyYXRvcnMgPSBjdHgud29yZFNlcGFyYXRvcnM7CiAgICAgIHZhciBtb2RlbCA9IGN0eC5tb2RlbDsKICAgICAgdmFyIHNlbGVjdGlvbiA9IGN0eC5zZWxlY3Rpb247CiAgICAgIHZhciB3aGl0ZXNwYWNlSGV1cmlzdGljcyA9IGN0eC53aGl0ZXNwYWNlSGV1cmlzdGljczsKICAgICAgaWYgKCFzZWxlY3Rpb24uaXNFbXB0eSgpKSB7CiAgICAgICAgcmV0dXJuIHNlbGVjdGlvbjsKICAgICAgfQogICAgICB2YXIgcG9zaXRpb24gPSBuZXcgUG9zaXRpb24oc2VsZWN0aW9uLnBvc2l0aW9uTGluZU51bWJlciwgc2VsZWN0aW9uLnBvc2l0aW9uQ29sdW1uKTsKICAgICAgdmFyIGxpbmVOdW1iZXIgPSBwb3NpdGlvbi5saW5lTnVtYmVyOwogICAgICB2YXIgY29sdW1uID0gcG9zaXRpb24uY29sdW1uOwogICAgICB2YXIgbGluZUNvdW50ID0gbW9kZWwuZ2V0TGluZUNvdW50KCk7CiAgICAgIHZhciBtYXhDb2x1bW4gPSBtb2RlbC5nZXRMaW5lTWF4Q29sdW1uKGxpbmVOdW1iZXIpOwogICAgICBpZiAobGluZU51bWJlciA9PT0gbGluZUNvdW50ICYmIGNvbHVtbiA9PT0gbWF4Q29sdW1uKSB7CiAgICAgICAgLy8gSWdub3JlIGRlbGV0aW5nIGF0IGVuZCBvZiBmaWxlCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgICAgaWYgKHdoaXRlc3BhY2VIZXVyaXN0aWNzKSB7CiAgICAgICAgdmFyIHIgPSB0aGlzLl9kZWxldGVXb3JkUmlnaHRXaGl0ZXNwYWNlKG1vZGVsLCBwb3NpdGlvbik7CiAgICAgICAgaWYgKHIpIHsKICAgICAgICAgIHJldHVybiByOwogICAgICAgIH0KICAgICAgfQogICAgICB2YXIgbmV4dFdvcmRPbkxpbmUgPSBXb3JkT3BlcmF0aW9ucy5fZmluZE5leHRXb3JkT25MaW5lKHdvcmRTZXBhcmF0b3JzLCBtb2RlbCwgcG9zaXRpb24pOwogICAgICBpZiAod29yZE5hdmlnYXRpb25UeXBlID09PSAyIC8qIFdvcmROYXZpZ2F0aW9uVHlwZS5Xb3JkRW5kICovKSB7CiAgICAgICAgaWYgKG5leHRXb3JkT25MaW5lKSB7CiAgICAgICAgICBjb2x1bW4gPSBuZXh0V29yZE9uTGluZS5lbmQgKyAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAoY29sdW1uIDwgbWF4Q29sdW1uIHx8IGxpbmVOdW1iZXIgPT09IGxpbmVDb3VudCkgewogICAgICAgICAgICBjb2x1bW4gPSBtYXhDb2x1bW47CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsaW5lTnVtYmVyKys7CiAgICAgICAgICAgIG5leHRXb3JkT25MaW5lID0gV29yZE9wZXJhdGlvbnMuX2ZpbmROZXh0V29yZE9uTGluZSh3b3JkU2VwYXJhdG9ycywgbW9kZWwsIG5ldyBQb3NpdGlvbihsaW5lTnVtYmVyLCAxKSk7CiAgICAgICAgICAgIGlmIChuZXh0V29yZE9uTGluZSkgewogICAgICAgICAgICAgIGNvbHVtbiA9IG5leHRXb3JkT25MaW5lLnN0YXJ0ICsgMTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjb2x1bW4gPSBtb2RlbC5nZXRMaW5lTWF4Q29sdW1uKGxpbmVOdW1iZXIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmIChuZXh0V29yZE9uTGluZSAmJiBjb2x1bW4gPj0gbmV4dFdvcmRPbkxpbmUuc3RhcnQgKyAxKSB7CiAgICAgICAgICBuZXh0V29yZE9uTGluZSA9IFdvcmRPcGVyYXRpb25zLl9maW5kTmV4dFdvcmRPbkxpbmUod29yZFNlcGFyYXRvcnMsIG1vZGVsLCBuZXcgUG9zaXRpb24obGluZU51bWJlciwgbmV4dFdvcmRPbkxpbmUuZW5kICsgMSkpOwogICAgICAgIH0KICAgICAgICBpZiAobmV4dFdvcmRPbkxpbmUpIHsKICAgICAgICAgIGNvbHVtbiA9IG5leHRXb3JkT25MaW5lLnN0YXJ0ICsgMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKGNvbHVtbiA8IG1heENvbHVtbiB8fCBsaW5lTnVtYmVyID09PSBsaW5lQ291bnQpIHsKICAgICAgICAgICAgY29sdW1uID0gbWF4Q29sdW1uOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbGluZU51bWJlcisrOwogICAgICAgICAgICBuZXh0V29yZE9uTGluZSA9IFdvcmRPcGVyYXRpb25zLl9maW5kTmV4dFdvcmRPbkxpbmUod29yZFNlcGFyYXRvcnMsIG1vZGVsLCBuZXcgUG9zaXRpb24obGluZU51bWJlciwgMSkpOwogICAgICAgICAgICBpZiAobmV4dFdvcmRPbkxpbmUpIHsKICAgICAgICAgICAgICBjb2x1bW4gPSBuZXh0V29yZE9uTGluZS5zdGFydCArIDE7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgY29sdW1uID0gbW9kZWwuZ2V0TGluZU1heENvbHVtbihsaW5lTnVtYmVyKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gbmV3IFJhbmdlKGxpbmVOdW1iZXIsIGNvbHVtbiwgcG9zaXRpb24ubGluZU51bWJlciwgcG9zaXRpb24uY29sdW1uKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfZGVsZXRlV29yZFBhcnRSaWdodCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RlbGV0ZVdvcmRQYXJ0UmlnaHQobW9kZWwsIHNlbGVjdGlvbikgewogICAgICBpZiAoIXNlbGVjdGlvbi5pc0VtcHR5KCkpIHsKICAgICAgICByZXR1cm4gc2VsZWN0aW9uOwogICAgICB9CiAgICAgIHZhciBwb3MgPSBzZWxlY3Rpb24uZ2V0UG9zaXRpb24oKTsKICAgICAgdmFyIHRvUG9zaXRpb24gPSBXb3JkT3BlcmF0aW9ucy5fbW92ZVdvcmRQYXJ0UmlnaHQobW9kZWwsIHBvcyk7CiAgICAgIHJldHVybiBuZXcgUmFuZ2UocG9zLmxpbmVOdW1iZXIsIHBvcy5jb2x1bW4sIHRvUG9zaXRpb24ubGluZU51bWJlciwgdG9Qb3NpdGlvbi5jb2x1bW4pOwogICAgfQogIH0sIHsKICAgIGtleTogIl9jcmVhdGVXb3JkQXRQb3NpdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2NyZWF0ZVdvcmRBdFBvc2l0aW9uKG1vZGVsLCBsaW5lTnVtYmVyLCB3b3JkKSB7CiAgICAgIHZhciByYW5nZSA9IG5ldyBSYW5nZShsaW5lTnVtYmVyLCB3b3JkLnN0YXJ0ICsgMSwgbGluZU51bWJlciwgd29yZC5lbmQgKyAxKTsKICAgICAgcmV0dXJuIHsKICAgICAgICB3b3JkOiBtb2RlbC5nZXRWYWx1ZUluUmFuZ2UocmFuZ2UpLAogICAgICAgIHN0YXJ0Q29sdW1uOiByYW5nZS5zdGFydENvbHVtbiwKICAgICAgICBlbmRDb2x1bW46IHJhbmdlLmVuZENvbHVtbgogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogImdldFdvcmRBdFBvc2l0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRXb3JkQXRQb3NpdGlvbihtb2RlbCwgX3dvcmRTZXBhcmF0b3JzLCBwb3NpdGlvbikgewogICAgICB2YXIgd29yZFNlcGFyYXRvcnMgPSBnZXRNYXBGb3JXb3JkU2VwYXJhdG9ycyhfd29yZFNlcGFyYXRvcnMpOwogICAgICB2YXIgcHJldldvcmQgPSBXb3JkT3BlcmF0aW9ucy5fZmluZFByZXZpb3VzV29yZE9uTGluZSh3b3JkU2VwYXJhdG9ycywgbW9kZWwsIHBvc2l0aW9uKTsKICAgICAgaWYgKHByZXZXb3JkICYmIHByZXZXb3JkLndvcmRUeXBlID09PSAxIC8qIFdvcmRUeXBlLlJlZ3VsYXIgKi8gJiYgcHJldldvcmQuc3RhcnQgPD0gcG9zaXRpb24uY29sdW1uIC0gMSAmJiBwb3NpdGlvbi5jb2x1bW4gLSAxIDw9IHByZXZXb3JkLmVuZCkgewogICAgICAgIHJldHVybiBXb3JkT3BlcmF0aW9ucy5fY3JlYXRlV29yZEF0UG9zaXRpb24obW9kZWwsIHBvc2l0aW9uLmxpbmVOdW1iZXIsIHByZXZXb3JkKTsKICAgICAgfQogICAgICB2YXIgbmV4dFdvcmQgPSBXb3JkT3BlcmF0aW9ucy5fZmluZE5leHRXb3JkT25MaW5lKHdvcmRTZXBhcmF0b3JzLCBtb2RlbCwgcG9zaXRpb24pOwogICAgICBpZiAobmV4dFdvcmQgJiYgbmV4dFdvcmQud29yZFR5cGUgPT09IDEgLyogV29yZFR5cGUuUmVndWxhciAqLyAmJiBuZXh0V29yZC5zdGFydCA8PSBwb3NpdGlvbi5jb2x1bW4gLSAxICYmIHBvc2l0aW9uLmNvbHVtbiAtIDEgPD0gbmV4dFdvcmQuZW5kKSB7CiAgICAgICAgcmV0dXJuIFdvcmRPcGVyYXRpb25zLl9jcmVhdGVXb3JkQXRQb3NpdGlvbihtb2RlbCwgcG9zaXRpb24ubGluZU51bWJlciwgbmV4dFdvcmQpOwogICAgICB9CiAgICAgIHJldHVybiBudWxsOwogICAgfQogIH0sIHsKICAgIGtleTogIndvcmQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHdvcmQoY29uZmlnLCBtb2RlbCwgY3Vyc29yLCBpblNlbGVjdGlvbk1vZGUsIHBvc2l0aW9uKSB7CiAgICAgIHZhciB3b3JkU2VwYXJhdG9ycyA9IGdldE1hcEZvcldvcmRTZXBhcmF0b3JzKGNvbmZpZy53b3JkU2VwYXJhdG9ycyk7CiAgICAgIHZhciBwcmV2V29yZCA9IFdvcmRPcGVyYXRpb25zLl9maW5kUHJldmlvdXNXb3JkT25MaW5lKHdvcmRTZXBhcmF0b3JzLCBtb2RlbCwgcG9zaXRpb24pOwogICAgICB2YXIgbmV4dFdvcmQgPSBXb3JkT3BlcmF0aW9ucy5fZmluZE5leHRXb3JkT25MaW5lKHdvcmRTZXBhcmF0b3JzLCBtb2RlbCwgcG9zaXRpb24pOwogICAgICBpZiAoIWluU2VsZWN0aW9uTW9kZSkgewogICAgICAgIC8vIEVudGVyaW5nIHdvcmQgc2VsZWN0aW9uIGZvciB0aGUgZmlyc3QgdGltZQogICAgICAgIHZhciBfc3RhcnRDb2x1bW47CiAgICAgICAgdmFyIF9lbmRDb2x1bW47CiAgICAgICAgaWYgKHByZXZXb3JkICYmIHByZXZXb3JkLndvcmRUeXBlID09PSAxIC8qIFdvcmRUeXBlLlJlZ3VsYXIgKi8gJiYgcHJldldvcmQuc3RhcnQgPD0gcG9zaXRpb24uY29sdW1uIC0gMSAmJiBwb3NpdGlvbi5jb2x1bW4gLSAxIDw9IHByZXZXb3JkLmVuZCkgewogICAgICAgICAgLy8gaXNUb3VjaGluZ1ByZXZXb3JkCiAgICAgICAgICBfc3RhcnRDb2x1bW4gPSBwcmV2V29yZC5zdGFydCArIDE7CiAgICAgICAgICBfZW5kQ29sdW1uID0gcHJldldvcmQuZW5kICsgMTsKICAgICAgICB9IGVsc2UgaWYgKG5leHRXb3JkICYmIG5leHRXb3JkLndvcmRUeXBlID09PSAxIC8qIFdvcmRUeXBlLlJlZ3VsYXIgKi8gJiYgbmV4dFdvcmQuc3RhcnQgPD0gcG9zaXRpb24uY29sdW1uIC0gMSAmJiBwb3NpdGlvbi5jb2x1bW4gLSAxIDw9IG5leHRXb3JkLmVuZCkgewogICAgICAgICAgLy8gaXNUb3VjaGluZ05leHRXb3JkCiAgICAgICAgICBfc3RhcnRDb2x1bW4gPSBuZXh0V29yZC5zdGFydCArIDE7CiAgICAgICAgICBfZW5kQ29sdW1uID0gbmV4dFdvcmQuZW5kICsgMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKHByZXZXb3JkKSB7CiAgICAgICAgICAgIF9zdGFydENvbHVtbiA9IHByZXZXb3JkLmVuZCArIDE7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfc3RhcnRDb2x1bW4gPSAxOwogICAgICAgICAgfQogICAgICAgICAgaWYgKG5leHRXb3JkKSB7CiAgICAgICAgICAgIF9lbmRDb2x1bW4gPSBuZXh0V29yZC5zdGFydCArIDE7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfZW5kQ29sdW1uID0gbW9kZWwuZ2V0TGluZU1heENvbHVtbihwb3NpdGlvbi5saW5lTnVtYmVyKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBTaW5nbGVDdXJzb3JTdGF0ZShuZXcgUmFuZ2UocG9zaXRpb24ubGluZU51bWJlciwgX3N0YXJ0Q29sdW1uLCBwb3NpdGlvbi5saW5lTnVtYmVyLCBfZW5kQ29sdW1uKSwgMCwgbmV3IFBvc2l0aW9uKHBvc2l0aW9uLmxpbmVOdW1iZXIsIF9lbmRDb2x1bW4pLCAwKTsKICAgICAgfQogICAgICB2YXIgc3RhcnRDb2x1bW47CiAgICAgIHZhciBlbmRDb2x1bW47CiAgICAgIGlmIChwcmV2V29yZCAmJiBwcmV2V29yZC53b3JkVHlwZSA9PT0gMSAvKiBXb3JkVHlwZS5SZWd1bGFyICovICYmIHByZXZXb3JkLnN0YXJ0IDwgcG9zaXRpb24uY29sdW1uIC0gMSAmJiBwb3NpdGlvbi5jb2x1bW4gLSAxIDwgcHJldldvcmQuZW5kKSB7CiAgICAgICAgLy8gaXNJbnNpZGVQcmV2V29yZAogICAgICAgIHN0YXJ0Q29sdW1uID0gcHJldldvcmQuc3RhcnQgKyAxOwogICAgICAgIGVuZENvbHVtbiA9IHByZXZXb3JkLmVuZCArIDE7CiAgICAgIH0gZWxzZSBpZiAobmV4dFdvcmQgJiYgbmV4dFdvcmQud29yZFR5cGUgPT09IDEgLyogV29yZFR5cGUuUmVndWxhciAqLyAmJiBuZXh0V29yZC5zdGFydCA8IHBvc2l0aW9uLmNvbHVtbiAtIDEgJiYgcG9zaXRpb24uY29sdW1uIC0gMSA8IG5leHRXb3JkLmVuZCkgewogICAgICAgIC8vIGlzSW5zaWRlTmV4dFdvcmQKICAgICAgICBzdGFydENvbHVtbiA9IG5leHRXb3JkLnN0YXJ0ICsgMTsKICAgICAgICBlbmRDb2x1bW4gPSBuZXh0V29yZC5lbmQgKyAxOwogICAgICB9IGVsc2UgewogICAgICAgIHN0YXJ0Q29sdW1uID0gcG9zaXRpb24uY29sdW1uOwogICAgICAgIGVuZENvbHVtbiA9IHBvc2l0aW9uLmNvbHVtbjsKICAgICAgfQogICAgICB2YXIgbGluZU51bWJlciA9IHBvc2l0aW9uLmxpbmVOdW1iZXI7CiAgICAgIHZhciBjb2x1bW47CiAgICAgIGlmIChjdXJzb3Iuc2VsZWN0aW9uU3RhcnQuY29udGFpbnNQb3NpdGlvbihwb3NpdGlvbikpIHsKICAgICAgICBjb2x1bW4gPSBjdXJzb3Iuc2VsZWN0aW9uU3RhcnQuZW5kQ29sdW1uOwogICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uLmlzQmVmb3JlT3JFcXVhbChjdXJzb3Iuc2VsZWN0aW9uU3RhcnQuZ2V0U3RhcnRQb3NpdGlvbigpKSkgewogICAgICAgIGNvbHVtbiA9IHN0YXJ0Q29sdW1uOwogICAgICAgIHZhciBwb3NzaWJsZVBvc2l0aW9uID0gbmV3IFBvc2l0aW9uKGxpbmVOdW1iZXIsIGNvbHVtbik7CiAgICAgICAgaWYgKGN1cnNvci5zZWxlY3Rpb25TdGFydC5jb250YWluc1Bvc2l0aW9uKHBvc3NpYmxlUG9zaXRpb24pKSB7CiAgICAgICAgICBjb2x1bW4gPSBjdXJzb3Iuc2VsZWN0aW9uU3RhcnQuZW5kQ29sdW1uOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBjb2x1bW4gPSBlbmRDb2x1bW47CiAgICAgICAgdmFyIF9wb3NzaWJsZVBvc2l0aW9uID0gbmV3IFBvc2l0aW9uKGxpbmVOdW1iZXIsIGNvbHVtbik7CiAgICAgICAgaWYgKGN1cnNvci5zZWxlY3Rpb25TdGFydC5jb250YWluc1Bvc2l0aW9uKF9wb3NzaWJsZVBvc2l0aW9uKSkgewogICAgICAgICAgY29sdW1uID0gY3Vyc29yLnNlbGVjdGlvblN0YXJ0LnN0YXJ0Q29sdW1uOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gY3Vyc29yLm1vdmUodHJ1ZSwgbGluZU51bWJlciwgY29sdW1uLCAwKTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIFdvcmRPcGVyYXRpb25zOwp9KCk7CmV4cG9ydCB2YXIgV29yZFBhcnRPcGVyYXRpb25zID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfV29yZE9wZXJhdGlvbnMpIHsKICBfaW5oZXJpdHMoV29yZFBhcnRPcGVyYXRpb25zLCBfV29yZE9wZXJhdGlvbnMpOwogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoV29yZFBhcnRPcGVyYXRpb25zKTsKICBmdW5jdGlvbiBXb3JkUGFydE9wZXJhdGlvbnMoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgV29yZFBhcnRPcGVyYXRpb25zKTsKICAgIHJldHVybiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9CiAgX2NyZWF0ZUNsYXNzKFdvcmRQYXJ0T3BlcmF0aW9ucywgbnVsbCwgW3sKICAgIGtleTogImRlbGV0ZVdvcmRQYXJ0TGVmdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGVsZXRlV29yZFBhcnRMZWZ0KGN0eCkgewogICAgICB2YXIgY2FuZGlkYXRlcyA9IGVuZm9yY2VEZWZpbmVkKFtXb3JkT3BlcmF0aW9ucy5kZWxldGVXb3JkTGVmdChjdHgsIDAgLyogV29yZE5hdmlnYXRpb25UeXBlLldvcmRTdGFydCAqLyksIFdvcmRPcGVyYXRpb25zLmRlbGV0ZVdvcmRMZWZ0KGN0eCwgMiAvKiBXb3JkTmF2aWdhdGlvblR5cGUuV29yZEVuZCAqLyksIFdvcmRPcGVyYXRpb25zLl9kZWxldGVXb3JkUGFydExlZnQoY3R4Lm1vZGVsLCBjdHguc2VsZWN0aW9uKV0pOwogICAgICBjYW5kaWRhdGVzLnNvcnQoUmFuZ2UuY29tcGFyZVJhbmdlc1VzaW5nRW5kcyk7CiAgICAgIHJldHVybiBjYW5kaWRhdGVzWzJdOwogICAgfQogIH0sIHsKICAgIGtleTogImRlbGV0ZVdvcmRQYXJ0UmlnaHQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRlbGV0ZVdvcmRQYXJ0UmlnaHQoY3R4KSB7CiAgICAgIHZhciBjYW5kaWRhdGVzID0gZW5mb3JjZURlZmluZWQoW1dvcmRPcGVyYXRpb25zLmRlbGV0ZVdvcmRSaWdodChjdHgsIDAgLyogV29yZE5hdmlnYXRpb25UeXBlLldvcmRTdGFydCAqLyksIFdvcmRPcGVyYXRpb25zLmRlbGV0ZVdvcmRSaWdodChjdHgsIDIgLyogV29yZE5hdmlnYXRpb25UeXBlLldvcmRFbmQgKi8pLCBXb3JkT3BlcmF0aW9ucy5fZGVsZXRlV29yZFBhcnRSaWdodChjdHgubW9kZWwsIGN0eC5zZWxlY3Rpb24pXSk7CiAgICAgIGNhbmRpZGF0ZXMuc29ydChSYW5nZS5jb21wYXJlUmFuZ2VzVXNpbmdTdGFydHMpOwogICAgICByZXR1cm4gY2FuZGlkYXRlc1swXTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJtb3ZlV29yZFBhcnRMZWZ0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtb3ZlV29yZFBhcnRMZWZ0KHdvcmRTZXBhcmF0b3JzLCBtb2RlbCwgcG9zaXRpb24pIHsKICAgICAgdmFyIGNhbmRpZGF0ZXMgPSBlbmZvcmNlRGVmaW5lZChbV29yZE9wZXJhdGlvbnMubW92ZVdvcmRMZWZ0KHdvcmRTZXBhcmF0b3JzLCBtb2RlbCwgcG9zaXRpb24sIDAgLyogV29yZE5hdmlnYXRpb25UeXBlLldvcmRTdGFydCAqLyksIFdvcmRPcGVyYXRpb25zLm1vdmVXb3JkTGVmdCh3b3JkU2VwYXJhdG9ycywgbW9kZWwsIHBvc2l0aW9uLCAyIC8qIFdvcmROYXZpZ2F0aW9uVHlwZS5Xb3JkRW5kICovKSwgV29yZE9wZXJhdGlvbnMuX21vdmVXb3JkUGFydExlZnQobW9kZWwsIHBvc2l0aW9uKV0pOwogICAgICBjYW5kaWRhdGVzLnNvcnQoUG9zaXRpb24uY29tcGFyZSk7CiAgICAgIHJldHVybiBjYW5kaWRhdGVzWzJdOwogICAgfQogIH0sIHsKICAgIGtleTogIm1vdmVXb3JkUGFydFJpZ2h0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtb3ZlV29yZFBhcnRSaWdodCh3b3JkU2VwYXJhdG9ycywgbW9kZWwsIHBvc2l0aW9uKSB7CiAgICAgIHZhciBjYW5kaWRhdGVzID0gZW5mb3JjZURlZmluZWQoW1dvcmRPcGVyYXRpb25zLm1vdmVXb3JkUmlnaHQod29yZFNlcGFyYXRvcnMsIG1vZGVsLCBwb3NpdGlvbiwgMCAvKiBXb3JkTmF2aWdhdGlvblR5cGUuV29yZFN0YXJ0ICovKSwgV29yZE9wZXJhdGlvbnMubW92ZVdvcmRSaWdodCh3b3JkU2VwYXJhdG9ycywgbW9kZWwsIHBvc2l0aW9uLCAyIC8qIFdvcmROYXZpZ2F0aW9uVHlwZS5Xb3JkRW5kICovKSwgV29yZE9wZXJhdGlvbnMuX21vdmVXb3JkUGFydFJpZ2h0KG1vZGVsLCBwb3NpdGlvbildKTsKICAgICAgY2FuZGlkYXRlcy5zb3J0KFBvc2l0aW9uLmNvbXBhcmUpOwogICAgICByZXR1cm4gY2FuZGlkYXRlc1swXTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIFdvcmRQYXJ0T3BlcmF0aW9uczsKfShXb3JkT3BlcmF0aW9ucyk7CmZ1bmN0aW9uIGVuZm9yY2VEZWZpbmVkKGFycikgewogIHJldHVybiBhcnIuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgcmV0dXJuIEJvb2xlYW4oZWwpOwogIH0pOwp9"},{"version":3,"names":["strings","SingleCursorState","DeleteOperations","getMapForWordSeparators","Position","Range","WordOperations","lineContent","wordType","nextCharClass","start","end","wordSeparators","model","position","getLineContent","lineNumber","_doFindPreviousWordOnLine","chIndex","column","chCode","charCodeAt","chClass","get","_createWord","_findEndOfWord","startIndex","len","length","_doFindNextWordOnLine","_findStartOfWord","wordNavigationType","getLineMaxColumn","prevWordOnLine","_findPreviousWordOnLine","maxColumn","left","right","isLowerAsciiLetter","isAsciiDigit","isUpperAsciiLetter","rightRight","movedDown","getLineCount","nextWordOnLine","_findNextWordOnLine","lastNonWhitespace","lastNonWhitespaceIndex","ctx","selection","whitespaceHeuristics","isEmpty","isAutoClosingPairDelete","autoClosingDelete","autoClosingBrackets","autoClosingQuotes","autoClosingPairs","autoClosingPairsOpenByEnd","autoClosedCharacters","getPosition","positionLineNumber","positionColumn","r","_deleteWordLeftWhitespace","_deleteInsideWordWhitespace","_deleteInsideWordDetermineDeleteRange","str","index","charCode","lineContentLength","leftIndex","Math","max","_charAtIsWhitespace","rightIndex","min","lineLength","touchesWord","word","createRangeWithPosition","startColumn","endColumn","deleteWordAndAdjacentWhitespace","expandedToTheRight","pos","toPosition","_moveWordPartLeft","ch","charAt","firstNonWhitespace","_findFirstNonWhitespaceChar","lineCount","_deleteWordRightWhitespace","_moveWordPartRight","range","getValueInRange","_wordSeparators","prevWord","_createWordAtPosition","nextWord","config","cursor","inSelectionMode","selectionStart","containsPosition","isBeforeOrEqual","getStartPosition","possiblePosition","move","WordPartOperations","candidates","enforceDefined","deleteWordLeft","_deleteWordPartLeft","sort","compareRangesUsingEnds","deleteWordRight","_deleteWordPartRight","compareRangesUsingStarts","moveWordLeft","compare","moveWordRight","arr","filter","el","Boolean"],"sources":["/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/editor/common/cursor/cursorWordOperations.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as strings from '../../../base/common/strings.js';\nimport { SingleCursorState } from '../cursorCommon.js';\nimport { DeleteOperations } from './cursorDeleteOperations.js';\nimport { getMapForWordSeparators } from '../core/wordCharacterClassifier.js';\nimport { Position } from '../core/position.js';\nimport { Range } from '../core/range.js';\nexport class WordOperations {\n    static _createWord(lineContent, wordType, nextCharClass, start, end) {\n        // console.log('WORD ==> ' + start + ' => ' + end + ':::: <<<' + lineContent.substring(start, end) + '>>>');\n        return { start: start, end: end, wordType: wordType, nextCharClass: nextCharClass };\n    }\n    static _findPreviousWordOnLine(wordSeparators, model, position) {\n        const lineContent = model.getLineContent(position.lineNumber);\n        return this._doFindPreviousWordOnLine(lineContent, wordSeparators, position);\n    }\n    static _doFindPreviousWordOnLine(lineContent, wordSeparators, position) {\n        let wordType = 0 /* WordType.None */;\n        for (let chIndex = position.column - 2; chIndex >= 0; chIndex--) {\n            const chCode = lineContent.charCodeAt(chIndex);\n            const chClass = wordSeparators.get(chCode);\n            if (chClass === 0 /* WordCharacterClass.Regular */) {\n                if (wordType === 2 /* WordType.Separator */) {\n                    return this._createWord(lineContent, wordType, chClass, chIndex + 1, this._findEndOfWord(lineContent, wordSeparators, wordType, chIndex + 1));\n                }\n                wordType = 1 /* WordType.Regular */;\n            }\n            else if (chClass === 2 /* WordCharacterClass.WordSeparator */) {\n                if (wordType === 1 /* WordType.Regular */) {\n                    return this._createWord(lineContent, wordType, chClass, chIndex + 1, this._findEndOfWord(lineContent, wordSeparators, wordType, chIndex + 1));\n                }\n                wordType = 2 /* WordType.Separator */;\n            }\n            else if (chClass === 1 /* WordCharacterClass.Whitespace */) {\n                if (wordType !== 0 /* WordType.None */) {\n                    return this._createWord(lineContent, wordType, chClass, chIndex + 1, this._findEndOfWord(lineContent, wordSeparators, wordType, chIndex + 1));\n                }\n            }\n        }\n        if (wordType !== 0 /* WordType.None */) {\n            return this._createWord(lineContent, wordType, 1 /* WordCharacterClass.Whitespace */, 0, this._findEndOfWord(lineContent, wordSeparators, wordType, 0));\n        }\n        return null;\n    }\n    static _findEndOfWord(lineContent, wordSeparators, wordType, startIndex) {\n        const len = lineContent.length;\n        for (let chIndex = startIndex; chIndex < len; chIndex++) {\n            const chCode = lineContent.charCodeAt(chIndex);\n            const chClass = wordSeparators.get(chCode);\n            if (chClass === 1 /* WordCharacterClass.Whitespace */) {\n                return chIndex;\n            }\n            if (wordType === 1 /* WordType.Regular */ && chClass === 2 /* WordCharacterClass.WordSeparator */) {\n                return chIndex;\n            }\n            if (wordType === 2 /* WordType.Separator */ && chClass === 0 /* WordCharacterClass.Regular */) {\n                return chIndex;\n            }\n        }\n        return len;\n    }\n    static _findNextWordOnLine(wordSeparators, model, position) {\n        const lineContent = model.getLineContent(position.lineNumber);\n        return this._doFindNextWordOnLine(lineContent, wordSeparators, position);\n    }\n    static _doFindNextWordOnLine(lineContent, wordSeparators, position) {\n        let wordType = 0 /* WordType.None */;\n        const len = lineContent.length;\n        for (let chIndex = position.column - 1; chIndex < len; chIndex++) {\n            const chCode = lineContent.charCodeAt(chIndex);\n            const chClass = wordSeparators.get(chCode);\n            if (chClass === 0 /* WordCharacterClass.Regular */) {\n                if (wordType === 2 /* WordType.Separator */) {\n                    return this._createWord(lineContent, wordType, chClass, this._findStartOfWord(lineContent, wordSeparators, wordType, chIndex - 1), chIndex);\n                }\n                wordType = 1 /* WordType.Regular */;\n            }\n            else if (chClass === 2 /* WordCharacterClass.WordSeparator */) {\n                if (wordType === 1 /* WordType.Regular */) {\n                    return this._createWord(lineContent, wordType, chClass, this._findStartOfWord(lineContent, wordSeparators, wordType, chIndex - 1), chIndex);\n                }\n                wordType = 2 /* WordType.Separator */;\n            }\n            else if (chClass === 1 /* WordCharacterClass.Whitespace */) {\n                if (wordType !== 0 /* WordType.None */) {\n                    return this._createWord(lineContent, wordType, chClass, this._findStartOfWord(lineContent, wordSeparators, wordType, chIndex - 1), chIndex);\n                }\n            }\n        }\n        if (wordType !== 0 /* WordType.None */) {\n            return this._createWord(lineContent, wordType, 1 /* WordCharacterClass.Whitespace */, this._findStartOfWord(lineContent, wordSeparators, wordType, len - 1), len);\n        }\n        return null;\n    }\n    static _findStartOfWord(lineContent, wordSeparators, wordType, startIndex) {\n        for (let chIndex = startIndex; chIndex >= 0; chIndex--) {\n            const chCode = lineContent.charCodeAt(chIndex);\n            const chClass = wordSeparators.get(chCode);\n            if (chClass === 1 /* WordCharacterClass.Whitespace */) {\n                return chIndex + 1;\n            }\n            if (wordType === 1 /* WordType.Regular */ && chClass === 2 /* WordCharacterClass.WordSeparator */) {\n                return chIndex + 1;\n            }\n            if (wordType === 2 /* WordType.Separator */ && chClass === 0 /* WordCharacterClass.Regular */) {\n                return chIndex + 1;\n            }\n        }\n        return 0;\n    }\n    static moveWordLeft(wordSeparators, model, position, wordNavigationType) {\n        let lineNumber = position.lineNumber;\n        let column = position.column;\n        if (column === 1) {\n            if (lineNumber > 1) {\n                lineNumber = lineNumber - 1;\n                column = model.getLineMaxColumn(lineNumber);\n            }\n        }\n        let prevWordOnLine = WordOperations._findPreviousWordOnLine(wordSeparators, model, new Position(lineNumber, column));\n        if (wordNavigationType === 0 /* WordNavigationType.WordStart */) {\n            return new Position(lineNumber, prevWordOnLine ? prevWordOnLine.start + 1 : 1);\n        }\n        if (wordNavigationType === 1 /* WordNavigationType.WordStartFast */) {\n            if (prevWordOnLine\n                && prevWordOnLine.wordType === 2 /* WordType.Separator */\n                && prevWordOnLine.end - prevWordOnLine.start === 1\n                && prevWordOnLine.nextCharClass === 0 /* WordCharacterClass.Regular */) {\n                // Skip over a word made up of one single separator and followed by a regular character\n                prevWordOnLine = WordOperations._findPreviousWordOnLine(wordSeparators, model, new Position(lineNumber, prevWordOnLine.start + 1));\n            }\n            return new Position(lineNumber, prevWordOnLine ? prevWordOnLine.start + 1 : 1);\n        }\n        if (wordNavigationType === 3 /* WordNavigationType.WordAccessibility */) {\n            while (prevWordOnLine\n                && prevWordOnLine.wordType === 2 /* WordType.Separator */) {\n                // Skip over words made up of only separators\n                prevWordOnLine = WordOperations._findPreviousWordOnLine(wordSeparators, model, new Position(lineNumber, prevWordOnLine.start + 1));\n            }\n            return new Position(lineNumber, prevWordOnLine ? prevWordOnLine.start + 1 : 1);\n        }\n        // We are stopping at the ending of words\n        if (prevWordOnLine && column <= prevWordOnLine.end + 1) {\n            prevWordOnLine = WordOperations._findPreviousWordOnLine(wordSeparators, model, new Position(lineNumber, prevWordOnLine.start + 1));\n        }\n        return new Position(lineNumber, prevWordOnLine ? prevWordOnLine.end + 1 : 1);\n    }\n    static _moveWordPartLeft(model, position) {\n        const lineNumber = position.lineNumber;\n        const maxColumn = model.getLineMaxColumn(lineNumber);\n        if (position.column === 1) {\n            return (lineNumber > 1 ? new Position(lineNumber - 1, model.getLineMaxColumn(lineNumber - 1)) : position);\n        }\n        const lineContent = model.getLineContent(lineNumber);\n        for (let column = position.column - 1; column > 1; column--) {\n            const left = lineContent.charCodeAt(column - 2);\n            const right = lineContent.charCodeAt(column - 1);\n            if (left === 95 /* CharCode.Underline */ && right !== 95 /* CharCode.Underline */) {\n                // snake_case_variables\n                return new Position(lineNumber, column);\n            }\n            if ((strings.isLowerAsciiLetter(left) || strings.isAsciiDigit(left)) && strings.isUpperAsciiLetter(right)) {\n                // camelCaseVariables\n                return new Position(lineNumber, column);\n            }\n            if (strings.isUpperAsciiLetter(left) && strings.isUpperAsciiLetter(right)) {\n                // thisIsACamelCaseWithOneLetterWords\n                if (column + 1 < maxColumn) {\n                    const rightRight = lineContent.charCodeAt(column);\n                    if (strings.isLowerAsciiLetter(rightRight) || strings.isAsciiDigit(rightRight)) {\n                        return new Position(lineNumber, column);\n                    }\n                }\n            }\n        }\n        return new Position(lineNumber, 1);\n    }\n    static moveWordRight(wordSeparators, model, position, wordNavigationType) {\n        let lineNumber = position.lineNumber;\n        let column = position.column;\n        let movedDown = false;\n        if (column === model.getLineMaxColumn(lineNumber)) {\n            if (lineNumber < model.getLineCount()) {\n                movedDown = true;\n                lineNumber = lineNumber + 1;\n                column = 1;\n            }\n        }\n        let nextWordOnLine = WordOperations._findNextWordOnLine(wordSeparators, model, new Position(lineNumber, column));\n        if (wordNavigationType === 2 /* WordNavigationType.WordEnd */) {\n            if (nextWordOnLine && nextWordOnLine.wordType === 2 /* WordType.Separator */) {\n                if (nextWordOnLine.end - nextWordOnLine.start === 1 && nextWordOnLine.nextCharClass === 0 /* WordCharacterClass.Regular */) {\n                    // Skip over a word made up of one single separator and followed by a regular character\n                    nextWordOnLine = WordOperations._findNextWordOnLine(wordSeparators, model, new Position(lineNumber, nextWordOnLine.end + 1));\n                }\n            }\n            if (nextWordOnLine) {\n                column = nextWordOnLine.end + 1;\n            }\n            else {\n                column = model.getLineMaxColumn(lineNumber);\n            }\n        }\n        else if (wordNavigationType === 3 /* WordNavigationType.WordAccessibility */) {\n            if (movedDown) {\n                // If we move to the next line, pretend that the cursor is right before the first character.\n                // This is needed when the first word starts right at the first character - and in order not to miss it,\n                // we need to start before.\n                column = 0;\n            }\n            while (nextWordOnLine\n                && (nextWordOnLine.wordType === 2 /* WordType.Separator */\n                    || nextWordOnLine.start + 1 <= column)) {\n                // Skip over a word made up of one single separator\n                // Also skip over word if it begins before current cursor position to ascertain we're moving forward at least 1 character.\n                nextWordOnLine = WordOperations._findNextWordOnLine(wordSeparators, model, new Position(lineNumber, nextWordOnLine.end + 1));\n            }\n            if (nextWordOnLine) {\n                column = nextWordOnLine.start + 1;\n            }\n            else {\n                column = model.getLineMaxColumn(lineNumber);\n            }\n        }\n        else {\n            if (nextWordOnLine && !movedDown && column >= nextWordOnLine.start + 1) {\n                nextWordOnLine = WordOperations._findNextWordOnLine(wordSeparators, model, new Position(lineNumber, nextWordOnLine.end + 1));\n            }\n            if (nextWordOnLine) {\n                column = nextWordOnLine.start + 1;\n            }\n            else {\n                column = model.getLineMaxColumn(lineNumber);\n            }\n        }\n        return new Position(lineNumber, column);\n    }\n    static _moveWordPartRight(model, position) {\n        const lineNumber = position.lineNumber;\n        const maxColumn = model.getLineMaxColumn(lineNumber);\n        if (position.column === maxColumn) {\n            return (lineNumber < model.getLineCount() ? new Position(lineNumber + 1, 1) : position);\n        }\n        const lineContent = model.getLineContent(lineNumber);\n        for (let column = position.column + 1; column < maxColumn; column++) {\n            const left = lineContent.charCodeAt(column - 2);\n            const right = lineContent.charCodeAt(column - 1);\n            if (left !== 95 /* CharCode.Underline */ && right === 95 /* CharCode.Underline */) {\n                // snake_case_variables\n                return new Position(lineNumber, column);\n            }\n            if ((strings.isLowerAsciiLetter(left) || strings.isAsciiDigit(left)) && strings.isUpperAsciiLetter(right)) {\n                // camelCaseVariables\n                return new Position(lineNumber, column);\n            }\n            if (strings.isUpperAsciiLetter(left) && strings.isUpperAsciiLetter(right)) {\n                // thisIsACamelCaseWithOneLetterWords\n                if (column + 1 < maxColumn) {\n                    const rightRight = lineContent.charCodeAt(column);\n                    if (strings.isLowerAsciiLetter(rightRight) || strings.isAsciiDigit(rightRight)) {\n                        return new Position(lineNumber, column);\n                    }\n                }\n            }\n        }\n        return new Position(lineNumber, maxColumn);\n    }\n    static _deleteWordLeftWhitespace(model, position) {\n        const lineContent = model.getLineContent(position.lineNumber);\n        const startIndex = position.column - 2;\n        const lastNonWhitespace = strings.lastNonWhitespaceIndex(lineContent, startIndex);\n        if (lastNonWhitespace + 1 < startIndex) {\n            return new Range(position.lineNumber, lastNonWhitespace + 2, position.lineNumber, position.column);\n        }\n        return null;\n    }\n    static deleteWordLeft(ctx, wordNavigationType) {\n        const wordSeparators = ctx.wordSeparators;\n        const model = ctx.model;\n        const selection = ctx.selection;\n        const whitespaceHeuristics = ctx.whitespaceHeuristics;\n        if (!selection.isEmpty()) {\n            return selection;\n        }\n        if (DeleteOperations.isAutoClosingPairDelete(ctx.autoClosingDelete, ctx.autoClosingBrackets, ctx.autoClosingQuotes, ctx.autoClosingPairs.autoClosingPairsOpenByEnd, ctx.model, [ctx.selection], ctx.autoClosedCharacters)) {\n            const position = ctx.selection.getPosition();\n            return new Range(position.lineNumber, position.column - 1, position.lineNumber, position.column + 1);\n        }\n        const position = new Position(selection.positionLineNumber, selection.positionColumn);\n        let lineNumber = position.lineNumber;\n        let column = position.column;\n        if (lineNumber === 1 && column === 1) {\n            // Ignore deleting at beginning of file\n            return null;\n        }\n        if (whitespaceHeuristics) {\n            const r = this._deleteWordLeftWhitespace(model, position);\n            if (r) {\n                return r;\n            }\n        }\n        let prevWordOnLine = WordOperations._findPreviousWordOnLine(wordSeparators, model, position);\n        if (wordNavigationType === 0 /* WordNavigationType.WordStart */) {\n            if (prevWordOnLine) {\n                column = prevWordOnLine.start + 1;\n            }\n            else {\n                if (column > 1) {\n                    column = 1;\n                }\n                else {\n                    lineNumber--;\n                    column = model.getLineMaxColumn(lineNumber);\n                }\n            }\n        }\n        else {\n            if (prevWordOnLine && column <= prevWordOnLine.end + 1) {\n                prevWordOnLine = WordOperations._findPreviousWordOnLine(wordSeparators, model, new Position(lineNumber, prevWordOnLine.start + 1));\n            }\n            if (prevWordOnLine) {\n                column = prevWordOnLine.end + 1;\n            }\n            else {\n                if (column > 1) {\n                    column = 1;\n                }\n                else {\n                    lineNumber--;\n                    column = model.getLineMaxColumn(lineNumber);\n                }\n            }\n        }\n        return new Range(lineNumber, column, position.lineNumber, position.column);\n    }\n    static deleteInsideWord(wordSeparators, model, selection) {\n        if (!selection.isEmpty()) {\n            return selection;\n        }\n        const position = new Position(selection.positionLineNumber, selection.positionColumn);\n        const r = this._deleteInsideWordWhitespace(model, position);\n        if (r) {\n            return r;\n        }\n        return this._deleteInsideWordDetermineDeleteRange(wordSeparators, model, position);\n    }\n    static _charAtIsWhitespace(str, index) {\n        const charCode = str.charCodeAt(index);\n        return (charCode === 32 /* CharCode.Space */ || charCode === 9 /* CharCode.Tab */);\n    }\n    static _deleteInsideWordWhitespace(model, position) {\n        const lineContent = model.getLineContent(position.lineNumber);\n        const lineContentLength = lineContent.length;\n        if (lineContentLength === 0) {\n            // empty line\n            return null;\n        }\n        let leftIndex = Math.max(position.column - 2, 0);\n        if (!this._charAtIsWhitespace(lineContent, leftIndex)) {\n            // touches a non-whitespace character to the left\n            return null;\n        }\n        let rightIndex = Math.min(position.column - 1, lineContentLength - 1);\n        if (!this._charAtIsWhitespace(lineContent, rightIndex)) {\n            // touches a non-whitespace character to the right\n            return null;\n        }\n        // walk over whitespace to the left\n        while (leftIndex > 0 && this._charAtIsWhitespace(lineContent, leftIndex - 1)) {\n            leftIndex--;\n        }\n        // walk over whitespace to the right\n        while (rightIndex + 1 < lineContentLength && this._charAtIsWhitespace(lineContent, rightIndex + 1)) {\n            rightIndex++;\n        }\n        return new Range(position.lineNumber, leftIndex + 1, position.lineNumber, rightIndex + 2);\n    }\n    static _deleteInsideWordDetermineDeleteRange(wordSeparators, model, position) {\n        const lineContent = model.getLineContent(position.lineNumber);\n        const lineLength = lineContent.length;\n        if (lineLength === 0) {\n            // empty line\n            if (position.lineNumber > 1) {\n                return new Range(position.lineNumber - 1, model.getLineMaxColumn(position.lineNumber - 1), position.lineNumber, 1);\n            }\n            else {\n                if (position.lineNumber < model.getLineCount()) {\n                    return new Range(position.lineNumber, 1, position.lineNumber + 1, 1);\n                }\n                else {\n                    // empty model\n                    return new Range(position.lineNumber, 1, position.lineNumber, 1);\n                }\n            }\n        }\n        const touchesWord = (word) => {\n            return (word.start + 1 <= position.column && position.column <= word.end + 1);\n        };\n        const createRangeWithPosition = (startColumn, endColumn) => {\n            startColumn = Math.min(startColumn, position.column);\n            endColumn = Math.max(endColumn, position.column);\n            return new Range(position.lineNumber, startColumn, position.lineNumber, endColumn);\n        };\n        const deleteWordAndAdjacentWhitespace = (word) => {\n            let startColumn = word.start + 1;\n            let endColumn = word.end + 1;\n            let expandedToTheRight = false;\n            while (endColumn - 1 < lineLength && this._charAtIsWhitespace(lineContent, endColumn - 1)) {\n                expandedToTheRight = true;\n                endColumn++;\n            }\n            if (!expandedToTheRight) {\n                while (startColumn > 1 && this._charAtIsWhitespace(lineContent, startColumn - 2)) {\n                    startColumn--;\n                }\n            }\n            return createRangeWithPosition(startColumn, endColumn);\n        };\n        const prevWordOnLine = WordOperations._findPreviousWordOnLine(wordSeparators, model, position);\n        if (prevWordOnLine && touchesWord(prevWordOnLine)) {\n            return deleteWordAndAdjacentWhitespace(prevWordOnLine);\n        }\n        const nextWordOnLine = WordOperations._findNextWordOnLine(wordSeparators, model, position);\n        if (nextWordOnLine && touchesWord(nextWordOnLine)) {\n            return deleteWordAndAdjacentWhitespace(nextWordOnLine);\n        }\n        if (prevWordOnLine && nextWordOnLine) {\n            return createRangeWithPosition(prevWordOnLine.end + 1, nextWordOnLine.start + 1);\n        }\n        if (prevWordOnLine) {\n            return createRangeWithPosition(prevWordOnLine.start + 1, prevWordOnLine.end + 1);\n        }\n        if (nextWordOnLine) {\n            return createRangeWithPosition(nextWordOnLine.start + 1, nextWordOnLine.end + 1);\n        }\n        return createRangeWithPosition(1, lineLength + 1);\n    }\n    static _deleteWordPartLeft(model, selection) {\n        if (!selection.isEmpty()) {\n            return selection;\n        }\n        const pos = selection.getPosition();\n        const toPosition = WordOperations._moveWordPartLeft(model, pos);\n        return new Range(pos.lineNumber, pos.column, toPosition.lineNumber, toPosition.column);\n    }\n    static _findFirstNonWhitespaceChar(str, startIndex) {\n        const len = str.length;\n        for (let chIndex = startIndex; chIndex < len; chIndex++) {\n            const ch = str.charAt(chIndex);\n            if (ch !== ' ' && ch !== '\\t') {\n                return chIndex;\n            }\n        }\n        return len;\n    }\n    static _deleteWordRightWhitespace(model, position) {\n        const lineContent = model.getLineContent(position.lineNumber);\n        const startIndex = position.column - 1;\n        const firstNonWhitespace = this._findFirstNonWhitespaceChar(lineContent, startIndex);\n        if (startIndex + 1 < firstNonWhitespace) {\n            // bingo\n            return new Range(position.lineNumber, position.column, position.lineNumber, firstNonWhitespace + 1);\n        }\n        return null;\n    }\n    static deleteWordRight(ctx, wordNavigationType) {\n        const wordSeparators = ctx.wordSeparators;\n        const model = ctx.model;\n        const selection = ctx.selection;\n        const whitespaceHeuristics = ctx.whitespaceHeuristics;\n        if (!selection.isEmpty()) {\n            return selection;\n        }\n        const position = new Position(selection.positionLineNumber, selection.positionColumn);\n        let lineNumber = position.lineNumber;\n        let column = position.column;\n        const lineCount = model.getLineCount();\n        const maxColumn = model.getLineMaxColumn(lineNumber);\n        if (lineNumber === lineCount && column === maxColumn) {\n            // Ignore deleting at end of file\n            return null;\n        }\n        if (whitespaceHeuristics) {\n            const r = this._deleteWordRightWhitespace(model, position);\n            if (r) {\n                return r;\n            }\n        }\n        let nextWordOnLine = WordOperations._findNextWordOnLine(wordSeparators, model, position);\n        if (wordNavigationType === 2 /* WordNavigationType.WordEnd */) {\n            if (nextWordOnLine) {\n                column = nextWordOnLine.end + 1;\n            }\n            else {\n                if (column < maxColumn || lineNumber === lineCount) {\n                    column = maxColumn;\n                }\n                else {\n                    lineNumber++;\n                    nextWordOnLine = WordOperations._findNextWordOnLine(wordSeparators, model, new Position(lineNumber, 1));\n                    if (nextWordOnLine) {\n                        column = nextWordOnLine.start + 1;\n                    }\n                    else {\n                        column = model.getLineMaxColumn(lineNumber);\n                    }\n                }\n            }\n        }\n        else {\n            if (nextWordOnLine && column >= nextWordOnLine.start + 1) {\n                nextWordOnLine = WordOperations._findNextWordOnLine(wordSeparators, model, new Position(lineNumber, nextWordOnLine.end + 1));\n            }\n            if (nextWordOnLine) {\n                column = nextWordOnLine.start + 1;\n            }\n            else {\n                if (column < maxColumn || lineNumber === lineCount) {\n                    column = maxColumn;\n                }\n                else {\n                    lineNumber++;\n                    nextWordOnLine = WordOperations._findNextWordOnLine(wordSeparators, model, new Position(lineNumber, 1));\n                    if (nextWordOnLine) {\n                        column = nextWordOnLine.start + 1;\n                    }\n                    else {\n                        column = model.getLineMaxColumn(lineNumber);\n                    }\n                }\n            }\n        }\n        return new Range(lineNumber, column, position.lineNumber, position.column);\n    }\n    static _deleteWordPartRight(model, selection) {\n        if (!selection.isEmpty()) {\n            return selection;\n        }\n        const pos = selection.getPosition();\n        const toPosition = WordOperations._moveWordPartRight(model, pos);\n        return new Range(pos.lineNumber, pos.column, toPosition.lineNumber, toPosition.column);\n    }\n    static _createWordAtPosition(model, lineNumber, word) {\n        const range = new Range(lineNumber, word.start + 1, lineNumber, word.end + 1);\n        return {\n            word: model.getValueInRange(range),\n            startColumn: range.startColumn,\n            endColumn: range.endColumn\n        };\n    }\n    static getWordAtPosition(model, _wordSeparators, position) {\n        const wordSeparators = getMapForWordSeparators(_wordSeparators);\n        const prevWord = WordOperations._findPreviousWordOnLine(wordSeparators, model, position);\n        if (prevWord && prevWord.wordType === 1 /* WordType.Regular */ && prevWord.start <= position.column - 1 && position.column - 1 <= prevWord.end) {\n            return WordOperations._createWordAtPosition(model, position.lineNumber, prevWord);\n        }\n        const nextWord = WordOperations._findNextWordOnLine(wordSeparators, model, position);\n        if (nextWord && nextWord.wordType === 1 /* WordType.Regular */ && nextWord.start <= position.column - 1 && position.column - 1 <= nextWord.end) {\n            return WordOperations._createWordAtPosition(model, position.lineNumber, nextWord);\n        }\n        return null;\n    }\n    static word(config, model, cursor, inSelectionMode, position) {\n        const wordSeparators = getMapForWordSeparators(config.wordSeparators);\n        const prevWord = WordOperations._findPreviousWordOnLine(wordSeparators, model, position);\n        const nextWord = WordOperations._findNextWordOnLine(wordSeparators, model, position);\n        if (!inSelectionMode) {\n            // Entering word selection for the first time\n            let startColumn;\n            let endColumn;\n            if (prevWord && prevWord.wordType === 1 /* WordType.Regular */ && prevWord.start <= position.column - 1 && position.column - 1 <= prevWord.end) {\n                // isTouchingPrevWord\n                startColumn = prevWord.start + 1;\n                endColumn = prevWord.end + 1;\n            }\n            else if (nextWord && nextWord.wordType === 1 /* WordType.Regular */ && nextWord.start <= position.column - 1 && position.column - 1 <= nextWord.end) {\n                // isTouchingNextWord\n                startColumn = nextWord.start + 1;\n                endColumn = nextWord.end + 1;\n            }\n            else {\n                if (prevWord) {\n                    startColumn = prevWord.end + 1;\n                }\n                else {\n                    startColumn = 1;\n                }\n                if (nextWord) {\n                    endColumn = nextWord.start + 1;\n                }\n                else {\n                    endColumn = model.getLineMaxColumn(position.lineNumber);\n                }\n            }\n            return new SingleCursorState(new Range(position.lineNumber, startColumn, position.lineNumber, endColumn), 0, new Position(position.lineNumber, endColumn), 0);\n        }\n        let startColumn;\n        let endColumn;\n        if (prevWord && prevWord.wordType === 1 /* WordType.Regular */ && prevWord.start < position.column - 1 && position.column - 1 < prevWord.end) {\n            // isInsidePrevWord\n            startColumn = prevWord.start + 1;\n            endColumn = prevWord.end + 1;\n        }\n        else if (nextWord && nextWord.wordType === 1 /* WordType.Regular */ && nextWord.start < position.column - 1 && position.column - 1 < nextWord.end) {\n            // isInsideNextWord\n            startColumn = nextWord.start + 1;\n            endColumn = nextWord.end + 1;\n        }\n        else {\n            startColumn = position.column;\n            endColumn = position.column;\n        }\n        const lineNumber = position.lineNumber;\n        let column;\n        if (cursor.selectionStart.containsPosition(position)) {\n            column = cursor.selectionStart.endColumn;\n        }\n        else if (position.isBeforeOrEqual(cursor.selectionStart.getStartPosition())) {\n            column = startColumn;\n            const possiblePosition = new Position(lineNumber, column);\n            if (cursor.selectionStart.containsPosition(possiblePosition)) {\n                column = cursor.selectionStart.endColumn;\n            }\n        }\n        else {\n            column = endColumn;\n            const possiblePosition = new Position(lineNumber, column);\n            if (cursor.selectionStart.containsPosition(possiblePosition)) {\n                column = cursor.selectionStart.startColumn;\n            }\n        }\n        return cursor.move(true, lineNumber, column, 0);\n    }\n}\nexport class WordPartOperations extends WordOperations {\n    static deleteWordPartLeft(ctx) {\n        const candidates = enforceDefined([\n            WordOperations.deleteWordLeft(ctx, 0 /* WordNavigationType.WordStart */),\n            WordOperations.deleteWordLeft(ctx, 2 /* WordNavigationType.WordEnd */),\n            WordOperations._deleteWordPartLeft(ctx.model, ctx.selection)\n        ]);\n        candidates.sort(Range.compareRangesUsingEnds);\n        return candidates[2];\n    }\n    static deleteWordPartRight(ctx) {\n        const candidates = enforceDefined([\n            WordOperations.deleteWordRight(ctx, 0 /* WordNavigationType.WordStart */),\n            WordOperations.deleteWordRight(ctx, 2 /* WordNavigationType.WordEnd */),\n            WordOperations._deleteWordPartRight(ctx.model, ctx.selection)\n        ]);\n        candidates.sort(Range.compareRangesUsingStarts);\n        return candidates[0];\n    }\n    static moveWordPartLeft(wordSeparators, model, position) {\n        const candidates = enforceDefined([\n            WordOperations.moveWordLeft(wordSeparators, model, position, 0 /* WordNavigationType.WordStart */),\n            WordOperations.moveWordLeft(wordSeparators, model, position, 2 /* WordNavigationType.WordEnd */),\n            WordOperations._moveWordPartLeft(model, position)\n        ]);\n        candidates.sort(Position.compare);\n        return candidates[2];\n    }\n    static moveWordPartRight(wordSeparators, model, position) {\n        const candidates = enforceDefined([\n            WordOperations.moveWordRight(wordSeparators, model, position, 0 /* WordNavigationType.WordStart */),\n            WordOperations.moveWordRight(wordSeparators, model, position, 2 /* WordNavigationType.WordEnd */),\n            WordOperations._moveWordPartRight(model, position)\n        ]);\n        candidates.sort(Position.compare);\n        return candidates[0];\n    }\n}\nfunction enforceDefined(arr) {\n    return arr.filter(el => Boolean(el));\n}\n"],"mappings":"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"}]}