{"remainingRequest":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/thread-loader/dist/cjs.js!/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js!/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/editor/browser/coreCommands.js","dependencies":[{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/editor/browser/coreCommands.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/babel.config.js","mtime":1668271197000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9zbGljZWRUb0FycmF5IGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vc2xpY2VkVG9BcnJheS5qcyI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjay5qcyI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcy5qcyI7CmltcG9ydCBfaW5oZXJpdHMgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9pbmhlcml0cy5qcyI7CmltcG9ydCBfY3JlYXRlU3VwZXIgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVTdXBlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5kZXNjcmlwdGlvbi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmF0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmF0LWFsdGVybmF0aXZlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc3BsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnN0aWNreS5qcyI7Ci8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAqICBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uCiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwppbXBvcnQgKiBhcyBubHMgZnJvbSAnLi4vLi4vbmxzLmpzJzsKaW1wb3J0IHsgaXNGaXJlZm94IH0gZnJvbSAnLi4vLi4vYmFzZS9icm93c2VyL2Jyb3dzZXIuanMnOwppbXBvcnQgKiBhcyB0eXBlcyBmcm9tICcuLi8uLi9iYXNlL2NvbW1vbi90eXBlcy5qcyc7CmltcG9ydCB7IHN0YXR1cyB9IGZyb20gJy4uLy4uL2Jhc2UvYnJvd3Nlci91aS9hcmlhL2FyaWEuanMnOwppbXBvcnQgeyBDb21tYW5kLCBFZGl0b3JDb21tYW5kLCByZWdpc3RlckVkaXRvckNvbW1hbmQsIFVuZG9Db21tYW5kLCBSZWRvQ29tbWFuZCwgU2VsZWN0QWxsQ29tbWFuZCB9IGZyb20gJy4vZWRpdG9yRXh0ZW5zaW9ucy5qcyc7CmltcG9ydCB7IElDb2RlRWRpdG9yU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvY29kZUVkaXRvclNlcnZpY2UuanMnOwppbXBvcnQgeyBDb2x1bW5TZWxlY3Rpb24gfSBmcm9tICcuLi9jb21tb24vY3Vyc29yL2N1cnNvckNvbHVtblNlbGVjdGlvbi5qcyc7CmltcG9ydCB7IEN1cnNvclN0YXRlIH0gZnJvbSAnLi4vY29tbW9uL2N1cnNvckNvbW1vbi5qcyc7CmltcG9ydCB7IERlbGV0ZU9wZXJhdGlvbnMgfSBmcm9tICcuLi9jb21tb24vY3Vyc29yL2N1cnNvckRlbGV0ZU9wZXJhdGlvbnMuanMnOwppbXBvcnQgeyBDdXJzb3JNb3ZlIGFzIEN1cnNvck1vdmVfLCBDdXJzb3JNb3ZlQ29tbWFuZHMgfSBmcm9tICcuLi9jb21tb24vY3Vyc29yL2N1cnNvck1vdmVDb21tYW5kcy5qcyc7CmltcG9ydCB7IFR5cGVPcGVyYXRpb25zIH0gZnJvbSAnLi4vY29tbW9uL2N1cnNvci9jdXJzb3JUeXBlT3BlcmF0aW9ucy5qcyc7CmltcG9ydCB7IFBvc2l0aW9uIH0gZnJvbSAnLi4vY29tbW9uL2NvcmUvcG9zaXRpb24uanMnOwppbXBvcnQgeyBSYW5nZSB9IGZyb20gJy4uL2NvbW1vbi9jb3JlL3JhbmdlLmpzJzsKaW1wb3J0IHsgRWRpdG9yQ29udGV4dEtleXMgfSBmcm9tICcuLi9jb21tb24vZWRpdG9yQ29udGV4dEtleXMuanMnOwppbXBvcnQgeyBDb250ZXh0S2V5RXhwciB9IGZyb20gJy4uLy4uL3BsYXRmb3JtL2NvbnRleHRrZXkvY29tbW9uL2NvbnRleHRrZXkuanMnOwppbXBvcnQgeyBLZXliaW5kaW5nc1JlZ2lzdHJ5IH0gZnJvbSAnLi4vLi4vcGxhdGZvcm0va2V5YmluZGluZy9jb21tb24va2V5YmluZGluZ3NSZWdpc3RyeS5qcyc7CnZhciBDT1JFX1dFSUdIVCA9IDAgLyogS2V5YmluZGluZ1dlaWdodC5FZGl0b3JDb3JlICovOwpleHBvcnQgdmFyIENvcmVFZGl0b3JDb21tYW5kID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfRWRpdG9yQ29tbWFuZCkgewogIF9pbmhlcml0cyhDb3JlRWRpdG9yQ29tbWFuZCwgX0VkaXRvckNvbW1hbmQpOwogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoQ29yZUVkaXRvckNvbW1hbmQpOwogIGZ1bmN0aW9uIENvcmVFZGl0b3JDb21tYW5kKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENvcmVFZGl0b3JDb21tYW5kKTsKICAgIHJldHVybiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9CiAgX2NyZWF0ZUNsYXNzKENvcmVFZGl0b3JDb21tYW5kLCBbewogICAga2V5OiAicnVuRWRpdG9yQ29tbWFuZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcnVuRWRpdG9yQ29tbWFuZChhY2Nlc3NvciwgZWRpdG9yLCBhcmdzKSB7CiAgICAgIHZhciB2aWV3TW9kZWwgPSBlZGl0b3IuX2dldFZpZXdNb2RlbCgpOwogICAgICBpZiAoIXZpZXdNb2RlbCkgewogICAgICAgIC8vIHRoZSBlZGl0b3IgaGFzIG5vIHZpZXcgPT4gaGFzIG5vIGN1cnNvcnMKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy5ydW5Db3JlRWRpdG9yQ29tbWFuZCh2aWV3TW9kZWwsIGFyZ3MgfHwge30pOwogICAgfQogIH1dKTsKICByZXR1cm4gQ29yZUVkaXRvckNvbW1hbmQ7Cn0oRWRpdG9yQ29tbWFuZCk7CmV4cG9ydCB2YXIgRWRpdG9yU2Nyb2xsXzsKKGZ1bmN0aW9uIChFZGl0b3JTY3JvbGxfKSB7CiAgdmFyIGlzRWRpdG9yU2Nyb2xsQXJncyA9IGZ1bmN0aW9uIGlzRWRpdG9yU2Nyb2xsQXJncyhhcmcpIHsKICAgIGlmICghdHlwZXMuaXNPYmplY3QoYXJnKSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICB2YXIgc2Nyb2xsQXJnID0gYXJnOwogICAgaWYgKCF0eXBlcy5pc1N0cmluZyhzY3JvbGxBcmcudG8pKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIGlmICghdHlwZXMuaXNVbmRlZmluZWQoc2Nyb2xsQXJnLmJ5KSAmJiAhdHlwZXMuaXNTdHJpbmcoc2Nyb2xsQXJnLmJ5KSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICBpZiAoIXR5cGVzLmlzVW5kZWZpbmVkKHNjcm9sbEFyZy52YWx1ZSkgJiYgIXR5cGVzLmlzTnVtYmVyKHNjcm9sbEFyZy52YWx1ZSkpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgaWYgKCF0eXBlcy5pc1VuZGVmaW5lZChzY3JvbGxBcmcucmV2ZWFsQ3Vyc29yKSAmJiAhdHlwZXMuaXNCb29sZWFuKHNjcm9sbEFyZy5yZXZlYWxDdXJzb3IpKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIHJldHVybiB0cnVlOwogIH07CiAgRWRpdG9yU2Nyb2xsXy5kZXNjcmlwdGlvbiA9IHsKICAgIGRlc2NyaXB0aW9uOiAnU2Nyb2xsIGVkaXRvciBpbiB0aGUgZ2l2ZW4gZGlyZWN0aW9uJywKICAgIGFyZ3M6IFt7CiAgICAgIG5hbWU6ICdFZGl0b3Igc2Nyb2xsIGFyZ3VtZW50IG9iamVjdCcsCiAgICAgIGRlc2NyaXB0aW9uOiAiUHJvcGVydHktdmFsdWUgcGFpcnMgdGhhdCBjYW4gYmUgcGFzc2VkIHRocm91Z2ggdGhpcyBhcmd1bWVudDpcblx0XHRcdFx0XHQqICd0byc6IEEgbWFuZGF0b3J5IGRpcmVjdGlvbiB2YWx1ZS5cblx0XHRcdFx0XHRcdGBgYFxuXHRcdFx0XHRcdFx0J3VwJywgJ2Rvd24nXG5cdFx0XHRcdFx0XHRgYGBcblx0XHRcdFx0XHQqICdieSc6IFVuaXQgdG8gbW92ZS4gRGVmYXVsdCBpcyBjb21wdXRlZCBiYXNlZCBvbiAndG8nIHZhbHVlLlxuXHRcdFx0XHRcdFx0YGBgXG5cdFx0XHRcdFx0XHQnbGluZScsICd3cmFwcGVkTGluZScsICdwYWdlJywgJ2hhbGZQYWdlJywgJ2VkaXRvcidcblx0XHRcdFx0XHRcdGBgYFxuXHRcdFx0XHRcdCogJ3ZhbHVlJzogTnVtYmVyIG9mIHVuaXRzIHRvIG1vdmUuIERlZmF1bHQgaXMgJzEnLlxuXHRcdFx0XHRcdCogJ3JldmVhbEN1cnNvcic6IElmICd0cnVlJyByZXZlYWxzIHRoZSBjdXJzb3IgaWYgaXQgaXMgb3V0c2lkZSB2aWV3IHBvcnQuXG5cdFx0XHRcdCIsCiAgICAgIGNvbnN0cmFpbnQ6IGlzRWRpdG9yU2Nyb2xsQXJncywKICAgICAgc2NoZW1hOiB7CiAgICAgICAgJ3R5cGUnOiAnb2JqZWN0JywKICAgICAgICAncmVxdWlyZWQnOiBbJ3RvJ10sCiAgICAgICAgJ3Byb3BlcnRpZXMnOiB7CiAgICAgICAgICAndG8nOiB7CiAgICAgICAgICAgICd0eXBlJzogJ3N0cmluZycsCiAgICAgICAgICAgICdlbnVtJzogWyd1cCcsICdkb3duJ10KICAgICAgICAgIH0sCiAgICAgICAgICAnYnknOiB7CiAgICAgICAgICAgICd0eXBlJzogJ3N0cmluZycsCiAgICAgICAgICAgICdlbnVtJzogWydsaW5lJywgJ3dyYXBwZWRMaW5lJywgJ3BhZ2UnLCAnaGFsZlBhZ2UnLCAnZWRpdG9yJ10KICAgICAgICAgIH0sCiAgICAgICAgICAndmFsdWUnOiB7CiAgICAgICAgICAgICd0eXBlJzogJ251bWJlcicsCiAgICAgICAgICAgICdkZWZhdWx0JzogMQogICAgICAgICAgfSwKICAgICAgICAgICdyZXZlYWxDdXJzb3InOiB7CiAgICAgICAgICAgICd0eXBlJzogJ2Jvb2xlYW4nCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9XQogIH07CiAgLyoqCiAgICogRGlyZWN0aW9ucyBpbiB0aGUgdmlldyBmb3IgZWRpdG9yIHNjcm9sbCBjb21tYW5kLgogICAqLwogIEVkaXRvclNjcm9sbF8uUmF3RGlyZWN0aW9uID0gewogICAgVXA6ICd1cCcsCiAgICBEb3duOiAnZG93bicKICB9OwogIC8qKgogICAqIFVuaXRzIGZvciBlZGl0b3Igc2Nyb2xsICdieScgYXJndW1lbnQKICAgKi8KICBFZGl0b3JTY3JvbGxfLlJhd1VuaXQgPSB7CiAgICBMaW5lOiAnbGluZScsCiAgICBXcmFwcGVkTGluZTogJ3dyYXBwZWRMaW5lJywKICAgIFBhZ2U6ICdwYWdlJywKICAgIEhhbGZQYWdlOiAnaGFsZlBhZ2UnLAogICAgRWRpdG9yOiAnZWRpdG9yJwogIH07CiAgZnVuY3Rpb24gcGFyc2UoYXJncykgewogICAgdmFyIGRpcmVjdGlvbjsKICAgIHN3aXRjaCAoYXJncy50bykgewogICAgICBjYXNlIEVkaXRvclNjcm9sbF8uUmF3RGlyZWN0aW9uLlVwOgogICAgICAgIGRpcmVjdGlvbiA9IDEgLyogRGlyZWN0aW9uLlVwICovOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIEVkaXRvclNjcm9sbF8uUmF3RGlyZWN0aW9uLkRvd246CiAgICAgICAgZGlyZWN0aW9uID0gMiAvKiBEaXJlY3Rpb24uRG93biAqLzsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICAvLyBJbGxlZ2FsIGFyZ3VtZW50cwogICAgICAgIHJldHVybiBudWxsOwogICAgfQogICAgdmFyIHVuaXQ7CiAgICBzd2l0Y2ggKGFyZ3MuYnkpIHsKICAgICAgY2FzZSBFZGl0b3JTY3JvbGxfLlJhd1VuaXQuTGluZToKICAgICAgICB1bml0ID0gMSAvKiBVbml0LkxpbmUgKi87CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgRWRpdG9yU2Nyb2xsXy5SYXdVbml0LldyYXBwZWRMaW5lOgogICAgICAgIHVuaXQgPSAyIC8qIFVuaXQuV3JhcHBlZExpbmUgKi87CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgRWRpdG9yU2Nyb2xsXy5SYXdVbml0LlBhZ2U6CiAgICAgICAgdW5pdCA9IDMgLyogVW5pdC5QYWdlICovOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIEVkaXRvclNjcm9sbF8uUmF3VW5pdC5IYWxmUGFnZToKICAgICAgICB1bml0ID0gNCAvKiBVbml0LkhhbGZQYWdlICovOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIEVkaXRvclNjcm9sbF8uUmF3VW5pdC5FZGl0b3I6CiAgICAgICAgdW5pdCA9IDUgLyogVW5pdC5FZGl0b3IgKi87CiAgICAgICAgYnJlYWs7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgdW5pdCA9IDIgLyogVW5pdC5XcmFwcGVkTGluZSAqLzsKICAgIH0KCiAgICB2YXIgdmFsdWUgPSBNYXRoLmZsb29yKGFyZ3MudmFsdWUgfHwgMSk7CiAgICB2YXIgcmV2ZWFsQ3Vyc29yID0gISFhcmdzLnJldmVhbEN1cnNvcjsKICAgIHJldHVybiB7CiAgICAgIGRpcmVjdGlvbjogZGlyZWN0aW9uLAogICAgICB1bml0OiB1bml0LAogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIHJldmVhbEN1cnNvcjogcmV2ZWFsQ3Vyc29yLAogICAgICBzZWxlY3Q6ICEhYXJncy5zZWxlY3QKICAgIH07CiAgfQogIEVkaXRvclNjcm9sbF8ucGFyc2UgPSBwYXJzZTsKfSkoRWRpdG9yU2Nyb2xsXyB8fCAoRWRpdG9yU2Nyb2xsXyA9IHt9KSk7CmV4cG9ydCB2YXIgUmV2ZWFsTGluZV87CihmdW5jdGlvbiAoUmV2ZWFsTGluZV8pIHsKICB2YXIgaXNSZXZlYWxMaW5lQXJncyA9IGZ1bmN0aW9uIGlzUmV2ZWFsTGluZUFyZ3MoYXJnKSB7CiAgICBpZiAoIXR5cGVzLmlzT2JqZWN0KGFyZykpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgdmFyIHJldmVhTGluZUFyZyA9IGFyZzsKICAgIGlmICghdHlwZXMuaXNOdW1iZXIocmV2ZWFMaW5lQXJnLmxpbmVOdW1iZXIpICYmICF0eXBlcy5pc1N0cmluZyhyZXZlYUxpbmVBcmcubGluZU51bWJlcikpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgaWYgKCF0eXBlcy5pc1VuZGVmaW5lZChyZXZlYUxpbmVBcmcuYXQpICYmICF0eXBlcy5pc1N0cmluZyhyZXZlYUxpbmVBcmcuYXQpKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIHJldHVybiB0cnVlOwogIH07CiAgUmV2ZWFsTGluZV8uZGVzY3JpcHRpb24gPSB7CiAgICBkZXNjcmlwdGlvbjogJ1JldmVhbCB0aGUgZ2l2ZW4gbGluZSBhdCB0aGUgZ2l2ZW4gbG9naWNhbCBwb3NpdGlvbicsCiAgICBhcmdzOiBbewogICAgICBuYW1lOiAnUmV2ZWFsIGxpbmUgYXJndW1lbnQgb2JqZWN0JywKICAgICAgZGVzY3JpcHRpb246ICJQcm9wZXJ0eS12YWx1ZSBwYWlycyB0aGF0IGNhbiBiZSBwYXNzZWQgdGhyb3VnaCB0aGlzIGFyZ3VtZW50OlxuXHRcdFx0XHRcdCogJ2xpbmVOdW1iZXInOiBBIG1hbmRhdG9yeSBsaW5lIG51bWJlciB2YWx1ZS5cblx0XHRcdFx0XHQqICdhdCc6IExvZ2ljYWwgcG9zaXRpb24gYXQgd2hpY2ggbGluZSBoYXMgdG8gYmUgcmV2ZWFsZWQuXG5cdFx0XHRcdFx0XHRgYGBcblx0XHRcdFx0XHRcdCd0b3AnLCAnY2VudGVyJywgJ2JvdHRvbSdcblx0XHRcdFx0XHRcdGBgYFxuXHRcdFx0XHQiLAogICAgICBjb25zdHJhaW50OiBpc1JldmVhbExpbmVBcmdzLAogICAgICBzY2hlbWE6IHsKICAgICAgICAndHlwZSc6ICdvYmplY3QnLAogICAgICAgICdyZXF1aXJlZCc6IFsnbGluZU51bWJlciddLAogICAgICAgICdwcm9wZXJ0aWVzJzogewogICAgICAgICAgJ2xpbmVOdW1iZXInOiB7CiAgICAgICAgICAgICd0eXBlJzogWydudW1iZXInLCAnc3RyaW5nJ10KICAgICAgICAgIH0sCiAgICAgICAgICAnYXQnOiB7CiAgICAgICAgICAgICd0eXBlJzogJ3N0cmluZycsCiAgICAgICAgICAgICdlbnVtJzogWyd0b3AnLCAnY2VudGVyJywgJ2JvdHRvbSddCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9XQogIH07CiAgLyoqCiAgICogVmFsdWVzIGZvciByZXZlYWwgbGluZSAnYXQnIGFyZ3VtZW50CiAgICovCiAgUmV2ZWFsTGluZV8uUmF3QXRBcmd1bWVudCA9IHsKICAgIFRvcDogJ3RvcCcsCiAgICBDZW50ZXI6ICdjZW50ZXInLAogICAgQm90dG9tOiAnYm90dG9tJwogIH07Cn0pKFJldmVhbExpbmVfIHx8IChSZXZlYWxMaW5lXyA9IHt9KSk7CnZhciBFZGl0b3JPck5hdGl2ZVRleHRJbnB1dENvbW1hbmQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEVkaXRvck9yTmF0aXZlVGV4dElucHV0Q29tbWFuZCh0YXJnZXQpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRWRpdG9yT3JOYXRpdmVUZXh0SW5wdXRDb21tYW5kKTsKICAgIC8vIDEuIGhhbmRsZSBjYXNlIHdoZW4gZm9jdXMgaXMgaW4gZWRpdG9yLgogICAgdGFyZ2V0LmFkZEltcGxlbWVudGF0aW9uKDEwMDAwLCAnY29kZS1lZGl0b3InLCBmdW5jdGlvbiAoYWNjZXNzb3IsIGFyZ3MpIHsKICAgICAgLy8gT25seSBpZiBlZGl0b3IgdGV4dCBmb2N1cyAoaS5lLiBub3QgaWYgZWRpdG9yIGhhcyB3aWRnZXQgZm9jdXMpLgogICAgICB2YXIgZm9jdXNlZEVkaXRvciA9IGFjY2Vzc29yLmdldChJQ29kZUVkaXRvclNlcnZpY2UpLmdldEZvY3VzZWRDb2RlRWRpdG9yKCk7CiAgICAgIGlmIChmb2N1c2VkRWRpdG9yICYmIGZvY3VzZWRFZGl0b3IuaGFzVGV4dEZvY3VzKCkpIHsKICAgICAgICByZXR1cm4gX3RoaXMuX3J1bkVkaXRvckNvbW1hbmQoYWNjZXNzb3IsIGZvY3VzZWRFZGl0b3IsIGFyZ3MpOwogICAgICB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0pOwogICAgLy8gMi4gaGFuZGxlIGNhc2Ugd2hlbiBmb2N1cyBpcyBpbiBzb21lIG90aGVyIGBpbnB1dGAgLyBgdGV4dGFyZWFgLgogICAgdGFyZ2V0LmFkZEltcGxlbWVudGF0aW9uKDEwMDAsICdnZW5lcmljLWRvbS1pbnB1dC10ZXh0YXJlYScsIGZ1bmN0aW9uIChhY2Nlc3NvciwgYXJncykgewogICAgICAvLyBPbmx5IGlmIGZvY3VzZWQgb24gYW4gZWxlbWVudCB0aGF0IGFsbG93cyBmb3IgZW50ZXJpbmcgdGV4dAogICAgICB2YXIgYWN0aXZlRWxlbWVudCA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7CiAgICAgIGlmIChhY3RpdmVFbGVtZW50ICYmIFsnaW5wdXQnLCAndGV4dGFyZWEnXS5pbmRleE9mKGFjdGl2ZUVsZW1lbnQudGFnTmFtZS50b0xvd2VyQ2FzZSgpKSA+PSAwKSB7CiAgICAgICAgX3RoaXMucnVuRE9NQ29tbWFuZCgpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0pOwogICAgLy8gMy4gKGRlZmF1bHQpIGhhbmRsZSBjYXNlIHdoZW4gZm9jdXMgaXMgc29tZXdoZXJlIGVsc2UuCiAgICB0YXJnZXQuYWRkSW1wbGVtZW50YXRpb24oMCwgJ2dlbmVyaWMtZG9tJywgZnVuY3Rpb24gKGFjY2Vzc29yLCBhcmdzKSB7CiAgICAgIC8vIFJlZGlyZWN0aW5nIHRvIGFjdGl2ZSBlZGl0b3IKICAgICAgdmFyIGFjdGl2ZUVkaXRvciA9IGFjY2Vzc29yLmdldChJQ29kZUVkaXRvclNlcnZpY2UpLmdldEFjdGl2ZUNvZGVFZGl0b3IoKTsKICAgICAgaWYgKGFjdGl2ZUVkaXRvcikgewogICAgICAgIGFjdGl2ZUVkaXRvci5mb2N1cygpOwogICAgICAgIHJldHVybiBfdGhpcy5fcnVuRWRpdG9yQ29tbWFuZChhY2Nlc3NvciwgYWN0aXZlRWRpdG9yLCBhcmdzKTsKICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9KTsKICB9CiAgX2NyZWF0ZUNsYXNzKEVkaXRvck9yTmF0aXZlVGV4dElucHV0Q29tbWFuZCwgW3sKICAgIGtleTogIl9ydW5FZGl0b3JDb21tYW5kIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfcnVuRWRpdG9yQ29tbWFuZChhY2Nlc3NvciwgZWRpdG9yLCBhcmdzKSB7CiAgICAgIHZhciByZXN1bHQgPSB0aGlzLnJ1bkVkaXRvckNvbW1hbmQoYWNjZXNzb3IsIGVkaXRvciwgYXJncyk7CiAgICAgIGlmIChyZXN1bHQpIHsKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICB9CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH1dKTsKICByZXR1cm4gRWRpdG9yT3JOYXRpdmVUZXh0SW5wdXRDb21tYW5kOwp9KCk7CmV4cG9ydCB2YXIgQ29yZU5hdmlnYXRpb25Db21tYW5kczsKKGZ1bmN0aW9uIChDb3JlTmF2aWdhdGlvbkNvbW1hbmRzKSB7CiAgdmFyIEJhc2VNb3ZlVG9Db21tYW5kID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29yZUVkaXRvckNvbW1hbmQpIHsKICAgIF9pbmhlcml0cyhCYXNlTW92ZVRvQ29tbWFuZCwgX0NvcmVFZGl0b3JDb21tYW5kKTsKICAgIHZhciBfc3VwZXIyID0gX2NyZWF0ZVN1cGVyKEJhc2VNb3ZlVG9Db21tYW5kKTsKICAgIGZ1bmN0aW9uIEJhc2VNb3ZlVG9Db21tYW5kKG9wdHMpIHsKICAgICAgdmFyIF90aGlzMjsKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEJhc2VNb3ZlVG9Db21tYW5kKTsKICAgICAgX3RoaXMyID0gX3N1cGVyMi5jYWxsKHRoaXMsIG9wdHMpOwogICAgICBfdGhpczIuX21pbmltYWxSZXZlYWwgPSBvcHRzLm1pbmltYWxSZXZlYWw7CiAgICAgIF90aGlzMi5faW5TZWxlY3Rpb25Nb2RlID0gb3B0cy5pblNlbGVjdGlvbk1vZGU7CiAgICAgIHJldHVybiBfdGhpczI7CiAgICB9CiAgICBfY3JlYXRlQ2xhc3MoQmFzZU1vdmVUb0NvbW1hbmQsIFt7CiAgICAgIGtleTogInJ1bkNvcmVFZGl0b3JDb21tYW5kIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJ1bkNvcmVFZGl0b3JDb21tYW5kKHZpZXdNb2RlbCwgYXJncykgewogICAgICAgIHZpZXdNb2RlbC5tb2RlbC5wdXNoU3RhY2tFbGVtZW50KCk7CiAgICAgICAgdmFyIGN1cnNvclN0YXRlQ2hhbmdlZCA9IHZpZXdNb2RlbC5zZXRDdXJzb3JTdGF0ZXMoYXJncy5zb3VyY2UsIDMgLyogQ3Vyc29yQ2hhbmdlUmVhc29uLkV4cGxpY2l0ICovLCBbQ3Vyc29yTW92ZUNvbW1hbmRzLm1vdmVUbyh2aWV3TW9kZWwsIHZpZXdNb2RlbC5nZXRQcmltYXJ5Q3Vyc29yU3RhdGUoKSwgdGhpcy5faW5TZWxlY3Rpb25Nb2RlLCBhcmdzLnBvc2l0aW9uLCBhcmdzLnZpZXdQb3NpdGlvbildKTsKICAgICAgICBpZiAoY3Vyc29yU3RhdGVDaGFuZ2VkKSB7CiAgICAgICAgICB2aWV3TW9kZWwucmV2ZWFsUHJpbWFyeUN1cnNvcihhcmdzLnNvdXJjZSwgdHJ1ZSwgdGhpcy5fbWluaW1hbFJldmVhbCk7CiAgICAgICAgfQogICAgICB9CiAgICB9XSk7CiAgICByZXR1cm4gQmFzZU1vdmVUb0NvbW1hbmQ7CiAgfShDb3JlRWRpdG9yQ29tbWFuZCk7CiAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5Nb3ZlVG8gPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3IEJhc2VNb3ZlVG9Db21tYW5kKHsKICAgIGlkOiAnX21vdmVUbycsCiAgICBtaW5pbWFsUmV2ZWFsOiB0cnVlLAogICAgaW5TZWxlY3Rpb25Nb2RlOiBmYWxzZSwKICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkCiAgfSkpOwogIENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMuTW92ZVRvU2VsZWN0ID0gcmVnaXN0ZXJFZGl0b3JDb21tYW5kKG5ldyBCYXNlTW92ZVRvQ29tbWFuZCh7CiAgICBpZDogJ19tb3ZlVG9TZWxlY3QnLAogICAgbWluaW1hbFJldmVhbDogZmFsc2UsCiAgICBpblNlbGVjdGlvbk1vZGU6IHRydWUsCiAgICBwcmVjb25kaXRpb246IHVuZGVmaW5lZAogIH0pKTsKICB2YXIgQ29sdW1uU2VsZWN0Q29tbWFuZCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NvcmVFZGl0b3JDb21tYW5kMikgewogICAgX2luaGVyaXRzKENvbHVtblNlbGVjdENvbW1hbmQsIF9Db3JlRWRpdG9yQ29tbWFuZDIpOwogICAgdmFyIF9zdXBlcjMgPSBfY3JlYXRlU3VwZXIoQ29sdW1uU2VsZWN0Q29tbWFuZCk7CiAgICBmdW5jdGlvbiBDb2x1bW5TZWxlY3RDb21tYW5kKCkgewogICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ29sdW1uU2VsZWN0Q29tbWFuZCk7CiAgICAgIHJldHVybiBfc3VwZXIzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9CiAgICBfY3JlYXRlQ2xhc3MoQ29sdW1uU2VsZWN0Q29tbWFuZCwgW3sKICAgICAga2V5OiAicnVuQ29yZUVkaXRvckNvbW1hbmQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcnVuQ29yZUVkaXRvckNvbW1hbmQodmlld01vZGVsLCBhcmdzKSB7CiAgICAgICAgdmlld01vZGVsLm1vZGVsLnB1c2hTdGFja0VsZW1lbnQoKTsKICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5fZ2V0Q29sdW1uU2VsZWN0UmVzdWx0KHZpZXdNb2RlbCwgdmlld01vZGVsLmdldFByaW1hcnlDdXJzb3JTdGF0ZSgpLCB2aWV3TW9kZWwuZ2V0Q3Vyc29yQ29sdW1uU2VsZWN0RGF0YSgpLCBhcmdzKTsKICAgICAgICB2aWV3TW9kZWwuc2V0Q3Vyc29yU3RhdGVzKGFyZ3Muc291cmNlLCAzIC8qIEN1cnNvckNoYW5nZVJlYXNvbi5FeHBsaWNpdCAqLywgcmVzdWx0LnZpZXdTdGF0ZXMubWFwKGZ1bmN0aW9uICh2aWV3U3RhdGUpIHsKICAgICAgICAgIHJldHVybiBDdXJzb3JTdGF0ZS5mcm9tVmlld1N0YXRlKHZpZXdTdGF0ZSk7CiAgICAgICAgfSkpOwogICAgICAgIHZpZXdNb2RlbC5zZXRDdXJzb3JDb2x1bW5TZWxlY3REYXRhKHsKICAgICAgICAgIGlzUmVhbDogdHJ1ZSwKICAgICAgICAgIGZyb21WaWV3TGluZU51bWJlcjogcmVzdWx0LmZyb21MaW5lTnVtYmVyLAogICAgICAgICAgZnJvbVZpZXdWaXN1YWxDb2x1bW46IHJlc3VsdC5mcm9tVmlzdWFsQ29sdW1uLAogICAgICAgICAgdG9WaWV3TGluZU51bWJlcjogcmVzdWx0LnRvTGluZU51bWJlciwKICAgICAgICAgIHRvVmlld1Zpc3VhbENvbHVtbjogcmVzdWx0LnRvVmlzdWFsQ29sdW1uCiAgICAgICAgfSk7CiAgICAgICAgaWYgKHJlc3VsdC5yZXZlcnNlZCkgewogICAgICAgICAgdmlld01vZGVsLnJldmVhbFRvcE1vc3RDdXJzb3IoYXJncy5zb3VyY2UpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2aWV3TW9kZWwucmV2ZWFsQm90dG9tTW9zdEN1cnNvcihhcmdzLnNvdXJjZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9XSk7CiAgICByZXR1cm4gQ29sdW1uU2VsZWN0Q29tbWFuZDsKICB9KENvcmVFZGl0b3JDb21tYW5kKTsKICBDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkNvbHVtblNlbGVjdCA9IHJlZ2lzdGVyRWRpdG9yQ29tbWFuZChuZXcgKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Db2x1bW5TZWxlY3RDb21tYW5kKSB7CiAgICBfaW5oZXJpdHMoX2NsYXNzLCBfQ29sdW1uU2VsZWN0Q29tbWFuZCk7CiAgICB2YXIgX3N1cGVyNCA9IF9jcmVhdGVTdXBlcihfY2xhc3MpOwogICAgZnVuY3Rpb24gX2NsYXNzKCkgewogICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgX2NsYXNzKTsKICAgICAgcmV0dXJuIF9zdXBlcjQuY2FsbCh0aGlzLCB7CiAgICAgICAgaWQ6ICdjb2x1bW5TZWxlY3QnLAogICAgICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkCiAgICAgIH0pOwogICAgfQogICAgX2NyZWF0ZUNsYXNzKF9jbGFzcywgW3sKICAgICAga2V5OiAiX2dldENvbHVtblNlbGVjdFJlc3VsdCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0Q29sdW1uU2VsZWN0UmVzdWx0KHZpZXdNb2RlbCwgcHJpbWFyeSwgcHJldkNvbHVtblNlbGVjdERhdGEsIGFyZ3MpIHsKICAgICAgICAvLyB2YWxpZGF0ZSBgYXJnc2AKICAgICAgICB2YXIgdmFsaWRhdGVkUG9zaXRpb24gPSB2aWV3TW9kZWwubW9kZWwudmFsaWRhdGVQb3NpdGlvbihhcmdzLnBvc2l0aW9uKTsKICAgICAgICB2YXIgdmFsaWRhdGVkVmlld1Bvc2l0aW9uID0gdmlld01vZGVsLmNvb3JkaW5hdGVzQ29udmVydGVyLnZhbGlkYXRlVmlld1Bvc2l0aW9uKG5ldyBQb3NpdGlvbihhcmdzLnZpZXdQb3NpdGlvbi5saW5lTnVtYmVyLCBhcmdzLnZpZXdQb3NpdGlvbi5jb2x1bW4pLCB2YWxpZGF0ZWRQb3NpdGlvbik7CiAgICAgICAgdmFyIGZyb21WaWV3TGluZU51bWJlciA9IGFyZ3MuZG9Db2x1bW5TZWxlY3QgPyBwcmV2Q29sdW1uU2VsZWN0RGF0YS5mcm9tVmlld0xpbmVOdW1iZXIgOiB2YWxpZGF0ZWRWaWV3UG9zaXRpb24ubGluZU51bWJlcjsKICAgICAgICB2YXIgZnJvbVZpZXdWaXN1YWxDb2x1bW4gPSBhcmdzLmRvQ29sdW1uU2VsZWN0ID8gcHJldkNvbHVtblNlbGVjdERhdGEuZnJvbVZpZXdWaXN1YWxDb2x1bW4gOiBhcmdzLm1vdXNlQ29sdW1uIC0gMTsKICAgICAgICByZXR1cm4gQ29sdW1uU2VsZWN0aW9uLmNvbHVtblNlbGVjdCh2aWV3TW9kZWwuY3Vyc29yQ29uZmlnLCB2aWV3TW9kZWwsIGZyb21WaWV3TGluZU51bWJlciwgZnJvbVZpZXdWaXN1YWxDb2x1bW4sIHZhbGlkYXRlZFZpZXdQb3NpdGlvbi5saW5lTnVtYmVyLCBhcmdzLm1vdXNlQ29sdW1uIC0gMSk7CiAgICAgIH0KICAgIH1dKTsKICAgIHJldHVybiBfY2xhc3M7CiAgfShDb2x1bW5TZWxlY3RDb21tYW5kKSkoKSk7CiAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5DdXJzb3JDb2x1bW5TZWxlY3RMZWZ0ID0gcmVnaXN0ZXJFZGl0b3JDb21tYW5kKG5ldyAoIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NvbHVtblNlbGVjdENvbW1hbmQyKSB7CiAgICBfaW5oZXJpdHMoX2NsYXNzMiwgX0NvbHVtblNlbGVjdENvbW1hbmQyKTsKICAgIHZhciBfc3VwZXI1ID0gX2NyZWF0ZVN1cGVyKF9jbGFzczIpOwogICAgZnVuY3Rpb24gX2NsYXNzMigpIHsKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIF9jbGFzczIpOwogICAgICByZXR1cm4gX3N1cGVyNS5jYWxsKHRoaXMsIHsKICAgICAgICBpZDogJ2N1cnNvckNvbHVtblNlbGVjdExlZnQnLAogICAgICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkLAogICAgICAgIGtiT3B0czogewogICAgICAgICAgd2VpZ2h0OiBDT1JFX1dFSUdIVCwKICAgICAgICAgIGtiRXhwcjogRWRpdG9yQ29udGV4dEtleXMudGV4dElucHV0Rm9jdXMsCiAgICAgICAgICBwcmltYXJ5OiAyMDQ4IC8qIEtleU1vZC5DdHJsQ21kICovIHwgMTAyNCAvKiBLZXlNb2QuU2hpZnQgKi8gfCA1MTIgLyogS2V5TW9kLkFsdCAqLyB8IDE1IC8qIEtleUNvZGUuTGVmdEFycm93ICovLAogICAgICAgICAgbGludXg6IHsKICAgICAgICAgICAgcHJpbWFyeTogMAogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgICBfY3JlYXRlQ2xhc3MoX2NsYXNzMiwgW3sKICAgICAga2V5OiAiX2dldENvbHVtblNlbGVjdFJlc3VsdCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0Q29sdW1uU2VsZWN0UmVzdWx0KHZpZXdNb2RlbCwgcHJpbWFyeSwgcHJldkNvbHVtblNlbGVjdERhdGEsIGFyZ3MpIHsKICAgICAgICByZXR1cm4gQ29sdW1uU2VsZWN0aW9uLmNvbHVtblNlbGVjdExlZnQodmlld01vZGVsLmN1cnNvckNvbmZpZywgdmlld01vZGVsLCBwcmV2Q29sdW1uU2VsZWN0RGF0YSk7CiAgICAgIH0KICAgIH1dKTsKICAgIHJldHVybiBfY2xhc3MyOwogIH0oQ29sdW1uU2VsZWN0Q29tbWFuZCkpKCkpOwogIENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMuQ3Vyc29yQ29sdW1uU2VsZWN0UmlnaHQgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3ICggLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29sdW1uU2VsZWN0Q29tbWFuZDMpIHsKICAgIF9pbmhlcml0cyhfY2xhc3MzLCBfQ29sdW1uU2VsZWN0Q29tbWFuZDMpOwogICAgdmFyIF9zdXBlcjYgPSBfY3JlYXRlU3VwZXIoX2NsYXNzMyk7CiAgICBmdW5jdGlvbiBfY2xhc3MzKCkgewogICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgX2NsYXNzMyk7CiAgICAgIHJldHVybiBfc3VwZXI2LmNhbGwodGhpcywgewogICAgICAgIGlkOiAnY3Vyc29yQ29sdW1uU2VsZWN0UmlnaHQnLAogICAgICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkLAogICAgICAgIGtiT3B0czogewogICAgICAgICAgd2VpZ2h0OiBDT1JFX1dFSUdIVCwKICAgICAgICAgIGtiRXhwcjogRWRpdG9yQ29udGV4dEtleXMudGV4dElucHV0Rm9jdXMsCiAgICAgICAgICBwcmltYXJ5OiAyMDQ4IC8qIEtleU1vZC5DdHJsQ21kICovIHwgMTAyNCAvKiBLZXlNb2QuU2hpZnQgKi8gfCA1MTIgLyogS2V5TW9kLkFsdCAqLyB8IDE3IC8qIEtleUNvZGUuUmlnaHRBcnJvdyAqLywKICAgICAgICAgIGxpbnV4OiB7CiAgICAgICAgICAgIHByaW1hcnk6IDAKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfQogICAgX2NyZWF0ZUNsYXNzKF9jbGFzczMsIFt7CiAgICAgIGtleTogIl9nZXRDb2x1bW5TZWxlY3RSZXN1bHQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gX2dldENvbHVtblNlbGVjdFJlc3VsdCh2aWV3TW9kZWwsIHByaW1hcnksIHByZXZDb2x1bW5TZWxlY3REYXRhLCBhcmdzKSB7CiAgICAgICAgcmV0dXJuIENvbHVtblNlbGVjdGlvbi5jb2x1bW5TZWxlY3RSaWdodCh2aWV3TW9kZWwuY3Vyc29yQ29uZmlnLCB2aWV3TW9kZWwsIHByZXZDb2x1bW5TZWxlY3REYXRhKTsKICAgICAgfQogICAgfV0pOwogICAgcmV0dXJuIF9jbGFzczM7CiAgfShDb2x1bW5TZWxlY3RDb21tYW5kKSkoKSk7CiAgdmFyIENvbHVtblNlbGVjdFVwQ29tbWFuZCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NvbHVtblNlbGVjdENvbW1hbmQ0KSB7CiAgICBfaW5oZXJpdHMoQ29sdW1uU2VsZWN0VXBDb21tYW5kLCBfQ29sdW1uU2VsZWN0Q29tbWFuZDQpOwogICAgdmFyIF9zdXBlcjcgPSBfY3JlYXRlU3VwZXIoQ29sdW1uU2VsZWN0VXBDb21tYW5kKTsKICAgIGZ1bmN0aW9uIENvbHVtblNlbGVjdFVwQ29tbWFuZChvcHRzKSB7CiAgICAgIHZhciBfdGhpczM7CiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDb2x1bW5TZWxlY3RVcENvbW1hbmQpOwogICAgICBfdGhpczMgPSBfc3VwZXI3LmNhbGwodGhpcywgb3B0cyk7CiAgICAgIF90aGlzMy5faXNQYWdlZCA9IG9wdHMuaXNQYWdlZDsKICAgICAgcmV0dXJuIF90aGlzMzsKICAgIH0KICAgIF9jcmVhdGVDbGFzcyhDb2x1bW5TZWxlY3RVcENvbW1hbmQsIFt7CiAgICAgIGtleTogIl9nZXRDb2x1bW5TZWxlY3RSZXN1bHQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gX2dldENvbHVtblNlbGVjdFJlc3VsdCh2aWV3TW9kZWwsIHByaW1hcnksIHByZXZDb2x1bW5TZWxlY3REYXRhLCBhcmdzKSB7CiAgICAgICAgcmV0dXJuIENvbHVtblNlbGVjdGlvbi5jb2x1bW5TZWxlY3RVcCh2aWV3TW9kZWwuY3Vyc29yQ29uZmlnLCB2aWV3TW9kZWwsIHByZXZDb2x1bW5TZWxlY3REYXRhLCB0aGlzLl9pc1BhZ2VkKTsKICAgICAgfQogICAgfV0pOwogICAgcmV0dXJuIENvbHVtblNlbGVjdFVwQ29tbWFuZDsKICB9KENvbHVtblNlbGVjdENvbW1hbmQpOwogIENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMuQ3Vyc29yQ29sdW1uU2VsZWN0VXAgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3IENvbHVtblNlbGVjdFVwQ29tbWFuZCh7CiAgICBpc1BhZ2VkOiBmYWxzZSwKICAgIGlkOiAnY3Vyc29yQ29sdW1uU2VsZWN0VXAnLAogICAgcHJlY29uZGl0aW9uOiB1bmRlZmluZWQsCiAgICBrYk9wdHM6IHsKICAgICAgd2VpZ2h0OiBDT1JFX1dFSUdIVCwKICAgICAga2JFeHByOiBFZGl0b3JDb250ZXh0S2V5cy50ZXh0SW5wdXRGb2N1cywKICAgICAgcHJpbWFyeTogMjA0OCAvKiBLZXlNb2QuQ3RybENtZCAqLyB8IDEwMjQgLyogS2V5TW9kLlNoaWZ0ICovIHwgNTEyIC8qIEtleU1vZC5BbHQgKi8gfCAxNiAvKiBLZXlDb2RlLlVwQXJyb3cgKi8sCiAgICAgIGxpbnV4OiB7CiAgICAgICAgcHJpbWFyeTogMAogICAgICB9CiAgICB9CiAgfSkpOwogIENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMuQ3Vyc29yQ29sdW1uU2VsZWN0UGFnZVVwID0gcmVnaXN0ZXJFZGl0b3JDb21tYW5kKG5ldyBDb2x1bW5TZWxlY3RVcENvbW1hbmQoewogICAgaXNQYWdlZDogdHJ1ZSwKICAgIGlkOiAnY3Vyc29yQ29sdW1uU2VsZWN0UGFnZVVwJywKICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkLAogICAga2JPcHRzOiB7CiAgICAgIHdlaWdodDogQ09SRV9XRUlHSFQsCiAgICAgIGtiRXhwcjogRWRpdG9yQ29udGV4dEtleXMudGV4dElucHV0Rm9jdXMsCiAgICAgIHByaW1hcnk6IDIwNDggLyogS2V5TW9kLkN0cmxDbWQgKi8gfCAxMDI0IC8qIEtleU1vZC5TaGlmdCAqLyB8IDUxMiAvKiBLZXlNb2QuQWx0ICovIHwgMTEgLyogS2V5Q29kZS5QYWdlVXAgKi8sCiAgICAgIGxpbnV4OiB7CiAgICAgICAgcHJpbWFyeTogMAogICAgICB9CiAgICB9CiAgfSkpOwogIHZhciBDb2x1bW5TZWxlY3REb3duQ29tbWFuZCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NvbHVtblNlbGVjdENvbW1hbmQ1KSB7CiAgICBfaW5oZXJpdHMoQ29sdW1uU2VsZWN0RG93bkNvbW1hbmQsIF9Db2x1bW5TZWxlY3RDb21tYW5kNSk7CiAgICB2YXIgX3N1cGVyOCA9IF9jcmVhdGVTdXBlcihDb2x1bW5TZWxlY3REb3duQ29tbWFuZCk7CiAgICBmdW5jdGlvbiBDb2x1bW5TZWxlY3REb3duQ29tbWFuZChvcHRzKSB7CiAgICAgIHZhciBfdGhpczQ7CiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDb2x1bW5TZWxlY3REb3duQ29tbWFuZCk7CiAgICAgIF90aGlzNCA9IF9zdXBlcjguY2FsbCh0aGlzLCBvcHRzKTsKICAgICAgX3RoaXM0Ll9pc1BhZ2VkID0gb3B0cy5pc1BhZ2VkOwogICAgICByZXR1cm4gX3RoaXM0OwogICAgfQogICAgX2NyZWF0ZUNsYXNzKENvbHVtblNlbGVjdERvd25Db21tYW5kLCBbewogICAgICBrZXk6ICJfZ2V0Q29sdW1uU2VsZWN0UmVzdWx0IiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9nZXRDb2x1bW5TZWxlY3RSZXN1bHQodmlld01vZGVsLCBwcmltYXJ5LCBwcmV2Q29sdW1uU2VsZWN0RGF0YSwgYXJncykgewogICAgICAgIHJldHVybiBDb2x1bW5TZWxlY3Rpb24uY29sdW1uU2VsZWN0RG93bih2aWV3TW9kZWwuY3Vyc29yQ29uZmlnLCB2aWV3TW9kZWwsIHByZXZDb2x1bW5TZWxlY3REYXRhLCB0aGlzLl9pc1BhZ2VkKTsKICAgICAgfQogICAgfV0pOwogICAgcmV0dXJuIENvbHVtblNlbGVjdERvd25Db21tYW5kOwogIH0oQ29sdW1uU2VsZWN0Q29tbWFuZCk7CiAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5DdXJzb3JDb2x1bW5TZWxlY3REb3duID0gcmVnaXN0ZXJFZGl0b3JDb21tYW5kKG5ldyBDb2x1bW5TZWxlY3REb3duQ29tbWFuZCh7CiAgICBpc1BhZ2VkOiBmYWxzZSwKICAgIGlkOiAnY3Vyc29yQ29sdW1uU2VsZWN0RG93bicsCiAgICBwcmVjb25kaXRpb246IHVuZGVmaW5lZCwKICAgIGtiT3B0czogewogICAgICB3ZWlnaHQ6IENPUkVfV0VJR0hULAogICAgICBrYkV4cHI6IEVkaXRvckNvbnRleHRLZXlzLnRleHRJbnB1dEZvY3VzLAogICAgICBwcmltYXJ5OiAyMDQ4IC8qIEtleU1vZC5DdHJsQ21kICovIHwgMTAyNCAvKiBLZXlNb2QuU2hpZnQgKi8gfCA1MTIgLyogS2V5TW9kLkFsdCAqLyB8IDE4IC8qIEtleUNvZGUuRG93bkFycm93ICovLAogICAgICBsaW51eDogewogICAgICAgIHByaW1hcnk6IDAKICAgICAgfQogICAgfQogIH0pKTsKICBDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkN1cnNvckNvbHVtblNlbGVjdFBhZ2VEb3duID0gcmVnaXN0ZXJFZGl0b3JDb21tYW5kKG5ldyBDb2x1bW5TZWxlY3REb3duQ29tbWFuZCh7CiAgICBpc1BhZ2VkOiB0cnVlLAogICAgaWQ6ICdjdXJzb3JDb2x1bW5TZWxlY3RQYWdlRG93bicsCiAgICBwcmVjb25kaXRpb246IHVuZGVmaW5lZCwKICAgIGtiT3B0czogewogICAgICB3ZWlnaHQ6IENPUkVfV0VJR0hULAogICAgICBrYkV4cHI6IEVkaXRvckNvbnRleHRLZXlzLnRleHRJbnB1dEZvY3VzLAogICAgICBwcmltYXJ5OiAyMDQ4IC8qIEtleU1vZC5DdHJsQ21kICovIHwgMTAyNCAvKiBLZXlNb2QuU2hpZnQgKi8gfCA1MTIgLyogS2V5TW9kLkFsdCAqLyB8IDEyIC8qIEtleUNvZGUuUGFnZURvd24gKi8sCiAgICAgIGxpbnV4OiB7CiAgICAgICAgcHJpbWFyeTogMAogICAgICB9CiAgICB9CiAgfSkpOwogIHZhciBDdXJzb3JNb3ZlSW1wbCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NvcmVFZGl0b3JDb21tYW5kMykgewogICAgX2luaGVyaXRzKEN1cnNvck1vdmVJbXBsLCBfQ29yZUVkaXRvckNvbW1hbmQzKTsKICAgIHZhciBfc3VwZXI5ID0gX2NyZWF0ZVN1cGVyKEN1cnNvck1vdmVJbXBsKTsKICAgIGZ1bmN0aW9uIEN1cnNvck1vdmVJbXBsKCkgewogICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ3Vyc29yTW92ZUltcGwpOwogICAgICByZXR1cm4gX3N1cGVyOS5jYWxsKHRoaXMsIHsKICAgICAgICBpZDogJ2N1cnNvck1vdmUnLAogICAgICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkLAogICAgICAgIGRlc2NyaXB0aW9uOiBDdXJzb3JNb3ZlXy5kZXNjcmlwdGlvbgogICAgICB9KTsKICAgIH0KICAgIF9jcmVhdGVDbGFzcyhDdXJzb3JNb3ZlSW1wbCwgW3sKICAgICAga2V5OiAicnVuQ29yZUVkaXRvckNvbW1hbmQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcnVuQ29yZUVkaXRvckNvbW1hbmQodmlld01vZGVsLCBhcmdzKSB7CiAgICAgICAgdmFyIHBhcnNlZCA9IEN1cnNvck1vdmVfLnBhcnNlKGFyZ3MpOwogICAgICAgIGlmICghcGFyc2VkKSB7CiAgICAgICAgICAvLyBpbGxlZ2FsIGFyZ3VtZW50cwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB0aGlzLl9ydW5DdXJzb3JNb3ZlKHZpZXdNb2RlbCwgYXJncy5zb3VyY2UsIHBhcnNlZCk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiX3J1bkN1cnNvck1vdmUiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gX3J1bkN1cnNvck1vdmUodmlld01vZGVsLCBzb3VyY2UsIGFyZ3MpIHsKICAgICAgICB2aWV3TW9kZWwubW9kZWwucHVzaFN0YWNrRWxlbWVudCgpOwogICAgICAgIHZpZXdNb2RlbC5zZXRDdXJzb3JTdGF0ZXMoc291cmNlLCAzIC8qIEN1cnNvckNoYW5nZVJlYXNvbi5FeHBsaWNpdCAqLywgQ3Vyc29yTW92ZUltcGwuX21vdmUodmlld01vZGVsLCB2aWV3TW9kZWwuZ2V0Q3Vyc29yU3RhdGVzKCksIGFyZ3MpKTsKICAgICAgICB2aWV3TW9kZWwucmV2ZWFsUHJpbWFyeUN1cnNvcihzb3VyY2UsIHRydWUpOwogICAgICB9CiAgICB9XSwgW3sKICAgICAga2V5OiAiX21vdmUiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gX21vdmUodmlld01vZGVsLCBjdXJzb3JzLCBhcmdzKSB7CiAgICAgICAgdmFyIGluU2VsZWN0aW9uTW9kZSA9IGFyZ3Muc2VsZWN0OwogICAgICAgIHZhciB2YWx1ZSA9IGFyZ3MudmFsdWU7CiAgICAgICAgc3dpdGNoIChhcmdzLmRpcmVjdGlvbikgewogICAgICAgICAgY2FzZSAwIC8qIEN1cnNvck1vdmVfLkRpcmVjdGlvbi5MZWZ0ICovOgogICAgICAgICAgY2FzZSAxIC8qIEN1cnNvck1vdmVfLkRpcmVjdGlvbi5SaWdodCAqLzoKICAgICAgICAgIGNhc2UgMiAvKiBDdXJzb3JNb3ZlXy5EaXJlY3Rpb24uVXAgKi86CiAgICAgICAgICBjYXNlIDMgLyogQ3Vyc29yTW92ZV8uRGlyZWN0aW9uLkRvd24gKi86CiAgICAgICAgICBjYXNlIDQgLyogQ3Vyc29yTW92ZV8uRGlyZWN0aW9uLlByZXZCbGFua0xpbmUgKi86CiAgICAgICAgICBjYXNlIDUgLyogQ3Vyc29yTW92ZV8uRGlyZWN0aW9uLk5leHRCbGFua0xpbmUgKi86CiAgICAgICAgICBjYXNlIDYgLyogQ3Vyc29yTW92ZV8uRGlyZWN0aW9uLldyYXBwZWRMaW5lU3RhcnQgKi86CiAgICAgICAgICBjYXNlIDcgLyogQ3Vyc29yTW92ZV8uRGlyZWN0aW9uLldyYXBwZWRMaW5lRmlyc3ROb25XaGl0ZXNwYWNlQ2hhcmFjdGVyICovOgogICAgICAgICAgY2FzZSA4IC8qIEN1cnNvck1vdmVfLkRpcmVjdGlvbi5XcmFwcGVkTGluZUNvbHVtbkNlbnRlciAqLzoKICAgICAgICAgIGNhc2UgOSAvKiBDdXJzb3JNb3ZlXy5EaXJlY3Rpb24uV3JhcHBlZExpbmVFbmQgKi86CiAgICAgICAgICBjYXNlIDEwIC8qIEN1cnNvck1vdmVfLkRpcmVjdGlvbi5XcmFwcGVkTGluZUxhc3ROb25XaGl0ZXNwYWNlQ2hhcmFjdGVyICovOgogICAgICAgICAgICByZXR1cm4gQ3Vyc29yTW92ZUNvbW1hbmRzLnNpbXBsZU1vdmUodmlld01vZGVsLCBjdXJzb3JzLCBhcmdzLmRpcmVjdGlvbiwgaW5TZWxlY3Rpb25Nb2RlLCB2YWx1ZSwgYXJncy51bml0KTsKICAgICAgICAgIGNhc2UgMTEgLyogQ3Vyc29yTW92ZV8uRGlyZWN0aW9uLlZpZXdQb3J0VG9wICovOgogICAgICAgICAgY2FzZSAxMyAvKiBDdXJzb3JNb3ZlXy5EaXJlY3Rpb24uVmlld1BvcnRCb3R0b20gKi86CiAgICAgICAgICBjYXNlIDEyIC8qIEN1cnNvck1vdmVfLkRpcmVjdGlvbi5WaWV3UG9ydENlbnRlciAqLzoKICAgICAgICAgIGNhc2UgMTQgLyogQ3Vyc29yTW92ZV8uRGlyZWN0aW9uLlZpZXdQb3J0SWZPdXRzaWRlICovOgogICAgICAgICAgICByZXR1cm4gQ3Vyc29yTW92ZUNvbW1hbmRzLnZpZXdwb3J0TW92ZSh2aWV3TW9kZWwsIGN1cnNvcnMsIGFyZ3MuZGlyZWN0aW9uLCBpblNlbGVjdGlvbk1vZGUsIHZhbHVlKTsKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgfQogICAgfV0pOwogICAgcmV0dXJuIEN1cnNvck1vdmVJbXBsOwogIH0oQ29yZUVkaXRvckNvbW1hbmQpOwogIENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMuQ3Vyc29yTW92ZUltcGwgPSBDdXJzb3JNb3ZlSW1wbDsKICBDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkN1cnNvck1vdmUgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3IEN1cnNvck1vdmVJbXBsKCkpOwogIHZhciBDdXJzb3JNb3ZlQmFzZWRDb21tYW5kID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29yZUVkaXRvckNvbW1hbmQ0KSB7CiAgICBfaW5oZXJpdHMoQ3Vyc29yTW92ZUJhc2VkQ29tbWFuZCwgX0NvcmVFZGl0b3JDb21tYW5kNCk7CiAgICB2YXIgX3N1cGVyMTAgPSBfY3JlYXRlU3VwZXIoQ3Vyc29yTW92ZUJhc2VkQ29tbWFuZCk7CiAgICBmdW5jdGlvbiBDdXJzb3JNb3ZlQmFzZWRDb21tYW5kKG9wdHMpIHsKICAgICAgdmFyIF90aGlzNTsKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEN1cnNvck1vdmVCYXNlZENvbW1hbmQpOwogICAgICBfdGhpczUgPSBfc3VwZXIxMC5jYWxsKHRoaXMsIG9wdHMpOwogICAgICBfdGhpczUuX3N0YXRpY0FyZ3MgPSBvcHRzLmFyZ3M7CiAgICAgIHJldHVybiBfdGhpczU7CiAgICB9CiAgICBfY3JlYXRlQ2xhc3MoQ3Vyc29yTW92ZUJhc2VkQ29tbWFuZCwgW3sKICAgICAga2V5OiAicnVuQ29yZUVkaXRvckNvbW1hbmQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcnVuQ29yZUVkaXRvckNvbW1hbmQodmlld01vZGVsLCBkeW5hbWljQXJncykgewogICAgICAgIHZhciBhcmdzID0gdGhpcy5fc3RhdGljQXJnczsKICAgICAgICBpZiAodGhpcy5fc3RhdGljQXJncy52YWx1ZSA9PT0gLTEgLyogQ29uc3RhbnRzLlBBR0VfU0laRV9NQVJLRVIgKi8pIHsKICAgICAgICAgIC8vIC0xIGlzIGEgbWFya2VyIGZvciBwYWdlIHNpemUKICAgICAgICAgIGFyZ3MgPSB7CiAgICAgICAgICAgIGRpcmVjdGlvbjogdGhpcy5fc3RhdGljQXJncy5kaXJlY3Rpb24sCiAgICAgICAgICAgIHVuaXQ6IHRoaXMuX3N0YXRpY0FyZ3MudW5pdCwKICAgICAgICAgICAgc2VsZWN0OiB0aGlzLl9zdGF0aWNBcmdzLnNlbGVjdCwKICAgICAgICAgICAgdmFsdWU6IGR5bmFtaWNBcmdzLnBhZ2VTaXplIHx8IHZpZXdNb2RlbC5jdXJzb3JDb25maWcucGFnZVNpemUKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAgIHZpZXdNb2RlbC5tb2RlbC5wdXNoU3RhY2tFbGVtZW50KCk7CiAgICAgICAgdmlld01vZGVsLnNldEN1cnNvclN0YXRlcyhkeW5hbWljQXJncy5zb3VyY2UsIDMgLyogQ3Vyc29yQ2hhbmdlUmVhc29uLkV4cGxpY2l0ICovLCBDdXJzb3JNb3ZlQ29tbWFuZHMuc2ltcGxlTW92ZSh2aWV3TW9kZWwsIHZpZXdNb2RlbC5nZXRDdXJzb3JTdGF0ZXMoKSwgYXJncy5kaXJlY3Rpb24sIGFyZ3Muc2VsZWN0LCBhcmdzLnZhbHVlLCBhcmdzLnVuaXQpKTsKICAgICAgICB2aWV3TW9kZWwucmV2ZWFsUHJpbWFyeUN1cnNvcihkeW5hbWljQXJncy5zb3VyY2UsIHRydWUpOwogICAgICB9CiAgICB9XSk7CiAgICByZXR1cm4gQ3Vyc29yTW92ZUJhc2VkQ29tbWFuZDsKICB9KENvcmVFZGl0b3JDb21tYW5kKTsKICBDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkN1cnNvckxlZnQgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3IEN1cnNvck1vdmVCYXNlZENvbW1hbmQoewogICAgYXJnczogewogICAgICBkaXJlY3Rpb246IDAgLyogQ3Vyc29yTW92ZV8uRGlyZWN0aW9uLkxlZnQgKi8sCiAgICAgIHVuaXQ6IDAgLyogQ3Vyc29yTW92ZV8uVW5pdC5Ob25lICovLAogICAgICBzZWxlY3Q6IGZhbHNlLAogICAgICB2YWx1ZTogMQogICAgfSwKICAgIGlkOiAnY3Vyc29yTGVmdCcsCiAgICBwcmVjb25kaXRpb246IHVuZGVmaW5lZCwKICAgIGtiT3B0czogewogICAgICB3ZWlnaHQ6IENPUkVfV0VJR0hULAogICAgICBrYkV4cHI6IEVkaXRvckNvbnRleHRLZXlzLnRleHRJbnB1dEZvY3VzLAogICAgICBwcmltYXJ5OiAxNSAvKiBLZXlDb2RlLkxlZnRBcnJvdyAqLywKICAgICAgbWFjOiB7CiAgICAgICAgcHJpbWFyeTogMTUgLyogS2V5Q29kZS5MZWZ0QXJyb3cgKi8sCiAgICAgICAgc2Vjb25kYXJ5OiBbMjU2IC8qIEtleU1vZC5XaW5DdHJsICovIHwgMzIgLyogS2V5Q29kZS5LZXlCICovXQogICAgICB9CiAgICB9CiAgfSkpOwoKICBDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkN1cnNvckxlZnRTZWxlY3QgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3IEN1cnNvck1vdmVCYXNlZENvbW1hbmQoewogICAgYXJnczogewogICAgICBkaXJlY3Rpb246IDAgLyogQ3Vyc29yTW92ZV8uRGlyZWN0aW9uLkxlZnQgKi8sCiAgICAgIHVuaXQ6IDAgLyogQ3Vyc29yTW92ZV8uVW5pdC5Ob25lICovLAogICAgICBzZWxlY3Q6IHRydWUsCiAgICAgIHZhbHVlOiAxCiAgICB9LAogICAgaWQ6ICdjdXJzb3JMZWZ0U2VsZWN0JywKICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkLAogICAga2JPcHRzOiB7CiAgICAgIHdlaWdodDogQ09SRV9XRUlHSFQsCiAgICAgIGtiRXhwcjogRWRpdG9yQ29udGV4dEtleXMudGV4dElucHV0Rm9jdXMsCiAgICAgIHByaW1hcnk6IDEwMjQgLyogS2V5TW9kLlNoaWZ0ICovIHwgMTUgLyogS2V5Q29kZS5MZWZ0QXJyb3cgKi8KICAgIH0KICB9KSk7CgogIENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMuQ3Vyc29yUmlnaHQgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3IEN1cnNvck1vdmVCYXNlZENvbW1hbmQoewogICAgYXJnczogewogICAgICBkaXJlY3Rpb246IDEgLyogQ3Vyc29yTW92ZV8uRGlyZWN0aW9uLlJpZ2h0ICovLAogICAgICB1bml0OiAwIC8qIEN1cnNvck1vdmVfLlVuaXQuTm9uZSAqLywKICAgICAgc2VsZWN0OiBmYWxzZSwKICAgICAgdmFsdWU6IDEKICAgIH0sCiAgICBpZDogJ2N1cnNvclJpZ2h0JywKICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkLAogICAga2JPcHRzOiB7CiAgICAgIHdlaWdodDogQ09SRV9XRUlHSFQsCiAgICAgIGtiRXhwcjogRWRpdG9yQ29udGV4dEtleXMudGV4dElucHV0Rm9jdXMsCiAgICAgIHByaW1hcnk6IDE3IC8qIEtleUNvZGUuUmlnaHRBcnJvdyAqLywKICAgICAgbWFjOiB7CiAgICAgICAgcHJpbWFyeTogMTcgLyogS2V5Q29kZS5SaWdodEFycm93ICovLAogICAgICAgIHNlY29uZGFyeTogWzI1NiAvKiBLZXlNb2QuV2luQ3RybCAqLyB8IDM2IC8qIEtleUNvZGUuS2V5RiAqL10KICAgICAgfQogICAgfQogIH0pKTsKCiAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5DdXJzb3JSaWdodFNlbGVjdCA9IHJlZ2lzdGVyRWRpdG9yQ29tbWFuZChuZXcgQ3Vyc29yTW92ZUJhc2VkQ29tbWFuZCh7CiAgICBhcmdzOiB7CiAgICAgIGRpcmVjdGlvbjogMSAvKiBDdXJzb3JNb3ZlXy5EaXJlY3Rpb24uUmlnaHQgKi8sCiAgICAgIHVuaXQ6IDAgLyogQ3Vyc29yTW92ZV8uVW5pdC5Ob25lICovLAogICAgICBzZWxlY3Q6IHRydWUsCiAgICAgIHZhbHVlOiAxCiAgICB9LAogICAgaWQ6ICdjdXJzb3JSaWdodFNlbGVjdCcsCiAgICBwcmVjb25kaXRpb246IHVuZGVmaW5lZCwKICAgIGtiT3B0czogewogICAgICB3ZWlnaHQ6IENPUkVfV0VJR0hULAogICAgICBrYkV4cHI6IEVkaXRvckNvbnRleHRLZXlzLnRleHRJbnB1dEZvY3VzLAogICAgICBwcmltYXJ5OiAxMDI0IC8qIEtleU1vZC5TaGlmdCAqLyB8IDE3IC8qIEtleUNvZGUuUmlnaHRBcnJvdyAqLwogICAgfQogIH0pKTsKCiAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5DdXJzb3JVcCA9IHJlZ2lzdGVyRWRpdG9yQ29tbWFuZChuZXcgQ3Vyc29yTW92ZUJhc2VkQ29tbWFuZCh7CiAgICBhcmdzOiB7CiAgICAgIGRpcmVjdGlvbjogMiAvKiBDdXJzb3JNb3ZlXy5EaXJlY3Rpb24uVXAgKi8sCiAgICAgIHVuaXQ6IDIgLyogQ3Vyc29yTW92ZV8uVW5pdC5XcmFwcGVkTGluZSAqLywKICAgICAgc2VsZWN0OiBmYWxzZSwKICAgICAgdmFsdWU6IDEKICAgIH0sCiAgICBpZDogJ2N1cnNvclVwJywKICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkLAogICAga2JPcHRzOiB7CiAgICAgIHdlaWdodDogQ09SRV9XRUlHSFQsCiAgICAgIGtiRXhwcjogRWRpdG9yQ29udGV4dEtleXMudGV4dElucHV0Rm9jdXMsCiAgICAgIHByaW1hcnk6IDE2IC8qIEtleUNvZGUuVXBBcnJvdyAqLywKICAgICAgbWFjOiB7CiAgICAgICAgcHJpbWFyeTogMTYgLyogS2V5Q29kZS5VcEFycm93ICovLAogICAgICAgIHNlY29uZGFyeTogWzI1NiAvKiBLZXlNb2QuV2luQ3RybCAqLyB8IDQ2IC8qIEtleUNvZGUuS2V5UCAqL10KICAgICAgfQogICAgfQogIH0pKTsKCiAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5DdXJzb3JVcFNlbGVjdCA9IHJlZ2lzdGVyRWRpdG9yQ29tbWFuZChuZXcgQ3Vyc29yTW92ZUJhc2VkQ29tbWFuZCh7CiAgICBhcmdzOiB7CiAgICAgIGRpcmVjdGlvbjogMiAvKiBDdXJzb3JNb3ZlXy5EaXJlY3Rpb24uVXAgKi8sCiAgICAgIHVuaXQ6IDIgLyogQ3Vyc29yTW92ZV8uVW5pdC5XcmFwcGVkTGluZSAqLywKICAgICAgc2VsZWN0OiB0cnVlLAogICAgICB2YWx1ZTogMQogICAgfSwKICAgIGlkOiAnY3Vyc29yVXBTZWxlY3QnLAogICAgcHJlY29uZGl0aW9uOiB1bmRlZmluZWQsCiAgICBrYk9wdHM6IHsKICAgICAgd2VpZ2h0OiBDT1JFX1dFSUdIVCwKICAgICAga2JFeHByOiBFZGl0b3JDb250ZXh0S2V5cy50ZXh0SW5wdXRGb2N1cywKICAgICAgcHJpbWFyeTogMTAyNCAvKiBLZXlNb2QuU2hpZnQgKi8gfCAxNiAvKiBLZXlDb2RlLlVwQXJyb3cgKi8sCiAgICAgIHNlY29uZGFyeTogWzIwNDggLyogS2V5TW9kLkN0cmxDbWQgKi8gfCAxMDI0IC8qIEtleU1vZC5TaGlmdCAqLyB8IDE2IC8qIEtleUNvZGUuVXBBcnJvdyAqL10sCiAgICAgIG1hYzogewogICAgICAgIHByaW1hcnk6IDEwMjQgLyogS2V5TW9kLlNoaWZ0ICovIHwgMTYgLyogS2V5Q29kZS5VcEFycm93ICovCiAgICAgIH0sCiAgICAgIGxpbnV4OiB7CiAgICAgICAgcHJpbWFyeTogMTAyNCAvKiBLZXlNb2QuU2hpZnQgKi8gfCAxNiAvKiBLZXlDb2RlLlVwQXJyb3cgKi8KICAgICAgfQogICAgfQogIH0pKTsKCiAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5DdXJzb3JQYWdlVXAgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3IEN1cnNvck1vdmVCYXNlZENvbW1hbmQoewogICAgYXJnczogewogICAgICBkaXJlY3Rpb246IDIgLyogQ3Vyc29yTW92ZV8uRGlyZWN0aW9uLlVwICovLAogICAgICB1bml0OiAyIC8qIEN1cnNvck1vdmVfLlVuaXQuV3JhcHBlZExpbmUgKi8sCiAgICAgIHNlbGVjdDogZmFsc2UsCiAgICAgIHZhbHVlOiAtMSAvKiBDb25zdGFudHMuUEFHRV9TSVpFX01BUktFUiAqLwogICAgfSwKCiAgICBpZDogJ2N1cnNvclBhZ2VVcCcsCiAgICBwcmVjb25kaXRpb246IHVuZGVmaW5lZCwKICAgIGtiT3B0czogewogICAgICB3ZWlnaHQ6IENPUkVfV0VJR0hULAogICAgICBrYkV4cHI6IEVkaXRvckNvbnRleHRLZXlzLnRleHRJbnB1dEZvY3VzLAogICAgICBwcmltYXJ5OiAxMSAvKiBLZXlDb2RlLlBhZ2VVcCAqLwogICAgfQogIH0pKTsKCiAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5DdXJzb3JQYWdlVXBTZWxlY3QgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3IEN1cnNvck1vdmVCYXNlZENvbW1hbmQoewogICAgYXJnczogewogICAgICBkaXJlY3Rpb246IDIgLyogQ3Vyc29yTW92ZV8uRGlyZWN0aW9uLlVwICovLAogICAgICB1bml0OiAyIC8qIEN1cnNvck1vdmVfLlVuaXQuV3JhcHBlZExpbmUgKi8sCiAgICAgIHNlbGVjdDogdHJ1ZSwKICAgICAgdmFsdWU6IC0xIC8qIENvbnN0YW50cy5QQUdFX1NJWkVfTUFSS0VSICovCiAgICB9LAoKICAgIGlkOiAnY3Vyc29yUGFnZVVwU2VsZWN0JywKICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkLAogICAga2JPcHRzOiB7CiAgICAgIHdlaWdodDogQ09SRV9XRUlHSFQsCiAgICAgIGtiRXhwcjogRWRpdG9yQ29udGV4dEtleXMudGV4dElucHV0Rm9jdXMsCiAgICAgIHByaW1hcnk6IDEwMjQgLyogS2V5TW9kLlNoaWZ0ICovIHwgMTEgLyogS2V5Q29kZS5QYWdlVXAgKi8KICAgIH0KICB9KSk7CgogIENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMuQ3Vyc29yRG93biA9IHJlZ2lzdGVyRWRpdG9yQ29tbWFuZChuZXcgQ3Vyc29yTW92ZUJhc2VkQ29tbWFuZCh7CiAgICBhcmdzOiB7CiAgICAgIGRpcmVjdGlvbjogMyAvKiBDdXJzb3JNb3ZlXy5EaXJlY3Rpb24uRG93biAqLywKICAgICAgdW5pdDogMiAvKiBDdXJzb3JNb3ZlXy5Vbml0LldyYXBwZWRMaW5lICovLAogICAgICBzZWxlY3Q6IGZhbHNlLAogICAgICB2YWx1ZTogMQogICAgfSwKICAgIGlkOiAnY3Vyc29yRG93bicsCiAgICBwcmVjb25kaXRpb246IHVuZGVmaW5lZCwKICAgIGtiT3B0czogewogICAgICB3ZWlnaHQ6IENPUkVfV0VJR0hULAogICAgICBrYkV4cHI6IEVkaXRvckNvbnRleHRLZXlzLnRleHRJbnB1dEZvY3VzLAogICAgICBwcmltYXJ5OiAxOCAvKiBLZXlDb2RlLkRvd25BcnJvdyAqLywKICAgICAgbWFjOiB7CiAgICAgICAgcHJpbWFyeTogMTggLyogS2V5Q29kZS5Eb3duQXJyb3cgKi8sCiAgICAgICAgc2Vjb25kYXJ5OiBbMjU2IC8qIEtleU1vZC5XaW5DdHJsICovIHwgNDQgLyogS2V5Q29kZS5LZXlOICovXQogICAgICB9CiAgICB9CiAgfSkpOwoKICBDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkN1cnNvckRvd25TZWxlY3QgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3IEN1cnNvck1vdmVCYXNlZENvbW1hbmQoewogICAgYXJnczogewogICAgICBkaXJlY3Rpb246IDMgLyogQ3Vyc29yTW92ZV8uRGlyZWN0aW9uLkRvd24gKi8sCiAgICAgIHVuaXQ6IDIgLyogQ3Vyc29yTW92ZV8uVW5pdC5XcmFwcGVkTGluZSAqLywKICAgICAgc2VsZWN0OiB0cnVlLAogICAgICB2YWx1ZTogMQogICAgfSwKICAgIGlkOiAnY3Vyc29yRG93blNlbGVjdCcsCiAgICBwcmVjb25kaXRpb246IHVuZGVmaW5lZCwKICAgIGtiT3B0czogewogICAgICB3ZWlnaHQ6IENPUkVfV0VJR0hULAogICAgICBrYkV4cHI6IEVkaXRvckNvbnRleHRLZXlzLnRleHRJbnB1dEZvY3VzLAogICAgICBwcmltYXJ5OiAxMDI0IC8qIEtleU1vZC5TaGlmdCAqLyB8IDE4IC8qIEtleUNvZGUuRG93bkFycm93ICovLAogICAgICBzZWNvbmRhcnk6IFsyMDQ4IC8qIEtleU1vZC5DdHJsQ21kICovIHwgMTAyNCAvKiBLZXlNb2QuU2hpZnQgKi8gfCAxOCAvKiBLZXlDb2RlLkRvd25BcnJvdyAqL10sCiAgICAgIG1hYzogewogICAgICAgIHByaW1hcnk6IDEwMjQgLyogS2V5TW9kLlNoaWZ0ICovIHwgMTggLyogS2V5Q29kZS5Eb3duQXJyb3cgKi8KICAgICAgfSwKICAgICAgbGludXg6IHsKICAgICAgICBwcmltYXJ5OiAxMDI0IC8qIEtleU1vZC5TaGlmdCAqLyB8IDE4IC8qIEtleUNvZGUuRG93bkFycm93ICovCiAgICAgIH0KICAgIH0KICB9KSk7CgogIENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMuQ3Vyc29yUGFnZURvd24gPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3IEN1cnNvck1vdmVCYXNlZENvbW1hbmQoewogICAgYXJnczogewogICAgICBkaXJlY3Rpb246IDMgLyogQ3Vyc29yTW92ZV8uRGlyZWN0aW9uLkRvd24gKi8sCiAgICAgIHVuaXQ6IDIgLyogQ3Vyc29yTW92ZV8uVW5pdC5XcmFwcGVkTGluZSAqLywKICAgICAgc2VsZWN0OiBmYWxzZSwKICAgICAgdmFsdWU6IC0xIC8qIENvbnN0YW50cy5QQUdFX1NJWkVfTUFSS0VSICovCiAgICB9LAoKICAgIGlkOiAnY3Vyc29yUGFnZURvd24nLAogICAgcHJlY29uZGl0aW9uOiB1bmRlZmluZWQsCiAgICBrYk9wdHM6IHsKICAgICAgd2VpZ2h0OiBDT1JFX1dFSUdIVCwKICAgICAga2JFeHByOiBFZGl0b3JDb250ZXh0S2V5cy50ZXh0SW5wdXRGb2N1cywKICAgICAgcHJpbWFyeTogMTIgLyogS2V5Q29kZS5QYWdlRG93biAqLwogICAgfQogIH0pKTsKCiAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5DdXJzb3JQYWdlRG93blNlbGVjdCA9IHJlZ2lzdGVyRWRpdG9yQ29tbWFuZChuZXcgQ3Vyc29yTW92ZUJhc2VkQ29tbWFuZCh7CiAgICBhcmdzOiB7CiAgICAgIGRpcmVjdGlvbjogMyAvKiBDdXJzb3JNb3ZlXy5EaXJlY3Rpb24uRG93biAqLywKICAgICAgdW5pdDogMiAvKiBDdXJzb3JNb3ZlXy5Vbml0LldyYXBwZWRMaW5lICovLAogICAgICBzZWxlY3Q6IHRydWUsCiAgICAgIHZhbHVlOiAtMSAvKiBDb25zdGFudHMuUEFHRV9TSVpFX01BUktFUiAqLwogICAgfSwKCiAgICBpZDogJ2N1cnNvclBhZ2VEb3duU2VsZWN0JywKICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkLAogICAga2JPcHRzOiB7CiAgICAgIHdlaWdodDogQ09SRV9XRUlHSFQsCiAgICAgIGtiRXhwcjogRWRpdG9yQ29udGV4dEtleXMudGV4dElucHV0Rm9jdXMsCiAgICAgIHByaW1hcnk6IDEwMjQgLyogS2V5TW9kLlNoaWZ0ICovIHwgMTIgLyogS2V5Q29kZS5QYWdlRG93biAqLwogICAgfQogIH0pKTsKCiAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5DcmVhdGVDdXJzb3IgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3ICggLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29yZUVkaXRvckNvbW1hbmQ1KSB7CiAgICBfaW5oZXJpdHMoX2NsYXNzNCwgX0NvcmVFZGl0b3JDb21tYW5kNSk7CiAgICB2YXIgX3N1cGVyMTEgPSBfY3JlYXRlU3VwZXIoX2NsYXNzNCk7CiAgICBmdW5jdGlvbiBfY2xhc3M0KCkgewogICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgX2NsYXNzNCk7CiAgICAgIHJldHVybiBfc3VwZXIxMS5jYWxsKHRoaXMsIHsKICAgICAgICBpZDogJ2NyZWF0ZUN1cnNvcicsCiAgICAgICAgcHJlY29uZGl0aW9uOiB1bmRlZmluZWQKICAgICAgfSk7CiAgICB9CiAgICBfY3JlYXRlQ2xhc3MoX2NsYXNzNCwgW3sKICAgICAga2V5OiAicnVuQ29yZUVkaXRvckNvbW1hbmQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcnVuQ29yZUVkaXRvckNvbW1hbmQodmlld01vZGVsLCBhcmdzKSB7CiAgICAgICAgdmFyIG5ld1N0YXRlOwogICAgICAgIGlmIChhcmdzLndob2xlTGluZSkgewogICAgICAgICAgbmV3U3RhdGUgPSBDdXJzb3JNb3ZlQ29tbWFuZHMubGluZSh2aWV3TW9kZWwsIHZpZXdNb2RlbC5nZXRQcmltYXJ5Q3Vyc29yU3RhdGUoKSwgZmFsc2UsIGFyZ3MucG9zaXRpb24sIGFyZ3Mudmlld1Bvc2l0aW9uKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbmV3U3RhdGUgPSBDdXJzb3JNb3ZlQ29tbWFuZHMubW92ZVRvKHZpZXdNb2RlbCwgdmlld01vZGVsLmdldFByaW1hcnlDdXJzb3JTdGF0ZSgpLCBmYWxzZSwgYXJncy5wb3NpdGlvbiwgYXJncy52aWV3UG9zaXRpb24pOwogICAgICAgIH0KICAgICAgICB2YXIgc3RhdGVzID0gdmlld01vZGVsLmdldEN1cnNvclN0YXRlcygpOwogICAgICAgIC8vIENoZWNrIGlmIHdlIHNob3VsZCByZW1vdmUgYSBjdXJzb3IgKHNvcnQgb2YgbGlrZSBhIHRvZ2dsZSkKICAgICAgICBpZiAoc3RhdGVzLmxlbmd0aCA+IDEpIHsKICAgICAgICAgIHZhciBuZXdNb2RlbFBvc2l0aW9uID0gbmV3U3RhdGUubW9kZWxTdGF0ZSA/IG5ld1N0YXRlLm1vZGVsU3RhdGUucG9zaXRpb24gOiBudWxsOwogICAgICAgICAgdmFyIG5ld1ZpZXdQb3NpdGlvbiA9IG5ld1N0YXRlLnZpZXdTdGF0ZSA/IG5ld1N0YXRlLnZpZXdTdGF0ZS5wb3NpdGlvbiA6IG51bGw7CiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gc3RhdGVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgICAgIHZhciBzdGF0ZSA9IHN0YXRlc1tpXTsKICAgICAgICAgICAgaWYgKG5ld01vZGVsUG9zaXRpb24gJiYgIXN0YXRlLm1vZGVsU3RhdGUuc2VsZWN0aW9uLmNvbnRhaW5zUG9zaXRpb24obmV3TW9kZWxQb3NpdGlvbikpIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAobmV3Vmlld1Bvc2l0aW9uICYmICFzdGF0ZS52aWV3U3RhdGUuc2VsZWN0aW9uLmNvbnRhaW5zUG9zaXRpb24obmV3Vmlld1Bvc2l0aW9uKSkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vID0+IFJlbW92ZSB0aGUgY3Vyc29yCiAgICAgICAgICAgIHN0YXRlcy5zcGxpY2UoaSwgMSk7CiAgICAgICAgICAgIHZpZXdNb2RlbC5tb2RlbC5wdXNoU3RhY2tFbGVtZW50KCk7CiAgICAgICAgICAgIHZpZXdNb2RlbC5zZXRDdXJzb3JTdGF0ZXMoYXJncy5zb3VyY2UsIDMgLyogQ3Vyc29yQ2hhbmdlUmVhc29uLkV4cGxpY2l0ICovLCBzdGF0ZXMpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIC8vID0+IEFkZCB0aGUgbmV3IGN1cnNvcgogICAgICAgIHN0YXRlcy5wdXNoKG5ld1N0YXRlKTsKICAgICAgICB2aWV3TW9kZWwubW9kZWwucHVzaFN0YWNrRWxlbWVudCgpOwogICAgICAgIHZpZXdNb2RlbC5zZXRDdXJzb3JTdGF0ZXMoYXJncy5zb3VyY2UsIDMgLyogQ3Vyc29yQ2hhbmdlUmVhc29uLkV4cGxpY2l0ICovLCBzdGF0ZXMpOwogICAgICB9CiAgICB9XSk7CiAgICByZXR1cm4gX2NsYXNzNDsKICB9KENvcmVFZGl0b3JDb21tYW5kKSkoKSk7CiAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5MYXN0Q3Vyc29yTW92ZVRvU2VsZWN0ID0gcmVnaXN0ZXJFZGl0b3JDb21tYW5kKG5ldyAoIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NvcmVFZGl0b3JDb21tYW5kNikgewogICAgX2luaGVyaXRzKF9jbGFzczUsIF9Db3JlRWRpdG9yQ29tbWFuZDYpOwogICAgdmFyIF9zdXBlcjEyID0gX2NyZWF0ZVN1cGVyKF9jbGFzczUpOwogICAgZnVuY3Rpb24gX2NsYXNzNSgpIHsKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIF9jbGFzczUpOwogICAgICByZXR1cm4gX3N1cGVyMTIuY2FsbCh0aGlzLCB7CiAgICAgICAgaWQ6ICdfbGFzdEN1cnNvck1vdmVUb1NlbGVjdCcsCiAgICAgICAgcHJlY29uZGl0aW9uOiB1bmRlZmluZWQKICAgICAgfSk7CiAgICB9CiAgICBfY3JlYXRlQ2xhc3MoX2NsYXNzNSwgW3sKICAgICAga2V5OiAicnVuQ29yZUVkaXRvckNvbW1hbmQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcnVuQ29yZUVkaXRvckNvbW1hbmQodmlld01vZGVsLCBhcmdzKSB7CiAgICAgICAgdmFyIGxhc3RBZGRlZEN1cnNvckluZGV4ID0gdmlld01vZGVsLmdldExhc3RBZGRlZEN1cnNvckluZGV4KCk7CiAgICAgICAgdmFyIHN0YXRlcyA9IHZpZXdNb2RlbC5nZXRDdXJzb3JTdGF0ZXMoKTsKICAgICAgICB2YXIgbmV3U3RhdGVzID0gc3RhdGVzLnNsaWNlKDApOwogICAgICAgIG5ld1N0YXRlc1tsYXN0QWRkZWRDdXJzb3JJbmRleF0gPSBDdXJzb3JNb3ZlQ29tbWFuZHMubW92ZVRvKHZpZXdNb2RlbCwgc3RhdGVzW2xhc3RBZGRlZEN1cnNvckluZGV4XSwgdHJ1ZSwgYXJncy5wb3NpdGlvbiwgYXJncy52aWV3UG9zaXRpb24pOwogICAgICAgIHZpZXdNb2RlbC5tb2RlbC5wdXNoU3RhY2tFbGVtZW50KCk7CiAgICAgICAgdmlld01vZGVsLnNldEN1cnNvclN0YXRlcyhhcmdzLnNvdXJjZSwgMyAvKiBDdXJzb3JDaGFuZ2VSZWFzb24uRXhwbGljaXQgKi8sIG5ld1N0YXRlcyk7CiAgICAgIH0KICAgIH1dKTsKICAgIHJldHVybiBfY2xhc3M1OwogIH0oQ29yZUVkaXRvckNvbW1hbmQpKSgpKTsKICB2YXIgSG9tZUNvbW1hbmQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Db3JlRWRpdG9yQ29tbWFuZDcpIHsKICAgIF9pbmhlcml0cyhIb21lQ29tbWFuZCwgX0NvcmVFZGl0b3JDb21tYW5kNyk7CiAgICB2YXIgX3N1cGVyMTMgPSBfY3JlYXRlU3VwZXIoSG9tZUNvbW1hbmQpOwogICAgZnVuY3Rpb24gSG9tZUNvbW1hbmQob3B0cykgewogICAgICB2YXIgX3RoaXM2OwogICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSG9tZUNvbW1hbmQpOwogICAgICBfdGhpczYgPSBfc3VwZXIxMy5jYWxsKHRoaXMsIG9wdHMpOwogICAgICBfdGhpczYuX2luU2VsZWN0aW9uTW9kZSA9IG9wdHMuaW5TZWxlY3Rpb25Nb2RlOwogICAgICByZXR1cm4gX3RoaXM2OwogICAgfQogICAgX2NyZWF0ZUNsYXNzKEhvbWVDb21tYW5kLCBbewogICAgICBrZXk6ICJydW5Db3JlRWRpdG9yQ29tbWFuZCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBydW5Db3JlRWRpdG9yQ29tbWFuZCh2aWV3TW9kZWwsIGFyZ3MpIHsKICAgICAgICB2aWV3TW9kZWwubW9kZWwucHVzaFN0YWNrRWxlbWVudCgpOwogICAgICAgIHZpZXdNb2RlbC5zZXRDdXJzb3JTdGF0ZXMoYXJncy5zb3VyY2UsIDMgLyogQ3Vyc29yQ2hhbmdlUmVhc29uLkV4cGxpY2l0ICovLCBDdXJzb3JNb3ZlQ29tbWFuZHMubW92ZVRvQmVnaW5uaW5nT2ZMaW5lKHZpZXdNb2RlbCwgdmlld01vZGVsLmdldEN1cnNvclN0YXRlcygpLCB0aGlzLl9pblNlbGVjdGlvbk1vZGUpKTsKICAgICAgICB2aWV3TW9kZWwucmV2ZWFsUHJpbWFyeUN1cnNvcihhcmdzLnNvdXJjZSwgdHJ1ZSk7CiAgICAgIH0KICAgIH1dKTsKICAgIHJldHVybiBIb21lQ29tbWFuZDsKICB9KENvcmVFZGl0b3JDb21tYW5kKTsKICBDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkN1cnNvckhvbWUgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3IEhvbWVDb21tYW5kKHsKICAgIGluU2VsZWN0aW9uTW9kZTogZmFsc2UsCiAgICBpZDogJ2N1cnNvckhvbWUnLAogICAgcHJlY29uZGl0aW9uOiB1bmRlZmluZWQsCiAgICBrYk9wdHM6IHsKICAgICAgd2VpZ2h0OiBDT1JFX1dFSUdIVCwKICAgICAga2JFeHByOiBFZGl0b3JDb250ZXh0S2V5cy50ZXh0SW5wdXRGb2N1cywKICAgICAgcHJpbWFyeTogMTQgLyogS2V5Q29kZS5Ib21lICovLAogICAgICBtYWM6IHsKICAgICAgICBwcmltYXJ5OiAxNCAvKiBLZXlDb2RlLkhvbWUgKi8sCiAgICAgICAgc2Vjb25kYXJ5OiBbMjA0OCAvKiBLZXlNb2QuQ3RybENtZCAqLyB8IDE1IC8qIEtleUNvZGUuTGVmdEFycm93ICovXQogICAgICB9CiAgICB9CiAgfSkpOwoKICBDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkN1cnNvckhvbWVTZWxlY3QgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3IEhvbWVDb21tYW5kKHsKICAgIGluU2VsZWN0aW9uTW9kZTogdHJ1ZSwKICAgIGlkOiAnY3Vyc29ySG9tZVNlbGVjdCcsCiAgICBwcmVjb25kaXRpb246IHVuZGVmaW5lZCwKICAgIGtiT3B0czogewogICAgICB3ZWlnaHQ6IENPUkVfV0VJR0hULAogICAgICBrYkV4cHI6IEVkaXRvckNvbnRleHRLZXlzLnRleHRJbnB1dEZvY3VzLAogICAgICBwcmltYXJ5OiAxMDI0IC8qIEtleU1vZC5TaGlmdCAqLyB8IDE0IC8qIEtleUNvZGUuSG9tZSAqLywKICAgICAgbWFjOiB7CiAgICAgICAgcHJpbWFyeTogMTAyNCAvKiBLZXlNb2QuU2hpZnQgKi8gfCAxNCAvKiBLZXlDb2RlLkhvbWUgKi8sCiAgICAgICAgc2Vjb25kYXJ5OiBbMjA0OCAvKiBLZXlNb2QuQ3RybENtZCAqLyB8IDEwMjQgLyogS2V5TW9kLlNoaWZ0ICovIHwgMTUgLyogS2V5Q29kZS5MZWZ0QXJyb3cgKi9dCiAgICAgIH0KICAgIH0KICB9KSk7CiAgdmFyIExpbmVTdGFydENvbW1hbmQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Db3JlRWRpdG9yQ29tbWFuZDgpIHsKICAgIF9pbmhlcml0cyhMaW5lU3RhcnRDb21tYW5kLCBfQ29yZUVkaXRvckNvbW1hbmQ4KTsKICAgIHZhciBfc3VwZXIxNCA9IF9jcmVhdGVTdXBlcihMaW5lU3RhcnRDb21tYW5kKTsKICAgIGZ1bmN0aW9uIExpbmVTdGFydENvbW1hbmQob3B0cykgewogICAgICB2YXIgX3RoaXM3OwogICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTGluZVN0YXJ0Q29tbWFuZCk7CiAgICAgIF90aGlzNyA9IF9zdXBlcjE0LmNhbGwodGhpcywgb3B0cyk7CiAgICAgIF90aGlzNy5faW5TZWxlY3Rpb25Nb2RlID0gb3B0cy5pblNlbGVjdGlvbk1vZGU7CiAgICAgIHJldHVybiBfdGhpczc7CiAgICB9CiAgICBfY3JlYXRlQ2xhc3MoTGluZVN0YXJ0Q29tbWFuZCwgW3sKICAgICAga2V5OiAicnVuQ29yZUVkaXRvckNvbW1hbmQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcnVuQ29yZUVkaXRvckNvbW1hbmQodmlld01vZGVsLCBhcmdzKSB7CiAgICAgICAgdmlld01vZGVsLm1vZGVsLnB1c2hTdGFja0VsZW1lbnQoKTsKICAgICAgICB2aWV3TW9kZWwuc2V0Q3Vyc29yU3RhdGVzKGFyZ3Muc291cmNlLCAzIC8qIEN1cnNvckNoYW5nZVJlYXNvbi5FeHBsaWNpdCAqLywgdGhpcy5fZXhlYyh2aWV3TW9kZWwuZ2V0Q3Vyc29yU3RhdGVzKCkpKTsKICAgICAgICB2aWV3TW9kZWwucmV2ZWFsUHJpbWFyeUN1cnNvcihhcmdzLnNvdXJjZSwgdHJ1ZSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiX2V4ZWMiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gX2V4ZWMoY3Vyc29ycykgewogICAgICAgIHZhciByZXN1bHQgPSBbXTsKICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gY3Vyc29ycy5sZW5ndGg7IGkgPCBsZW47IGkrKykgewogICAgICAgICAgdmFyIGN1cnNvciA9IGN1cnNvcnNbaV07CiAgICAgICAgICB2YXIgbGluZU51bWJlciA9IGN1cnNvci5tb2RlbFN0YXRlLnBvc2l0aW9uLmxpbmVOdW1iZXI7CiAgICAgICAgICByZXN1bHRbaV0gPSBDdXJzb3JTdGF0ZS5mcm9tTW9kZWxTdGF0ZShjdXJzb3IubW9kZWxTdGF0ZS5tb3ZlKHRoaXMuX2luU2VsZWN0aW9uTW9kZSwgbGluZU51bWJlciwgMSwgMCkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICB9CiAgICB9XSk7CiAgICByZXR1cm4gTGluZVN0YXJ0Q29tbWFuZDsKICB9KENvcmVFZGl0b3JDb21tYW5kKTsKICBDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkN1cnNvckxpbmVTdGFydCA9IHJlZ2lzdGVyRWRpdG9yQ29tbWFuZChuZXcgTGluZVN0YXJ0Q29tbWFuZCh7CiAgICBpblNlbGVjdGlvbk1vZGU6IGZhbHNlLAogICAgaWQ6ICdjdXJzb3JMaW5lU3RhcnQnLAogICAgcHJlY29uZGl0aW9uOiB1bmRlZmluZWQsCiAgICBrYk9wdHM6IHsKICAgICAgd2VpZ2h0OiBDT1JFX1dFSUdIVCwKICAgICAga2JFeHByOiBFZGl0b3JDb250ZXh0S2V5cy50ZXh0SW5wdXRGb2N1cywKICAgICAgcHJpbWFyeTogMCwKICAgICAgbWFjOiB7CiAgICAgICAgcHJpbWFyeTogMjU2IC8qIEtleU1vZC5XaW5DdHJsICovIHwgMzEgLyogS2V5Q29kZS5LZXlBICovCiAgICAgIH0KICAgIH0KICB9KSk7CgogIENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMuQ3Vyc29yTGluZVN0YXJ0U2VsZWN0ID0gcmVnaXN0ZXJFZGl0b3JDb21tYW5kKG5ldyBMaW5lU3RhcnRDb21tYW5kKHsKICAgIGluU2VsZWN0aW9uTW9kZTogdHJ1ZSwKICAgIGlkOiAnY3Vyc29yTGluZVN0YXJ0U2VsZWN0JywKICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkLAogICAga2JPcHRzOiB7CiAgICAgIHdlaWdodDogQ09SRV9XRUlHSFQsCiAgICAgIGtiRXhwcjogRWRpdG9yQ29udGV4dEtleXMudGV4dElucHV0Rm9jdXMsCiAgICAgIHByaW1hcnk6IDAsCiAgICAgIG1hYzogewogICAgICAgIHByaW1hcnk6IDI1NiAvKiBLZXlNb2QuV2luQ3RybCAqLyB8IDEwMjQgLyogS2V5TW9kLlNoaWZ0ICovIHwgMzEgLyogS2V5Q29kZS5LZXlBICovCiAgICAgIH0KICAgIH0KICB9KSk7CiAgdmFyIEVuZENvbW1hbmQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Db3JlRWRpdG9yQ29tbWFuZDkpIHsKICAgIF9pbmhlcml0cyhFbmRDb21tYW5kLCBfQ29yZUVkaXRvckNvbW1hbmQ5KTsKICAgIHZhciBfc3VwZXIxNSA9IF9jcmVhdGVTdXBlcihFbmRDb21tYW5kKTsKICAgIGZ1bmN0aW9uIEVuZENvbW1hbmQob3B0cykgewogICAgICB2YXIgX3RoaXM4OwogICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRW5kQ29tbWFuZCk7CiAgICAgIF90aGlzOCA9IF9zdXBlcjE1LmNhbGwodGhpcywgb3B0cyk7CiAgICAgIF90aGlzOC5faW5TZWxlY3Rpb25Nb2RlID0gb3B0cy5pblNlbGVjdGlvbk1vZGU7CiAgICAgIHJldHVybiBfdGhpczg7CiAgICB9CiAgICBfY3JlYXRlQ2xhc3MoRW5kQ29tbWFuZCwgW3sKICAgICAga2V5OiAicnVuQ29yZUVkaXRvckNvbW1hbmQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcnVuQ29yZUVkaXRvckNvbW1hbmQodmlld01vZGVsLCBhcmdzKSB7CiAgICAgICAgdmlld01vZGVsLm1vZGVsLnB1c2hTdGFja0VsZW1lbnQoKTsKICAgICAgICB2aWV3TW9kZWwuc2V0Q3Vyc29yU3RhdGVzKGFyZ3Muc291cmNlLCAzIC8qIEN1cnNvckNoYW5nZVJlYXNvbi5FeHBsaWNpdCAqLywgQ3Vyc29yTW92ZUNvbW1hbmRzLm1vdmVUb0VuZE9mTGluZSh2aWV3TW9kZWwsIHZpZXdNb2RlbC5nZXRDdXJzb3JTdGF0ZXMoKSwgdGhpcy5faW5TZWxlY3Rpb25Nb2RlLCBhcmdzLnN0aWNreSB8fCBmYWxzZSkpOwogICAgICAgIHZpZXdNb2RlbC5yZXZlYWxQcmltYXJ5Q3Vyc29yKGFyZ3Muc291cmNlLCB0cnVlKTsKICAgICAgfQogICAgfV0pOwogICAgcmV0dXJuIEVuZENvbW1hbmQ7CiAgfShDb3JlRWRpdG9yQ29tbWFuZCk7CiAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5DdXJzb3JFbmQgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3IEVuZENvbW1hbmQoewogICAgaW5TZWxlY3Rpb25Nb2RlOiBmYWxzZSwKICAgIGlkOiAnY3Vyc29yRW5kJywKICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkLAogICAga2JPcHRzOiB7CiAgICAgIGFyZ3M6IHsKICAgICAgICBzdGlja3k6IGZhbHNlCiAgICAgIH0sCiAgICAgIHdlaWdodDogQ09SRV9XRUlHSFQsCiAgICAgIGtiRXhwcjogRWRpdG9yQ29udGV4dEtleXMudGV4dElucHV0Rm9jdXMsCiAgICAgIHByaW1hcnk6IDEzIC8qIEtleUNvZGUuRW5kICovLAogICAgICBtYWM6IHsKICAgICAgICBwcmltYXJ5OiAxMyAvKiBLZXlDb2RlLkVuZCAqLywKICAgICAgICBzZWNvbmRhcnk6IFsyMDQ4IC8qIEtleU1vZC5DdHJsQ21kICovIHwgMTcgLyogS2V5Q29kZS5SaWdodEFycm93ICovXQogICAgICB9CiAgICB9LAoKICAgIGRlc2NyaXB0aW9uOiB7CiAgICAgIGRlc2NyaXB0aW9uOiAiR28gdG8gRW5kIiwKICAgICAgYXJnczogW3sKICAgICAgICBuYW1lOiAnYXJncycsCiAgICAgICAgc2NoZW1hOiB7CiAgICAgICAgICB0eXBlOiAnb2JqZWN0JywKICAgICAgICAgIHByb3BlcnRpZXM6IHsKICAgICAgICAgICAgJ3N0aWNreSc6IHsKICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogbmxzLmxvY2FsaXplKCdzdGlja3lkZXNjJywgIlN0aWNrIHRvIHRoZSBlbmQgZXZlbiB3aGVuIGdvaW5nIHRvIGxvbmdlciBsaW5lcyIpLAogICAgICAgICAgICAgIHR5cGU6ICdib29sZWFuJywKICAgICAgICAgICAgICBkZWZhdWx0OiBmYWxzZQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9XQogICAgfQogIH0pKTsKICBDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkN1cnNvckVuZFNlbGVjdCA9IHJlZ2lzdGVyRWRpdG9yQ29tbWFuZChuZXcgRW5kQ29tbWFuZCh7CiAgICBpblNlbGVjdGlvbk1vZGU6IHRydWUsCiAgICBpZDogJ2N1cnNvckVuZFNlbGVjdCcsCiAgICBwcmVjb25kaXRpb246IHVuZGVmaW5lZCwKICAgIGtiT3B0czogewogICAgICBhcmdzOiB7CiAgICAgICAgc3RpY2t5OiBmYWxzZQogICAgICB9LAogICAgICB3ZWlnaHQ6IENPUkVfV0VJR0hULAogICAgICBrYkV4cHI6IEVkaXRvckNvbnRleHRLZXlzLnRleHRJbnB1dEZvY3VzLAogICAgICBwcmltYXJ5OiAxMDI0IC8qIEtleU1vZC5TaGlmdCAqLyB8IDEzIC8qIEtleUNvZGUuRW5kICovLAogICAgICBtYWM6IHsKICAgICAgICBwcmltYXJ5OiAxMDI0IC8qIEtleU1vZC5TaGlmdCAqLyB8IDEzIC8qIEtleUNvZGUuRW5kICovLAogICAgICAgIHNlY29uZGFyeTogWzIwNDggLyogS2V5TW9kLkN0cmxDbWQgKi8gfCAxMDI0IC8qIEtleU1vZC5TaGlmdCAqLyB8IDE3IC8qIEtleUNvZGUuUmlnaHRBcnJvdyAqL10KICAgICAgfQogICAgfSwKCiAgICBkZXNjcmlwdGlvbjogewogICAgICBkZXNjcmlwdGlvbjogIlNlbGVjdCB0byBFbmQiLAogICAgICBhcmdzOiBbewogICAgICAgIG5hbWU6ICdhcmdzJywKICAgICAgICBzY2hlbWE6IHsKICAgICAgICAgIHR5cGU6ICdvYmplY3QnLAogICAgICAgICAgcHJvcGVydGllczogewogICAgICAgICAgICAnc3RpY2t5JzogewogICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBubHMubG9jYWxpemUoJ3N0aWNreWRlc2MnLCAiU3RpY2sgdG8gdGhlIGVuZCBldmVuIHdoZW4gZ29pbmcgdG8gbG9uZ2VyIGxpbmVzIiksCiAgICAgICAgICAgICAgdHlwZTogJ2Jvb2xlYW4nLAogICAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH1dCiAgICB9CiAgfSkpOwogIHZhciBMaW5lRW5kQ29tbWFuZCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NvcmVFZGl0b3JDb21tYW5kMTApIHsKICAgIF9pbmhlcml0cyhMaW5lRW5kQ29tbWFuZCwgX0NvcmVFZGl0b3JDb21tYW5kMTApOwogICAgdmFyIF9zdXBlcjE2ID0gX2NyZWF0ZVN1cGVyKExpbmVFbmRDb21tYW5kKTsKICAgIGZ1bmN0aW9uIExpbmVFbmRDb21tYW5kKG9wdHMpIHsKICAgICAgdmFyIF90aGlzOTsKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIExpbmVFbmRDb21tYW5kKTsKICAgICAgX3RoaXM5ID0gX3N1cGVyMTYuY2FsbCh0aGlzLCBvcHRzKTsKICAgICAgX3RoaXM5Ll9pblNlbGVjdGlvbk1vZGUgPSBvcHRzLmluU2VsZWN0aW9uTW9kZTsKICAgICAgcmV0dXJuIF90aGlzOTsKICAgIH0KICAgIF9jcmVhdGVDbGFzcyhMaW5lRW5kQ29tbWFuZCwgW3sKICAgICAga2V5OiAicnVuQ29yZUVkaXRvckNvbW1hbmQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcnVuQ29yZUVkaXRvckNvbW1hbmQodmlld01vZGVsLCBhcmdzKSB7CiAgICAgICAgdmlld01vZGVsLm1vZGVsLnB1c2hTdGFja0VsZW1lbnQoKTsKICAgICAgICB2aWV3TW9kZWwuc2V0Q3Vyc29yU3RhdGVzKGFyZ3Muc291cmNlLCAzIC8qIEN1cnNvckNoYW5nZVJlYXNvbi5FeHBsaWNpdCAqLywgdGhpcy5fZXhlYyh2aWV3TW9kZWwsIHZpZXdNb2RlbC5nZXRDdXJzb3JTdGF0ZXMoKSkpOwogICAgICAgIHZpZXdNb2RlbC5yZXZlYWxQcmltYXJ5Q3Vyc29yKGFyZ3Muc291cmNlLCB0cnVlKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJfZXhlYyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZXhlYyh2aWV3TW9kZWwsIGN1cnNvcnMpIHsKICAgICAgICB2YXIgcmVzdWx0ID0gW107CiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGN1cnNvcnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICAgIHZhciBjdXJzb3IgPSBjdXJzb3JzW2ldOwogICAgICAgICAgdmFyIGxpbmVOdW1iZXIgPSBjdXJzb3IubW9kZWxTdGF0ZS5wb3NpdGlvbi5saW5lTnVtYmVyOwogICAgICAgICAgdmFyIG1heENvbHVtbiA9IHZpZXdNb2RlbC5tb2RlbC5nZXRMaW5lTWF4Q29sdW1uKGxpbmVOdW1iZXIpOwogICAgICAgICAgcmVzdWx0W2ldID0gQ3Vyc29yU3RhdGUuZnJvbU1vZGVsU3RhdGUoY3Vyc29yLm1vZGVsU3RhdGUubW92ZSh0aGlzLl9pblNlbGVjdGlvbk1vZGUsIGxpbmVOdW1iZXIsIG1heENvbHVtbiwgMCkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICB9CiAgICB9XSk7CiAgICByZXR1cm4gTGluZUVuZENvbW1hbmQ7CiAgfShDb3JlRWRpdG9yQ29tbWFuZCk7CiAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5DdXJzb3JMaW5lRW5kID0gcmVnaXN0ZXJFZGl0b3JDb21tYW5kKG5ldyBMaW5lRW5kQ29tbWFuZCh7CiAgICBpblNlbGVjdGlvbk1vZGU6IGZhbHNlLAogICAgaWQ6ICdjdXJzb3JMaW5lRW5kJywKICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkLAogICAga2JPcHRzOiB7CiAgICAgIHdlaWdodDogQ09SRV9XRUlHSFQsCiAgICAgIGtiRXhwcjogRWRpdG9yQ29udGV4dEtleXMudGV4dElucHV0Rm9jdXMsCiAgICAgIHByaW1hcnk6IDAsCiAgICAgIG1hYzogewogICAgICAgIHByaW1hcnk6IDI1NiAvKiBLZXlNb2QuV2luQ3RybCAqLyB8IDM1IC8qIEtleUNvZGUuS2V5RSAqLwogICAgICB9CiAgICB9CiAgfSkpOwoKICBDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkN1cnNvckxpbmVFbmRTZWxlY3QgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3IExpbmVFbmRDb21tYW5kKHsKICAgIGluU2VsZWN0aW9uTW9kZTogdHJ1ZSwKICAgIGlkOiAnY3Vyc29yTGluZUVuZFNlbGVjdCcsCiAgICBwcmVjb25kaXRpb246IHVuZGVmaW5lZCwKICAgIGtiT3B0czogewogICAgICB3ZWlnaHQ6IENPUkVfV0VJR0hULAogICAgICBrYkV4cHI6IEVkaXRvckNvbnRleHRLZXlzLnRleHRJbnB1dEZvY3VzLAogICAgICBwcmltYXJ5OiAwLAogICAgICBtYWM6IHsKICAgICAgICBwcmltYXJ5OiAyNTYgLyogS2V5TW9kLldpbkN0cmwgKi8gfCAxMDI0IC8qIEtleU1vZC5TaGlmdCAqLyB8IDM1IC8qIEtleUNvZGUuS2V5RSAqLwogICAgICB9CiAgICB9CiAgfSkpOwogIHZhciBUb3BDb21tYW5kID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29yZUVkaXRvckNvbW1hbmQxMSkgewogICAgX2luaGVyaXRzKFRvcENvbW1hbmQsIF9Db3JlRWRpdG9yQ29tbWFuZDExKTsKICAgIHZhciBfc3VwZXIxNyA9IF9jcmVhdGVTdXBlcihUb3BDb21tYW5kKTsKICAgIGZ1bmN0aW9uIFRvcENvbW1hbmQob3B0cykgewogICAgICB2YXIgX3RoaXMxMDsKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRvcENvbW1hbmQpOwogICAgICBfdGhpczEwID0gX3N1cGVyMTcuY2FsbCh0aGlzLCBvcHRzKTsKICAgICAgX3RoaXMxMC5faW5TZWxlY3Rpb25Nb2RlID0gb3B0cy5pblNlbGVjdGlvbk1vZGU7CiAgICAgIHJldHVybiBfdGhpczEwOwogICAgfQogICAgX2NyZWF0ZUNsYXNzKFRvcENvbW1hbmQsIFt7CiAgICAgIGtleTogInJ1bkNvcmVFZGl0b3JDb21tYW5kIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJ1bkNvcmVFZGl0b3JDb21tYW5kKHZpZXdNb2RlbCwgYXJncykgewogICAgICAgIHZpZXdNb2RlbC5tb2RlbC5wdXNoU3RhY2tFbGVtZW50KCk7CiAgICAgICAgdmlld01vZGVsLnNldEN1cnNvclN0YXRlcyhhcmdzLnNvdXJjZSwgMyAvKiBDdXJzb3JDaGFuZ2VSZWFzb24uRXhwbGljaXQgKi8sIEN1cnNvck1vdmVDb21tYW5kcy5tb3ZlVG9CZWdpbm5pbmdPZkJ1ZmZlcih2aWV3TW9kZWwsIHZpZXdNb2RlbC5nZXRDdXJzb3JTdGF0ZXMoKSwgdGhpcy5faW5TZWxlY3Rpb25Nb2RlKSk7CiAgICAgICAgdmlld01vZGVsLnJldmVhbFByaW1hcnlDdXJzb3IoYXJncy5zb3VyY2UsIHRydWUpOwogICAgICB9CiAgICB9XSk7CiAgICByZXR1cm4gVG9wQ29tbWFuZDsKICB9KENvcmVFZGl0b3JDb21tYW5kKTsKICBDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkN1cnNvclRvcCA9IHJlZ2lzdGVyRWRpdG9yQ29tbWFuZChuZXcgVG9wQ29tbWFuZCh7CiAgICBpblNlbGVjdGlvbk1vZGU6IGZhbHNlLAogICAgaWQ6ICdjdXJzb3JUb3AnLAogICAgcHJlY29uZGl0aW9uOiB1bmRlZmluZWQsCiAgICBrYk9wdHM6IHsKICAgICAgd2VpZ2h0OiBDT1JFX1dFSUdIVCwKICAgICAga2JFeHByOiBFZGl0b3JDb250ZXh0S2V5cy50ZXh0SW5wdXRGb2N1cywKICAgICAgcHJpbWFyeTogMjA0OCAvKiBLZXlNb2QuQ3RybENtZCAqLyB8IDE0IC8qIEtleUNvZGUuSG9tZSAqLywKICAgICAgbWFjOiB7CiAgICAgICAgcHJpbWFyeTogMjA0OCAvKiBLZXlNb2QuQ3RybENtZCAqLyB8IDE2IC8qIEtleUNvZGUuVXBBcnJvdyAqLwogICAgICB9CiAgICB9CiAgfSkpOwoKICBDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkN1cnNvclRvcFNlbGVjdCA9IHJlZ2lzdGVyRWRpdG9yQ29tbWFuZChuZXcgVG9wQ29tbWFuZCh7CiAgICBpblNlbGVjdGlvbk1vZGU6IHRydWUsCiAgICBpZDogJ2N1cnNvclRvcFNlbGVjdCcsCiAgICBwcmVjb25kaXRpb246IHVuZGVmaW5lZCwKICAgIGtiT3B0czogewogICAgICB3ZWlnaHQ6IENPUkVfV0VJR0hULAogICAgICBrYkV4cHI6IEVkaXRvckNvbnRleHRLZXlzLnRleHRJbnB1dEZvY3VzLAogICAgICBwcmltYXJ5OiAyMDQ4IC8qIEtleU1vZC5DdHJsQ21kICovIHwgMTAyNCAvKiBLZXlNb2QuU2hpZnQgKi8gfCAxNCAvKiBLZXlDb2RlLkhvbWUgKi8sCiAgICAgIG1hYzogewogICAgICAgIHByaW1hcnk6IDIwNDggLyogS2V5TW9kLkN0cmxDbWQgKi8gfCAxMDI0IC8qIEtleU1vZC5TaGlmdCAqLyB8IDE2IC8qIEtleUNvZGUuVXBBcnJvdyAqLwogICAgICB9CiAgICB9CiAgfSkpOwogIHZhciBCb3R0b21Db21tYW5kID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29yZUVkaXRvckNvbW1hbmQxMikgewogICAgX2luaGVyaXRzKEJvdHRvbUNvbW1hbmQsIF9Db3JlRWRpdG9yQ29tbWFuZDEyKTsKICAgIHZhciBfc3VwZXIxOCA9IF9jcmVhdGVTdXBlcihCb3R0b21Db21tYW5kKTsKICAgIGZ1bmN0aW9uIEJvdHRvbUNvbW1hbmQob3B0cykgewogICAgICB2YXIgX3RoaXMxMTsKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEJvdHRvbUNvbW1hbmQpOwogICAgICBfdGhpczExID0gX3N1cGVyMTguY2FsbCh0aGlzLCBvcHRzKTsKICAgICAgX3RoaXMxMS5faW5TZWxlY3Rpb25Nb2RlID0gb3B0cy5pblNlbGVjdGlvbk1vZGU7CiAgICAgIHJldHVybiBfdGhpczExOwogICAgfQogICAgX2NyZWF0ZUNsYXNzKEJvdHRvbUNvbW1hbmQsIFt7CiAgICAgIGtleTogInJ1bkNvcmVFZGl0b3JDb21tYW5kIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJ1bkNvcmVFZGl0b3JDb21tYW5kKHZpZXdNb2RlbCwgYXJncykgewogICAgICAgIHZpZXdNb2RlbC5tb2RlbC5wdXNoU3RhY2tFbGVtZW50KCk7CiAgICAgICAgdmlld01vZGVsLnNldEN1cnNvclN0YXRlcyhhcmdzLnNvdXJjZSwgMyAvKiBDdXJzb3JDaGFuZ2VSZWFzb24uRXhwbGljaXQgKi8sIEN1cnNvck1vdmVDb21tYW5kcy5tb3ZlVG9FbmRPZkJ1ZmZlcih2aWV3TW9kZWwsIHZpZXdNb2RlbC5nZXRDdXJzb3JTdGF0ZXMoKSwgdGhpcy5faW5TZWxlY3Rpb25Nb2RlKSk7CiAgICAgICAgdmlld01vZGVsLnJldmVhbFByaW1hcnlDdXJzb3IoYXJncy5zb3VyY2UsIHRydWUpOwogICAgICB9CiAgICB9XSk7CiAgICByZXR1cm4gQm90dG9tQ29tbWFuZDsKICB9KENvcmVFZGl0b3JDb21tYW5kKTsKICBDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkN1cnNvckJvdHRvbSA9IHJlZ2lzdGVyRWRpdG9yQ29tbWFuZChuZXcgQm90dG9tQ29tbWFuZCh7CiAgICBpblNlbGVjdGlvbk1vZGU6IGZhbHNlLAogICAgaWQ6ICdjdXJzb3JCb3R0b20nLAogICAgcHJlY29uZGl0aW9uOiB1bmRlZmluZWQsCiAgICBrYk9wdHM6IHsKICAgICAgd2VpZ2h0OiBDT1JFX1dFSUdIVCwKICAgICAga2JFeHByOiBFZGl0b3JDb250ZXh0S2V5cy50ZXh0SW5wdXRGb2N1cywKICAgICAgcHJpbWFyeTogMjA0OCAvKiBLZXlNb2QuQ3RybENtZCAqLyB8IDEzIC8qIEtleUNvZGUuRW5kICovLAogICAgICBtYWM6IHsKICAgICAgICBwcmltYXJ5OiAyMDQ4IC8qIEtleU1vZC5DdHJsQ21kICovIHwgMTggLyogS2V5Q29kZS5Eb3duQXJyb3cgKi8KICAgICAgfQogICAgfQogIH0pKTsKCiAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5DdXJzb3JCb3R0b21TZWxlY3QgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3IEJvdHRvbUNvbW1hbmQoewogICAgaW5TZWxlY3Rpb25Nb2RlOiB0cnVlLAogICAgaWQ6ICdjdXJzb3JCb3R0b21TZWxlY3QnLAogICAgcHJlY29uZGl0aW9uOiB1bmRlZmluZWQsCiAgICBrYk9wdHM6IHsKICAgICAgd2VpZ2h0OiBDT1JFX1dFSUdIVCwKICAgICAga2JFeHByOiBFZGl0b3JDb250ZXh0S2V5cy50ZXh0SW5wdXRGb2N1cywKICAgICAgcHJpbWFyeTogMjA0OCAvKiBLZXlNb2QuQ3RybENtZCAqLyB8IDEwMjQgLyogS2V5TW9kLlNoaWZ0ICovIHwgMTMgLyogS2V5Q29kZS5FbmQgKi8sCiAgICAgIG1hYzogewogICAgICAgIHByaW1hcnk6IDIwNDggLyogS2V5TW9kLkN0cmxDbWQgKi8gfCAxMDI0IC8qIEtleU1vZC5TaGlmdCAqLyB8IDE4IC8qIEtleUNvZGUuRG93bkFycm93ICovCiAgICAgIH0KICAgIH0KICB9KSk7CiAgdmFyIEVkaXRvclNjcm9sbEltcGwgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Db3JlRWRpdG9yQ29tbWFuZDEzKSB7CiAgICBfaW5oZXJpdHMoRWRpdG9yU2Nyb2xsSW1wbCwgX0NvcmVFZGl0b3JDb21tYW5kMTMpOwogICAgdmFyIF9zdXBlcjE5ID0gX2NyZWF0ZVN1cGVyKEVkaXRvclNjcm9sbEltcGwpOwogICAgZnVuY3Rpb24gRWRpdG9yU2Nyb2xsSW1wbCgpIHsKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEVkaXRvclNjcm9sbEltcGwpOwogICAgICByZXR1cm4gX3N1cGVyMTkuY2FsbCh0aGlzLCB7CiAgICAgICAgaWQ6ICdlZGl0b3JTY3JvbGwnLAogICAgICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkLAogICAgICAgIGRlc2NyaXB0aW9uOiBFZGl0b3JTY3JvbGxfLmRlc2NyaXB0aW9uCiAgICAgIH0pOwogICAgfQogICAgX2NyZWF0ZUNsYXNzKEVkaXRvclNjcm9sbEltcGwsIFt7CiAgICAgIGtleTogInJ1bkNvcmVFZGl0b3JDb21tYW5kIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJ1bkNvcmVFZGl0b3JDb21tYW5kKHZpZXdNb2RlbCwgYXJncykgewogICAgICAgIHZhciBwYXJzZWQgPSBFZGl0b3JTY3JvbGxfLnBhcnNlKGFyZ3MpOwogICAgICAgIGlmICghcGFyc2VkKSB7CiAgICAgICAgICAvLyBpbGxlZ2FsIGFyZ3VtZW50cwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB0aGlzLl9ydW5FZGl0b3JTY3JvbGwodmlld01vZGVsLCBhcmdzLnNvdXJjZSwgcGFyc2VkKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJfcnVuRWRpdG9yU2Nyb2xsIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9ydW5FZGl0b3JTY3JvbGwodmlld01vZGVsLCBzb3VyY2UsIGFyZ3MpIHsKICAgICAgICB2YXIgZGVzaXJlZFNjcm9sbFRvcCA9IHRoaXMuX2NvbXB1dGVEZXNpcmVkU2Nyb2xsVG9wKHZpZXdNb2RlbCwgYXJncyk7CiAgICAgICAgaWYgKGFyZ3MucmV2ZWFsQ3Vyc29yKSB7CiAgICAgICAgICAvLyBtdXN0IGVuc3VyZSBjdXJzb3IgaXMgaW4gbmV3IHZpc2libGUgcmFuZ2UKICAgICAgICAgIHZhciBkZXNpcmVkVmlzaWJsZVZpZXdSYW5nZSA9IHZpZXdNb2RlbC5nZXRDb21wbGV0ZWx5VmlzaWJsZVZpZXdSYW5nZUF0U2Nyb2xsVG9wKGRlc2lyZWRTY3JvbGxUb3ApOwogICAgICAgICAgdmlld01vZGVsLnNldEN1cnNvclN0YXRlcyhzb3VyY2UsIDMgLyogQ3Vyc29yQ2hhbmdlUmVhc29uLkV4cGxpY2l0ICovLCBbQ3Vyc29yTW92ZUNvbW1hbmRzLmZpbmRQb3NpdGlvbkluVmlld3BvcnRJZk91dHNpZGUodmlld01vZGVsLCB2aWV3TW9kZWwuZ2V0UHJpbWFyeUN1cnNvclN0YXRlKCksIGRlc2lyZWRWaXNpYmxlVmlld1JhbmdlLCBhcmdzLnNlbGVjdCldKTsKICAgICAgICB9CiAgICAgICAgdmlld01vZGVsLnZpZXdMYXlvdXQuc2V0U2Nyb2xsUG9zaXRpb24oewogICAgICAgICAgc2Nyb2xsVG9wOiBkZXNpcmVkU2Nyb2xsVG9wCiAgICAgICAgfSwgMCAvKiBTY3JvbGxUeXBlLlNtb290aCAqLyk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiX2NvbXB1dGVEZXNpcmVkU2Nyb2xsVG9wIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9jb21wdXRlRGVzaXJlZFNjcm9sbFRvcCh2aWV3TW9kZWwsIGFyZ3MpIHsKICAgICAgICBpZiAoYXJncy51bml0ID09PSAxIC8qIEVkaXRvclNjcm9sbF8uVW5pdC5MaW5lICovKSB7CiAgICAgICAgICAvLyBzY3JvbGxpbmcgYnkgbW9kZWwgbGluZXMKICAgICAgICAgIHZhciB2aXNpYmxlVmlld1JhbmdlID0gdmlld01vZGVsLmdldENvbXBsZXRlbHlWaXNpYmxlVmlld1JhbmdlKCk7CiAgICAgICAgICB2YXIgdmlzaWJsZU1vZGVsUmFuZ2UgPSB2aWV3TW9kZWwuY29vcmRpbmF0ZXNDb252ZXJ0ZXIuY29udmVydFZpZXdSYW5nZVRvTW9kZWxSYW5nZSh2aXNpYmxlVmlld1JhbmdlKTsKICAgICAgICAgIHZhciBkZXNpcmVkVG9wTW9kZWxMaW5lTnVtYmVyOwogICAgICAgICAgaWYgKGFyZ3MuZGlyZWN0aW9uID09PSAxIC8qIEVkaXRvclNjcm9sbF8uRGlyZWN0aW9uLlVwICovKSB7CiAgICAgICAgICAgIC8vIG11c3QgZ28geCBtb2RlbCBsaW5lcyB1cAogICAgICAgICAgICBkZXNpcmVkVG9wTW9kZWxMaW5lTnVtYmVyID0gTWF0aC5tYXgoMSwgdmlzaWJsZU1vZGVsUmFuZ2Uuc3RhcnRMaW5lTnVtYmVyIC0gYXJncy52YWx1ZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBtdXN0IGdvIHggbW9kZWwgbGluZXMgZG93bgogICAgICAgICAgICBkZXNpcmVkVG9wTW9kZWxMaW5lTnVtYmVyID0gTWF0aC5taW4odmlld01vZGVsLm1vZGVsLmdldExpbmVDb3VudCgpLCB2aXNpYmxlTW9kZWxSYW5nZS5zdGFydExpbmVOdW1iZXIgKyBhcmdzLnZhbHVlKTsKICAgICAgICAgIH0KICAgICAgICAgIHZhciB2aWV3UG9zaXRpb24gPSB2aWV3TW9kZWwuY29vcmRpbmF0ZXNDb252ZXJ0ZXIuY29udmVydE1vZGVsUG9zaXRpb25Ub1ZpZXdQb3NpdGlvbihuZXcgUG9zaXRpb24oZGVzaXJlZFRvcE1vZGVsTGluZU51bWJlciwgMSkpOwogICAgICAgICAgcmV0dXJuIHZpZXdNb2RlbC52aWV3TGF5b3V0LmdldFZlcnRpY2FsT2Zmc2V0Rm9yTGluZU51bWJlcih2aWV3UG9zaXRpb24ubGluZU51bWJlcik7CiAgICAgICAgfQogICAgICAgIGlmIChhcmdzLnVuaXQgPT09IDUgLyogRWRpdG9yU2Nyb2xsXy5Vbml0LkVkaXRvciAqLykgewogICAgICAgICAgdmFyIF9kZXNpcmVkVG9wTW9kZWxMaW5lTnVtYmVyID0gMDsKICAgICAgICAgIGlmIChhcmdzLmRpcmVjdGlvbiA9PT0gMiAvKiBFZGl0b3JTY3JvbGxfLkRpcmVjdGlvbi5Eb3duICovKSB7CiAgICAgICAgICAgIF9kZXNpcmVkVG9wTW9kZWxMaW5lTnVtYmVyID0gdmlld01vZGVsLm1vZGVsLmdldExpbmVDb3VudCgpIC0gdmlld01vZGVsLmN1cnNvckNvbmZpZy5wYWdlU2l6ZTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiB2aWV3TW9kZWwudmlld0xheW91dC5nZXRWZXJ0aWNhbE9mZnNldEZvckxpbmVOdW1iZXIoX2Rlc2lyZWRUb3BNb2RlbExpbmVOdW1iZXIpOwogICAgICAgIH0KICAgICAgICB2YXIgbm9PZkxpbmVzOwogICAgICAgIGlmIChhcmdzLnVuaXQgPT09IDMgLyogRWRpdG9yU2Nyb2xsXy5Vbml0LlBhZ2UgKi8pIHsKICAgICAgICAgIG5vT2ZMaW5lcyA9IHZpZXdNb2RlbC5jdXJzb3JDb25maWcucGFnZVNpemUgKiBhcmdzLnZhbHVlOwogICAgICAgIH0gZWxzZSBpZiAoYXJncy51bml0ID09PSA0IC8qIEVkaXRvclNjcm9sbF8uVW5pdC5IYWxmUGFnZSAqLykgewogICAgICAgICAgbm9PZkxpbmVzID0gTWF0aC5yb3VuZCh2aWV3TW9kZWwuY3Vyc29yQ29uZmlnLnBhZ2VTaXplIC8gMikgKiBhcmdzLnZhbHVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBub09mTGluZXMgPSBhcmdzLnZhbHVlOwogICAgICAgIH0KICAgICAgICB2YXIgZGVsdGFMaW5lcyA9IChhcmdzLmRpcmVjdGlvbiA9PT0gMSAvKiBFZGl0b3JTY3JvbGxfLkRpcmVjdGlvbi5VcCAqLyA/IC0xIDogMSkgKiBub09mTGluZXM7CiAgICAgICAgcmV0dXJuIHZpZXdNb2RlbC52aWV3TGF5b3V0LmdldEN1cnJlbnRTY3JvbGxUb3AoKSArIGRlbHRhTGluZXMgKiB2aWV3TW9kZWwuY3Vyc29yQ29uZmlnLmxpbmVIZWlnaHQ7CiAgICAgIH0KICAgIH1dKTsKICAgIHJldHVybiBFZGl0b3JTY3JvbGxJbXBsOwogIH0oQ29yZUVkaXRvckNvbW1hbmQpOwogIENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMuRWRpdG9yU2Nyb2xsSW1wbCA9IEVkaXRvclNjcm9sbEltcGw7CiAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5FZGl0b3JTY3JvbGwgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3IEVkaXRvclNjcm9sbEltcGwoKSk7CiAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5TY3JvbGxMaW5lVXAgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3ICggLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29yZUVkaXRvckNvbW1hbmQxNCkgewogICAgX2luaGVyaXRzKF9jbGFzczYsIF9Db3JlRWRpdG9yQ29tbWFuZDE0KTsKICAgIHZhciBfc3VwZXIyMCA9IF9jcmVhdGVTdXBlcihfY2xhc3M2KTsKICAgIGZ1bmN0aW9uIF9jbGFzczYoKSB7CiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBfY2xhc3M2KTsKICAgICAgcmV0dXJuIF9zdXBlcjIwLmNhbGwodGhpcywgewogICAgICAgIGlkOiAnc2Nyb2xsTGluZVVwJywKICAgICAgICBwcmVjb25kaXRpb246IHVuZGVmaW5lZCwKICAgICAgICBrYk9wdHM6IHsKICAgICAgICAgIHdlaWdodDogQ09SRV9XRUlHSFQsCiAgICAgICAgICBrYkV4cHI6IEVkaXRvckNvbnRleHRLZXlzLnRleHRJbnB1dEZvY3VzLAogICAgICAgICAgcHJpbWFyeTogMjA0OCAvKiBLZXlNb2QuQ3RybENtZCAqLyB8IDE2IC8qIEtleUNvZGUuVXBBcnJvdyAqLywKICAgICAgICAgIG1hYzogewogICAgICAgICAgICBwcmltYXJ5OiAyNTYgLyogS2V5TW9kLldpbkN0cmwgKi8gfCAxMSAvKiBLZXlDb2RlLlBhZ2VVcCAqLwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgICBfY3JlYXRlQ2xhc3MoX2NsYXNzNiwgW3sKICAgICAga2V5OiAicnVuQ29yZUVkaXRvckNvbW1hbmQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcnVuQ29yZUVkaXRvckNvbW1hbmQodmlld01vZGVsLCBhcmdzKSB7CiAgICAgICAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5FZGl0b3JTY3JvbGwuX3J1bkVkaXRvclNjcm9sbCh2aWV3TW9kZWwsIGFyZ3Muc291cmNlLCB7CiAgICAgICAgICBkaXJlY3Rpb246IDEgLyogRWRpdG9yU2Nyb2xsXy5EaXJlY3Rpb24uVXAgKi8sCiAgICAgICAgICB1bml0OiAyIC8qIEVkaXRvclNjcm9sbF8uVW5pdC5XcmFwcGVkTGluZSAqLywKICAgICAgICAgIHZhbHVlOiAxLAogICAgICAgICAgcmV2ZWFsQ3Vyc29yOiBmYWxzZSwKICAgICAgICAgIHNlbGVjdDogZmFsc2UKICAgICAgICB9KTsKICAgICAgfQogICAgfV0pOwogICAgcmV0dXJuIF9jbGFzczY7CiAgfShDb3JlRWRpdG9yQ29tbWFuZCkpKCkpOwogIENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMuU2Nyb2xsUGFnZVVwID0gcmVnaXN0ZXJFZGl0b3JDb21tYW5kKG5ldyAoIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NvcmVFZGl0b3JDb21tYW5kMTUpIHsKICAgIF9pbmhlcml0cyhfY2xhc3M3LCBfQ29yZUVkaXRvckNvbW1hbmQxNSk7CiAgICB2YXIgX3N1cGVyMjEgPSBfY3JlYXRlU3VwZXIoX2NsYXNzNyk7CiAgICBmdW5jdGlvbiBfY2xhc3M3KCkgewogICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgX2NsYXNzNyk7CiAgICAgIHJldHVybiBfc3VwZXIyMS5jYWxsKHRoaXMsIHsKICAgICAgICBpZDogJ3Njcm9sbFBhZ2VVcCcsCiAgICAgICAgcHJlY29uZGl0aW9uOiB1bmRlZmluZWQsCiAgICAgICAga2JPcHRzOiB7CiAgICAgICAgICB3ZWlnaHQ6IENPUkVfV0VJR0hULAogICAgICAgICAga2JFeHByOiBFZGl0b3JDb250ZXh0S2V5cy50ZXh0SW5wdXRGb2N1cywKICAgICAgICAgIHByaW1hcnk6IDIwNDggLyogS2V5TW9kLkN0cmxDbWQgKi8gfCAxMSAvKiBLZXlDb2RlLlBhZ2VVcCAqLywKICAgICAgICAgIHdpbjogewogICAgICAgICAgICBwcmltYXJ5OiA1MTIgLyogS2V5TW9kLkFsdCAqLyB8IDExIC8qIEtleUNvZGUuUGFnZVVwICovCiAgICAgICAgICB9LAogICAgICAgICAgbGludXg6IHsKICAgICAgICAgICAgcHJpbWFyeTogNTEyIC8qIEtleU1vZC5BbHQgKi8gfCAxMSAvKiBLZXlDb2RlLlBhZ2VVcCAqLwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgICBfY3JlYXRlQ2xhc3MoX2NsYXNzNywgW3sKICAgICAga2V5OiAicnVuQ29yZUVkaXRvckNvbW1hbmQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcnVuQ29yZUVkaXRvckNvbW1hbmQodmlld01vZGVsLCBhcmdzKSB7CiAgICAgICAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5FZGl0b3JTY3JvbGwuX3J1bkVkaXRvclNjcm9sbCh2aWV3TW9kZWwsIGFyZ3Muc291cmNlLCB7CiAgICAgICAgICBkaXJlY3Rpb246IDEgLyogRWRpdG9yU2Nyb2xsXy5EaXJlY3Rpb24uVXAgKi8sCiAgICAgICAgICB1bml0OiAzIC8qIEVkaXRvclNjcm9sbF8uVW5pdC5QYWdlICovLAogICAgICAgICAgdmFsdWU6IDEsCiAgICAgICAgICByZXZlYWxDdXJzb3I6IGZhbHNlLAogICAgICAgICAgc2VsZWN0OiBmYWxzZQogICAgICAgIH0pOwogICAgICB9CiAgICB9XSk7CiAgICByZXR1cm4gX2NsYXNzNzsKICB9KENvcmVFZGl0b3JDb21tYW5kKSkoKSk7CiAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5TY3JvbGxFZGl0b3JUb3AgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3ICggLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29yZUVkaXRvckNvbW1hbmQxNikgewogICAgX2luaGVyaXRzKF9jbGFzczgsIF9Db3JlRWRpdG9yQ29tbWFuZDE2KTsKICAgIHZhciBfc3VwZXIyMiA9IF9jcmVhdGVTdXBlcihfY2xhc3M4KTsKICAgIGZ1bmN0aW9uIF9jbGFzczgoKSB7CiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBfY2xhc3M4KTsKICAgICAgcmV0dXJuIF9zdXBlcjIyLmNhbGwodGhpcywgewogICAgICAgIGlkOiAnc2Nyb2xsRWRpdG9yVG9wJywKICAgICAgICBwcmVjb25kaXRpb246IHVuZGVmaW5lZCwKICAgICAgICBrYk9wdHM6IHsKICAgICAgICAgIHdlaWdodDogQ09SRV9XRUlHSFQsCiAgICAgICAgICBrYkV4cHI6IEVkaXRvckNvbnRleHRLZXlzLnRleHRJbnB1dEZvY3VzCiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICAgIF9jcmVhdGVDbGFzcyhfY2xhc3M4LCBbewogICAgICBrZXk6ICJydW5Db3JlRWRpdG9yQ29tbWFuZCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBydW5Db3JlRWRpdG9yQ29tbWFuZCh2aWV3TW9kZWwsIGFyZ3MpIHsKICAgICAgICBDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkVkaXRvclNjcm9sbC5fcnVuRWRpdG9yU2Nyb2xsKHZpZXdNb2RlbCwgYXJncy5zb3VyY2UsIHsKICAgICAgICAgIGRpcmVjdGlvbjogMSAvKiBFZGl0b3JTY3JvbGxfLkRpcmVjdGlvbi5VcCAqLywKICAgICAgICAgIHVuaXQ6IDUgLyogRWRpdG9yU2Nyb2xsXy5Vbml0LkVkaXRvciAqLywKICAgICAgICAgIHZhbHVlOiAxLAogICAgICAgICAgcmV2ZWFsQ3Vyc29yOiBmYWxzZSwKICAgICAgICAgIHNlbGVjdDogZmFsc2UKICAgICAgICB9KTsKICAgICAgfQogICAgfV0pOwogICAgcmV0dXJuIF9jbGFzczg7CiAgfShDb3JlRWRpdG9yQ29tbWFuZCkpKCkpOwogIENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMuU2Nyb2xsTGluZURvd24gPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3ICggLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29yZUVkaXRvckNvbW1hbmQxNykgewogICAgX2luaGVyaXRzKF9jbGFzczksIF9Db3JlRWRpdG9yQ29tbWFuZDE3KTsKICAgIHZhciBfc3VwZXIyMyA9IF9jcmVhdGVTdXBlcihfY2xhc3M5KTsKICAgIGZ1bmN0aW9uIF9jbGFzczkoKSB7CiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBfY2xhc3M5KTsKICAgICAgcmV0dXJuIF9zdXBlcjIzLmNhbGwodGhpcywgewogICAgICAgIGlkOiAnc2Nyb2xsTGluZURvd24nLAogICAgICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkLAogICAgICAgIGtiT3B0czogewogICAgICAgICAgd2VpZ2h0OiBDT1JFX1dFSUdIVCwKICAgICAgICAgIGtiRXhwcjogRWRpdG9yQ29udGV4dEtleXMudGV4dElucHV0Rm9jdXMsCiAgICAgICAgICBwcmltYXJ5OiAyMDQ4IC8qIEtleU1vZC5DdHJsQ21kICovIHwgMTggLyogS2V5Q29kZS5Eb3duQXJyb3cgKi8sCiAgICAgICAgICBtYWM6IHsKICAgICAgICAgICAgcHJpbWFyeTogMjU2IC8qIEtleU1vZC5XaW5DdHJsICovIHwgMTIgLyogS2V5Q29kZS5QYWdlRG93biAqLwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgICBfY3JlYXRlQ2xhc3MoX2NsYXNzOSwgW3sKICAgICAga2V5OiAicnVuQ29yZUVkaXRvckNvbW1hbmQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcnVuQ29yZUVkaXRvckNvbW1hbmQodmlld01vZGVsLCBhcmdzKSB7CiAgICAgICAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5FZGl0b3JTY3JvbGwuX3J1bkVkaXRvclNjcm9sbCh2aWV3TW9kZWwsIGFyZ3Muc291cmNlLCB7CiAgICAgICAgICBkaXJlY3Rpb246IDIgLyogRWRpdG9yU2Nyb2xsXy5EaXJlY3Rpb24uRG93biAqLywKICAgICAgICAgIHVuaXQ6IDIgLyogRWRpdG9yU2Nyb2xsXy5Vbml0LldyYXBwZWRMaW5lICovLAogICAgICAgICAgdmFsdWU6IDEsCiAgICAgICAgICByZXZlYWxDdXJzb3I6IGZhbHNlLAogICAgICAgICAgc2VsZWN0OiBmYWxzZQogICAgICAgIH0pOwogICAgICB9CiAgICB9XSk7CiAgICByZXR1cm4gX2NsYXNzOTsKICB9KENvcmVFZGl0b3JDb21tYW5kKSkoKSk7CiAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5TY3JvbGxQYWdlRG93biA9IHJlZ2lzdGVyRWRpdG9yQ29tbWFuZChuZXcgKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Db3JlRWRpdG9yQ29tbWFuZDE4KSB7CiAgICBfaW5oZXJpdHMoX2NsYXNzMTAsIF9Db3JlRWRpdG9yQ29tbWFuZDE4KTsKICAgIHZhciBfc3VwZXIyNCA9IF9jcmVhdGVTdXBlcihfY2xhc3MxMCk7CiAgICBmdW5jdGlvbiBfY2xhc3MxMCgpIHsKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIF9jbGFzczEwKTsKICAgICAgcmV0dXJuIF9zdXBlcjI0LmNhbGwodGhpcywgewogICAgICAgIGlkOiAnc2Nyb2xsUGFnZURvd24nLAogICAgICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkLAogICAgICAgIGtiT3B0czogewogICAgICAgICAgd2VpZ2h0OiBDT1JFX1dFSUdIVCwKICAgICAgICAgIGtiRXhwcjogRWRpdG9yQ29udGV4dEtleXMudGV4dElucHV0Rm9jdXMsCiAgICAgICAgICBwcmltYXJ5OiAyMDQ4IC8qIEtleU1vZC5DdHJsQ21kICovIHwgMTIgLyogS2V5Q29kZS5QYWdlRG93biAqLywKICAgICAgICAgIHdpbjogewogICAgICAgICAgICBwcmltYXJ5OiA1MTIgLyogS2V5TW9kLkFsdCAqLyB8IDEyIC8qIEtleUNvZGUuUGFnZURvd24gKi8KICAgICAgICAgIH0sCiAgICAgICAgICBsaW51eDogewogICAgICAgICAgICBwcmltYXJ5OiA1MTIgLyogS2V5TW9kLkFsdCAqLyB8IDEyIC8qIEtleUNvZGUuUGFnZURvd24gKi8KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfQogICAgX2NyZWF0ZUNsYXNzKF9jbGFzczEwLCBbewogICAgICBrZXk6ICJydW5Db3JlRWRpdG9yQ29tbWFuZCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBydW5Db3JlRWRpdG9yQ29tbWFuZCh2aWV3TW9kZWwsIGFyZ3MpIHsKICAgICAgICBDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkVkaXRvclNjcm9sbC5fcnVuRWRpdG9yU2Nyb2xsKHZpZXdNb2RlbCwgYXJncy5zb3VyY2UsIHsKICAgICAgICAgIGRpcmVjdGlvbjogMiAvKiBFZGl0b3JTY3JvbGxfLkRpcmVjdGlvbi5Eb3duICovLAogICAgICAgICAgdW5pdDogMyAvKiBFZGl0b3JTY3JvbGxfLlVuaXQuUGFnZSAqLywKICAgICAgICAgIHZhbHVlOiAxLAogICAgICAgICAgcmV2ZWFsQ3Vyc29yOiBmYWxzZSwKICAgICAgICAgIHNlbGVjdDogZmFsc2UKICAgICAgICB9KTsKICAgICAgfQogICAgfV0pOwogICAgcmV0dXJuIF9jbGFzczEwOwogIH0oQ29yZUVkaXRvckNvbW1hbmQpKSgpKTsKICBDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLlNjcm9sbEVkaXRvckJvdHRvbSA9IHJlZ2lzdGVyRWRpdG9yQ29tbWFuZChuZXcgKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Db3JlRWRpdG9yQ29tbWFuZDE5KSB7CiAgICBfaW5oZXJpdHMoX2NsYXNzMTEsIF9Db3JlRWRpdG9yQ29tbWFuZDE5KTsKICAgIHZhciBfc3VwZXIyNSA9IF9jcmVhdGVTdXBlcihfY2xhc3MxMSk7CiAgICBmdW5jdGlvbiBfY2xhc3MxMSgpIHsKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIF9jbGFzczExKTsKICAgICAgcmV0dXJuIF9zdXBlcjI1LmNhbGwodGhpcywgewogICAgICAgIGlkOiAnc2Nyb2xsRWRpdG9yQm90dG9tJywKICAgICAgICBwcmVjb25kaXRpb246IHVuZGVmaW5lZCwKICAgICAgICBrYk9wdHM6IHsKICAgICAgICAgIHdlaWdodDogQ09SRV9XRUlHSFQsCiAgICAgICAgICBrYkV4cHI6IEVkaXRvckNvbnRleHRLZXlzLnRleHRJbnB1dEZvY3VzCiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICAgIF9jcmVhdGVDbGFzcyhfY2xhc3MxMSwgW3sKICAgICAga2V5OiAicnVuQ29yZUVkaXRvckNvbW1hbmQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcnVuQ29yZUVkaXRvckNvbW1hbmQodmlld01vZGVsLCBhcmdzKSB7CiAgICAgICAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5FZGl0b3JTY3JvbGwuX3J1bkVkaXRvclNjcm9sbCh2aWV3TW9kZWwsIGFyZ3Muc291cmNlLCB7CiAgICAgICAgICBkaXJlY3Rpb246IDIgLyogRWRpdG9yU2Nyb2xsXy5EaXJlY3Rpb24uRG93biAqLywKICAgICAgICAgIHVuaXQ6IDUgLyogRWRpdG9yU2Nyb2xsXy5Vbml0LkVkaXRvciAqLywKICAgICAgICAgIHZhbHVlOiAxLAogICAgICAgICAgcmV2ZWFsQ3Vyc29yOiBmYWxzZSwKICAgICAgICAgIHNlbGVjdDogZmFsc2UKICAgICAgICB9KTsKICAgICAgfQogICAgfV0pOwogICAgcmV0dXJuIF9jbGFzczExOwogIH0oQ29yZUVkaXRvckNvbW1hbmQpKSgpKTsKICB2YXIgV29yZENvbW1hbmQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Db3JlRWRpdG9yQ29tbWFuZDIwKSB7CiAgICBfaW5oZXJpdHMoV29yZENvbW1hbmQsIF9Db3JlRWRpdG9yQ29tbWFuZDIwKTsKICAgIHZhciBfc3VwZXIyNiA9IF9jcmVhdGVTdXBlcihXb3JkQ29tbWFuZCk7CiAgICBmdW5jdGlvbiBXb3JkQ29tbWFuZChvcHRzKSB7CiAgICAgIHZhciBfdGhpczEyOwogICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgV29yZENvbW1hbmQpOwogICAgICBfdGhpczEyID0gX3N1cGVyMjYuY2FsbCh0aGlzLCBvcHRzKTsKICAgICAgX3RoaXMxMi5faW5TZWxlY3Rpb25Nb2RlID0gb3B0cy5pblNlbGVjdGlvbk1vZGU7CiAgICAgIHJldHVybiBfdGhpczEyOwogICAgfQogICAgX2NyZWF0ZUNsYXNzKFdvcmRDb21tYW5kLCBbewogICAgICBrZXk6ICJydW5Db3JlRWRpdG9yQ29tbWFuZCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBydW5Db3JlRWRpdG9yQ29tbWFuZCh2aWV3TW9kZWwsIGFyZ3MpIHsKICAgICAgICB2aWV3TW9kZWwubW9kZWwucHVzaFN0YWNrRWxlbWVudCgpOwogICAgICAgIHZpZXdNb2RlbC5zZXRDdXJzb3JTdGF0ZXMoYXJncy5zb3VyY2UsIDMgLyogQ3Vyc29yQ2hhbmdlUmVhc29uLkV4cGxpY2l0ICovLCBbQ3Vyc29yTW92ZUNvbW1hbmRzLndvcmQodmlld01vZGVsLCB2aWV3TW9kZWwuZ2V0UHJpbWFyeUN1cnNvclN0YXRlKCksIHRoaXMuX2luU2VsZWN0aW9uTW9kZSwgYXJncy5wb3NpdGlvbildKTsKICAgICAgICB2aWV3TW9kZWwucmV2ZWFsUHJpbWFyeUN1cnNvcihhcmdzLnNvdXJjZSwgdHJ1ZSk7CiAgICAgIH0KICAgIH1dKTsKICAgIHJldHVybiBXb3JkQ29tbWFuZDsKICB9KENvcmVFZGl0b3JDb21tYW5kKTsKICBDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLldvcmRTZWxlY3QgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3IFdvcmRDb21tYW5kKHsKICAgIGluU2VsZWN0aW9uTW9kZTogZmFsc2UsCiAgICBpZDogJ193b3JkU2VsZWN0JywKICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkCiAgfSkpOwogIENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMuV29yZFNlbGVjdERyYWcgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3IFdvcmRDb21tYW5kKHsKICAgIGluU2VsZWN0aW9uTW9kZTogdHJ1ZSwKICAgIGlkOiAnX3dvcmRTZWxlY3REcmFnJywKICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkCiAgfSkpOwogIENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMuTGFzdEN1cnNvcldvcmRTZWxlY3QgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3ICggLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29yZUVkaXRvckNvbW1hbmQyMSkgewogICAgX2luaGVyaXRzKF9jbGFzczEyLCBfQ29yZUVkaXRvckNvbW1hbmQyMSk7CiAgICB2YXIgX3N1cGVyMjcgPSBfY3JlYXRlU3VwZXIoX2NsYXNzMTIpOwogICAgZnVuY3Rpb24gX2NsYXNzMTIoKSB7CiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBfY2xhc3MxMik7CiAgICAgIHJldHVybiBfc3VwZXIyNy5jYWxsKHRoaXMsIHsKICAgICAgICBpZDogJ2xhc3RDdXJzb3JXb3JkU2VsZWN0JywKICAgICAgICBwcmVjb25kaXRpb246IHVuZGVmaW5lZAogICAgICB9KTsKICAgIH0KICAgIF9jcmVhdGVDbGFzcyhfY2xhc3MxMiwgW3sKICAgICAga2V5OiAicnVuQ29yZUVkaXRvckNvbW1hbmQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcnVuQ29yZUVkaXRvckNvbW1hbmQodmlld01vZGVsLCBhcmdzKSB7CiAgICAgICAgdmFyIGxhc3RBZGRlZEN1cnNvckluZGV4ID0gdmlld01vZGVsLmdldExhc3RBZGRlZEN1cnNvckluZGV4KCk7CiAgICAgICAgdmFyIHN0YXRlcyA9IHZpZXdNb2RlbC5nZXRDdXJzb3JTdGF0ZXMoKTsKICAgICAgICB2YXIgbmV3U3RhdGVzID0gc3RhdGVzLnNsaWNlKDApOwogICAgICAgIHZhciBsYXN0QWRkZWRTdGF0ZSA9IHN0YXRlc1tsYXN0QWRkZWRDdXJzb3JJbmRleF07CiAgICAgICAgbmV3U3RhdGVzW2xhc3RBZGRlZEN1cnNvckluZGV4XSA9IEN1cnNvck1vdmVDb21tYW5kcy53b3JkKHZpZXdNb2RlbCwgbGFzdEFkZGVkU3RhdGUsIGxhc3RBZGRlZFN0YXRlLm1vZGVsU3RhdGUuaGFzU2VsZWN0aW9uKCksIGFyZ3MucG9zaXRpb24pOwogICAgICAgIHZpZXdNb2RlbC5tb2RlbC5wdXNoU3RhY2tFbGVtZW50KCk7CiAgICAgICAgdmlld01vZGVsLnNldEN1cnNvclN0YXRlcyhhcmdzLnNvdXJjZSwgMyAvKiBDdXJzb3JDaGFuZ2VSZWFzb24uRXhwbGljaXQgKi8sIG5ld1N0YXRlcyk7CiAgICAgIH0KICAgIH1dKTsKICAgIHJldHVybiBfY2xhc3MxMjsKICB9KENvcmVFZGl0b3JDb21tYW5kKSkoKSk7CiAgdmFyIExpbmVDb21tYW5kID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29yZUVkaXRvckNvbW1hbmQyMikgewogICAgX2luaGVyaXRzKExpbmVDb21tYW5kLCBfQ29yZUVkaXRvckNvbW1hbmQyMik7CiAgICB2YXIgX3N1cGVyMjggPSBfY3JlYXRlU3VwZXIoTGluZUNvbW1hbmQpOwogICAgZnVuY3Rpb24gTGluZUNvbW1hbmQob3B0cykgewogICAgICB2YXIgX3RoaXMxMzsKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIExpbmVDb21tYW5kKTsKICAgICAgX3RoaXMxMyA9IF9zdXBlcjI4LmNhbGwodGhpcywgb3B0cyk7CiAgICAgIF90aGlzMTMuX2luU2VsZWN0aW9uTW9kZSA9IG9wdHMuaW5TZWxlY3Rpb25Nb2RlOwogICAgICByZXR1cm4gX3RoaXMxMzsKICAgIH0KICAgIF9jcmVhdGVDbGFzcyhMaW5lQ29tbWFuZCwgW3sKICAgICAga2V5OiAicnVuQ29yZUVkaXRvckNvbW1hbmQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcnVuQ29yZUVkaXRvckNvbW1hbmQodmlld01vZGVsLCBhcmdzKSB7CiAgICAgICAgdmlld01vZGVsLm1vZGVsLnB1c2hTdGFja0VsZW1lbnQoKTsKICAgICAgICB2aWV3TW9kZWwuc2V0Q3Vyc29yU3RhdGVzKGFyZ3Muc291cmNlLCAzIC8qIEN1cnNvckNoYW5nZVJlYXNvbi5FeHBsaWNpdCAqLywgW0N1cnNvck1vdmVDb21tYW5kcy5saW5lKHZpZXdNb2RlbCwgdmlld01vZGVsLmdldFByaW1hcnlDdXJzb3JTdGF0ZSgpLCB0aGlzLl9pblNlbGVjdGlvbk1vZGUsIGFyZ3MucG9zaXRpb24sIGFyZ3Mudmlld1Bvc2l0aW9uKV0pOwogICAgICAgIHZpZXdNb2RlbC5yZXZlYWxQcmltYXJ5Q3Vyc29yKGFyZ3Muc291cmNlLCBmYWxzZSk7CiAgICAgIH0KICAgIH1dKTsKICAgIHJldHVybiBMaW5lQ29tbWFuZDsKICB9KENvcmVFZGl0b3JDb21tYW5kKTsKICBDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkxpbmVTZWxlY3QgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3IExpbmVDb21tYW5kKHsKICAgIGluU2VsZWN0aW9uTW9kZTogZmFsc2UsCiAgICBpZDogJ19saW5lU2VsZWN0JywKICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkCiAgfSkpOwogIENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMuTGluZVNlbGVjdERyYWcgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3IExpbmVDb21tYW5kKHsKICAgIGluU2VsZWN0aW9uTW9kZTogdHJ1ZSwKICAgIGlkOiAnX2xpbmVTZWxlY3REcmFnJywKICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkCiAgfSkpOwogIHZhciBMYXN0Q3Vyc29yTGluZUNvbW1hbmQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Db3JlRWRpdG9yQ29tbWFuZDIzKSB7CiAgICBfaW5oZXJpdHMoTGFzdEN1cnNvckxpbmVDb21tYW5kLCBfQ29yZUVkaXRvckNvbW1hbmQyMyk7CiAgICB2YXIgX3N1cGVyMjkgPSBfY3JlYXRlU3VwZXIoTGFzdEN1cnNvckxpbmVDb21tYW5kKTsKICAgIGZ1bmN0aW9uIExhc3RDdXJzb3JMaW5lQ29tbWFuZChvcHRzKSB7CiAgICAgIHZhciBfdGhpczE0OwogICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTGFzdEN1cnNvckxpbmVDb21tYW5kKTsKICAgICAgX3RoaXMxNCA9IF9zdXBlcjI5LmNhbGwodGhpcywgb3B0cyk7CiAgICAgIF90aGlzMTQuX2luU2VsZWN0aW9uTW9kZSA9IG9wdHMuaW5TZWxlY3Rpb25Nb2RlOwogICAgICByZXR1cm4gX3RoaXMxNDsKICAgIH0KICAgIF9jcmVhdGVDbGFzcyhMYXN0Q3Vyc29yTGluZUNvbW1hbmQsIFt7CiAgICAgIGtleTogInJ1bkNvcmVFZGl0b3JDb21tYW5kIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJ1bkNvcmVFZGl0b3JDb21tYW5kKHZpZXdNb2RlbCwgYXJncykgewogICAgICAgIHZhciBsYXN0QWRkZWRDdXJzb3JJbmRleCA9IHZpZXdNb2RlbC5nZXRMYXN0QWRkZWRDdXJzb3JJbmRleCgpOwogICAgICAgIHZhciBzdGF0ZXMgPSB2aWV3TW9kZWwuZ2V0Q3Vyc29yU3RhdGVzKCk7CiAgICAgICAgdmFyIG5ld1N0YXRlcyA9IHN0YXRlcy5zbGljZSgwKTsKICAgICAgICBuZXdTdGF0ZXNbbGFzdEFkZGVkQ3Vyc29ySW5kZXhdID0gQ3Vyc29yTW92ZUNvbW1hbmRzLmxpbmUodmlld01vZGVsLCBzdGF0ZXNbbGFzdEFkZGVkQ3Vyc29ySW5kZXhdLCB0aGlzLl9pblNlbGVjdGlvbk1vZGUsIGFyZ3MucG9zaXRpb24sIGFyZ3Mudmlld1Bvc2l0aW9uKTsKICAgICAgICB2aWV3TW9kZWwubW9kZWwucHVzaFN0YWNrRWxlbWVudCgpOwogICAgICAgIHZpZXdNb2RlbC5zZXRDdXJzb3JTdGF0ZXMoYXJncy5zb3VyY2UsIDMgLyogQ3Vyc29yQ2hhbmdlUmVhc29uLkV4cGxpY2l0ICovLCBuZXdTdGF0ZXMpOwogICAgICB9CiAgICB9XSk7CiAgICByZXR1cm4gTGFzdEN1cnNvckxpbmVDb21tYW5kOwogIH0oQ29yZUVkaXRvckNvbW1hbmQpOwogIENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMuTGFzdEN1cnNvckxpbmVTZWxlY3QgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3IExhc3RDdXJzb3JMaW5lQ29tbWFuZCh7CiAgICBpblNlbGVjdGlvbk1vZGU6IGZhbHNlLAogICAgaWQ6ICdsYXN0Q3Vyc29yTGluZVNlbGVjdCcsCiAgICBwcmVjb25kaXRpb246IHVuZGVmaW5lZAogIH0pKTsKICBDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkxhc3RDdXJzb3JMaW5lU2VsZWN0RHJhZyA9IHJlZ2lzdGVyRWRpdG9yQ29tbWFuZChuZXcgTGFzdEN1cnNvckxpbmVDb21tYW5kKHsKICAgIGluU2VsZWN0aW9uTW9kZTogdHJ1ZSwKICAgIGlkOiAnbGFzdEN1cnNvckxpbmVTZWxlY3REcmFnJywKICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkCiAgfSkpOwogIENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMuQ2FuY2VsU2VsZWN0aW9uID0gcmVnaXN0ZXJFZGl0b3JDb21tYW5kKG5ldyAoIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NvcmVFZGl0b3JDb21tYW5kMjQpIHsKICAgIF9pbmhlcml0cyhfY2xhc3MxMywgX0NvcmVFZGl0b3JDb21tYW5kMjQpOwogICAgdmFyIF9zdXBlcjMwID0gX2NyZWF0ZVN1cGVyKF9jbGFzczEzKTsKICAgIGZ1bmN0aW9uIF9jbGFzczEzKCkgewogICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgX2NsYXNzMTMpOwogICAgICByZXR1cm4gX3N1cGVyMzAuY2FsbCh0aGlzLCB7CiAgICAgICAgaWQ6ICdjYW5jZWxTZWxlY3Rpb24nLAogICAgICAgIHByZWNvbmRpdGlvbjogRWRpdG9yQ29udGV4dEtleXMuaGFzTm9uRW1wdHlTZWxlY3Rpb24sCiAgICAgICAga2JPcHRzOiB7CiAgICAgICAgICB3ZWlnaHQ6IENPUkVfV0VJR0hULAogICAgICAgICAga2JFeHByOiBFZGl0b3JDb250ZXh0S2V5cy50ZXh0SW5wdXRGb2N1cywKICAgICAgICAgIHByaW1hcnk6IDkgLyogS2V5Q29kZS5Fc2NhcGUgKi8sCiAgICAgICAgICBzZWNvbmRhcnk6IFsxMDI0IC8qIEtleU1vZC5TaGlmdCAqLyB8IDkgLyogS2V5Q29kZS5Fc2NhcGUgKi9dCiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICAgIF9jcmVhdGVDbGFzcyhfY2xhc3MxMywgW3sKICAgICAga2V5OiAicnVuQ29yZUVkaXRvckNvbW1hbmQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcnVuQ29yZUVkaXRvckNvbW1hbmQodmlld01vZGVsLCBhcmdzKSB7CiAgICAgICAgdmlld01vZGVsLm1vZGVsLnB1c2hTdGFja0VsZW1lbnQoKTsKICAgICAgICB2aWV3TW9kZWwuc2V0Q3Vyc29yU3RhdGVzKGFyZ3Muc291cmNlLCAzIC8qIEN1cnNvckNoYW5nZVJlYXNvbi5FeHBsaWNpdCAqLywgW0N1cnNvck1vdmVDb21tYW5kcy5jYW5jZWxTZWxlY3Rpb24odmlld01vZGVsLCB2aWV3TW9kZWwuZ2V0UHJpbWFyeUN1cnNvclN0YXRlKCkpXSk7CiAgICAgICAgdmlld01vZGVsLnJldmVhbFByaW1hcnlDdXJzb3IoYXJncy5zb3VyY2UsIHRydWUpOwogICAgICB9CiAgICB9XSk7CiAgICByZXR1cm4gX2NsYXNzMTM7CiAgfShDb3JlRWRpdG9yQ29tbWFuZCkpKCkpOwogIENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMuUmVtb3ZlU2Vjb25kYXJ5Q3Vyc29ycyA9IHJlZ2lzdGVyRWRpdG9yQ29tbWFuZChuZXcgKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Db3JlRWRpdG9yQ29tbWFuZDI1KSB7CiAgICBfaW5oZXJpdHMoX2NsYXNzMTQsIF9Db3JlRWRpdG9yQ29tbWFuZDI1KTsKICAgIHZhciBfc3VwZXIzMSA9IF9jcmVhdGVTdXBlcihfY2xhc3MxNCk7CiAgICBmdW5jdGlvbiBfY2xhc3MxNCgpIHsKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIF9jbGFzczE0KTsKICAgICAgcmV0dXJuIF9zdXBlcjMxLmNhbGwodGhpcywgewogICAgICAgIGlkOiAncmVtb3ZlU2Vjb25kYXJ5Q3Vyc29ycycsCiAgICAgICAgcHJlY29uZGl0aW9uOiBFZGl0b3JDb250ZXh0S2V5cy5oYXNNdWx0aXBsZVNlbGVjdGlvbnMsCiAgICAgICAga2JPcHRzOiB7CiAgICAgICAgICB3ZWlnaHQ6IENPUkVfV0VJR0hUICsgMSwKICAgICAgICAgIGtiRXhwcjogRWRpdG9yQ29udGV4dEtleXMudGV4dElucHV0Rm9jdXMsCiAgICAgICAgICBwcmltYXJ5OiA5IC8qIEtleUNvZGUuRXNjYXBlICovLAogICAgICAgICAgc2Vjb25kYXJ5OiBbMTAyNCAvKiBLZXlNb2QuU2hpZnQgKi8gfCA5IC8qIEtleUNvZGUuRXNjYXBlICovXQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgICBfY3JlYXRlQ2xhc3MoX2NsYXNzMTQsIFt7CiAgICAgIGtleTogInJ1bkNvcmVFZGl0b3JDb21tYW5kIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJ1bkNvcmVFZGl0b3JDb21tYW5kKHZpZXdNb2RlbCwgYXJncykgewogICAgICAgIHZpZXdNb2RlbC5tb2RlbC5wdXNoU3RhY2tFbGVtZW50KCk7CiAgICAgICAgdmlld01vZGVsLnNldEN1cnNvclN0YXRlcyhhcmdzLnNvdXJjZSwgMyAvKiBDdXJzb3JDaGFuZ2VSZWFzb24uRXhwbGljaXQgKi8sIFt2aWV3TW9kZWwuZ2V0UHJpbWFyeUN1cnNvclN0YXRlKCldKTsKICAgICAgICB2aWV3TW9kZWwucmV2ZWFsUHJpbWFyeUN1cnNvcihhcmdzLnNvdXJjZSwgdHJ1ZSk7CiAgICAgICAgc3RhdHVzKG5scy5sb2NhbGl6ZSgncmVtb3ZlZEN1cnNvcicsICJSZW1vdmVkIHNlY29uZGFyeSBjdXJzb3JzIikpOwogICAgICB9CiAgICB9XSk7CiAgICByZXR1cm4gX2NsYXNzMTQ7CiAgfShDb3JlRWRpdG9yQ29tbWFuZCkpKCkpOwogIENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMuUmV2ZWFsTGluZSA9IHJlZ2lzdGVyRWRpdG9yQ29tbWFuZChuZXcgKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Db3JlRWRpdG9yQ29tbWFuZDI2KSB7CiAgICBfaW5oZXJpdHMoX2NsYXNzMTUsIF9Db3JlRWRpdG9yQ29tbWFuZDI2KTsKICAgIHZhciBfc3VwZXIzMiA9IF9jcmVhdGVTdXBlcihfY2xhc3MxNSk7CiAgICBmdW5jdGlvbiBfY2xhc3MxNSgpIHsKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIF9jbGFzczE1KTsKICAgICAgcmV0dXJuIF9zdXBlcjMyLmNhbGwodGhpcywgewogICAgICAgIGlkOiAncmV2ZWFsTGluZScsCiAgICAgICAgcHJlY29uZGl0aW9uOiB1bmRlZmluZWQsCiAgICAgICAgZGVzY3JpcHRpb246IFJldmVhbExpbmVfLmRlc2NyaXB0aW9uCiAgICAgIH0pOwogICAgfQogICAgX2NyZWF0ZUNsYXNzKF9jbGFzczE1LCBbewogICAgICBrZXk6ICJydW5Db3JlRWRpdG9yQ29tbWFuZCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBydW5Db3JlRWRpdG9yQ29tbWFuZCh2aWV3TW9kZWwsIGFyZ3MpIHsKICAgICAgICB2YXIgcmV2ZWFsTGluZUFyZyA9IGFyZ3M7CiAgICAgICAgdmFyIGxpbmVOdW1iZXJBcmcgPSByZXZlYWxMaW5lQXJnLmxpbmVOdW1iZXIgfHwgMDsKICAgICAgICB2YXIgbGluZU51bWJlciA9IHR5cGVvZiBsaW5lTnVtYmVyQXJnID09PSAnbnVtYmVyJyA/IGxpbmVOdW1iZXJBcmcgKyAxIDogcGFyc2VJbnQobGluZU51bWJlckFyZykgKyAxOwogICAgICAgIGlmIChsaW5lTnVtYmVyIDwgMSkgewogICAgICAgICAgbGluZU51bWJlciA9IDE7CiAgICAgICAgfQogICAgICAgIHZhciBsaW5lQ291bnQgPSB2aWV3TW9kZWwubW9kZWwuZ2V0TGluZUNvdW50KCk7CiAgICAgICAgaWYgKGxpbmVOdW1iZXIgPiBsaW5lQ291bnQpIHsKICAgICAgICAgIGxpbmVOdW1iZXIgPSBsaW5lQ291bnQ7CiAgICAgICAgfQogICAgICAgIHZhciByYW5nZSA9IG5ldyBSYW5nZShsaW5lTnVtYmVyLCAxLCBsaW5lTnVtYmVyLCB2aWV3TW9kZWwubW9kZWwuZ2V0TGluZU1heENvbHVtbihsaW5lTnVtYmVyKSk7CiAgICAgICAgdmFyIHJldmVhbEF0ID0gMCAvKiBWZXJ0aWNhbFJldmVhbFR5cGUuU2ltcGxlICovOwogICAgICAgIGlmIChyZXZlYWxMaW5lQXJnLmF0KSB7CiAgICAgICAgICBzd2l0Y2ggKHJldmVhbExpbmVBcmcuYXQpIHsKICAgICAgICAgICAgY2FzZSBSZXZlYWxMaW5lXy5SYXdBdEFyZ3VtZW50LlRvcDoKICAgICAgICAgICAgICByZXZlYWxBdCA9IDMgLyogVmVydGljYWxSZXZlYWxUeXBlLlRvcCAqLzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBSZXZlYWxMaW5lXy5SYXdBdEFyZ3VtZW50LkNlbnRlcjoKICAgICAgICAgICAgICByZXZlYWxBdCA9IDEgLyogVmVydGljYWxSZXZlYWxUeXBlLkNlbnRlciAqLzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBSZXZlYWxMaW5lXy5SYXdBdEFyZ3VtZW50LkJvdHRvbToKICAgICAgICAgICAgICByZXZlYWxBdCA9IDQgLyogVmVydGljYWxSZXZlYWxUeXBlLkJvdHRvbSAqLzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdmFyIHZpZXdSYW5nZSA9IHZpZXdNb2RlbC5jb29yZGluYXRlc0NvbnZlcnRlci5jb252ZXJ0TW9kZWxSYW5nZVRvVmlld1JhbmdlKHJhbmdlKTsKICAgICAgICB2aWV3TW9kZWwucmV2ZWFsUmFuZ2UoYXJncy5zb3VyY2UsIGZhbHNlLCB2aWV3UmFuZ2UsIHJldmVhbEF0LCAwIC8qIFNjcm9sbFR5cGUuU21vb3RoICovKTsKICAgICAgfQogICAgfV0pOwogICAgcmV0dXJuIF9jbGFzczE1OwogIH0oQ29yZUVkaXRvckNvbW1hbmQpKSgpKTsKICBDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLlNlbGVjdEFsbCA9IG5ldyAoIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0VkaXRvck9yTmF0aXZlVGV4dEluKSB7CiAgICBfaW5oZXJpdHMoX2NsYXNzMTYsIF9FZGl0b3JPck5hdGl2ZVRleHRJbik7CiAgICB2YXIgX3N1cGVyMzMgPSBfY3JlYXRlU3VwZXIoX2NsYXNzMTYpOwogICAgZnVuY3Rpb24gX2NsYXNzMTYoKSB7CiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBfY2xhc3MxNik7CiAgICAgIHJldHVybiBfc3VwZXIzMy5jYWxsKHRoaXMsIFNlbGVjdEFsbENvbW1hbmQpOwogICAgfQogICAgX2NyZWF0ZUNsYXNzKF9jbGFzczE2LCBbewogICAgICBrZXk6ICJydW5ET01Db21tYW5kIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJ1bkRPTUNvbW1hbmQoKSB7CiAgICAgICAgaWYgKGlzRmlyZWZveCkgewogICAgICAgICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5mb2N1cygpOwogICAgICAgICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5zZWxlY3QoKTsKICAgICAgICB9CiAgICAgICAgZG9jdW1lbnQuZXhlY0NvbW1hbmQoJ3NlbGVjdEFsbCcpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInJ1bkVkaXRvckNvbW1hbmQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcnVuRWRpdG9yQ29tbWFuZChhY2Nlc3NvciwgZWRpdG9yLCBhcmdzKSB7CiAgICAgICAgdmFyIHZpZXdNb2RlbCA9IGVkaXRvci5fZ2V0Vmlld01vZGVsKCk7CiAgICAgICAgaWYgKCF2aWV3TW9kZWwpIHsKICAgICAgICAgIC8vIHRoZSBlZGl0b3IgaGFzIG5vIHZpZXcgPT4gaGFzIG5vIGN1cnNvcnMKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdGhpcy5ydW5Db3JlRWRpdG9yQ29tbWFuZCh2aWV3TW9kZWwsIGFyZ3MpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInJ1bkNvcmVFZGl0b3JDb21tYW5kIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJ1bkNvcmVFZGl0b3JDb21tYW5kKHZpZXdNb2RlbCwgYXJncykgewogICAgICAgIHZpZXdNb2RlbC5tb2RlbC5wdXNoU3RhY2tFbGVtZW50KCk7CiAgICAgICAgdmlld01vZGVsLnNldEN1cnNvclN0YXRlcygna2V5Ym9hcmQnLCAzIC8qIEN1cnNvckNoYW5nZVJlYXNvbi5FeHBsaWNpdCAqLywgW0N1cnNvck1vdmVDb21tYW5kcy5zZWxlY3RBbGwodmlld01vZGVsLCB2aWV3TW9kZWwuZ2V0UHJpbWFyeUN1cnNvclN0YXRlKCkpXSk7CiAgICAgIH0KICAgIH1dKTsKICAgIHJldHVybiBfY2xhc3MxNjsKICB9KEVkaXRvck9yTmF0aXZlVGV4dElucHV0Q29tbWFuZCkpKCk7CiAgQ29yZU5hdmlnYXRpb25Db21tYW5kcy5TZXRTZWxlY3Rpb24gPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3ICggLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29yZUVkaXRvckNvbW1hbmQyNykgewogICAgX2luaGVyaXRzKF9jbGFzczE3LCBfQ29yZUVkaXRvckNvbW1hbmQyNyk7CiAgICB2YXIgX3N1cGVyMzQgPSBfY3JlYXRlU3VwZXIoX2NsYXNzMTcpOwogICAgZnVuY3Rpb24gX2NsYXNzMTcoKSB7CiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBfY2xhc3MxNyk7CiAgICAgIHJldHVybiBfc3VwZXIzNC5jYWxsKHRoaXMsIHsKICAgICAgICBpZDogJ3NldFNlbGVjdGlvbicsCiAgICAgICAgcHJlY29uZGl0aW9uOiB1bmRlZmluZWQKICAgICAgfSk7CiAgICB9CiAgICBfY3JlYXRlQ2xhc3MoX2NsYXNzMTcsIFt7CiAgICAgIGtleTogInJ1bkNvcmVFZGl0b3JDb21tYW5kIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJ1bkNvcmVFZGl0b3JDb21tYW5kKHZpZXdNb2RlbCwgYXJncykgewogICAgICAgIHZpZXdNb2RlbC5tb2RlbC5wdXNoU3RhY2tFbGVtZW50KCk7CiAgICAgICAgdmlld01vZGVsLnNldEN1cnNvclN0YXRlcyhhcmdzLnNvdXJjZSwgMyAvKiBDdXJzb3JDaGFuZ2VSZWFzb24uRXhwbGljaXQgKi8sIFtDdXJzb3JTdGF0ZS5mcm9tTW9kZWxTZWxlY3Rpb24oYXJncy5zZWxlY3Rpb24pXSk7CiAgICAgIH0KICAgIH1dKTsKICAgIHJldHVybiBfY2xhc3MxNzsKICB9KENvcmVFZGl0b3JDb21tYW5kKSkoKSk7Cn0pKENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMgfHwgKENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMgPSB7fSkpOwp2YXIgY29sdW1uU2VsZWN0aW9uQ29uZGl0aW9uID0gQ29udGV4dEtleUV4cHIuYW5kKEVkaXRvckNvbnRleHRLZXlzLnRleHRJbnB1dEZvY3VzLCBFZGl0b3JDb250ZXh0S2V5cy5jb2x1bW5TZWxlY3Rpb24pOwpmdW5jdGlvbiByZWdpc3RlckNvbHVtblNlbGVjdGlvbihpZCwga2V5YmluZGluZykgewogIEtleWJpbmRpbmdzUmVnaXN0cnkucmVnaXN0ZXJLZXliaW5kaW5nUnVsZSh7CiAgICBpZDogaWQsCiAgICBwcmltYXJ5OiBrZXliaW5kaW5nLAogICAgd2hlbjogY29sdW1uU2VsZWN0aW9uQ29uZGl0aW9uLAogICAgd2VpZ2h0OiBDT1JFX1dFSUdIVCArIDEKICB9KTsKfQpyZWdpc3RlckNvbHVtblNlbGVjdGlvbihDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkN1cnNvckNvbHVtblNlbGVjdExlZnQuaWQsIDEwMjQgLyogS2V5TW9kLlNoaWZ0ICovIHwgMTUgLyogS2V5Q29kZS5MZWZ0QXJyb3cgKi8pOwpyZWdpc3RlckNvbHVtblNlbGVjdGlvbihDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkN1cnNvckNvbHVtblNlbGVjdFJpZ2h0LmlkLCAxMDI0IC8qIEtleU1vZC5TaGlmdCAqLyB8IDE3IC8qIEtleUNvZGUuUmlnaHRBcnJvdyAqLyk7CnJlZ2lzdGVyQ29sdW1uU2VsZWN0aW9uKENvcmVOYXZpZ2F0aW9uQ29tbWFuZHMuQ3Vyc29yQ29sdW1uU2VsZWN0VXAuaWQsIDEwMjQgLyogS2V5TW9kLlNoaWZ0ICovIHwgMTYgLyogS2V5Q29kZS5VcEFycm93ICovKTsKcmVnaXN0ZXJDb2x1bW5TZWxlY3Rpb24oQ29yZU5hdmlnYXRpb25Db21tYW5kcy5DdXJzb3JDb2x1bW5TZWxlY3RQYWdlVXAuaWQsIDEwMjQgLyogS2V5TW9kLlNoaWZ0ICovIHwgMTEgLyogS2V5Q29kZS5QYWdlVXAgKi8pOwpyZWdpc3RlckNvbHVtblNlbGVjdGlvbihDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkN1cnNvckNvbHVtblNlbGVjdERvd24uaWQsIDEwMjQgLyogS2V5TW9kLlNoaWZ0ICovIHwgMTggLyogS2V5Q29kZS5Eb3duQXJyb3cgKi8pOwpyZWdpc3RlckNvbHVtblNlbGVjdGlvbihDb3JlTmF2aWdhdGlvbkNvbW1hbmRzLkN1cnNvckNvbHVtblNlbGVjdFBhZ2VEb3duLmlkLCAxMDI0IC8qIEtleU1vZC5TaGlmdCAqLyB8IDEyIC8qIEtleUNvZGUuUGFnZURvd24gKi8pOwpmdW5jdGlvbiByZWdpc3RlckNvbW1hbmQoY29tbWFuZCkgewogIGNvbW1hbmQucmVnaXN0ZXIoKTsKICByZXR1cm4gY29tbWFuZDsKfQpleHBvcnQgdmFyIENvcmVFZGl0aW5nQ29tbWFuZHM7CihmdW5jdGlvbiAoQ29yZUVkaXRpbmdDb21tYW5kcykgewogIHZhciBDb3JlRWRpdGluZ0NvbW1hbmQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9FZGl0b3JDb21tYW5kMikgewogICAgX2luaGVyaXRzKENvcmVFZGl0aW5nQ29tbWFuZCwgX0VkaXRvckNvbW1hbmQyKTsKICAgIHZhciBfc3VwZXIzNSA9IF9jcmVhdGVTdXBlcihDb3JlRWRpdGluZ0NvbW1hbmQpOwogICAgZnVuY3Rpb24gQ29yZUVkaXRpbmdDb21tYW5kKCkgewogICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ29yZUVkaXRpbmdDb21tYW5kKTsKICAgICAgcmV0dXJuIF9zdXBlcjM1LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9CiAgICBfY3JlYXRlQ2xhc3MoQ29yZUVkaXRpbmdDb21tYW5kLCBbewogICAgICBrZXk6ICJydW5FZGl0b3JDb21tYW5kIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJ1bkVkaXRvckNvbW1hbmQoYWNjZXNzb3IsIGVkaXRvciwgYXJncykgewogICAgICAgIHZhciB2aWV3TW9kZWwgPSBlZGl0b3IuX2dldFZpZXdNb2RlbCgpOwogICAgICAgIGlmICghdmlld01vZGVsKSB7CiAgICAgICAgICAvLyB0aGUgZWRpdG9yIGhhcyBubyB2aWV3ID0+IGhhcyBubyBjdXJzb3JzCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHRoaXMucnVuQ29yZUVkaXRpbmdDb21tYW5kKGVkaXRvciwgdmlld01vZGVsLCBhcmdzIHx8IHt9KTsKICAgICAgfQogICAgfV0pOwogICAgcmV0dXJuIENvcmVFZGl0aW5nQ29tbWFuZDsKICB9KEVkaXRvckNvbW1hbmQpOwogIENvcmVFZGl0aW5nQ29tbWFuZHMuQ29yZUVkaXRpbmdDb21tYW5kID0gQ29yZUVkaXRpbmdDb21tYW5kOwogIENvcmVFZGl0aW5nQ29tbWFuZHMuTGluZUJyZWFrSW5zZXJ0ID0gcmVnaXN0ZXJFZGl0b3JDb21tYW5kKG5ldyAoIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NvcmVFZGl0aW5nQ29tbWFuZCkgewogICAgX2luaGVyaXRzKF9jbGFzczE4LCBfQ29yZUVkaXRpbmdDb21tYW5kKTsKICAgIHZhciBfc3VwZXIzNiA9IF9jcmVhdGVTdXBlcihfY2xhc3MxOCk7CiAgICBmdW5jdGlvbiBfY2xhc3MxOCgpIHsKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIF9jbGFzczE4KTsKICAgICAgcmV0dXJuIF9zdXBlcjM2LmNhbGwodGhpcywgewogICAgICAgIGlkOiAnbGluZUJyZWFrSW5zZXJ0JywKICAgICAgICBwcmVjb25kaXRpb246IEVkaXRvckNvbnRleHRLZXlzLndyaXRhYmxlLAogICAgICAgIGtiT3B0czogewogICAgICAgICAgd2VpZ2h0OiBDT1JFX1dFSUdIVCwKICAgICAgICAgIGtiRXhwcjogRWRpdG9yQ29udGV4dEtleXMudGV4dElucHV0Rm9jdXMsCiAgICAgICAgICBwcmltYXJ5OiAwLAogICAgICAgICAgbWFjOiB7CiAgICAgICAgICAgIHByaW1hcnk6IDI1NiAvKiBLZXlNb2QuV2luQ3RybCAqLyB8IDQ1IC8qIEtleUNvZGUuS2V5TyAqLwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgICBfY3JlYXRlQ2xhc3MoX2NsYXNzMTgsIFt7CiAgICAgIGtleTogInJ1bkNvcmVFZGl0aW5nQ29tbWFuZCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBydW5Db3JlRWRpdGluZ0NvbW1hbmQoZWRpdG9yLCB2aWV3TW9kZWwsIGFyZ3MpIHsKICAgICAgICBlZGl0b3IucHVzaFVuZG9TdG9wKCk7CiAgICAgICAgZWRpdG9yLmV4ZWN1dGVDb21tYW5kcyh0aGlzLmlkLCBUeXBlT3BlcmF0aW9ucy5saW5lQnJlYWtJbnNlcnQodmlld01vZGVsLmN1cnNvckNvbmZpZywgdmlld01vZGVsLm1vZGVsLCB2aWV3TW9kZWwuZ2V0Q3Vyc29yU3RhdGVzKCkubWFwKGZ1bmN0aW9uIChzKSB7CiAgICAgICAgICByZXR1cm4gcy5tb2RlbFN0YXRlLnNlbGVjdGlvbjsKICAgICAgICB9KSkpOwogICAgICB9CiAgICB9XSk7CiAgICByZXR1cm4gX2NsYXNzMTg7CiAgfShDb3JlRWRpdGluZ0NvbW1hbmQpKSgpKTsKICBDb3JlRWRpdGluZ0NvbW1hbmRzLk91dGRlbnQgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3ICggLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29yZUVkaXRpbmdDb21tYW5kMikgewogICAgX2luaGVyaXRzKF9jbGFzczE5LCBfQ29yZUVkaXRpbmdDb21tYW5kMik7CiAgICB2YXIgX3N1cGVyMzcgPSBfY3JlYXRlU3VwZXIoX2NsYXNzMTkpOwogICAgZnVuY3Rpb24gX2NsYXNzMTkoKSB7CiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBfY2xhc3MxOSk7CiAgICAgIHJldHVybiBfc3VwZXIzNy5jYWxsKHRoaXMsIHsKICAgICAgICBpZDogJ291dGRlbnQnLAogICAgICAgIHByZWNvbmRpdGlvbjogRWRpdG9yQ29udGV4dEtleXMud3JpdGFibGUsCiAgICAgICAga2JPcHRzOiB7CiAgICAgICAgICB3ZWlnaHQ6IENPUkVfV0VJR0hULAogICAgICAgICAga2JFeHByOiBDb250ZXh0S2V5RXhwci5hbmQoRWRpdG9yQ29udGV4dEtleXMuZWRpdG9yVGV4dEZvY3VzLCBFZGl0b3JDb250ZXh0S2V5cy50YWJEb2VzTm90TW92ZUZvY3VzKSwKICAgICAgICAgIHByaW1hcnk6IDEwMjQgLyogS2V5TW9kLlNoaWZ0ICovIHwgMiAvKiBLZXlDb2RlLlRhYiAqLwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgICBfY3JlYXRlQ2xhc3MoX2NsYXNzMTksIFt7CiAgICAgIGtleTogInJ1bkNvcmVFZGl0aW5nQ29tbWFuZCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBydW5Db3JlRWRpdGluZ0NvbW1hbmQoZWRpdG9yLCB2aWV3TW9kZWwsIGFyZ3MpIHsKICAgICAgICBlZGl0b3IucHVzaFVuZG9TdG9wKCk7CiAgICAgICAgZWRpdG9yLmV4ZWN1dGVDb21tYW5kcyh0aGlzLmlkLCBUeXBlT3BlcmF0aW9ucy5vdXRkZW50KHZpZXdNb2RlbC5jdXJzb3JDb25maWcsIHZpZXdNb2RlbC5tb2RlbCwgdmlld01vZGVsLmdldEN1cnNvclN0YXRlcygpLm1hcChmdW5jdGlvbiAocykgewogICAgICAgICAgcmV0dXJuIHMubW9kZWxTdGF0ZS5zZWxlY3Rpb247CiAgICAgICAgfSkpKTsKICAgICAgICBlZGl0b3IucHVzaFVuZG9TdG9wKCk7CiAgICAgIH0KICAgIH1dKTsKICAgIHJldHVybiBfY2xhc3MxOTsKICB9KENvcmVFZGl0aW5nQ29tbWFuZCkpKCkpOwogIENvcmVFZGl0aW5nQ29tbWFuZHMuVGFiID0gcmVnaXN0ZXJFZGl0b3JDb21tYW5kKG5ldyAoIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0NvcmVFZGl0aW5nQ29tbWFuZDMpIHsKICAgIF9pbmhlcml0cyhfY2xhc3MyMCwgX0NvcmVFZGl0aW5nQ29tbWFuZDMpOwogICAgdmFyIF9zdXBlcjM4ID0gX2NyZWF0ZVN1cGVyKF9jbGFzczIwKTsKICAgIGZ1bmN0aW9uIF9jbGFzczIwKCkgewogICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgX2NsYXNzMjApOwogICAgICByZXR1cm4gX3N1cGVyMzguY2FsbCh0aGlzLCB7CiAgICAgICAgaWQ6ICd0YWInLAogICAgICAgIHByZWNvbmRpdGlvbjogRWRpdG9yQ29udGV4dEtleXMud3JpdGFibGUsCiAgICAgICAga2JPcHRzOiB7CiAgICAgICAgICB3ZWlnaHQ6IENPUkVfV0VJR0hULAogICAgICAgICAga2JFeHByOiBDb250ZXh0S2V5RXhwci5hbmQoRWRpdG9yQ29udGV4dEtleXMuZWRpdG9yVGV4dEZvY3VzLCBFZGl0b3JDb250ZXh0S2V5cy50YWJEb2VzTm90TW92ZUZvY3VzKSwKICAgICAgICAgIHByaW1hcnk6IDIgLyogS2V5Q29kZS5UYWIgKi8KICAgICAgICB9CiAgICAgIH0pOwogICAgfQogICAgX2NyZWF0ZUNsYXNzKF9jbGFzczIwLCBbewogICAgICBrZXk6ICJydW5Db3JlRWRpdGluZ0NvbW1hbmQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcnVuQ29yZUVkaXRpbmdDb21tYW5kKGVkaXRvciwgdmlld01vZGVsLCBhcmdzKSB7CiAgICAgICAgZWRpdG9yLnB1c2hVbmRvU3RvcCgpOwogICAgICAgIGVkaXRvci5leGVjdXRlQ29tbWFuZHModGhpcy5pZCwgVHlwZU9wZXJhdGlvbnMudGFiKHZpZXdNb2RlbC5jdXJzb3JDb25maWcsIHZpZXdNb2RlbC5tb2RlbCwgdmlld01vZGVsLmdldEN1cnNvclN0YXRlcygpLm1hcChmdW5jdGlvbiAocykgewogICAgICAgICAgcmV0dXJuIHMubW9kZWxTdGF0ZS5zZWxlY3Rpb247CiAgICAgICAgfSkpKTsKICAgICAgICBlZGl0b3IucHVzaFVuZG9TdG9wKCk7CiAgICAgIH0KICAgIH1dKTsKICAgIHJldHVybiBfY2xhc3MyMDsKICB9KENvcmVFZGl0aW5nQ29tbWFuZCkpKCkpOwogIENvcmVFZGl0aW5nQ29tbWFuZHMuRGVsZXRlTGVmdCA9IHJlZ2lzdGVyRWRpdG9yQ29tbWFuZChuZXcgKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Db3JlRWRpdGluZ0NvbW1hbmQ0KSB7CiAgICBfaW5oZXJpdHMoX2NsYXNzMjEsIF9Db3JlRWRpdGluZ0NvbW1hbmQ0KTsKICAgIHZhciBfc3VwZXIzOSA9IF9jcmVhdGVTdXBlcihfY2xhc3MyMSk7CiAgICBmdW5jdGlvbiBfY2xhc3MyMSgpIHsKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIF9jbGFzczIxKTsKICAgICAgcmV0dXJuIF9zdXBlcjM5LmNhbGwodGhpcywgewogICAgICAgIGlkOiAnZGVsZXRlTGVmdCcsCiAgICAgICAgcHJlY29uZGl0aW9uOiB1bmRlZmluZWQsCiAgICAgICAga2JPcHRzOiB7CiAgICAgICAgICB3ZWlnaHQ6IENPUkVfV0VJR0hULAogICAgICAgICAga2JFeHByOiBFZGl0b3JDb250ZXh0S2V5cy50ZXh0SW5wdXRGb2N1cywKICAgICAgICAgIHByaW1hcnk6IDEgLyogS2V5Q29kZS5CYWNrc3BhY2UgKi8sCiAgICAgICAgICBzZWNvbmRhcnk6IFsxMDI0IC8qIEtleU1vZC5TaGlmdCAqLyB8IDEgLyogS2V5Q29kZS5CYWNrc3BhY2UgKi9dLAogICAgICAgICAgbWFjOiB7CiAgICAgICAgICAgIHByaW1hcnk6IDEgLyogS2V5Q29kZS5CYWNrc3BhY2UgKi8sCiAgICAgICAgICAgIHNlY29uZGFyeTogWzEwMjQgLyogS2V5TW9kLlNoaWZ0ICovIHwgMSAvKiBLZXlDb2RlLkJhY2tzcGFjZSAqLywgMjU2IC8qIEtleU1vZC5XaW5DdHJsICovIHwgMzggLyogS2V5Q29kZS5LZXlIICovLCAyNTYgLyogS2V5TW9kLldpbkN0cmwgKi8gfCAxIC8qIEtleUNvZGUuQmFja3NwYWNlICovXQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgICBfY3JlYXRlQ2xhc3MoX2NsYXNzMjEsIFt7CiAgICAgIGtleTogInJ1bkNvcmVFZGl0aW5nQ29tbWFuZCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBydW5Db3JlRWRpdGluZ0NvbW1hbmQoZWRpdG9yLCB2aWV3TW9kZWwsIGFyZ3MpIHsKICAgICAgICB2YXIgX0RlbGV0ZU9wZXJhdGlvbnMkZGVsID0gRGVsZXRlT3BlcmF0aW9ucy5kZWxldGVMZWZ0KHZpZXdNb2RlbC5nZXRQcmV2RWRpdE9wZXJhdGlvblR5cGUoKSwgdmlld01vZGVsLmN1cnNvckNvbmZpZywgdmlld01vZGVsLm1vZGVsLCB2aWV3TW9kZWwuZ2V0Q3Vyc29yU3RhdGVzKCkubWFwKGZ1bmN0aW9uIChzKSB7CiAgICAgICAgICAgIHJldHVybiBzLm1vZGVsU3RhdGUuc2VsZWN0aW9uOwogICAgICAgICAgfSksIHZpZXdNb2RlbC5nZXRDdXJzb3JBdXRvQ2xvc2VkQ2hhcmFjdGVycygpKSwKICAgICAgICAgIF9EZWxldGVPcGVyYXRpb25zJGRlbDIgPSBfc2xpY2VkVG9BcnJheShfRGVsZXRlT3BlcmF0aW9ucyRkZWwsIDIpLAogICAgICAgICAgc2hvdWxkUHVzaFN0YWNrRWxlbWVudEJlZm9yZSA9IF9EZWxldGVPcGVyYXRpb25zJGRlbDJbMF0sCiAgICAgICAgICBjb21tYW5kcyA9IF9EZWxldGVPcGVyYXRpb25zJGRlbDJbMV07CiAgICAgICAgaWYgKHNob3VsZFB1c2hTdGFja0VsZW1lbnRCZWZvcmUpIHsKICAgICAgICAgIGVkaXRvci5wdXNoVW5kb1N0b3AoKTsKICAgICAgICB9CiAgICAgICAgZWRpdG9yLmV4ZWN1dGVDb21tYW5kcyh0aGlzLmlkLCBjb21tYW5kcyk7CiAgICAgICAgdmlld01vZGVsLnNldFByZXZFZGl0T3BlcmF0aW9uVHlwZSgyIC8qIEVkaXRPcGVyYXRpb25UeXBlLkRlbGV0aW5nTGVmdCAqLyk7CiAgICAgIH0KICAgIH1dKTsKICAgIHJldHVybiBfY2xhc3MyMTsKICB9KENvcmVFZGl0aW5nQ29tbWFuZCkpKCkpOwogIENvcmVFZGl0aW5nQ29tbWFuZHMuRGVsZXRlUmlnaHQgPSByZWdpc3RlckVkaXRvckNvbW1hbmQobmV3ICggLyojX19QVVJFX18qL2Z1bmN0aW9uIChfQ29yZUVkaXRpbmdDb21tYW5kNSkgewogICAgX2luaGVyaXRzKF9jbGFzczIyLCBfQ29yZUVkaXRpbmdDb21tYW5kNSk7CiAgICB2YXIgX3N1cGVyNDAgPSBfY3JlYXRlU3VwZXIoX2NsYXNzMjIpOwogICAgZnVuY3Rpb24gX2NsYXNzMjIoKSB7CiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBfY2xhc3MyMik7CiAgICAgIHJldHVybiBfc3VwZXI0MC5jYWxsKHRoaXMsIHsKICAgICAgICBpZDogJ2RlbGV0ZVJpZ2h0JywKICAgICAgICBwcmVjb25kaXRpb246IHVuZGVmaW5lZCwKICAgICAgICBrYk9wdHM6IHsKICAgICAgICAgIHdlaWdodDogQ09SRV9XRUlHSFQsCiAgICAgICAgICBrYkV4cHI6IEVkaXRvckNvbnRleHRLZXlzLnRleHRJbnB1dEZvY3VzLAogICAgICAgICAgcHJpbWFyeTogMjAgLyogS2V5Q29kZS5EZWxldGUgKi8sCiAgICAgICAgICBtYWM6IHsKICAgICAgICAgICAgcHJpbWFyeTogMjAgLyogS2V5Q29kZS5EZWxldGUgKi8sCiAgICAgICAgICAgIHNlY29uZGFyeTogWzI1NiAvKiBLZXlNb2QuV2luQ3RybCAqLyB8IDM0IC8qIEtleUNvZGUuS2V5RCAqLywgMjU2IC8qIEtleU1vZC5XaW5DdHJsICovIHwgMjAgLyogS2V5Q29kZS5EZWxldGUgKi9dCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICAgIF9jcmVhdGVDbGFzcyhfY2xhc3MyMiwgW3sKICAgICAga2V5OiAicnVuQ29yZUVkaXRpbmdDb21tYW5kIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJ1bkNvcmVFZGl0aW5nQ29tbWFuZChlZGl0b3IsIHZpZXdNb2RlbCwgYXJncykgewogICAgICAgIHZhciBfRGVsZXRlT3BlcmF0aW9ucyRkZWwzID0gRGVsZXRlT3BlcmF0aW9ucy5kZWxldGVSaWdodCh2aWV3TW9kZWwuZ2V0UHJldkVkaXRPcGVyYXRpb25UeXBlKCksIHZpZXdNb2RlbC5jdXJzb3JDb25maWcsIHZpZXdNb2RlbC5tb2RlbCwgdmlld01vZGVsLmdldEN1cnNvclN0YXRlcygpLm1hcChmdW5jdGlvbiAocykgewogICAgICAgICAgICByZXR1cm4gcy5tb2RlbFN0YXRlLnNlbGVjdGlvbjsKICAgICAgICAgIH0pKSwKICAgICAgICAgIF9EZWxldGVPcGVyYXRpb25zJGRlbDQgPSBfc2xpY2VkVG9BcnJheShfRGVsZXRlT3BlcmF0aW9ucyRkZWwzLCAyKSwKICAgICAgICAgIHNob3VsZFB1c2hTdGFja0VsZW1lbnRCZWZvcmUgPSBfRGVsZXRlT3BlcmF0aW9ucyRkZWw0WzBdLAogICAgICAgICAgY29tbWFuZHMgPSBfRGVsZXRlT3BlcmF0aW9ucyRkZWw0WzFdOwogICAgICAgIGlmIChzaG91bGRQdXNoU3RhY2tFbGVtZW50QmVmb3JlKSB7CiAgICAgICAgICBlZGl0b3IucHVzaFVuZG9TdG9wKCk7CiAgICAgICAgfQogICAgICAgIGVkaXRvci5leGVjdXRlQ29tbWFuZHModGhpcy5pZCwgY29tbWFuZHMpOwogICAgICAgIHZpZXdNb2RlbC5zZXRQcmV2RWRpdE9wZXJhdGlvblR5cGUoMyAvKiBFZGl0T3BlcmF0aW9uVHlwZS5EZWxldGluZ1JpZ2h0ICovKTsKICAgICAgfQogICAgfV0pOwogICAgcmV0dXJuIF9jbGFzczIyOwogIH0oQ29yZUVkaXRpbmdDb21tYW5kKSkoKSk7CiAgQ29yZUVkaXRpbmdDb21tYW5kcy5VbmRvID0gbmV3ICggLyojX19QVVJFX18qL2Z1bmN0aW9uIChfRWRpdG9yT3JOYXRpdmVUZXh0SW4yKSB7CiAgICBfaW5oZXJpdHMoX2NsYXNzMjMsIF9FZGl0b3JPck5hdGl2ZVRleHRJbjIpOwogICAgdmFyIF9zdXBlcjQxID0gX2NyZWF0ZVN1cGVyKF9jbGFzczIzKTsKICAgIGZ1bmN0aW9uIF9jbGFzczIzKCkgewogICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgX2NsYXNzMjMpOwogICAgICByZXR1cm4gX3N1cGVyNDEuY2FsbCh0aGlzLCBVbmRvQ29tbWFuZCk7CiAgICB9CiAgICBfY3JlYXRlQ2xhc3MoX2NsYXNzMjMsIFt7CiAgICAgIGtleTogInJ1bkRPTUNvbW1hbmQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcnVuRE9NQ29tbWFuZCgpIHsKICAgICAgICBkb2N1bWVudC5leGVjQ29tbWFuZCgndW5kbycpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInJ1bkVkaXRvckNvbW1hbmQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcnVuRWRpdG9yQ29tbWFuZChhY2Nlc3NvciwgZWRpdG9yLCBhcmdzKSB7CiAgICAgICAgaWYgKCFlZGl0b3IuaGFzTW9kZWwoKSB8fCBlZGl0b3IuZ2V0T3B0aW9uKDgzIC8qIEVkaXRvck9wdGlvbi5yZWFkT25seSAqLykgPT09IHRydWUpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGVkaXRvci5nZXRNb2RlbCgpLnVuZG8oKTsKICAgICAgfQogICAgfV0pOwogICAgcmV0dXJuIF9jbGFzczIzOwogIH0oRWRpdG9yT3JOYXRpdmVUZXh0SW5wdXRDb21tYW5kKSkoKTsKICBDb3JlRWRpdGluZ0NvbW1hbmRzLlJlZG8gPSBuZXcgKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9FZGl0b3JPck5hdGl2ZVRleHRJbjMpIHsKICAgIF9pbmhlcml0cyhfY2xhc3MyNCwgX0VkaXRvck9yTmF0aXZlVGV4dEluMyk7CiAgICB2YXIgX3N1cGVyNDIgPSBfY3JlYXRlU3VwZXIoX2NsYXNzMjQpOwogICAgZnVuY3Rpb24gX2NsYXNzMjQoKSB7CiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBfY2xhc3MyNCk7CiAgICAgIHJldHVybiBfc3VwZXI0Mi5jYWxsKHRoaXMsIFJlZG9Db21tYW5kKTsKICAgIH0KICAgIF9jcmVhdGVDbGFzcyhfY2xhc3MyNCwgW3sKICAgICAga2V5OiAicnVuRE9NQ29tbWFuZCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBydW5ET01Db21tYW5kKCkgewogICAgICAgIGRvY3VtZW50LmV4ZWNDb21tYW5kKCdyZWRvJyk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAicnVuRWRpdG9yQ29tbWFuZCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBydW5FZGl0b3JDb21tYW5kKGFjY2Vzc29yLCBlZGl0b3IsIGFyZ3MpIHsKICAgICAgICBpZiAoIWVkaXRvci5oYXNNb2RlbCgpIHx8IGVkaXRvci5nZXRPcHRpb24oODMgLyogRWRpdG9yT3B0aW9uLnJlYWRPbmx5ICovKSA9PT0gdHJ1ZSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZWRpdG9yLmdldE1vZGVsKCkucmVkbygpOwogICAgICB9CiAgICB9XSk7CiAgICByZXR1cm4gX2NsYXNzMjQ7CiAgfShFZGl0b3JPck5hdGl2ZVRleHRJbnB1dENvbW1hbmQpKSgpOwp9KShDb3JlRWRpdGluZ0NvbW1hbmRzIHx8IChDb3JlRWRpdGluZ0NvbW1hbmRzID0ge30pKTsKLyoqCiAqIEEgY29tbWFuZCB0aGF0IHdpbGwgaW52b2tlIGEgY29tbWFuZCBvbiB0aGUgZm9jdXNlZCBlZGl0b3IuCiAqLwp2YXIgRWRpdG9ySGFuZGxlckNvbW1hbmQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9Db21tYW5kKSB7CiAgX2luaGVyaXRzKEVkaXRvckhhbmRsZXJDb21tYW5kLCBfQ29tbWFuZCk7CiAgdmFyIF9zdXBlcjQzID0gX2NyZWF0ZVN1cGVyKEVkaXRvckhhbmRsZXJDb21tYW5kKTsKICBmdW5jdGlvbiBFZGl0b3JIYW5kbGVyQ29tbWFuZChpZCwgaGFuZGxlcklkLCBkZXNjcmlwdGlvbikgewogICAgdmFyIF90aGlzMTU7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRWRpdG9ySGFuZGxlckNvbW1hbmQpOwogICAgX3RoaXMxNSA9IF9zdXBlcjQzLmNhbGwodGhpcywgewogICAgICBpZDogaWQsCiAgICAgIHByZWNvbmRpdGlvbjogdW5kZWZpbmVkLAogICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24KICAgIH0pOwogICAgX3RoaXMxNS5faGFuZGxlcklkID0gaGFuZGxlcklkOwogICAgcmV0dXJuIF90aGlzMTU7CiAgfQogIF9jcmVhdGVDbGFzcyhFZGl0b3JIYW5kbGVyQ29tbWFuZCwgW3sKICAgIGtleTogInJ1bkNvbW1hbmQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJ1bkNvbW1hbmQoYWNjZXNzb3IsIGFyZ3MpIHsKICAgICAgdmFyIGVkaXRvciA9IGFjY2Vzc29yLmdldChJQ29kZUVkaXRvclNlcnZpY2UpLmdldEZvY3VzZWRDb2RlRWRpdG9yKCk7CiAgICAgIGlmICghZWRpdG9yKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGVkaXRvci50cmlnZ2VyKCdrZXlib2FyZCcsIHRoaXMuX2hhbmRsZXJJZCwgYXJncyk7CiAgICB9CiAgfV0pOwogIHJldHVybiBFZGl0b3JIYW5kbGVyQ29tbWFuZDsKfShDb21tYW5kKTsKZnVuY3Rpb24gcmVnaXN0ZXJPdmVyd3JpdGFibGVDb21tYW5kKGhhbmRsZXJJZCwgZGVzY3JpcHRpb24pIHsKICByZWdpc3RlckNvbW1hbmQobmV3IEVkaXRvckhhbmRsZXJDb21tYW5kKCdkZWZhdWx0OicgKyBoYW5kbGVySWQsIGhhbmRsZXJJZCkpOwogIHJlZ2lzdGVyQ29tbWFuZChuZXcgRWRpdG9ySGFuZGxlckNvbW1hbmQoaGFuZGxlcklkLCBoYW5kbGVySWQsIGRlc2NyaXB0aW9uKSk7Cn0KcmVnaXN0ZXJPdmVyd3JpdGFibGVDb21tYW5kKCJ0eXBlIiAvKiBIYW5kbGVyLlR5cGUgKi8sIHsKICBkZXNjcmlwdGlvbjogIlR5cGUiLAogIGFyZ3M6IFt7CiAgICBuYW1lOiAnYXJncycsCiAgICBzY2hlbWE6IHsKICAgICAgJ3R5cGUnOiAnb2JqZWN0JywKICAgICAgJ3JlcXVpcmVkJzogWyd0ZXh0J10sCiAgICAgICdwcm9wZXJ0aWVzJzogewogICAgICAgICd0ZXh0JzogewogICAgICAgICAgJ3R5cGUnOiAnc3RyaW5nJwogICAgICAgIH0KICAgICAgfQogICAgfQogIH1dCn0pOwpyZWdpc3Rlck92ZXJ3cml0YWJsZUNvbW1hbmQoInJlcGxhY2VQcmV2aW91c0NoYXIiIC8qIEhhbmRsZXIuUmVwbGFjZVByZXZpb3VzQ2hhciAqLyk7CnJlZ2lzdGVyT3ZlcndyaXRhYmxlQ29tbWFuZCgiY29tcG9zaXRpb25UeXBlIiAvKiBIYW5kbGVyLkNvbXBvc2l0aW9uVHlwZSAqLyk7CnJlZ2lzdGVyT3ZlcndyaXRhYmxlQ29tbWFuZCgiY29tcG9zaXRpb25TdGFydCIgLyogSGFuZGxlci5Db21wb3NpdGlvblN0YXJ0ICovKTsKcmVnaXN0ZXJPdmVyd3JpdGFibGVDb21tYW5kKCJjb21wb3NpdGlvbkVuZCIgLyogSGFuZGxlci5Db21wb3NpdGlvbkVuZCAqLyk7CnJlZ2lzdGVyT3ZlcndyaXRhYmxlQ29tbWFuZCgicGFzdGUiIC8qIEhhbmRsZXIuUGFzdGUgKi8pOwpyZWdpc3Rlck92ZXJ3cml0YWJsZUNvbW1hbmQoImN1dCIgLyogSGFuZGxlci5DdXQgKi8pOw=="},{"version":3,"names":["nls","isFirefox","types","status","Command","EditorCommand","registerEditorCommand","UndoCommand","RedoCommand","SelectAllCommand","ICodeEditorService","ColumnSelection","CursorState","DeleteOperations","CursorMove","CursorMove_","CursorMoveCommands","TypeOperations","Position","Range","EditorContextKeys","ContextKeyExpr","KeybindingsRegistry","CORE_WEIGHT","CoreEditorCommand","accessor","editor","args","viewModel","_getViewModel","runCoreEditorCommand","EditorScroll_","isEditorScrollArgs","arg","isObject","scrollArg","isString","to","isUndefined","by","value","isNumber","revealCursor","isBoolean","description","name","constraint","schema","RawDirection","Up","Down","RawUnit","Line","WrappedLine","Page","HalfPage","Editor","parse","direction","unit","Math","floor","select","RevealLine_","isRevealLineArgs","reveaLineArg","lineNumber","at","RawAtArgument","Top","Center","Bottom","EditorOrNativeTextInputCommand","target","addImplementation","focusedEditor","get","getFocusedCodeEditor","hasTextFocus","_runEditorCommand","activeElement","document","indexOf","tagName","toLowerCase","runDOMCommand","activeEditor","getActiveCodeEditor","focus","result","runEditorCommand","CoreNavigationCommands","BaseMoveToCommand","opts","_minimalReveal","minimalReveal","_inSelectionMode","inSelectionMode","model","pushStackElement","cursorStateChanged","setCursorStates","source","moveTo","getPrimaryCursorState","position","viewPosition","revealPrimaryCursor","MoveTo","id","precondition","undefined","MoveToSelect","ColumnSelectCommand","_getColumnSelectResult","getCursorColumnSelectData","viewStates","map","viewState","fromViewState","setCursorColumnSelectData","isReal","fromViewLineNumber","fromLineNumber","fromViewVisualColumn","fromVisualColumn","toViewLineNumber","toLineNumber","toViewVisualColumn","toVisualColumn","reversed","revealTopMostCursor","revealBottomMostCursor","ColumnSelect","primary","prevColumnSelectData","validatedPosition","validatePosition","validatedViewPosition","coordinatesConverter","validateViewPosition","column","doColumnSelect","mouseColumn","columnSelect","cursorConfig","CursorColumnSelectLeft","kbOpts","weight","kbExpr","textInputFocus","linux","columnSelectLeft","CursorColumnSelectRight","columnSelectRight","ColumnSelectUpCommand","_isPaged","isPaged","columnSelectUp","CursorColumnSelectUp","CursorColumnSelectPageUp","ColumnSelectDownCommand","columnSelectDown","CursorColumnSelectDown","CursorColumnSelectPageDown","CursorMoveImpl","parsed","_runCursorMove","_move","getCursorStates","cursors","simpleMove","viewportMove","CursorMoveBasedCommand","_staticArgs","dynamicArgs","pageSize","CursorLeft","mac","secondary","CursorLeftSelect","CursorRight","CursorRightSelect","CursorUp","CursorUpSelect","CursorPageUp","CursorPageUpSelect","CursorDown","CursorDownSelect","CursorPageDown","CursorPageDownSelect","CreateCursor","newState","wholeLine","line","states","length","newModelPosition","modelState","newViewPosition","i","len","state","selection","containsPosition","splice","push","LastCursorMoveToSelect","lastAddedCursorIndex","getLastAddedCursorIndex","newStates","slice","HomeCommand","moveToBeginningOfLine","CursorHome","CursorHomeSelect","LineStartCommand","_exec","cursor","fromModelState","move","CursorLineStart","CursorLineStartSelect","EndCommand","moveToEndOfLine","sticky","CursorEnd","type","properties","localize","default","CursorEndSelect","LineEndCommand","maxColumn","getLineMaxColumn","CursorLineEnd","CursorLineEndSelect","TopCommand","moveToBeginningOfBuffer","CursorTop","CursorTopSelect","BottomCommand","moveToEndOfBuffer","CursorBottom","CursorBottomSelect","EditorScrollImpl","_runEditorScroll","desiredScrollTop","_computeDesiredScrollTop","desiredVisibleViewRange","getCompletelyVisibleViewRangeAtScrollTop","findPositionInViewportIfOutside","viewLayout","setScrollPosition","scrollTop","visibleViewRange","getCompletelyVisibleViewRange","visibleModelRange","convertViewRangeToModelRange","desiredTopModelLineNumber","max","startLineNumber","min","getLineCount","convertModelPositionToViewPosition","getVerticalOffsetForLineNumber","noOfLines","round","deltaLines","getCurrentScrollTop","lineHeight","EditorScroll","ScrollLineUp","ScrollPageUp","win","ScrollEditorTop","ScrollLineDown","ScrollPageDown","ScrollEditorBottom","WordCommand","word","WordSelect","WordSelectDrag","LastCursorWordSelect","lastAddedState","hasSelection","LineCommand","LineSelect","LineSelectDrag","LastCursorLineCommand","LastCursorLineSelect","LastCursorLineSelectDrag","CancelSelection","hasNonEmptySelection","cancelSelection","RemoveSecondaryCursors","hasMultipleSelections","RevealLine","revealLineArg","lineNumberArg","parseInt","lineCount","range","revealAt","viewRange","convertModelRangeToViewRange","revealRange","SelectAll","execCommand","selectAll","SetSelection","fromModelSelection","columnSelectionCondition","and","columnSelection","registerColumnSelection","keybinding","registerKeybindingRule","when","registerCommand","command","register","CoreEditingCommands","CoreEditingCommand","runCoreEditingCommand","LineBreakInsert","writable","pushUndoStop","executeCommands","lineBreakInsert","s","Outdent","editorTextFocus","tabDoesNotMoveFocus","outdent","Tab","tab","DeleteLeft","deleteLeft","getPrevEditOperationType","getCursorAutoClosedCharacters","shouldPushStackElementBefore","commands","setPrevEditOperationType","DeleteRight","deleteRight","Undo","hasModel","getOption","getModel","undo","Redo","redo","EditorHandlerCommand","handlerId","_handlerId","trigger","registerOverwritableCommand"],"sources":["/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/editor/browser/coreCommands.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as nls from '../../nls.js';\nimport { isFirefox } from '../../base/browser/browser.js';\nimport * as types from '../../base/common/types.js';\nimport { status } from '../../base/browser/ui/aria/aria.js';\nimport { Command, EditorCommand, registerEditorCommand, UndoCommand, RedoCommand, SelectAllCommand } from './editorExtensions.js';\nimport { ICodeEditorService } from './services/codeEditorService.js';\nimport { ColumnSelection } from '../common/cursor/cursorColumnSelection.js';\nimport { CursorState } from '../common/cursorCommon.js';\nimport { DeleteOperations } from '../common/cursor/cursorDeleteOperations.js';\nimport { CursorMove as CursorMove_, CursorMoveCommands } from '../common/cursor/cursorMoveCommands.js';\nimport { TypeOperations } from '../common/cursor/cursorTypeOperations.js';\nimport { Position } from '../common/core/position.js';\nimport { Range } from '../common/core/range.js';\nimport { EditorContextKeys } from '../common/editorContextKeys.js';\nimport { ContextKeyExpr } from '../../platform/contextkey/common/contextkey.js';\nimport { KeybindingsRegistry } from '../../platform/keybinding/common/keybindingsRegistry.js';\nconst CORE_WEIGHT = 0 /* KeybindingWeight.EditorCore */;\nexport class CoreEditorCommand extends EditorCommand {\n    runEditorCommand(accessor, editor, args) {\n        const viewModel = editor._getViewModel();\n        if (!viewModel) {\n            // the editor has no view => has no cursors\n            return;\n        }\n        this.runCoreEditorCommand(viewModel, args || {});\n    }\n}\nexport var EditorScroll_;\n(function (EditorScroll_) {\n    const isEditorScrollArgs = function (arg) {\n        if (!types.isObject(arg)) {\n            return false;\n        }\n        const scrollArg = arg;\n        if (!types.isString(scrollArg.to)) {\n            return false;\n        }\n        if (!types.isUndefined(scrollArg.by) && !types.isString(scrollArg.by)) {\n            return false;\n        }\n        if (!types.isUndefined(scrollArg.value) && !types.isNumber(scrollArg.value)) {\n            return false;\n        }\n        if (!types.isUndefined(scrollArg.revealCursor) && !types.isBoolean(scrollArg.revealCursor)) {\n            return false;\n        }\n        return true;\n    };\n    EditorScroll_.description = {\n        description: 'Scroll editor in the given direction',\n        args: [\n            {\n                name: 'Editor scroll argument object',\n                description: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'to': A mandatory direction value.\n\t\t\t\t\t\t\\`\\`\\`\n\t\t\t\t\t\t'up', 'down'\n\t\t\t\t\t\t\\`\\`\\`\n\t\t\t\t\t* 'by': Unit to move. Default is computed based on 'to' value.\n\t\t\t\t\t\t\\`\\`\\`\n\t\t\t\t\t\t'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n\t\t\t\t\t\t\\`\\`\\`\n\t\t\t\t\t* 'value': Number of units to move. Default is '1'.\n\t\t\t\t\t* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n\t\t\t\t`,\n                constraint: isEditorScrollArgs,\n                schema: {\n                    'type': 'object',\n                    'required': ['to'],\n                    'properties': {\n                        'to': {\n                            'type': 'string',\n                            'enum': ['up', 'down']\n                        },\n                        'by': {\n                            'type': 'string',\n                            'enum': ['line', 'wrappedLine', 'page', 'halfPage', 'editor']\n                        },\n                        'value': {\n                            'type': 'number',\n                            'default': 1\n                        },\n                        'revealCursor': {\n                            'type': 'boolean',\n                        }\n                    }\n                }\n            }\n        ]\n    };\n    /**\n     * Directions in the view for editor scroll command.\n     */\n    EditorScroll_.RawDirection = {\n        Up: 'up',\n        Down: 'down',\n    };\n    /**\n     * Units for editor scroll 'by' argument\n     */\n    EditorScroll_.RawUnit = {\n        Line: 'line',\n        WrappedLine: 'wrappedLine',\n        Page: 'page',\n        HalfPage: 'halfPage',\n        Editor: 'editor'\n    };\n    function parse(args) {\n        let direction;\n        switch (args.to) {\n            case EditorScroll_.RawDirection.Up:\n                direction = 1 /* Direction.Up */;\n                break;\n            case EditorScroll_.RawDirection.Down:\n                direction = 2 /* Direction.Down */;\n                break;\n            default:\n                // Illegal arguments\n                return null;\n        }\n        let unit;\n        switch (args.by) {\n            case EditorScroll_.RawUnit.Line:\n                unit = 1 /* Unit.Line */;\n                break;\n            case EditorScroll_.RawUnit.WrappedLine:\n                unit = 2 /* Unit.WrappedLine */;\n                break;\n            case EditorScroll_.RawUnit.Page:\n                unit = 3 /* Unit.Page */;\n                break;\n            case EditorScroll_.RawUnit.HalfPage:\n                unit = 4 /* Unit.HalfPage */;\n                break;\n            case EditorScroll_.RawUnit.Editor:\n                unit = 5 /* Unit.Editor */;\n                break;\n            default:\n                unit = 2 /* Unit.WrappedLine */;\n        }\n        const value = Math.floor(args.value || 1);\n        const revealCursor = !!args.revealCursor;\n        return {\n            direction: direction,\n            unit: unit,\n            value: value,\n            revealCursor: revealCursor,\n            select: (!!args.select)\n        };\n    }\n    EditorScroll_.parse = parse;\n})(EditorScroll_ || (EditorScroll_ = {}));\nexport var RevealLine_;\n(function (RevealLine_) {\n    const isRevealLineArgs = function (arg) {\n        if (!types.isObject(arg)) {\n            return false;\n        }\n        const reveaLineArg = arg;\n        if (!types.isNumber(reveaLineArg.lineNumber) && !types.isString(reveaLineArg.lineNumber)) {\n            return false;\n        }\n        if (!types.isUndefined(reveaLineArg.at) && !types.isString(reveaLineArg.at)) {\n            return false;\n        }\n        return true;\n    };\n    RevealLine_.description = {\n        description: 'Reveal the given line at the given logical position',\n        args: [\n            {\n                name: 'Reveal line argument object',\n                description: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'lineNumber': A mandatory line number value.\n\t\t\t\t\t* 'at': Logical position at which line has to be revealed.\n\t\t\t\t\t\t\\`\\`\\`\n\t\t\t\t\t\t'top', 'center', 'bottom'\n\t\t\t\t\t\t\\`\\`\\`\n\t\t\t\t`,\n                constraint: isRevealLineArgs,\n                schema: {\n                    'type': 'object',\n                    'required': ['lineNumber'],\n                    'properties': {\n                        'lineNumber': {\n                            'type': ['number', 'string'],\n                        },\n                        'at': {\n                            'type': 'string',\n                            'enum': ['top', 'center', 'bottom']\n                        }\n                    }\n                }\n            }\n        ]\n    };\n    /**\n     * Values for reveal line 'at' argument\n     */\n    RevealLine_.RawAtArgument = {\n        Top: 'top',\n        Center: 'center',\n        Bottom: 'bottom'\n    };\n})(RevealLine_ || (RevealLine_ = {}));\nclass EditorOrNativeTextInputCommand {\n    constructor(target) {\n        // 1. handle case when focus is in editor.\n        target.addImplementation(10000, 'code-editor', (accessor, args) => {\n            // Only if editor text focus (i.e. not if editor has widget focus).\n            const focusedEditor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n            if (focusedEditor && focusedEditor.hasTextFocus()) {\n                return this._runEditorCommand(accessor, focusedEditor, args);\n            }\n            return false;\n        });\n        // 2. handle case when focus is in some other `input` / `textarea`.\n        target.addImplementation(1000, 'generic-dom-input-textarea', (accessor, args) => {\n            // Only if focused on an element that allows for entering text\n            const activeElement = document.activeElement;\n            if (activeElement && ['input', 'textarea'].indexOf(activeElement.tagName.toLowerCase()) >= 0) {\n                this.runDOMCommand();\n                return true;\n            }\n            return false;\n        });\n        // 3. (default) handle case when focus is somewhere else.\n        target.addImplementation(0, 'generic-dom', (accessor, args) => {\n            // Redirecting to active editor\n            const activeEditor = accessor.get(ICodeEditorService).getActiveCodeEditor();\n            if (activeEditor) {\n                activeEditor.focus();\n                return this._runEditorCommand(accessor, activeEditor, args);\n            }\n            return false;\n        });\n    }\n    _runEditorCommand(accessor, editor, args) {\n        const result = this.runEditorCommand(accessor, editor, args);\n        if (result) {\n            return result;\n        }\n        return true;\n    }\n}\nexport var CoreNavigationCommands;\n(function (CoreNavigationCommands) {\n    class BaseMoveToCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._minimalReveal = opts.minimalReveal;\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            const cursorStateChanged = viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, [\n                CursorMoveCommands.moveTo(viewModel, viewModel.getPrimaryCursorState(), this._inSelectionMode, args.position, args.viewPosition)\n            ]);\n            if (cursorStateChanged) {\n                viewModel.revealPrimaryCursor(args.source, true, this._minimalReveal);\n            }\n        }\n    }\n    CoreNavigationCommands.MoveTo = registerEditorCommand(new BaseMoveToCommand({\n        id: '_moveTo',\n        minimalReveal: true,\n        inSelectionMode: false,\n        precondition: undefined\n    }));\n    CoreNavigationCommands.MoveToSelect = registerEditorCommand(new BaseMoveToCommand({\n        id: '_moveToSelect',\n        minimalReveal: false,\n        inSelectionMode: true,\n        precondition: undefined\n    }));\n    class ColumnSelectCommand extends CoreEditorCommand {\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            const result = this._getColumnSelectResult(viewModel, viewModel.getPrimaryCursorState(), viewModel.getCursorColumnSelectData(), args);\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, result.viewStates.map((viewState) => CursorState.fromViewState(viewState)));\n            viewModel.setCursorColumnSelectData({\n                isReal: true,\n                fromViewLineNumber: result.fromLineNumber,\n                fromViewVisualColumn: result.fromVisualColumn,\n                toViewLineNumber: result.toLineNumber,\n                toViewVisualColumn: result.toVisualColumn\n            });\n            if (result.reversed) {\n                viewModel.revealTopMostCursor(args.source);\n            }\n            else {\n                viewModel.revealBottomMostCursor(args.source);\n            }\n        }\n    }\n    CoreNavigationCommands.ColumnSelect = registerEditorCommand(new class extends ColumnSelectCommand {\n        constructor() {\n            super({\n                id: 'columnSelect',\n                precondition: undefined\n            });\n        }\n        _getColumnSelectResult(viewModel, primary, prevColumnSelectData, args) {\n            // validate `args`\n            const validatedPosition = viewModel.model.validatePosition(args.position);\n            const validatedViewPosition = viewModel.coordinatesConverter.validateViewPosition(new Position(args.viewPosition.lineNumber, args.viewPosition.column), validatedPosition);\n            const fromViewLineNumber = args.doColumnSelect ? prevColumnSelectData.fromViewLineNumber : validatedViewPosition.lineNumber;\n            const fromViewVisualColumn = args.doColumnSelect ? prevColumnSelectData.fromViewVisualColumn : args.mouseColumn - 1;\n            return ColumnSelection.columnSelect(viewModel.cursorConfig, viewModel, fromViewLineNumber, fromViewVisualColumn, validatedViewPosition.lineNumber, args.mouseColumn - 1);\n        }\n    });\n    CoreNavigationCommands.CursorColumnSelectLeft = registerEditorCommand(new class extends ColumnSelectCommand {\n        constructor() {\n            super({\n                id: 'cursorColumnSelectLeft',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 15 /* KeyCode.LeftArrow */,\n                    linux: { primary: 0 }\n                }\n            });\n        }\n        _getColumnSelectResult(viewModel, primary, prevColumnSelectData, args) {\n            return ColumnSelection.columnSelectLeft(viewModel.cursorConfig, viewModel, prevColumnSelectData);\n        }\n    });\n    CoreNavigationCommands.CursorColumnSelectRight = registerEditorCommand(new class extends ColumnSelectCommand {\n        constructor() {\n            super({\n                id: 'cursorColumnSelectRight',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 17 /* KeyCode.RightArrow */,\n                    linux: { primary: 0 }\n                }\n            });\n        }\n        _getColumnSelectResult(viewModel, primary, prevColumnSelectData, args) {\n            return ColumnSelection.columnSelectRight(viewModel.cursorConfig, viewModel, prevColumnSelectData);\n        }\n    });\n    class ColumnSelectUpCommand extends ColumnSelectCommand {\n        constructor(opts) {\n            super(opts);\n            this._isPaged = opts.isPaged;\n        }\n        _getColumnSelectResult(viewModel, primary, prevColumnSelectData, args) {\n            return ColumnSelection.columnSelectUp(viewModel.cursorConfig, viewModel, prevColumnSelectData, this._isPaged);\n        }\n    }\n    CoreNavigationCommands.CursorColumnSelectUp = registerEditorCommand(new ColumnSelectUpCommand({\n        isPaged: false,\n        id: 'cursorColumnSelectUp',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */,\n            linux: { primary: 0 }\n        }\n    }));\n    CoreNavigationCommands.CursorColumnSelectPageUp = registerEditorCommand(new ColumnSelectUpCommand({\n        isPaged: true,\n        id: 'cursorColumnSelectPageUp',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 11 /* KeyCode.PageUp */,\n            linux: { primary: 0 }\n        }\n    }));\n    class ColumnSelectDownCommand extends ColumnSelectCommand {\n        constructor(opts) {\n            super(opts);\n            this._isPaged = opts.isPaged;\n        }\n        _getColumnSelectResult(viewModel, primary, prevColumnSelectData, args) {\n            return ColumnSelection.columnSelectDown(viewModel.cursorConfig, viewModel, prevColumnSelectData, this._isPaged);\n        }\n    }\n    CoreNavigationCommands.CursorColumnSelectDown = registerEditorCommand(new ColumnSelectDownCommand({\n        isPaged: false,\n        id: 'cursorColumnSelectDown',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */,\n            linux: { primary: 0 }\n        }\n    }));\n    CoreNavigationCommands.CursorColumnSelectPageDown = registerEditorCommand(new ColumnSelectDownCommand({\n        isPaged: true,\n        id: 'cursorColumnSelectPageDown',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 12 /* KeyCode.PageDown */,\n            linux: { primary: 0 }\n        }\n    }));\n    class CursorMoveImpl extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'cursorMove',\n                precondition: undefined,\n                description: CursorMove_.description\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            const parsed = CursorMove_.parse(args);\n            if (!parsed) {\n                // illegal arguments\n                return;\n            }\n            this._runCursorMove(viewModel, args.source, parsed);\n        }\n        _runCursorMove(viewModel, source, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(source, 3 /* CursorChangeReason.Explicit */, CursorMoveImpl._move(viewModel, viewModel.getCursorStates(), args));\n            viewModel.revealPrimaryCursor(source, true);\n        }\n        static _move(viewModel, cursors, args) {\n            const inSelectionMode = args.select;\n            const value = args.value;\n            switch (args.direction) {\n                case 0 /* CursorMove_.Direction.Left */:\n                case 1 /* CursorMove_.Direction.Right */:\n                case 2 /* CursorMove_.Direction.Up */:\n                case 3 /* CursorMove_.Direction.Down */:\n                case 4 /* CursorMove_.Direction.PrevBlankLine */:\n                case 5 /* CursorMove_.Direction.NextBlankLine */:\n                case 6 /* CursorMove_.Direction.WrappedLineStart */:\n                case 7 /* CursorMove_.Direction.WrappedLineFirstNonWhitespaceCharacter */:\n                case 8 /* CursorMove_.Direction.WrappedLineColumnCenter */:\n                case 9 /* CursorMove_.Direction.WrappedLineEnd */:\n                case 10 /* CursorMove_.Direction.WrappedLineLastNonWhitespaceCharacter */:\n                    return CursorMoveCommands.simpleMove(viewModel, cursors, args.direction, inSelectionMode, value, args.unit);\n                case 11 /* CursorMove_.Direction.ViewPortTop */:\n                case 13 /* CursorMove_.Direction.ViewPortBottom */:\n                case 12 /* CursorMove_.Direction.ViewPortCenter */:\n                case 14 /* CursorMove_.Direction.ViewPortIfOutside */:\n                    return CursorMoveCommands.viewportMove(viewModel, cursors, args.direction, inSelectionMode, value);\n                default:\n                    return null;\n            }\n        }\n    }\n    CoreNavigationCommands.CursorMoveImpl = CursorMoveImpl;\n    CoreNavigationCommands.CursorMove = registerEditorCommand(new CursorMoveImpl());\n    class CursorMoveBasedCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._staticArgs = opts.args;\n        }\n        runCoreEditorCommand(viewModel, dynamicArgs) {\n            let args = this._staticArgs;\n            if (this._staticArgs.value === -1 /* Constants.PAGE_SIZE_MARKER */) {\n                // -1 is a marker for page size\n                args = {\n                    direction: this._staticArgs.direction,\n                    unit: this._staticArgs.unit,\n                    select: this._staticArgs.select,\n                    value: dynamicArgs.pageSize || viewModel.cursorConfig.pageSize\n                };\n            }\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(dynamicArgs.source, 3 /* CursorChangeReason.Explicit */, CursorMoveCommands.simpleMove(viewModel, viewModel.getCursorStates(), args.direction, args.select, args.value, args.unit));\n            viewModel.revealPrimaryCursor(dynamicArgs.source, true);\n        }\n    }\n    CoreNavigationCommands.CursorLeft = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 0 /* CursorMove_.Direction.Left */,\n            unit: 0 /* CursorMove_.Unit.None */,\n            select: false,\n            value: 1\n        },\n        id: 'cursorLeft',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 15 /* KeyCode.LeftArrow */,\n            mac: { primary: 15 /* KeyCode.LeftArrow */, secondary: [256 /* KeyMod.WinCtrl */ | 32 /* KeyCode.KeyB */] }\n        }\n    }));\n    CoreNavigationCommands.CursorLeftSelect = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 0 /* CursorMove_.Direction.Left */,\n            unit: 0 /* CursorMove_.Unit.None */,\n            select: true,\n            value: 1\n        },\n        id: 'cursorLeftSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */\n        }\n    }));\n    CoreNavigationCommands.CursorRight = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 1 /* CursorMove_.Direction.Right */,\n            unit: 0 /* CursorMove_.Unit.None */,\n            select: false,\n            value: 1\n        },\n        id: 'cursorRight',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 17 /* KeyCode.RightArrow */,\n            mac: { primary: 17 /* KeyCode.RightArrow */, secondary: [256 /* KeyMod.WinCtrl */ | 36 /* KeyCode.KeyF */] }\n        }\n    }));\n    CoreNavigationCommands.CursorRightSelect = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 1 /* CursorMove_.Direction.Right */,\n            unit: 0 /* CursorMove_.Unit.None */,\n            select: true,\n            value: 1\n        },\n        id: 'cursorRightSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */\n        }\n    }));\n    CoreNavigationCommands.CursorUp = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 2 /* CursorMove_.Direction.Up */,\n            unit: 2 /* CursorMove_.Unit.WrappedLine */,\n            select: false,\n            value: 1\n        },\n        id: 'cursorUp',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 16 /* KeyCode.UpArrow */,\n            mac: { primary: 16 /* KeyCode.UpArrow */, secondary: [256 /* KeyMod.WinCtrl */ | 46 /* KeyCode.KeyP */] }\n        }\n    }));\n    CoreNavigationCommands.CursorUpSelect = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 2 /* CursorMove_.Direction.Up */,\n            unit: 2 /* CursorMove_.Unit.WrappedLine */,\n            select: true,\n            value: 1\n        },\n        id: 'cursorUpSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* KeyMod.Shift */ | 16 /* KeyCode.UpArrow */,\n            secondary: [2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 16 /* KeyCode.UpArrow */],\n            mac: { primary: 1024 /* KeyMod.Shift */ | 16 /* KeyCode.UpArrow */ },\n            linux: { primary: 1024 /* KeyMod.Shift */ | 16 /* KeyCode.UpArrow */ }\n        }\n    }));\n    CoreNavigationCommands.CursorPageUp = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 2 /* CursorMove_.Direction.Up */,\n            unit: 2 /* CursorMove_.Unit.WrappedLine */,\n            select: false,\n            value: -1 /* Constants.PAGE_SIZE_MARKER */\n        },\n        id: 'cursorPageUp',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 11 /* KeyCode.PageUp */\n        }\n    }));\n    CoreNavigationCommands.CursorPageUpSelect = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 2 /* CursorMove_.Direction.Up */,\n            unit: 2 /* CursorMove_.Unit.WrappedLine */,\n            select: true,\n            value: -1 /* Constants.PAGE_SIZE_MARKER */\n        },\n        id: 'cursorPageUpSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* KeyMod.Shift */ | 11 /* KeyCode.PageUp */\n        }\n    }));\n    CoreNavigationCommands.CursorDown = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 3 /* CursorMove_.Direction.Down */,\n            unit: 2 /* CursorMove_.Unit.WrappedLine */,\n            select: false,\n            value: 1\n        },\n        id: 'cursorDown',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 18 /* KeyCode.DownArrow */,\n            mac: { primary: 18 /* KeyCode.DownArrow */, secondary: [256 /* KeyMod.WinCtrl */ | 44 /* KeyCode.KeyN */] }\n        }\n    }));\n    CoreNavigationCommands.CursorDownSelect = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 3 /* CursorMove_.Direction.Down */,\n            unit: 2 /* CursorMove_.Unit.WrappedLine */,\n            select: true,\n            value: 1\n        },\n        id: 'cursorDownSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* KeyMod.Shift */ | 18 /* KeyCode.DownArrow */,\n            secondary: [2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 18 /* KeyCode.DownArrow */],\n            mac: { primary: 1024 /* KeyMod.Shift */ | 18 /* KeyCode.DownArrow */ },\n            linux: { primary: 1024 /* KeyMod.Shift */ | 18 /* KeyCode.DownArrow */ }\n        }\n    }));\n    CoreNavigationCommands.CursorPageDown = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 3 /* CursorMove_.Direction.Down */,\n            unit: 2 /* CursorMove_.Unit.WrappedLine */,\n            select: false,\n            value: -1 /* Constants.PAGE_SIZE_MARKER */\n        },\n        id: 'cursorPageDown',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 12 /* KeyCode.PageDown */\n        }\n    }));\n    CoreNavigationCommands.CursorPageDownSelect = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 3 /* CursorMove_.Direction.Down */,\n            unit: 2 /* CursorMove_.Unit.WrappedLine */,\n            select: true,\n            value: -1 /* Constants.PAGE_SIZE_MARKER */\n        },\n        id: 'cursorPageDownSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* KeyMod.Shift */ | 12 /* KeyCode.PageDown */\n        }\n    }));\n    CoreNavigationCommands.CreateCursor = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'createCursor',\n                precondition: undefined\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            let newState;\n            if (args.wholeLine) {\n                newState = CursorMoveCommands.line(viewModel, viewModel.getPrimaryCursorState(), false, args.position, args.viewPosition);\n            }\n            else {\n                newState = CursorMoveCommands.moveTo(viewModel, viewModel.getPrimaryCursorState(), false, args.position, args.viewPosition);\n            }\n            const states = viewModel.getCursorStates();\n            // Check if we should remove a cursor (sort of like a toggle)\n            if (states.length > 1) {\n                const newModelPosition = (newState.modelState ? newState.modelState.position : null);\n                const newViewPosition = (newState.viewState ? newState.viewState.position : null);\n                for (let i = 0, len = states.length; i < len; i++) {\n                    const state = states[i];\n                    if (newModelPosition && !state.modelState.selection.containsPosition(newModelPosition)) {\n                        continue;\n                    }\n                    if (newViewPosition && !state.viewState.selection.containsPosition(newViewPosition)) {\n                        continue;\n                    }\n                    // => Remove the cursor\n                    states.splice(i, 1);\n                    viewModel.model.pushStackElement();\n                    viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, states);\n                    return;\n                }\n            }\n            // => Add the new cursor\n            states.push(newState);\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, states);\n        }\n    });\n    CoreNavigationCommands.LastCursorMoveToSelect = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: '_lastCursorMoveToSelect',\n                precondition: undefined\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            const lastAddedCursorIndex = viewModel.getLastAddedCursorIndex();\n            const states = viewModel.getCursorStates();\n            const newStates = states.slice(0);\n            newStates[lastAddedCursorIndex] = CursorMoveCommands.moveTo(viewModel, states[lastAddedCursorIndex], true, args.position, args.viewPosition);\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, newStates);\n        }\n    });\n    class HomeCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, CursorMoveCommands.moveToBeginningOfLine(viewModel, viewModel.getCursorStates(), this._inSelectionMode));\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n    }\n    CoreNavigationCommands.CursorHome = registerEditorCommand(new HomeCommand({\n        inSelectionMode: false,\n        id: 'cursorHome',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 14 /* KeyCode.Home */,\n            mac: { primary: 14 /* KeyCode.Home */, secondary: [2048 /* KeyMod.CtrlCmd */ | 15 /* KeyCode.LeftArrow */] }\n        }\n    }));\n    CoreNavigationCommands.CursorHomeSelect = registerEditorCommand(new HomeCommand({\n        inSelectionMode: true,\n        id: 'cursorHomeSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* KeyMod.Shift */ | 14 /* KeyCode.Home */,\n            mac: { primary: 1024 /* KeyMod.Shift */ | 14 /* KeyCode.Home */, secondary: [2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */] }\n        }\n    }));\n    class LineStartCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, this._exec(viewModel.getCursorStates()));\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n        _exec(cursors) {\n            const result = [];\n            for (let i = 0, len = cursors.length; i < len; i++) {\n                const cursor = cursors[i];\n                const lineNumber = cursor.modelState.position.lineNumber;\n                result[i] = CursorState.fromModelState(cursor.modelState.move(this._inSelectionMode, lineNumber, 1, 0));\n            }\n            return result;\n        }\n    }\n    CoreNavigationCommands.CursorLineStart = registerEditorCommand(new LineStartCommand({\n        inSelectionMode: false,\n        id: 'cursorLineStart',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 0,\n            mac: { primary: 256 /* KeyMod.WinCtrl */ | 31 /* KeyCode.KeyA */ }\n        }\n    }));\n    CoreNavigationCommands.CursorLineStartSelect = registerEditorCommand(new LineStartCommand({\n        inSelectionMode: true,\n        id: 'cursorLineStartSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 0,\n            mac: { primary: 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 31 /* KeyCode.KeyA */ }\n        }\n    }));\n    class EndCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, CursorMoveCommands.moveToEndOfLine(viewModel, viewModel.getCursorStates(), this._inSelectionMode, args.sticky || false));\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n    }\n    CoreNavigationCommands.CursorEnd = registerEditorCommand(new EndCommand({\n        inSelectionMode: false,\n        id: 'cursorEnd',\n        precondition: undefined,\n        kbOpts: {\n            args: { sticky: false },\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 13 /* KeyCode.End */,\n            mac: { primary: 13 /* KeyCode.End */, secondary: [2048 /* KeyMod.CtrlCmd */ | 17 /* KeyCode.RightArrow */] }\n        },\n        description: {\n            description: `Go to End`,\n            args: [{\n                    name: 'args',\n                    schema: {\n                        type: 'object',\n                        properties: {\n                            'sticky': {\n                                description: nls.localize('stickydesc', \"Stick to the end even when going to longer lines\"),\n                                type: 'boolean',\n                                default: false\n                            }\n                        }\n                    }\n                }]\n        }\n    }));\n    CoreNavigationCommands.CursorEndSelect = registerEditorCommand(new EndCommand({\n        inSelectionMode: true,\n        id: 'cursorEndSelect',\n        precondition: undefined,\n        kbOpts: {\n            args: { sticky: false },\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* KeyMod.Shift */ | 13 /* KeyCode.End */,\n            mac: { primary: 1024 /* KeyMod.Shift */ | 13 /* KeyCode.End */, secondary: [2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */] }\n        },\n        description: {\n            description: `Select to End`,\n            args: [{\n                    name: 'args',\n                    schema: {\n                        type: 'object',\n                        properties: {\n                            'sticky': {\n                                description: nls.localize('stickydesc', \"Stick to the end even when going to longer lines\"),\n                                type: 'boolean',\n                                default: false\n                            }\n                        }\n                    }\n                }]\n        }\n    }));\n    class LineEndCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, this._exec(viewModel, viewModel.getCursorStates()));\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n        _exec(viewModel, cursors) {\n            const result = [];\n            for (let i = 0, len = cursors.length; i < len; i++) {\n                const cursor = cursors[i];\n                const lineNumber = cursor.modelState.position.lineNumber;\n                const maxColumn = viewModel.model.getLineMaxColumn(lineNumber);\n                result[i] = CursorState.fromModelState(cursor.modelState.move(this._inSelectionMode, lineNumber, maxColumn, 0));\n            }\n            return result;\n        }\n    }\n    CoreNavigationCommands.CursorLineEnd = registerEditorCommand(new LineEndCommand({\n        inSelectionMode: false,\n        id: 'cursorLineEnd',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 0,\n            mac: { primary: 256 /* KeyMod.WinCtrl */ | 35 /* KeyCode.KeyE */ }\n        }\n    }));\n    CoreNavigationCommands.CursorLineEndSelect = registerEditorCommand(new LineEndCommand({\n        inSelectionMode: true,\n        id: 'cursorLineEndSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 0,\n            mac: { primary: 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 35 /* KeyCode.KeyE */ }\n        }\n    }));\n    class TopCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, CursorMoveCommands.moveToBeginningOfBuffer(viewModel, viewModel.getCursorStates(), this._inSelectionMode));\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n    }\n    CoreNavigationCommands.CursorTop = registerEditorCommand(new TopCommand({\n        inSelectionMode: false,\n        id: 'cursorTop',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* KeyMod.CtrlCmd */ | 14 /* KeyCode.Home */,\n            mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */ }\n        }\n    }));\n    CoreNavigationCommands.CursorTopSelect = registerEditorCommand(new TopCommand({\n        inSelectionMode: true,\n        id: 'cursorTopSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 14 /* KeyCode.Home */,\n            mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 16 /* KeyCode.UpArrow */ }\n        }\n    }));\n    class BottomCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, CursorMoveCommands.moveToEndOfBuffer(viewModel, viewModel.getCursorStates(), this._inSelectionMode));\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n    }\n    CoreNavigationCommands.CursorBottom = registerEditorCommand(new BottomCommand({\n        inSelectionMode: false,\n        id: 'cursorBottom',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* KeyMod.CtrlCmd */ | 13 /* KeyCode.End */,\n            mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */ }\n        }\n    }));\n    CoreNavigationCommands.CursorBottomSelect = registerEditorCommand(new BottomCommand({\n        inSelectionMode: true,\n        id: 'cursorBottomSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 13 /* KeyCode.End */,\n            mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 18 /* KeyCode.DownArrow */ }\n        }\n    }));\n    class EditorScrollImpl extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'editorScroll',\n                precondition: undefined,\n                description: EditorScroll_.description\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            const parsed = EditorScroll_.parse(args);\n            if (!parsed) {\n                // illegal arguments\n                return;\n            }\n            this._runEditorScroll(viewModel, args.source, parsed);\n        }\n        _runEditorScroll(viewModel, source, args) {\n            const desiredScrollTop = this._computeDesiredScrollTop(viewModel, args);\n            if (args.revealCursor) {\n                // must ensure cursor is in new visible range\n                const desiredVisibleViewRange = viewModel.getCompletelyVisibleViewRangeAtScrollTop(desiredScrollTop);\n                viewModel.setCursorStates(source, 3 /* CursorChangeReason.Explicit */, [\n                    CursorMoveCommands.findPositionInViewportIfOutside(viewModel, viewModel.getPrimaryCursorState(), desiredVisibleViewRange, args.select)\n                ]);\n            }\n            viewModel.viewLayout.setScrollPosition({ scrollTop: desiredScrollTop }, 0 /* ScrollType.Smooth */);\n        }\n        _computeDesiredScrollTop(viewModel, args) {\n            if (args.unit === 1 /* EditorScroll_.Unit.Line */) {\n                // scrolling by model lines\n                const visibleViewRange = viewModel.getCompletelyVisibleViewRange();\n                const visibleModelRange = viewModel.coordinatesConverter.convertViewRangeToModelRange(visibleViewRange);\n                let desiredTopModelLineNumber;\n                if (args.direction === 1 /* EditorScroll_.Direction.Up */) {\n                    // must go x model lines up\n                    desiredTopModelLineNumber = Math.max(1, visibleModelRange.startLineNumber - args.value);\n                }\n                else {\n                    // must go x model lines down\n                    desiredTopModelLineNumber = Math.min(viewModel.model.getLineCount(), visibleModelRange.startLineNumber + args.value);\n                }\n                const viewPosition = viewModel.coordinatesConverter.convertModelPositionToViewPosition(new Position(desiredTopModelLineNumber, 1));\n                return viewModel.viewLayout.getVerticalOffsetForLineNumber(viewPosition.lineNumber);\n            }\n            if (args.unit === 5 /* EditorScroll_.Unit.Editor */) {\n                let desiredTopModelLineNumber = 0;\n                if (args.direction === 2 /* EditorScroll_.Direction.Down */) {\n                    desiredTopModelLineNumber = viewModel.model.getLineCount() - viewModel.cursorConfig.pageSize;\n                }\n                return viewModel.viewLayout.getVerticalOffsetForLineNumber(desiredTopModelLineNumber);\n            }\n            let noOfLines;\n            if (args.unit === 3 /* EditorScroll_.Unit.Page */) {\n                noOfLines = viewModel.cursorConfig.pageSize * args.value;\n            }\n            else if (args.unit === 4 /* EditorScroll_.Unit.HalfPage */) {\n                noOfLines = Math.round(viewModel.cursorConfig.pageSize / 2) * args.value;\n            }\n            else {\n                noOfLines = args.value;\n            }\n            const deltaLines = (args.direction === 1 /* EditorScroll_.Direction.Up */ ? -1 : 1) * noOfLines;\n            return viewModel.viewLayout.getCurrentScrollTop() + deltaLines * viewModel.cursorConfig.lineHeight;\n        }\n    }\n    CoreNavigationCommands.EditorScrollImpl = EditorScrollImpl;\n    CoreNavigationCommands.EditorScroll = registerEditorCommand(new EditorScrollImpl());\n    CoreNavigationCommands.ScrollLineUp = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'scrollLineUp',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */,\n                    mac: { primary: 256 /* KeyMod.WinCtrl */ | 11 /* KeyCode.PageUp */ }\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            CoreNavigationCommands.EditorScroll._runEditorScroll(viewModel, args.source, {\n                direction: 1 /* EditorScroll_.Direction.Up */,\n                unit: 2 /* EditorScroll_.Unit.WrappedLine */,\n                value: 1,\n                revealCursor: false,\n                select: false\n            });\n        }\n    });\n    CoreNavigationCommands.ScrollPageUp = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'scrollPageUp',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 11 /* KeyCode.PageUp */,\n                    win: { primary: 512 /* KeyMod.Alt */ | 11 /* KeyCode.PageUp */ },\n                    linux: { primary: 512 /* KeyMod.Alt */ | 11 /* KeyCode.PageUp */ }\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            CoreNavigationCommands.EditorScroll._runEditorScroll(viewModel, args.source, {\n                direction: 1 /* EditorScroll_.Direction.Up */,\n                unit: 3 /* EditorScroll_.Unit.Page */,\n                value: 1,\n                revealCursor: false,\n                select: false\n            });\n        }\n    });\n    CoreNavigationCommands.ScrollEditorTop = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'scrollEditorTop',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            CoreNavigationCommands.EditorScroll._runEditorScroll(viewModel, args.source, {\n                direction: 1 /* EditorScroll_.Direction.Up */,\n                unit: 5 /* EditorScroll_.Unit.Editor */,\n                value: 1,\n                revealCursor: false,\n                select: false\n            });\n        }\n    });\n    CoreNavigationCommands.ScrollLineDown = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'scrollLineDown',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */,\n                    mac: { primary: 256 /* KeyMod.WinCtrl */ | 12 /* KeyCode.PageDown */ }\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            CoreNavigationCommands.EditorScroll._runEditorScroll(viewModel, args.source, {\n                direction: 2 /* EditorScroll_.Direction.Down */,\n                unit: 2 /* EditorScroll_.Unit.WrappedLine */,\n                value: 1,\n                revealCursor: false,\n                select: false\n            });\n        }\n    });\n    CoreNavigationCommands.ScrollPageDown = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'scrollPageDown',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 12 /* KeyCode.PageDown */,\n                    win: { primary: 512 /* KeyMod.Alt */ | 12 /* KeyCode.PageDown */ },\n                    linux: { primary: 512 /* KeyMod.Alt */ | 12 /* KeyCode.PageDown */ }\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            CoreNavigationCommands.EditorScroll._runEditorScroll(viewModel, args.source, {\n                direction: 2 /* EditorScroll_.Direction.Down */,\n                unit: 3 /* EditorScroll_.Unit.Page */,\n                value: 1,\n                revealCursor: false,\n                select: false\n            });\n        }\n    });\n    CoreNavigationCommands.ScrollEditorBottom = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'scrollEditorBottom',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            CoreNavigationCommands.EditorScroll._runEditorScroll(viewModel, args.source, {\n                direction: 2 /* EditorScroll_.Direction.Down */,\n                unit: 5 /* EditorScroll_.Unit.Editor */,\n                value: 1,\n                revealCursor: false,\n                select: false\n            });\n        }\n    });\n    class WordCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, [\n                CursorMoveCommands.word(viewModel, viewModel.getPrimaryCursorState(), this._inSelectionMode, args.position)\n            ]);\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n    }\n    CoreNavigationCommands.WordSelect = registerEditorCommand(new WordCommand({\n        inSelectionMode: false,\n        id: '_wordSelect',\n        precondition: undefined\n    }));\n    CoreNavigationCommands.WordSelectDrag = registerEditorCommand(new WordCommand({\n        inSelectionMode: true,\n        id: '_wordSelectDrag',\n        precondition: undefined\n    }));\n    CoreNavigationCommands.LastCursorWordSelect = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'lastCursorWordSelect',\n                precondition: undefined\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            const lastAddedCursorIndex = viewModel.getLastAddedCursorIndex();\n            const states = viewModel.getCursorStates();\n            const newStates = states.slice(0);\n            const lastAddedState = states[lastAddedCursorIndex];\n            newStates[lastAddedCursorIndex] = CursorMoveCommands.word(viewModel, lastAddedState, lastAddedState.modelState.hasSelection(), args.position);\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, newStates);\n        }\n    });\n    class LineCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, [\n                CursorMoveCommands.line(viewModel, viewModel.getPrimaryCursorState(), this._inSelectionMode, args.position, args.viewPosition)\n            ]);\n            viewModel.revealPrimaryCursor(args.source, false);\n        }\n    }\n    CoreNavigationCommands.LineSelect = registerEditorCommand(new LineCommand({\n        inSelectionMode: false,\n        id: '_lineSelect',\n        precondition: undefined\n    }));\n    CoreNavigationCommands.LineSelectDrag = registerEditorCommand(new LineCommand({\n        inSelectionMode: true,\n        id: '_lineSelectDrag',\n        precondition: undefined\n    }));\n    class LastCursorLineCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            const lastAddedCursorIndex = viewModel.getLastAddedCursorIndex();\n            const states = viewModel.getCursorStates();\n            const newStates = states.slice(0);\n            newStates[lastAddedCursorIndex] = CursorMoveCommands.line(viewModel, states[lastAddedCursorIndex], this._inSelectionMode, args.position, args.viewPosition);\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, newStates);\n        }\n    }\n    CoreNavigationCommands.LastCursorLineSelect = registerEditorCommand(new LastCursorLineCommand({\n        inSelectionMode: false,\n        id: 'lastCursorLineSelect',\n        precondition: undefined\n    }));\n    CoreNavigationCommands.LastCursorLineSelectDrag = registerEditorCommand(new LastCursorLineCommand({\n        inSelectionMode: true,\n        id: 'lastCursorLineSelectDrag',\n        precondition: undefined\n    }));\n    CoreNavigationCommands.CancelSelection = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'cancelSelection',\n                precondition: EditorContextKeys.hasNonEmptySelection,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 9 /* KeyCode.Escape */,\n                    secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, [\n                CursorMoveCommands.cancelSelection(viewModel, viewModel.getPrimaryCursorState())\n            ]);\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n    });\n    CoreNavigationCommands.RemoveSecondaryCursors = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'removeSecondaryCursors',\n                precondition: EditorContextKeys.hasMultipleSelections,\n                kbOpts: {\n                    weight: CORE_WEIGHT + 1,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 9 /* KeyCode.Escape */,\n                    secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, [\n                viewModel.getPrimaryCursorState()\n            ]);\n            viewModel.revealPrimaryCursor(args.source, true);\n            status(nls.localize('removedCursor', \"Removed secondary cursors\"));\n        }\n    });\n    CoreNavigationCommands.RevealLine = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'revealLine',\n                precondition: undefined,\n                description: RevealLine_.description\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            const revealLineArg = args;\n            const lineNumberArg = revealLineArg.lineNumber || 0;\n            let lineNumber = typeof lineNumberArg === 'number' ? (lineNumberArg + 1) : (parseInt(lineNumberArg) + 1);\n            if (lineNumber < 1) {\n                lineNumber = 1;\n            }\n            const lineCount = viewModel.model.getLineCount();\n            if (lineNumber > lineCount) {\n                lineNumber = lineCount;\n            }\n            const range = new Range(lineNumber, 1, lineNumber, viewModel.model.getLineMaxColumn(lineNumber));\n            let revealAt = 0 /* VerticalRevealType.Simple */;\n            if (revealLineArg.at) {\n                switch (revealLineArg.at) {\n                    case RevealLine_.RawAtArgument.Top:\n                        revealAt = 3 /* VerticalRevealType.Top */;\n                        break;\n                    case RevealLine_.RawAtArgument.Center:\n                        revealAt = 1 /* VerticalRevealType.Center */;\n                        break;\n                    case RevealLine_.RawAtArgument.Bottom:\n                        revealAt = 4 /* VerticalRevealType.Bottom */;\n                        break;\n                    default:\n                        break;\n                }\n            }\n            const viewRange = viewModel.coordinatesConverter.convertModelRangeToViewRange(range);\n            viewModel.revealRange(args.source, false, viewRange, revealAt, 0 /* ScrollType.Smooth */);\n        }\n    });\n    CoreNavigationCommands.SelectAll = new class extends EditorOrNativeTextInputCommand {\n        constructor() {\n            super(SelectAllCommand);\n        }\n        runDOMCommand() {\n            if (isFirefox) {\n                document.activeElement.focus();\n                document.activeElement.select();\n            }\n            document.execCommand('selectAll');\n        }\n        runEditorCommand(accessor, editor, args) {\n            const viewModel = editor._getViewModel();\n            if (!viewModel) {\n                // the editor has no view => has no cursors\n                return;\n            }\n            this.runCoreEditorCommand(viewModel, args);\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates('keyboard', 3 /* CursorChangeReason.Explicit */, [\n                CursorMoveCommands.selectAll(viewModel, viewModel.getPrimaryCursorState())\n            ]);\n        }\n    }();\n    CoreNavigationCommands.SetSelection = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'setSelection',\n                precondition: undefined\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, [\n                CursorState.fromModelSelection(args.selection)\n            ]);\n        }\n    });\n})(CoreNavigationCommands || (CoreNavigationCommands = {}));\nconst columnSelectionCondition = ContextKeyExpr.and(EditorContextKeys.textInputFocus, EditorContextKeys.columnSelection);\nfunction registerColumnSelection(id, keybinding) {\n    KeybindingsRegistry.registerKeybindingRule({\n        id: id,\n        primary: keybinding,\n        when: columnSelectionCondition,\n        weight: CORE_WEIGHT + 1\n    });\n}\nregisterColumnSelection(CoreNavigationCommands.CursorColumnSelectLeft.id, 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */);\nregisterColumnSelection(CoreNavigationCommands.CursorColumnSelectRight.id, 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */);\nregisterColumnSelection(CoreNavigationCommands.CursorColumnSelectUp.id, 1024 /* KeyMod.Shift */ | 16 /* KeyCode.UpArrow */);\nregisterColumnSelection(CoreNavigationCommands.CursorColumnSelectPageUp.id, 1024 /* KeyMod.Shift */ | 11 /* KeyCode.PageUp */);\nregisterColumnSelection(CoreNavigationCommands.CursorColumnSelectDown.id, 1024 /* KeyMod.Shift */ | 18 /* KeyCode.DownArrow */);\nregisterColumnSelection(CoreNavigationCommands.CursorColumnSelectPageDown.id, 1024 /* KeyMod.Shift */ | 12 /* KeyCode.PageDown */);\nfunction registerCommand(command) {\n    command.register();\n    return command;\n}\nexport var CoreEditingCommands;\n(function (CoreEditingCommands) {\n    class CoreEditingCommand extends EditorCommand {\n        runEditorCommand(accessor, editor, args) {\n            const viewModel = editor._getViewModel();\n            if (!viewModel) {\n                // the editor has no view => has no cursors\n                return;\n            }\n            this.runCoreEditingCommand(editor, viewModel, args || {});\n        }\n    }\n    CoreEditingCommands.CoreEditingCommand = CoreEditingCommand;\n    CoreEditingCommands.LineBreakInsert = registerEditorCommand(new class extends CoreEditingCommand {\n        constructor() {\n            super({\n                id: 'lineBreakInsert',\n                precondition: EditorContextKeys.writable,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 0,\n                    mac: { primary: 256 /* KeyMod.WinCtrl */ | 45 /* KeyCode.KeyO */ }\n                }\n            });\n        }\n        runCoreEditingCommand(editor, viewModel, args) {\n            editor.pushUndoStop();\n            editor.executeCommands(this.id, TypeOperations.lineBreakInsert(viewModel.cursorConfig, viewModel.model, viewModel.getCursorStates().map(s => s.modelState.selection)));\n        }\n    });\n    CoreEditingCommands.Outdent = registerEditorCommand(new class extends CoreEditingCommand {\n        constructor() {\n            super({\n                id: 'outdent',\n                precondition: EditorContextKeys.writable,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, EditorContextKeys.tabDoesNotMoveFocus),\n                    primary: 1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */\n                }\n            });\n        }\n        runCoreEditingCommand(editor, viewModel, args) {\n            editor.pushUndoStop();\n            editor.executeCommands(this.id, TypeOperations.outdent(viewModel.cursorConfig, viewModel.model, viewModel.getCursorStates().map(s => s.modelState.selection)));\n            editor.pushUndoStop();\n        }\n    });\n    CoreEditingCommands.Tab = registerEditorCommand(new class extends CoreEditingCommand {\n        constructor() {\n            super({\n                id: 'tab',\n                precondition: EditorContextKeys.writable,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, EditorContextKeys.tabDoesNotMoveFocus),\n                    primary: 2 /* KeyCode.Tab */\n                }\n            });\n        }\n        runCoreEditingCommand(editor, viewModel, args) {\n            editor.pushUndoStop();\n            editor.executeCommands(this.id, TypeOperations.tab(viewModel.cursorConfig, viewModel.model, viewModel.getCursorStates().map(s => s.modelState.selection)));\n            editor.pushUndoStop();\n        }\n    });\n    CoreEditingCommands.DeleteLeft = registerEditorCommand(new class extends CoreEditingCommand {\n        constructor() {\n            super({\n                id: 'deleteLeft',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 1 /* KeyCode.Backspace */,\n                    secondary: [1024 /* KeyMod.Shift */ | 1 /* KeyCode.Backspace */],\n                    mac: { primary: 1 /* KeyCode.Backspace */, secondary: [1024 /* KeyMod.Shift */ | 1 /* KeyCode.Backspace */, 256 /* KeyMod.WinCtrl */ | 38 /* KeyCode.KeyH */, 256 /* KeyMod.WinCtrl */ | 1 /* KeyCode.Backspace */] }\n                }\n            });\n        }\n        runCoreEditingCommand(editor, viewModel, args) {\n            const [shouldPushStackElementBefore, commands] = DeleteOperations.deleteLeft(viewModel.getPrevEditOperationType(), viewModel.cursorConfig, viewModel.model, viewModel.getCursorStates().map(s => s.modelState.selection), viewModel.getCursorAutoClosedCharacters());\n            if (shouldPushStackElementBefore) {\n                editor.pushUndoStop();\n            }\n            editor.executeCommands(this.id, commands);\n            viewModel.setPrevEditOperationType(2 /* EditOperationType.DeletingLeft */);\n        }\n    });\n    CoreEditingCommands.DeleteRight = registerEditorCommand(new class extends CoreEditingCommand {\n        constructor() {\n            super({\n                id: 'deleteRight',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 20 /* KeyCode.Delete */,\n                    mac: { primary: 20 /* KeyCode.Delete */, secondary: [256 /* KeyMod.WinCtrl */ | 34 /* KeyCode.KeyD */, 256 /* KeyMod.WinCtrl */ | 20 /* KeyCode.Delete */] }\n                }\n            });\n        }\n        runCoreEditingCommand(editor, viewModel, args) {\n            const [shouldPushStackElementBefore, commands] = DeleteOperations.deleteRight(viewModel.getPrevEditOperationType(), viewModel.cursorConfig, viewModel.model, viewModel.getCursorStates().map(s => s.modelState.selection));\n            if (shouldPushStackElementBefore) {\n                editor.pushUndoStop();\n            }\n            editor.executeCommands(this.id, commands);\n            viewModel.setPrevEditOperationType(3 /* EditOperationType.DeletingRight */);\n        }\n    });\n    CoreEditingCommands.Undo = new class extends EditorOrNativeTextInputCommand {\n        constructor() {\n            super(UndoCommand);\n        }\n        runDOMCommand() {\n            document.execCommand('undo');\n        }\n        runEditorCommand(accessor, editor, args) {\n            if (!editor.hasModel() || editor.getOption(83 /* EditorOption.readOnly */) === true) {\n                return;\n            }\n            return editor.getModel().undo();\n        }\n    }();\n    CoreEditingCommands.Redo = new class extends EditorOrNativeTextInputCommand {\n        constructor() {\n            super(RedoCommand);\n        }\n        runDOMCommand() {\n            document.execCommand('redo');\n        }\n        runEditorCommand(accessor, editor, args) {\n            if (!editor.hasModel() || editor.getOption(83 /* EditorOption.readOnly */) === true) {\n                return;\n            }\n            return editor.getModel().redo();\n        }\n    }();\n})(CoreEditingCommands || (CoreEditingCommands = {}));\n/**\n * A command that will invoke a command on the focused editor.\n */\nclass EditorHandlerCommand extends Command {\n    constructor(id, handlerId, description) {\n        super({\n            id: id,\n            precondition: undefined,\n            description: description\n        });\n        this._handlerId = handlerId;\n    }\n    runCommand(accessor, args) {\n        const editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n        if (!editor) {\n            return;\n        }\n        editor.trigger('keyboard', this._handlerId, args);\n    }\n}\nfunction registerOverwritableCommand(handlerId, description) {\n    registerCommand(new EditorHandlerCommand('default:' + handlerId, handlerId));\n    registerCommand(new EditorHandlerCommand(handlerId, handlerId, description));\n}\nregisterOverwritableCommand(\"type\" /* Handler.Type */, {\n    description: `Type`,\n    args: [{\n            name: 'args',\n            schema: {\n                'type': 'object',\n                'required': ['text'],\n                'properties': {\n                    'text': {\n                        'type': 'string'\n                    }\n                },\n            }\n        }]\n});\nregisterOverwritableCommand(\"replacePreviousChar\" /* Handler.ReplacePreviousChar */);\nregisterOverwritableCommand(\"compositionType\" /* Handler.CompositionType */);\nregisterOverwritableCommand(\"compositionStart\" /* Handler.CompositionStart */);\nregisterOverwritableCommand(\"compositionEnd\" /* Handler.CompositionEnd */);\nregisterOverwritableCommand(\"paste\" /* Handler.Paste */);\nregisterOverwritableCommand(\"cut\" /* Handler.Cut */);\n"],"mappings":"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"}]}