{"remainingRequest":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js!/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/base/common/event.js","dependencies":[{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/base/common/event.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/babel.config.js","mtime":1668271197000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9nZXQgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9nZXQuanMiOwppbXBvcnQgX2dldFByb3RvdHlwZU9mIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZ2V0UHJvdG90eXBlT2YuanMiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vaW5oZXJpdHMuanMiOwppbXBvcnQgX2NyZWF0ZVN1cGVyIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlU3VwZXIuanMiOwppbXBvcnQgX3NsaWNlZFRvQXJyYXkgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9zbGljZWRUb0FycmF5LmpzIjsKaW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlci5qcyI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjay5qcyI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcy5qcyI7CmltcG9ydCBfdG9Db25zdW1hYmxlQXJyYXkgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucmVkdWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3BsaXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnB1c2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIudG8tZml4ZWQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5qb2luLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5mcm9tLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnF1ZXVlLW1pY3JvdGFzay5qcyI7CmltcG9ydCB7IG9uVW5leHBlY3RlZEVycm9yIH0gZnJvbSAnLi9lcnJvcnMuanMnOwppbXBvcnQgeyBjb21iaW5lZERpc3Bvc2FibGUsIERpc3Bvc2FibGUsIERpc3Bvc2FibGVTdG9yZSwgU2FmZURpc3Bvc2FibGUsIHRvRGlzcG9zYWJsZSB9IGZyb20gJy4vbGlmZWN5Y2xlLmpzJzsKaW1wb3J0IHsgTGlua2VkTGlzdCB9IGZyb20gJy4vbGlua2VkTGlzdC5qcyc7CmltcG9ydCB7IFN0b3BXYXRjaCB9IGZyb20gJy4vc3RvcHdhdGNoLmpzJzsKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLy8gVW5jb21tZW50IHRoZSBuZXh0IGxpbmUgdG8gcHJpbnQgd2FybmluZ3Mgd2hlbmV2ZXIgYW4gZW1pdHRlciB3aXRoIGxpc3RlbmVycyBpcyBkaXNwb3NlZC4gVGhhdCBpcyBhIHNpZ24gb2YgY29kZSBzbWVsbC4KLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KdmFyIF9lbmFibGVEaXNwb3NlV2l0aExpc3RlbmVyV2FybmluZyA9IGZhbHNlOwovLyBfZW5hYmxlRGlzcG9zZVdpdGhMaXN0ZW5lcldhcm5pbmcgPSBCb29sZWFuKCJUUlVFIik7IC8vIGNhdXNlcyBhIGxpbnRlciB3YXJuaW5nIHNvIHRoYXQgaXQgY2Fubm90IGJlIHB1c2hlZAovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyBVbmNvbW1lbnQgdGhlIG5leHQgbGluZSB0byBwcmludCB3YXJuaW5ncyB3aGVuZXZlciBhIHNuYXBzaG90dGVkIGV2ZW50IGlzIHVzZWQgcmVwZWF0ZWRseSB3aXRob3V0IGNsZWFudXAuCi8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vbWljcm9zb2Z0L3ZzY29kZS9pc3N1ZXMvMTQyODUxCi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCnZhciBfZW5hYmxlU25hcHNob3RQb3RlbnRpYWxMZWFrV2FybmluZyA9IGZhbHNlOwpleHBvcnQgdmFyIEV2ZW50OwooZnVuY3Rpb24gKEV2ZW50KSB7CiAgRXZlbnQuTm9uZSA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiBEaXNwb3NhYmxlLk5vbmU7CiAgfTsKICBmdW5jdGlvbiBfYWRkTGVha2FnZVRyYWNlTG9naWMob3B0aW9ucykgewogICAgaWYgKF9lbmFibGVTbmFwc2hvdFBvdGVudGlhbExlYWtXYXJuaW5nKSB7CiAgICAgIHZhciBvcmlnTGlzdGVuZXJEaWRBZGQgPSBvcHRpb25zLm9uTGlzdGVuZXJEaWRBZGQ7CiAgICAgIHZhciBzdGFjayA9IFN0YWNrdHJhY2UuY3JlYXRlKCk7CiAgICAgIHZhciBjb3VudCA9IDA7CiAgICAgIG9wdGlvbnMub25MaXN0ZW5lckRpZEFkZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoKytjb3VudCA9PT0gMikgewogICAgICAgICAgY29uc29sZS53YXJuKCdzbmFwc2hvdHRlZCBlbWl0dGVyIExJS0VMWSB1c2VkIHB1YmxpYyBhbmQgU0hPVUxEIEhBVkUgQkVFTiBjcmVhdGVkIHdpdGggRGlzcG9zYWJsZVN0b3JlLiBzbmFwc2hvdHRlZCBoZXJlJyk7CiAgICAgICAgICBzdGFjay5wcmludCgpOwogICAgICAgIH0KICAgICAgICBvcmlnTGlzdGVuZXJEaWRBZGQgPT09IG51bGwgfHwgb3JpZ0xpc3RlbmVyRGlkQWRkID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcmlnTGlzdGVuZXJEaWRBZGQoKTsKICAgICAgfTsKICAgIH0KICB9CiAgLyoqCiAgICogR2l2ZW4gYW4gZXZlbnQsIHJldHVybnMgYW5vdGhlciBldmVudCB3aGljaCBvbmx5IGZpcmVzIG9uY2UuCiAgICovCiAgZnVuY3Rpb24gX29uY2UoZXZlbnQpIHsKICAgIHJldHVybiBmdW5jdGlvbiAobGlzdGVuZXIpIHsKICAgICAgdmFyIHRoaXNBcmdzID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBudWxsOwogICAgICB2YXIgZGlzcG9zYWJsZXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMiA/IGFyZ3VtZW50c1syXSA6IHVuZGVmaW5lZDsKICAgICAgLy8gd2UgbmVlZCB0aGlzLCBpbiBjYXNlIHRoZSBldmVudCBmaXJlcyBkdXJpbmcgdGhlIGxpc3RlbmVyIGNhbGwKICAgICAgdmFyIGRpZEZpcmUgPSBmYWxzZTsKICAgICAgdmFyIHJlc3VsdCA9IHVuZGVmaW5lZDsKICAgICAgcmVzdWx0ID0gZXZlbnQoZnVuY3Rpb24gKGUpIHsKICAgICAgICBpZiAoZGlkRmlyZSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gZWxzZSBpZiAocmVzdWx0KSB7CiAgICAgICAgICByZXN1bHQuZGlzcG9zZSgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBkaWRGaXJlID0gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGxpc3RlbmVyLmNhbGwodGhpc0FyZ3MsIGUpOwogICAgICB9LCBudWxsLCBkaXNwb3NhYmxlcyk7CiAgICAgIGlmIChkaWRGaXJlKSB7CiAgICAgICAgcmVzdWx0LmRpc3Bvc2UoKTsKICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfTsKICB9CiAgRXZlbnQub25jZSA9IF9vbmNlOwogIC8qKgogICAqICpOT1RFKiB0aGF0IHRoaXMgZnVuY3Rpb24gcmV0dXJucyBhbiBgRXZlbnRgIGFuZCBpdCBNVVNUIGJlIGNhbGxlZCB3aXRoIGEgYERpc3Bvc2FibGVTdG9yZWAgd2hlbmV2ZXIgdGhlIHJldHVybmVkCiAgICogZXZlbnQgaXMgYWNjZXNzaWJsZSB0byAidGhpcmQgcGFydGllcyIsIGUuZyB0aGUgZXZlbnQgaXMgYSBwdWJsaWMgcHJvcGVydHkuIE90aGVyd2lzZSBhIGxlYWtlZCBsaXN0ZW5lciBvbiB0aGUKICAgKiByZXR1cm5lZCBldmVudCBjYXVzZXMgdGhpcyB1dGlsaXR5IHRvIGxlYWsgYSBsaXN0ZW5lciBvbiB0aGUgb3JpZ2luYWwgZXZlbnQuCiAgICovCiAgZnVuY3Rpb24gX21hcChldmVudCwgbWFwLCBkaXNwb3NhYmxlKSB7CiAgICByZXR1cm4gc25hcHNob3QoZnVuY3Rpb24gKGxpc3RlbmVyKSB7CiAgICAgIHZhciB0aGlzQXJncyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogbnVsbDsKICAgICAgdmFyIGRpc3Bvc2FibGVzID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgPyBhcmd1bWVudHNbMl0gOiB1bmRlZmluZWQ7CiAgICAgIHJldHVybiBldmVudChmdW5jdGlvbiAoaSkgewogICAgICAgIHJldHVybiBsaXN0ZW5lci5jYWxsKHRoaXNBcmdzLCBtYXAoaSkpOwogICAgICB9LCBudWxsLCBkaXNwb3NhYmxlcyk7CiAgICB9LCBkaXNwb3NhYmxlKTsKICB9CiAgRXZlbnQubWFwID0gX21hcDsKICAvKioKICAgKiAqTk9URSogdGhhdCB0aGlzIGZ1bmN0aW9uIHJldHVybnMgYW4gYEV2ZW50YCBhbmQgaXQgTVVTVCBiZSBjYWxsZWQgd2l0aCBhIGBEaXNwb3NhYmxlU3RvcmVgIHdoZW5ldmVyIHRoZSByZXR1cm5lZAogICAqIGV2ZW50IGlzIGFjY2Vzc2libGUgdG8gInRoaXJkIHBhcnRpZXMiLCBlLmcgdGhlIGV2ZW50IGlzIGEgcHVibGljIHByb3BlcnR5LiBPdGhlcndpc2UgYSBsZWFrZWQgbGlzdGVuZXIgb24gdGhlCiAgICogcmV0dXJuZWQgZXZlbnQgY2F1c2VzIHRoaXMgdXRpbGl0eSB0byBsZWFrIGEgbGlzdGVuZXIgb24gdGhlIG9yaWdpbmFsIGV2ZW50LgogICAqLwogIGZ1bmN0aW9uIF9mb3JFYWNoKGV2ZW50LCBlYWNoLCBkaXNwb3NhYmxlKSB7CiAgICByZXR1cm4gc25hcHNob3QoZnVuY3Rpb24gKGxpc3RlbmVyKSB7CiAgICAgIHZhciB0aGlzQXJncyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogbnVsbDsKICAgICAgdmFyIGRpc3Bvc2FibGVzID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgPyBhcmd1bWVudHNbMl0gOiB1bmRlZmluZWQ7CiAgICAgIHJldHVybiBldmVudChmdW5jdGlvbiAoaSkgewogICAgICAgIGVhY2goaSk7CiAgICAgICAgbGlzdGVuZXIuY2FsbCh0aGlzQXJncywgaSk7CiAgICAgIH0sIG51bGwsIGRpc3Bvc2FibGVzKTsKICAgIH0sIGRpc3Bvc2FibGUpOwogIH0KICBFdmVudC5mb3JFYWNoID0gX2ZvckVhY2g7CiAgZnVuY3Rpb24gX2ZpbHRlcihldmVudCwgZmlsdGVyLCBkaXNwb3NhYmxlKSB7CiAgICByZXR1cm4gc25hcHNob3QoZnVuY3Rpb24gKGxpc3RlbmVyKSB7CiAgICAgIHZhciB0aGlzQXJncyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogbnVsbDsKICAgICAgdmFyIGRpc3Bvc2FibGVzID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgPyBhcmd1bWVudHNbMl0gOiB1bmRlZmluZWQ7CiAgICAgIHJldHVybiBldmVudChmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBmaWx0ZXIoZSkgJiYgbGlzdGVuZXIuY2FsbCh0aGlzQXJncywgZSk7CiAgICAgIH0sIG51bGwsIGRpc3Bvc2FibGVzKTsKICAgIH0sIGRpc3Bvc2FibGUpOwogIH0KICBFdmVudC5maWx0ZXIgPSBfZmlsdGVyOwogIC8qKgogICAqIEdpdmVuIGFuIGV2ZW50LCByZXR1cm5zIHRoZSBzYW1lIGV2ZW50IGJ1dCB0eXBlZCBhcyBgRXZlbnQ8dm9pZD5gLgogICAqLwogIGZ1bmN0aW9uIHNpZ25hbChldmVudCkgewogICAgcmV0dXJuIGV2ZW50OwogIH0KICBFdmVudC5zaWduYWwgPSBzaWduYWw7CiAgZnVuY3Rpb24gYW55KCkgewogICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGV2ZW50cyA9IG5ldyBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHsKICAgICAgZXZlbnRzW19rZXldID0gYXJndW1lbnRzW19rZXldOwogICAgfQogICAgcmV0dXJuIGZ1bmN0aW9uIChsaXN0ZW5lcikgewogICAgICB2YXIgdGhpc0FyZ3MgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IG51bGw7CiAgICAgIHZhciBkaXNwb3NhYmxlcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyID8gYXJndW1lbnRzWzJdIDogdW5kZWZpbmVkOwogICAgICByZXR1cm4gY29tYmluZWREaXNwb3NhYmxlLmFwcGx5KHZvaWQgMCwgX3RvQ29uc3VtYWJsZUFycmF5KGV2ZW50cy5tYXAoZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgcmV0dXJuIGV2ZW50KGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gbGlzdGVuZXIuY2FsbCh0aGlzQXJncywgZSk7CiAgICAgICAgfSwgbnVsbCwgZGlzcG9zYWJsZXMpOwogICAgICB9KSkpOwogICAgfTsKICB9CiAgRXZlbnQuYW55ID0gYW55OwogIC8qKgogICAqICpOT1RFKiB0aGF0IHRoaXMgZnVuY3Rpb24gcmV0dXJucyBhbiBgRXZlbnRgIGFuZCBpdCBNVVNUIGJlIGNhbGxlZCB3aXRoIGEgYERpc3Bvc2FibGVTdG9yZWAgd2hlbmV2ZXIgdGhlIHJldHVybmVkCiAgICogZXZlbnQgaXMgYWNjZXNzaWJsZSB0byAidGhpcmQgcGFydGllcyIsIGUuZyB0aGUgZXZlbnQgaXMgYSBwdWJsaWMgcHJvcGVydHkuIE90aGVyd2lzZSBhIGxlYWtlZCBsaXN0ZW5lciBvbiB0aGUKICAgKiByZXR1cm5lZCBldmVudCBjYXVzZXMgdGhpcyB1dGlsaXR5IHRvIGxlYWsgYSBsaXN0ZW5lciBvbiB0aGUgb3JpZ2luYWwgZXZlbnQuCiAgICovCiAgZnVuY3Rpb24gX3JlZHVjZShldmVudCwgbWVyZ2UsIGluaXRpYWwsIGRpc3Bvc2FibGUpIHsKICAgIHZhciBvdXRwdXQgPSBpbml0aWFsOwogICAgcmV0dXJuIF9tYXAoZXZlbnQsIGZ1bmN0aW9uIChlKSB7CiAgICAgIG91dHB1dCA9IG1lcmdlKG91dHB1dCwgZSk7CiAgICAgIHJldHVybiBvdXRwdXQ7CiAgICB9LCBkaXNwb3NhYmxlKTsKICB9CiAgRXZlbnQucmVkdWNlID0gX3JlZHVjZTsKICBmdW5jdGlvbiBzbmFwc2hvdChldmVudCwgZGlzcG9zYWJsZSkgewogICAgdmFyIGxpc3RlbmVyOwogICAgdmFyIG9wdGlvbnMgPSB7CiAgICAgIG9uRmlyc3RMaXN0ZW5lckFkZDogZnVuY3Rpb24gb25GaXJzdExpc3RlbmVyQWRkKCkgewogICAgICAgIGxpc3RlbmVyID0gZXZlbnQoZW1pdHRlci5maXJlLCBlbWl0dGVyKTsKICAgICAgfSwKICAgICAgb25MYXN0TGlzdGVuZXJSZW1vdmU6IGZ1bmN0aW9uIG9uTGFzdExpc3RlbmVyUmVtb3ZlKCkgewogICAgICAgIGxpc3RlbmVyID09PSBudWxsIHx8IGxpc3RlbmVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBsaXN0ZW5lci5kaXNwb3NlKCk7CiAgICAgIH0KICAgIH07CiAgICBpZiAoIWRpc3Bvc2FibGUpIHsKICAgICAgX2FkZExlYWthZ2VUcmFjZUxvZ2ljKG9wdGlvbnMpOwogICAgfQogICAgdmFyIGVtaXR0ZXIgPSBuZXcgRW1pdHRlcihvcHRpb25zKTsKICAgIGRpc3Bvc2FibGUgPT09IG51bGwgfHwgZGlzcG9zYWJsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogZGlzcG9zYWJsZS5hZGQoZW1pdHRlcik7CiAgICByZXR1cm4gZW1pdHRlci5ldmVudDsKICB9CiAgZnVuY3Rpb24gX2RlYm91bmNlKGV2ZW50LCBtZXJnZSkgewogICAgdmFyIGRlbGF5ID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiAxMDA7CiAgICB2YXIgbGVhZGluZyA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDogZmFsc2U7CiAgICB2YXIgbGVha1dhcm5pbmdUaHJlc2hvbGQgPSBhcmd1bWVudHMubGVuZ3RoID4gNCA/IGFyZ3VtZW50c1s0XSA6IHVuZGVmaW5lZDsKICAgIHZhciBkaXNwb3NhYmxlID0gYXJndW1lbnRzLmxlbmd0aCA+IDUgPyBhcmd1bWVudHNbNV0gOiB1bmRlZmluZWQ7CiAgICB2YXIgc3Vic2NyaXB0aW9uOwogICAgdmFyIG91dHB1dCA9IHVuZGVmaW5lZDsKICAgIHZhciBoYW5kbGUgPSB1bmRlZmluZWQ7CiAgICB2YXIgbnVtRGVib3VuY2VkQ2FsbHMgPSAwOwogICAgdmFyIG9wdGlvbnMgPSB7CiAgICAgIGxlYWtXYXJuaW5nVGhyZXNob2xkOiBsZWFrV2FybmluZ1RocmVzaG9sZCwKICAgICAgb25GaXJzdExpc3RlbmVyQWRkOiBmdW5jdGlvbiBvbkZpcnN0TGlzdGVuZXJBZGQoKSB7CiAgICAgICAgc3Vic2NyaXB0aW9uID0gZXZlbnQoZnVuY3Rpb24gKGN1cikgewogICAgICAgICAgbnVtRGVib3VuY2VkQ2FsbHMrKzsKICAgICAgICAgIG91dHB1dCA9IG1lcmdlKG91dHB1dCwgY3VyKTsKICAgICAgICAgIGlmIChsZWFkaW5nICYmICFoYW5kbGUpIHsKICAgICAgICAgICAgZW1pdHRlci5maXJlKG91dHB1dCk7CiAgICAgICAgICAgIG91dHB1dCA9IHVuZGVmaW5lZDsKICAgICAgICAgIH0KICAgICAgICAgIGNsZWFyVGltZW91dChoYW5kbGUpOwogICAgICAgICAgaGFuZGxlID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBfb3V0cHV0ID0gb3V0cHV0OwogICAgICAgICAgICBvdXRwdXQgPSB1bmRlZmluZWQ7CiAgICAgICAgICAgIGhhbmRsZSA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgaWYgKCFsZWFkaW5nIHx8IG51bURlYm91bmNlZENhbGxzID4gMSkgewogICAgICAgICAgICAgIGVtaXR0ZXIuZmlyZShfb3V0cHV0KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBudW1EZWJvdW5jZWRDYWxscyA9IDA7CiAgICAgICAgICB9LCBkZWxheSk7CiAgICAgICAgfSk7CiAgICAgIH0sCiAgICAgIG9uTGFzdExpc3RlbmVyUmVtb3ZlOiBmdW5jdGlvbiBvbkxhc3RMaXN0ZW5lclJlbW92ZSgpIHsKICAgICAgICBzdWJzY3JpcHRpb24uZGlzcG9zZSgpOwogICAgICB9CiAgICB9OwogICAgaWYgKCFkaXNwb3NhYmxlKSB7CiAgICAgIF9hZGRMZWFrYWdlVHJhY2VMb2dpYyhvcHRpb25zKTsKICAgIH0KICAgIHZhciBlbWl0dGVyID0gbmV3IEVtaXR0ZXIob3B0aW9ucyk7CiAgICBkaXNwb3NhYmxlID09PSBudWxsIHx8IGRpc3Bvc2FibGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGRpc3Bvc2FibGUuYWRkKGVtaXR0ZXIpOwogICAgcmV0dXJuIGVtaXR0ZXIuZXZlbnQ7CiAgfQogIEV2ZW50LmRlYm91bmNlID0gX2RlYm91bmNlOwogIC8qKgogICAqICpOT1RFKiB0aGF0IHRoaXMgZnVuY3Rpb24gcmV0dXJucyBhbiBgRXZlbnRgIGFuZCBpdCBNVVNUIGJlIGNhbGxlZCB3aXRoIGEgYERpc3Bvc2FibGVTdG9yZWAgd2hlbmV2ZXIgdGhlIHJldHVybmVkCiAgICogZXZlbnQgaXMgYWNjZXNzaWJsZSB0byAidGhpcmQgcGFydGllcyIsIGUuZyB0aGUgZXZlbnQgaXMgYSBwdWJsaWMgcHJvcGVydHkuIE90aGVyd2lzZSBhIGxlYWtlZCBsaXN0ZW5lciBvbiB0aGUKICAgKiByZXR1cm5lZCBldmVudCBjYXVzZXMgdGhpcyB1dGlsaXR5IHRvIGxlYWsgYSBsaXN0ZW5lciBvbiB0aGUgb3JpZ2luYWwgZXZlbnQuCiAgICovCiAgZnVuY3Rpb24gX2xhdGNoKGV2ZW50KSB7CiAgICB2YXIgZXF1YWxzID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmdW5jdGlvbiAoYSwgYikgewogICAgICByZXR1cm4gYSA9PT0gYjsKICAgIH07CiAgICB2YXIgZGlzcG9zYWJsZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyID8gYXJndW1lbnRzWzJdIDogdW5kZWZpbmVkOwogICAgdmFyIGZpcnN0Q2FsbCA9IHRydWU7CiAgICB2YXIgY2FjaGU7CiAgICByZXR1cm4gX2ZpbHRlcihldmVudCwgZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgIHZhciBzaG91bGRFbWl0ID0gZmlyc3RDYWxsIHx8ICFlcXVhbHModmFsdWUsIGNhY2hlKTsKICAgICAgZmlyc3RDYWxsID0gZmFsc2U7CiAgICAgIGNhY2hlID0gdmFsdWU7CiAgICAgIHJldHVybiBzaG91bGRFbWl0OwogICAgfSwgZGlzcG9zYWJsZSk7CiAgfQogIEV2ZW50LmxhdGNoID0gX2xhdGNoOwogIC8qKgogICAqICpOT1RFKiB0aGF0IHRoaXMgZnVuY3Rpb24gcmV0dXJucyBhbiBgRXZlbnRgIGFuZCBpdCBNVVNUIGJlIGNhbGxlZCB3aXRoIGEgYERpc3Bvc2FibGVTdG9yZWAgd2hlbmV2ZXIgdGhlIHJldHVybmVkCiAgICogZXZlbnQgaXMgYWNjZXNzaWJsZSB0byAidGhpcmQgcGFydGllcyIsIGUuZyB0aGUgZXZlbnQgaXMgYSBwdWJsaWMgcHJvcGVydHkuIE90aGVyd2lzZSBhIGxlYWtlZCBsaXN0ZW5lciBvbiB0aGUKICAgKiByZXR1cm5lZCBldmVudCBjYXVzZXMgdGhpcyB1dGlsaXR5IHRvIGxlYWsgYSBsaXN0ZW5lciBvbiB0aGUgb3JpZ2luYWwgZXZlbnQuCiAgICovCiAgZnVuY3Rpb24gc3BsaXQoZXZlbnQsIGlzVCwgZGlzcG9zYWJsZSkgewogICAgcmV0dXJuIFtFdmVudC5maWx0ZXIoZXZlbnQsIGlzVCwgZGlzcG9zYWJsZSksIEV2ZW50LmZpbHRlcihldmVudCwgZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuICFpc1QoZSk7CiAgICB9LCBkaXNwb3NhYmxlKV07CiAgfQogIEV2ZW50LnNwbGl0ID0gc3BsaXQ7CiAgLyoqCiAgICogKk5PVEUqIHRoYXQgdGhpcyBmdW5jdGlvbiByZXR1cm5zIGFuIGBFdmVudGAgYW5kIGl0IE1VU1QgYmUgY2FsbGVkIHdpdGggYSBgRGlzcG9zYWJsZVN0b3JlYCB3aGVuZXZlciB0aGUgcmV0dXJuZWQKICAgKiBldmVudCBpcyBhY2Nlc3NpYmxlIHRvICJ0aGlyZCBwYXJ0aWVzIiwgZS5nIHRoZSBldmVudCBpcyBhIHB1YmxpYyBwcm9wZXJ0eS4gT3RoZXJ3aXNlIGEgbGVha2VkIGxpc3RlbmVyIG9uIHRoZQogICAqIHJldHVybmVkIGV2ZW50IGNhdXNlcyB0aGlzIHV0aWxpdHkgdG8gbGVhayBhIGxpc3RlbmVyIG9uIHRoZSBvcmlnaW5hbCBldmVudC4KICAgKi8KICBmdW5jdGlvbiBidWZmZXIoZXZlbnQpIHsKICAgIHZhciBmbHVzaEFmdGVyVGltZW91dCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CiAgICB2YXIgX2J1ZmZlciA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogW107CiAgICB2YXIgYnVmZmVyID0gX2J1ZmZlci5zbGljZSgpOwogICAgdmFyIGxpc3RlbmVyID0gZXZlbnQoZnVuY3Rpb24gKGUpIHsKICAgICAgaWYgKGJ1ZmZlcikgewogICAgICAgIGJ1ZmZlci5wdXNoKGUpOwogICAgICB9IGVsc2UgewogICAgICAgIGVtaXR0ZXIuZmlyZShlKTsKICAgICAgfQogICAgfSk7CiAgICB2YXIgZmx1c2ggPSBmdW5jdGlvbiBmbHVzaCgpIHsKICAgICAgYnVmZmVyID09PSBudWxsIHx8IGJ1ZmZlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogYnVmZmVyLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gZW1pdHRlci5maXJlKGUpOwogICAgICB9KTsKICAgICAgYnVmZmVyID0gbnVsbDsKICAgIH07CiAgICB2YXIgZW1pdHRlciA9IG5ldyBFbWl0dGVyKHsKICAgICAgb25GaXJzdExpc3RlbmVyQWRkOiBmdW5jdGlvbiBvbkZpcnN0TGlzdGVuZXJBZGQoKSB7CiAgICAgICAgaWYgKCFsaXN0ZW5lcikgewogICAgICAgICAgbGlzdGVuZXIgPSBldmVudChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICByZXR1cm4gZW1pdHRlci5maXJlKGUpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBvbkZpcnN0TGlzdGVuZXJEaWRBZGQ6IGZ1bmN0aW9uIG9uRmlyc3RMaXN0ZW5lckRpZEFkZCgpIHsKICAgICAgICBpZiAoYnVmZmVyKSB7CiAgICAgICAgICBpZiAoZmx1c2hBZnRlclRpbWVvdXQpIHsKICAgICAgICAgICAgc2V0VGltZW91dChmbHVzaCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmbHVzaCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgb25MYXN0TGlzdGVuZXJSZW1vdmU6IGZ1bmN0aW9uIG9uTGFzdExpc3RlbmVyUmVtb3ZlKCkgewogICAgICAgIGlmIChsaXN0ZW5lcikgewogICAgICAgICAgbGlzdGVuZXIuZGlzcG9zZSgpOwogICAgICAgIH0KICAgICAgICBsaXN0ZW5lciA9IG51bGw7CiAgICAgIH0KICAgIH0pOwogICAgcmV0dXJuIGVtaXR0ZXIuZXZlbnQ7CiAgfQogIEV2ZW50LmJ1ZmZlciA9IGJ1ZmZlcjsKICB2YXIgQ2hhaW5hYmxlRXZlbnQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gQ2hhaW5hYmxlRXZlbnQoZXZlbnQpIHsKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENoYWluYWJsZUV2ZW50KTsKICAgICAgdGhpcy5ldmVudCA9IGV2ZW50OwogICAgICB0aGlzLmRpc3Bvc2FibGVzID0gbmV3IERpc3Bvc2FibGVTdG9yZSgpOwogICAgfQogICAgX2NyZWF0ZUNsYXNzKENoYWluYWJsZUV2ZW50LCBbewogICAgICBrZXk6ICJtYXAiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gbWFwKGZuKSB7CiAgICAgICAgcmV0dXJuIG5ldyBDaGFpbmFibGVFdmVudChfbWFwKHRoaXMuZXZlbnQsIGZuLCB0aGlzLmRpc3Bvc2FibGVzKSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZm9yRWFjaCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBmb3JFYWNoKGZuKSB7CiAgICAgICAgcmV0dXJuIG5ldyBDaGFpbmFibGVFdmVudChfZm9yRWFjaCh0aGlzLmV2ZW50LCBmbiwgdGhpcy5kaXNwb3NhYmxlcykpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImZpbHRlciIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBmaWx0ZXIoZm4pIHsKICAgICAgICByZXR1cm4gbmV3IENoYWluYWJsZUV2ZW50KF9maWx0ZXIodGhpcy5ldmVudCwgZm4sIHRoaXMuZGlzcG9zYWJsZXMpKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJyZWR1Y2UiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcmVkdWNlKG1lcmdlLCBpbml0aWFsKSB7CiAgICAgICAgcmV0dXJuIG5ldyBDaGFpbmFibGVFdmVudChfcmVkdWNlKHRoaXMuZXZlbnQsIG1lcmdlLCBpbml0aWFsLCB0aGlzLmRpc3Bvc2FibGVzKSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAibGF0Y2giLAogICAgICB2YWx1ZTogZnVuY3Rpb24gbGF0Y2goKSB7CiAgICAgICAgcmV0dXJuIG5ldyBDaGFpbmFibGVFdmVudChfbGF0Y2godGhpcy5ldmVudCwgdW5kZWZpbmVkLCB0aGlzLmRpc3Bvc2FibGVzKSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZGVib3VuY2UiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZGVib3VuY2UobWVyZ2UpIHsKICAgICAgICB2YXIgZGVsYXkgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IDEwMDsKICAgICAgICB2YXIgbGVhZGluZyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CiAgICAgICAgdmFyIGxlYWtXYXJuaW5nVGhyZXNob2xkID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgPyBhcmd1bWVudHNbM10gOiB1bmRlZmluZWQ7CiAgICAgICAgcmV0dXJuIG5ldyBDaGFpbmFibGVFdmVudChfZGVib3VuY2UodGhpcy5ldmVudCwgbWVyZ2UsIGRlbGF5LCBsZWFkaW5nLCBsZWFrV2FybmluZ1RocmVzaG9sZCwgdGhpcy5kaXNwb3NhYmxlcykpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogIm9uIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uKGxpc3RlbmVyLCB0aGlzQXJncywgZGlzcG9zYWJsZXMpIHsKICAgICAgICByZXR1cm4gdGhpcy5ldmVudChsaXN0ZW5lciwgdGhpc0FyZ3MsIGRpc3Bvc2FibGVzKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJvbmNlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uY2UobGlzdGVuZXIsIHRoaXNBcmdzLCBkaXNwb3NhYmxlcykgewogICAgICAgIHJldHVybiBfb25jZSh0aGlzLmV2ZW50KShsaXN0ZW5lciwgdGhpc0FyZ3MsIGRpc3Bvc2FibGVzKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJkaXNwb3NlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7CiAgICAgICAgdGhpcy5kaXNwb3NhYmxlcy5kaXNwb3NlKCk7CiAgICAgIH0KICAgIH1dKTsKICAgIHJldHVybiBDaGFpbmFibGVFdmVudDsKICB9KCk7CiAgZnVuY3Rpb24gY2hhaW4oZXZlbnQpIHsKICAgIHJldHVybiBuZXcgQ2hhaW5hYmxlRXZlbnQoZXZlbnQpOwogIH0KICBFdmVudC5jaGFpbiA9IGNoYWluOwogIGZ1bmN0aW9uIGZyb21Ob2RlRXZlbnRFbWl0dGVyKGVtaXR0ZXIsIGV2ZW50TmFtZSkgewogICAgdmFyIG1hcCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZnVuY3Rpb24gKGlkKSB7CiAgICAgIHJldHVybiBpZDsKICAgIH07CiAgICB2YXIgZm4gPSBmdW5jdGlvbiBmbigpIHsKICAgICAgcmV0dXJuIHJlc3VsdC5maXJlKG1hcC5hcHBseSh2b2lkIDAsIGFyZ3VtZW50cykpOwogICAgfTsKICAgIHZhciBvbkZpcnN0TGlzdGVuZXJBZGQgPSBmdW5jdGlvbiBvbkZpcnN0TGlzdGVuZXJBZGQoKSB7CiAgICAgIHJldHVybiBlbWl0dGVyLm9uKGV2ZW50TmFtZSwgZm4pOwogICAgfTsKICAgIHZhciBvbkxhc3RMaXN0ZW5lclJlbW92ZSA9IGZ1bmN0aW9uIG9uTGFzdExpc3RlbmVyUmVtb3ZlKCkgewogICAgICByZXR1cm4gZW1pdHRlci5yZW1vdmVMaXN0ZW5lcihldmVudE5hbWUsIGZuKTsKICAgIH07CiAgICB2YXIgcmVzdWx0ID0gbmV3IEVtaXR0ZXIoewogICAgICBvbkZpcnN0TGlzdGVuZXJBZGQ6IG9uRmlyc3RMaXN0ZW5lckFkZCwKICAgICAgb25MYXN0TGlzdGVuZXJSZW1vdmU6IG9uTGFzdExpc3RlbmVyUmVtb3ZlCiAgICB9KTsKICAgIHJldHVybiByZXN1bHQuZXZlbnQ7CiAgfQogIEV2ZW50LmZyb21Ob2RlRXZlbnRFbWl0dGVyID0gZnJvbU5vZGVFdmVudEVtaXR0ZXI7CiAgZnVuY3Rpb24gZnJvbURPTUV2ZW50RW1pdHRlcihlbWl0dGVyLCBldmVudE5hbWUpIHsKICAgIHZhciBtYXAgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IGZ1bmN0aW9uIChpZCkgewogICAgICByZXR1cm4gaWQ7CiAgICB9OwogICAgdmFyIGZuID0gZnVuY3Rpb24gZm4oKSB7CiAgICAgIHJldHVybiByZXN1bHQuZmlyZShtYXAuYXBwbHkodm9pZCAwLCBhcmd1bWVudHMpKTsKICAgIH07CiAgICB2YXIgb25GaXJzdExpc3RlbmVyQWRkID0gZnVuY3Rpb24gb25GaXJzdExpc3RlbmVyQWRkKCkgewogICAgICByZXR1cm4gZW1pdHRlci5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgZm4pOwogICAgfTsKICAgIHZhciBvbkxhc3RMaXN0ZW5lclJlbW92ZSA9IGZ1bmN0aW9uIG9uTGFzdExpc3RlbmVyUmVtb3ZlKCkgewogICAgICByZXR1cm4gZW1pdHRlci5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgZm4pOwogICAgfTsKICAgIHZhciByZXN1bHQgPSBuZXcgRW1pdHRlcih7CiAgICAgIG9uRmlyc3RMaXN0ZW5lckFkZDogb25GaXJzdExpc3RlbmVyQWRkLAogICAgICBvbkxhc3RMaXN0ZW5lclJlbW92ZTogb25MYXN0TGlzdGVuZXJSZW1vdmUKICAgIH0pOwogICAgcmV0dXJuIHJlc3VsdC5ldmVudDsKICB9CiAgRXZlbnQuZnJvbURPTUV2ZW50RW1pdHRlciA9IGZyb21ET01FdmVudEVtaXR0ZXI7CiAgZnVuY3Rpb24gdG9Qcm9taXNlKGV2ZW50KSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgcmV0dXJuIF9vbmNlKGV2ZW50KShyZXNvbHZlKTsKICAgIH0pOwogIH0KICBFdmVudC50b1Byb21pc2UgPSB0b1Byb21pc2U7CiAgZnVuY3Rpb24gcnVuQW5kU3Vic2NyaWJlKGV2ZW50LCBoYW5kbGVyKSB7CiAgICBoYW5kbGVyKHVuZGVmaW5lZCk7CiAgICByZXR1cm4gZXZlbnQoZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuIGhhbmRsZXIoZSk7CiAgICB9KTsKICB9CiAgRXZlbnQucnVuQW5kU3Vic2NyaWJlID0gcnVuQW5kU3Vic2NyaWJlOwogIGZ1bmN0aW9uIHJ1bkFuZFN1YnNjcmliZVdpdGhTdG9yZShldmVudCwgaGFuZGxlcikgewogICAgdmFyIHN0b3JlID0gbnVsbDsKICAgIGZ1bmN0aW9uIHJ1bihlKSB7CiAgICAgIHN0b3JlID09PSBudWxsIHx8IHN0b3JlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdG9yZS5kaXNwb3NlKCk7CiAgICAgIHN0b3JlID0gbmV3IERpc3Bvc2FibGVTdG9yZSgpOwogICAgICBoYW5kbGVyKGUsIHN0b3JlKTsKICAgIH0KICAgIHJ1bih1bmRlZmluZWQpOwogICAgdmFyIGRpc3Bvc2FibGUgPSBldmVudChmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gcnVuKGUpOwogICAgfSk7CiAgICByZXR1cm4gdG9EaXNwb3NhYmxlKGZ1bmN0aW9uICgpIHsKICAgICAgZGlzcG9zYWJsZS5kaXNwb3NlKCk7CiAgICAgIHN0b3JlID09PSBudWxsIHx8IHN0b3JlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdG9yZS5kaXNwb3NlKCk7CiAgICB9KTsKICB9CiAgRXZlbnQucnVuQW5kU3Vic2NyaWJlV2l0aFN0b3JlID0gcnVuQW5kU3Vic2NyaWJlV2l0aFN0b3JlOwogIHZhciBFbWl0dGVyT2JzZXJ2ZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gRW1pdHRlck9ic2VydmVyKG9icywgc3RvcmUpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEVtaXR0ZXJPYnNlcnZlcik7CiAgICAgIHRoaXMub2JzID0gb2JzOwogICAgICB0aGlzLl9jb3VudGVyID0gMDsKICAgICAgdGhpcy5faGFzQ2hhbmdlZCA9IGZhbHNlOwogICAgICB2YXIgb3B0aW9ucyA9IHsKICAgICAgICBvbkZpcnN0TGlzdGVuZXJBZGQ6IGZ1bmN0aW9uIG9uRmlyc3RMaXN0ZW5lckFkZCgpIHsKICAgICAgICAgIG9icy5hZGRPYnNlcnZlcihfdGhpcyk7CiAgICAgICAgfSwKICAgICAgICBvbkxhc3RMaXN0ZW5lclJlbW92ZTogZnVuY3Rpb24gb25MYXN0TGlzdGVuZXJSZW1vdmUoKSB7CiAgICAgICAgICBvYnMucmVtb3ZlT2JzZXJ2ZXIoX3RoaXMpOwogICAgICAgIH0KICAgICAgfTsKICAgICAgaWYgKCFzdG9yZSkgewogICAgICAgIF9hZGRMZWFrYWdlVHJhY2VMb2dpYyhvcHRpb25zKTsKICAgICAgfQogICAgICB0aGlzLmVtaXR0ZXIgPSBuZXcgRW1pdHRlcihvcHRpb25zKTsKICAgICAgaWYgKHN0b3JlKSB7CiAgICAgICAgc3RvcmUuYWRkKHRoaXMuZW1pdHRlcik7CiAgICAgIH0KICAgIH0KICAgIF9jcmVhdGVDbGFzcyhFbWl0dGVyT2JzZXJ2ZXIsIFt7CiAgICAgIGtleTogImJlZ2luVXBkYXRlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGJlZ2luVXBkYXRlKF9vYnNlcnZhYmxlKSB7CiAgICAgICAgLy8gY29uc29sZS5hc3NlcnQoX29ic2VydmFibGUgPT09IHRoaXMub2JzKTsKICAgICAgICB0aGlzLl9jb3VudGVyKys7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiaGFuZGxlQ2hhbmdlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZUNoYW5nZShfb2JzZXJ2YWJsZSwgX2NoYW5nZSkgewogICAgICAgIHRoaXMuX2hhc0NoYW5nZWQgPSB0cnVlOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImVuZFVwZGF0ZSIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBlbmRVcGRhdGUoX29ic2VydmFibGUpIHsKICAgICAgICBpZiAoLS10aGlzLl9jb3VudGVyID09PSAwKSB7CiAgICAgICAgICBpZiAodGhpcy5faGFzQ2hhbmdlZCkgewogICAgICAgICAgICB0aGlzLl9oYXNDaGFuZ2VkID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMuZW1pdHRlci5maXJlKHRoaXMub2JzLmdldCgpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH1dKTsKICAgIHJldHVybiBFbWl0dGVyT2JzZXJ2ZXI7CiAgfSgpOwogIGZ1bmN0aW9uIGZyb21PYnNlcnZhYmxlKG9icywgc3RvcmUpIHsKICAgIHZhciBvYnNlcnZlciA9IG5ldyBFbWl0dGVyT2JzZXJ2ZXIob2JzLCBzdG9yZSk7CiAgICByZXR1cm4gb2JzZXJ2ZXIuZW1pdHRlci5ldmVudDsKICB9CiAgRXZlbnQuZnJvbU9ic2VydmFibGUgPSBmcm9tT2JzZXJ2YWJsZTsKfSkoRXZlbnQgfHwgKEV2ZW50ID0ge30pKTsKdmFyIEV2ZW50UHJvZmlsaW5nID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBFdmVudFByb2ZpbGluZyhuYW1lKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRXZlbnRQcm9maWxpbmcpOwogICAgdGhpcy5fbGlzdGVuZXJDb3VudCA9IDA7CiAgICB0aGlzLl9pbnZvY2F0aW9uQ291bnQgPSAwOwogICAgdGhpcy5fZWxhcHNlZE92ZXJhbGwgPSAwOwogICAgdGhpcy5fbmFtZSA9ICIiLmNvbmNhdChuYW1lLCAiXyIpLmNvbmNhdChFdmVudFByb2ZpbGluZy5faWRQb29sKyspOwogIH0KICBfY3JlYXRlQ2xhc3MoRXZlbnRQcm9maWxpbmcsIFt7CiAgICBrZXk6ICJzdGFydCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc3RhcnQobGlzdGVuZXJDb3VudCkgewogICAgICB0aGlzLl9zdG9wV2F0Y2ggPSBuZXcgU3RvcFdhdGNoKHRydWUpOwogICAgICB0aGlzLl9saXN0ZW5lckNvdW50ID0gbGlzdGVuZXJDb3VudDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzdG9wIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzdG9wKCkgewogICAgICBpZiAodGhpcy5fc3RvcFdhdGNoKSB7CiAgICAgICAgdmFyIGVsYXBzZWQgPSB0aGlzLl9zdG9wV2F0Y2guZWxhcHNlZCgpOwogICAgICAgIHRoaXMuX2VsYXBzZWRPdmVyYWxsICs9IGVsYXBzZWQ7CiAgICAgICAgdGhpcy5faW52b2NhdGlvbkNvdW50ICs9IDE7CiAgICAgICAgY29uc29sZS5pbmZvKCJkaWQgRklSRSAiLmNvbmNhdCh0aGlzLl9uYW1lLCAiOiBlbGFwc2VkX21zOiAiKS5jb25jYXQoZWxhcHNlZC50b0ZpeGVkKDUpLCAiLCBsaXN0ZW5lcjogIikuY29uY2F0KHRoaXMuX2xpc3RlbmVyQ291bnQsICIgKGVsYXBzZWRfb3ZlcmFsbDogIikuY29uY2F0KHRoaXMuX2VsYXBzZWRPdmVyYWxsLnRvRml4ZWQoMiksICIsIGludm9jYXRpb25zOiAiKS5jb25jYXQodGhpcy5faW52b2NhdGlvbkNvdW50LCAiKSIpKTsKICAgICAgICB0aGlzLl9zdG9wV2F0Y2ggPSB1bmRlZmluZWQ7CiAgICAgIH0KICAgIH0KICB9XSk7CiAgcmV0dXJuIEV2ZW50UHJvZmlsaW5nOwp9KCk7CkV2ZW50UHJvZmlsaW5nLl9pZFBvb2wgPSAwOwp2YXIgX2dsb2JhbExlYWtXYXJuaW5nVGhyZXNob2xkID0gLTE7CnZhciBMZWFrYWdlTW9uaXRvciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gTGVha2FnZU1vbml0b3IoY3VzdG9tVGhyZXNob2xkKSB7CiAgICB2YXIgbmFtZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogTWF0aC5yYW5kb20oKS50b1N0cmluZygxOCkuc2xpY2UoMiwgNSk7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTGVha2FnZU1vbml0b3IpOwogICAgdGhpcy5jdXN0b21UaHJlc2hvbGQgPSBjdXN0b21UaHJlc2hvbGQ7CiAgICB0aGlzLm5hbWUgPSBuYW1lOwogICAgdGhpcy5fd2FybkNvdW50ZG93biA9IDA7CiAgfQogIF9jcmVhdGVDbGFzcyhMZWFrYWdlTW9uaXRvciwgW3sKICAgIGtleTogImRpc3Bvc2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7CiAgICAgIGlmICh0aGlzLl9zdGFja3MpIHsKICAgICAgICB0aGlzLl9zdGFja3MuY2xlYXIoKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImNoZWNrIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjaGVjayhzdGFjaywgbGlzdGVuZXJDb3VudCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgICAgdmFyIHRocmVzaG9sZCA9IF9nbG9iYWxMZWFrV2FybmluZ1RocmVzaG9sZDsKICAgICAgaWYgKHR5cGVvZiB0aGlzLmN1c3RvbVRocmVzaG9sZCA9PT0gJ251bWJlcicpIHsKICAgICAgICB0aHJlc2hvbGQgPSB0aGlzLmN1c3RvbVRocmVzaG9sZDsKICAgICAgfQogICAgICBpZiAodGhyZXNob2xkIDw9IDAgfHwgbGlzdGVuZXJDb3VudCA8IHRocmVzaG9sZCkgewogICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgIH0KICAgICAgaWYgKCF0aGlzLl9zdGFja3MpIHsKICAgICAgICB0aGlzLl9zdGFja3MgPSBuZXcgTWFwKCk7CiAgICAgIH0KICAgICAgdmFyIGNvdW50ID0gdGhpcy5fc3RhY2tzLmdldChzdGFjay52YWx1ZSkgfHwgMDsKICAgICAgdGhpcy5fc3RhY2tzLnNldChzdGFjay52YWx1ZSwgY291bnQgKyAxKTsKICAgICAgdGhpcy5fd2FybkNvdW50ZG93biAtPSAxOwogICAgICBpZiAodGhpcy5fd2FybkNvdW50ZG93biA8PSAwKSB7CiAgICAgICAgLy8gb25seSB3YXJuIG9uIGZpcnN0IGV4Y2VlZCBhbmQgdGhlbiBldmVyeSB0aW1lIHRoZSBsaW1pdAogICAgICAgIC8vIGlzIGV4Y2VlZGVkIGJ5IDUwJSBhZ2FpbgogICAgICAgIHRoaXMuX3dhcm5Db3VudGRvd24gPSB0aHJlc2hvbGQgKiAwLjU7CiAgICAgICAgLy8gZmluZCBtb3N0IGZyZXF1ZW50IGxpc3RlbmVyIGFuZCBwcmludCB3YXJuaW5nCiAgICAgICAgdmFyIHRvcFN0YWNrOwogICAgICAgIHZhciB0b3BDb3VudCA9IDA7CiAgICAgICAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHRoaXMuX3N0YWNrcyksCiAgICAgICAgICBfc3RlcDsKICAgICAgICB0cnkgewogICAgICAgICAgZm9yIChfaXRlcmF0b3IucygpOyAhKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgdmFyIF9zdGVwJHZhbHVlID0gX3NsaWNlZFRvQXJyYXkoX3N0ZXAudmFsdWUsIDIpLAogICAgICAgICAgICAgIF9zdGFjayA9IF9zdGVwJHZhbHVlWzBdLAogICAgICAgICAgICAgIF9jb3VudCA9IF9zdGVwJHZhbHVlWzFdOwogICAgICAgICAgICBpZiAoIXRvcFN0YWNrIHx8IHRvcENvdW50IDwgX2NvdW50KSB7CiAgICAgICAgICAgICAgdG9wU3RhY2sgPSBfc3RhY2s7CiAgICAgICAgICAgICAgdG9wQ291bnQgPSBfY291bnQ7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIF9pdGVyYXRvci5lKGVycik7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIF9pdGVyYXRvci5mKCk7CiAgICAgICAgfQogICAgICAgIGNvbnNvbGUud2FybigiWyIuY29uY2F0KHRoaXMubmFtZSwgIl0gcG90ZW50aWFsIGxpc3RlbmVyIExFQUsgZGV0ZWN0ZWQsIGhhdmluZyAiKS5jb25jYXQobGlzdGVuZXJDb3VudCwgIiBsaXN0ZW5lcnMgYWxyZWFkeS4gTU9TVCBmcmVxdWVudCBsaXN0ZW5lciAoIikuY29uY2F0KHRvcENvdW50LCAiKToiKSk7CiAgICAgICAgY29uc29sZS53YXJuKHRvcFN0YWNrKTsKICAgICAgfQogICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBjb3VudCA9IF90aGlzMi5fc3RhY2tzLmdldChzdGFjay52YWx1ZSkgfHwgMDsKICAgICAgICBfdGhpczIuX3N0YWNrcy5zZXQoc3RhY2sudmFsdWUsIGNvdW50IC0gMSk7CiAgICAgIH07CiAgICB9CiAgfV0pOwogIHJldHVybiBMZWFrYWdlTW9uaXRvcjsKfSgpOwp2YXIgU3RhY2t0cmFjZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gU3RhY2t0cmFjZSh2YWx1ZSkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFN0YWNrdHJhY2UpOwogICAgdGhpcy52YWx1ZSA9IHZhbHVlOwogIH0KICBfY3JlYXRlQ2xhc3MoU3RhY2t0cmFjZSwgW3sKICAgIGtleTogInByaW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBwcmludCgpIHsKICAgICAgY29uc29sZS53YXJuKHRoaXMudmFsdWUuc3BsaXQoJ1xuJykuc2xpY2UoMikuam9pbignXG4nKSk7CiAgICB9CiAgfV0sIFt7CiAgICBrZXk6ICJjcmVhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZSgpIHsKICAgICAgdmFyIF9hOwogICAgICByZXR1cm4gbmV3IFN0YWNrdHJhY2UoKF9hID0gbmV3IEVycm9yKCkuc3RhY2spICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6ICcnKTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIFN0YWNrdHJhY2U7Cn0oKTsKdmFyIExpc3RlbmVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBMaXN0ZW5lcihjYWxsYmFjaywgY2FsbGJhY2tUaGlzLCBzdGFjaykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIExpc3RlbmVyKTsKICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjazsKICAgIHRoaXMuY2FsbGJhY2tUaGlzID0gY2FsbGJhY2tUaGlzOwogICAgdGhpcy5zdGFjayA9IHN0YWNrOwogICAgdGhpcy5zdWJzY3JpcHRpb24gPSBuZXcgU2FmZURpc3Bvc2FibGUoKTsKICB9CiAgX2NyZWF0ZUNsYXNzKExpc3RlbmVyLCBbewogICAga2V5OiAiaW52b2tlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpbnZva2UoZSkgewogICAgICB0aGlzLmNhbGxiYWNrLmNhbGwodGhpcy5jYWxsYmFja1RoaXMsIGUpOwogICAgfQogIH1dKTsKICByZXR1cm4gTGlzdGVuZXI7Cn0oKTsKLyoqCiAqIFRoZSBFbWl0dGVyIGNhbiBiZSB1c2VkIHRvIGV4cG9zZSBhbiBFdmVudCB0byB0aGUgcHVibGljCiAqIHRvIGZpcmUgaXQgZnJvbSB0aGUgaW5zaWRlcy4KICogU2FtcGxlOgogICAgY2xhc3MgRG9jdW1lbnQgewoKICAgICAgICBwcml2YXRlIHJlYWRvbmx5IF9vbkRpZENoYW5nZSA9IG5ldyBFbWl0dGVyPCh2YWx1ZTpzdHJpbmcpPT5hbnk+KCk7CgogICAgICAgIHB1YmxpYyBvbkRpZENoYW5nZSA9IHRoaXMuX29uRGlkQ2hhbmdlLmV2ZW50OwoKICAgICAgICAvLyBnZXR0ZXItc3R5bGUKICAgICAgICAvLyBnZXQgb25EaWRDaGFuZ2UoKTogRXZlbnQ8KHZhbHVlOnN0cmluZyk9PmFueT4gewogICAgICAgIC8vIAlyZXR1cm4gdGhpcy5fb25EaWRDaGFuZ2UuZXZlbnQ7CiAgICAgICAgLy8gfQoKICAgICAgICBwcml2YXRlIF9kb0l0KCkgewogICAgICAgICAgICAvLy4uLgogICAgICAgICAgICB0aGlzLl9vbkRpZENoYW5nZS5maXJlKHZhbHVlKTsKICAgICAgICB9CiAgICB9CiAqLwpleHBvcnQgdmFyIEVtaXR0ZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEVtaXR0ZXIob3B0aW9ucykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEVtaXR0ZXIpOwogICAgdmFyIF9hLCBfYjsKICAgIHRoaXMuX2Rpc3Bvc2VkID0gZmFsc2U7CiAgICB0aGlzLl9vcHRpb25zID0gb3B0aW9uczsKICAgIHRoaXMuX2xlYWthZ2VNb24gPSBfZ2xvYmFsTGVha1dhcm5pbmdUaHJlc2hvbGQgPiAwID8gbmV3IExlYWthZ2VNb25pdG9yKHRoaXMuX29wdGlvbnMgJiYgdGhpcy5fb3B0aW9ucy5sZWFrV2FybmluZ1RocmVzaG9sZCkgOiB1bmRlZmluZWQ7CiAgICB0aGlzLl9wZXJmTW9uID0gKChfYSA9IHRoaXMuX29wdGlvbnMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5fcHJvZk5hbWUpID8gbmV3IEV2ZW50UHJvZmlsaW5nKHRoaXMuX29wdGlvbnMuX3Byb2ZOYW1lKSA6IHVuZGVmaW5lZDsKICAgIHRoaXMuX2RlbGl2ZXJ5UXVldWUgPSAoX2IgPSB0aGlzLl9vcHRpb25zKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuZGVsaXZlcnlRdWV1ZTsKICB9CiAgX2NyZWF0ZUNsYXNzKEVtaXR0ZXIsIFt7CiAgICBrZXk6ICJkaXNwb3NlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNwb3NlKCkgewogICAgICB2YXIgX2EsIF9iLCBfYywgX2Q7CiAgICAgIGlmICghdGhpcy5fZGlzcG9zZWQpIHsKICAgICAgICB0aGlzLl9kaXNwb3NlZCA9IHRydWU7CiAgICAgICAgLy8gSXQgaXMgYmFkIHRvIGhhdmUgbGlzdGVuZXJzIGF0IHRoZSB0aW1lIG9mIGRpc3Bvc2luZyBhbiBlbWl0dGVyLCBpdCBpcyB3b3JzdCB0byBoYXZlIGxpc3RlbmVycyBrZWVwIHRoZSBlbWl0dGVyCiAgICAgICAgLy8gYWxpdmUgdmlhIHRoZSByZWZlcmVuY2UgdGhhdCdzIGVtYmVkZGVkIGluIHRoZWlyIGRpc3Bvc2FibGVzLiBUaGVyZWZvcmUgd2UgbG9vcCBvdmVyIGFsbCByZW1haW5pbmcgbGlzdGVuZXJzIGFuZAogICAgICAgIC8vIHVuc2V0IHRoZWlyIHN1YnNjcmlwdGlvbnMvZGlzcG9zYWJsZXMuIExvb3BpbmcgYW5kIGJsYW1pbmcgcmVtYWluaW5nIGxpc3RlbmVycyBpcyBkb25lIG9uIG5leHQgdGljayBiZWNhdXNlIHRoZQogICAgICAgIC8vIHRoZSBmb2xsb3dpbmcgcHJvZ3JhbW1pbmcgcGF0dGVybiBpcyB2ZXJ5IHBvcHVsYXI6CiAgICAgICAgLy8KICAgICAgICAvLyBjb25zdCBzb21lTW9kZWwgPSB0aGlzLl9kaXNwb3NhYmxlcy5hZGQobmV3IE1vZGVsT2JqZWN0KCkpOyAvLyAoMSkgY3JlYXRlIGFuZCByZWdpc3RlciBtb2RlbAogICAgICAgIC8vIHRoaXMuX2Rpc3Bvc2FibGVzLmFkZChzb21lTW9kZWwub25EaWRDaGFuZ2UoKCkgPT4geyAuLi4gfSk7IC8vICgyKSBzdWJzY3JpYmUgYW5kIHJlZ2lzdGVyIG1vZGVsLWV2ZW50IGxpc3RlbmVyCiAgICAgICAgLy8gLi4ubGF0ZXIuLi4KICAgICAgICAvLyB0aGlzLl9kaXNwb3NhYmxlcy5kaXNwb3NlKCk7IGRpc3Bvc2VzICgxKSB0aGVuICgyKTogZG9uJ3Qgd2FybiBhZnRlciAoMSkgYnV0IGFmdGVyIHRoZSAib3ZlcmFsbCBkaXNwb3NlIiBpcyBkb25lCiAgICAgICAgaWYgKHRoaXMuX2xpc3RlbmVycykgewogICAgICAgICAgaWYgKF9lbmFibGVEaXNwb3NlV2l0aExpc3RlbmVyV2FybmluZykgewogICAgICAgICAgICB2YXIgbGlzdGVuZXJzID0gQXJyYXkuZnJvbSh0aGlzLl9saXN0ZW5lcnMpOwogICAgICAgICAgICBxdWV1ZU1pY3JvdGFzayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgdmFyIF9hOwogICAgICAgICAgICAgIHZhciBfaXRlcmF0b3IyID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIobGlzdGVuZXJzKSwKICAgICAgICAgICAgICAgIF9zdGVwMjsKICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgZm9yIChfaXRlcmF0b3IyLnMoKTsgIShfc3RlcDIgPSBfaXRlcmF0b3IyLm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgICAgICAgdmFyIGxpc3RlbmVyID0gX3N0ZXAyLnZhbHVlOwogICAgICAgICAgICAgICAgICBpZiAobGlzdGVuZXIuc3Vic2NyaXB0aW9uLmlzc2V0KCkpIHsKICAgICAgICAgICAgICAgICAgICBsaXN0ZW5lci5zdWJzY3JpcHRpb24udW5zZXQoKTsKICAgICAgICAgICAgICAgICAgICAoX2EgPSBsaXN0ZW5lci5zdGFjaykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnByaW50KCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgIF9pdGVyYXRvcjIuZShlcnIpOwogICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICBfaXRlcmF0b3IyLmYoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5fbGlzdGVuZXJzLmNsZWFyKCk7CiAgICAgICAgfQogICAgICAgIChfYSA9IHRoaXMuX2RlbGl2ZXJ5UXVldWUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5jbGVhcih0aGlzKTsKICAgICAgICAoX2MgPSAoX2IgPSB0aGlzLl9vcHRpb25zKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Iub25MYXN0TGlzdGVuZXJSZW1vdmUpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5jYWxsKF9iKTsKICAgICAgICAoX2QgPSB0aGlzLl9sZWFrYWdlTW9uKSA9PT0gbnVsbCB8fCBfZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2QuZGlzcG9zZSgpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEZvciB0aGUgcHVibGljIHRvIGFsbG93IHRvIHN1YnNjcmliZQogICAgICogdG8gZXZlbnRzIGZyb20gdGhpcyBFbWl0dGVyCiAgICAgKi8KICB9LCB7CiAgICBrZXk6ICJldmVudCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIGlmICghdGhpcy5fZXZlbnQpIHsKICAgICAgICB0aGlzLl9ldmVudCA9IGZ1bmN0aW9uIChjYWxsYmFjaywgdGhpc0FyZ3MsIGRpc3Bvc2FibGVzKSB7CiAgICAgICAgICB2YXIgX2EsIF9iLCBfYzsKICAgICAgICAgIGlmICghX3RoaXMzLl9saXN0ZW5lcnMpIHsKICAgICAgICAgICAgX3RoaXMzLl9saXN0ZW5lcnMgPSBuZXcgTGlua2VkTGlzdCgpOwogICAgICAgICAgfQogICAgICAgICAgdmFyIGZpcnN0TGlzdGVuZXIgPSBfdGhpczMuX2xpc3RlbmVycy5pc0VtcHR5KCk7CiAgICAgICAgICBpZiAoZmlyc3RMaXN0ZW5lciAmJiAoKF9hID0gX3RoaXMzLl9vcHRpb25zKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Eub25GaXJzdExpc3RlbmVyQWRkKSkgewogICAgICAgICAgICBfdGhpczMuX29wdGlvbnMub25GaXJzdExpc3RlbmVyQWRkKF90aGlzMyk7CiAgICAgICAgICB9CiAgICAgICAgICB2YXIgcmVtb3ZlTW9uaXRvcjsKICAgICAgICAgIHZhciBzdGFjazsKICAgICAgICAgIGlmIChfdGhpczMuX2xlYWthZ2VNb24gJiYgX3RoaXMzLl9saXN0ZW5lcnMuc2l6ZSA+PSAzMCkgewogICAgICAgICAgICAvLyBjaGVjayBhbmQgcmVjb3JkIHRoaXMgZW1pdHRlciBmb3IgcG90ZW50aWFsIGxlYWthZ2UKICAgICAgICAgICAgc3RhY2sgPSBTdGFja3RyYWNlLmNyZWF0ZSgpOwogICAgICAgICAgICByZW1vdmVNb25pdG9yID0gX3RoaXMzLl9sZWFrYWdlTW9uLmNoZWNrKHN0YWNrLCBfdGhpczMuX2xpc3RlbmVycy5zaXplICsgMSk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoX2VuYWJsZURpc3Bvc2VXaXRoTGlzdGVuZXJXYXJuaW5nKSB7CiAgICAgICAgICAgIHN0YWNrID0gc3RhY2sgIT09IG51bGwgJiYgc3RhY2sgIT09IHZvaWQgMCA/IHN0YWNrIDogU3RhY2t0cmFjZS5jcmVhdGUoKTsKICAgICAgICAgIH0KICAgICAgICAgIHZhciBsaXN0ZW5lciA9IG5ldyBMaXN0ZW5lcihjYWxsYmFjaywgdGhpc0FyZ3MsIHN0YWNrKTsKICAgICAgICAgIHZhciByZW1vdmVMaXN0ZW5lciA9IF90aGlzMy5fbGlzdGVuZXJzLnB1c2gobGlzdGVuZXIpOwogICAgICAgICAgaWYgKGZpcnN0TGlzdGVuZXIgJiYgKChfYiA9IF90aGlzMy5fb3B0aW9ucykgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLm9uRmlyc3RMaXN0ZW5lckRpZEFkZCkpIHsKICAgICAgICAgICAgX3RoaXMzLl9vcHRpb25zLm9uRmlyc3RMaXN0ZW5lckRpZEFkZChfdGhpczMpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKChfYyA9IF90aGlzMy5fb3B0aW9ucykgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLm9uTGlzdGVuZXJEaWRBZGQpIHsKICAgICAgICAgICAgX3RoaXMzLl9vcHRpb25zLm9uTGlzdGVuZXJEaWRBZGQoX3RoaXMzLCBjYWxsYmFjaywgdGhpc0FyZ3MpOwogICAgICAgICAgfQogICAgICAgICAgdmFyIHJlc3VsdCA9IGxpc3RlbmVyLnN1YnNjcmlwdGlvbi5zZXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZW1vdmVNb25pdG9yID09PSBudWxsIHx8IHJlbW92ZU1vbml0b3IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHJlbW92ZU1vbml0b3IoKTsKICAgICAgICAgICAgaWYgKCFfdGhpczMuX2Rpc3Bvc2VkKSB7CiAgICAgICAgICAgICAgcmVtb3ZlTGlzdGVuZXIoKTsKICAgICAgICAgICAgICBpZiAoX3RoaXMzLl9vcHRpb25zICYmIF90aGlzMy5fb3B0aW9ucy5vbkxhc3RMaXN0ZW5lclJlbW92ZSkgewogICAgICAgICAgICAgICAgdmFyIGhhc0xpc3RlbmVycyA9IF90aGlzMy5fbGlzdGVuZXJzICYmICFfdGhpczMuX2xpc3RlbmVycy5pc0VtcHR5KCk7CiAgICAgICAgICAgICAgICBpZiAoIWhhc0xpc3RlbmVycykgewogICAgICAgICAgICAgICAgICBfdGhpczMuX29wdGlvbnMub25MYXN0TGlzdGVuZXJSZW1vdmUoX3RoaXMzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgaWYgKGRpc3Bvc2FibGVzIGluc3RhbmNlb2YgRGlzcG9zYWJsZVN0b3JlKSB7CiAgICAgICAgICAgIGRpc3Bvc2FibGVzLmFkZChyZXN1bHQpOwogICAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGRpc3Bvc2FibGVzKSkgewogICAgICAgICAgICBkaXNwb3NhYmxlcy5wdXNoKHJlc3VsdCk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH07CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMuX2V2ZW50OwogICAgfQogICAgLyoqCiAgICAgKiBUbyBiZSBrZXB0IHByaXZhdGUgdG8gZmlyZSBhbiBldmVudCB0bwogICAgICogc3Vic2NyaWJlcnMKICAgICAqLwogIH0sIHsKICAgIGtleTogImZpcmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpcmUoZXZlbnQpIHsKICAgICAgdmFyIF9hLCBfYjsKICAgICAgaWYgKHRoaXMuX2xpc3RlbmVycykgewogICAgICAgIC8vIHB1dCBhbGwgW2xpc3RlbmVyLGV2ZW50XS1wYWlycyBpbnRvIGRlbGl2ZXJ5IHF1ZXVlCiAgICAgICAgLy8gdGhlbiBlbWl0IGFsbCBldmVudC4gYW4gaW5uZXIvbmVzdGVkIGV2ZW50IG1pZ2h0IGJlCiAgICAgICAgLy8gdGhlIGRyaXZlciBvZiB0aGlzCiAgICAgICAgaWYgKCF0aGlzLl9kZWxpdmVyeVF1ZXVlKSB7CiAgICAgICAgICB0aGlzLl9kZWxpdmVyeVF1ZXVlID0gbmV3IFByaXZhdGVFdmVudERlbGl2ZXJ5UXVldWUoKTsKICAgICAgICB9CiAgICAgICAgdmFyIF9pdGVyYXRvcjMgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih0aGlzLl9saXN0ZW5lcnMpLAogICAgICAgICAgX3N0ZXAzOwogICAgICAgIHRyeSB7CiAgICAgICAgICBmb3IgKF9pdGVyYXRvcjMucygpOyAhKF9zdGVwMyA9IF9pdGVyYXRvcjMubigpKS5kb25lOykgewogICAgICAgICAgICB2YXIgbGlzdGVuZXIgPSBfc3RlcDMudmFsdWU7CiAgICAgICAgICAgIHRoaXMuX2RlbGl2ZXJ5UXVldWUucHVzaCh0aGlzLCBsaXN0ZW5lciwgZXZlbnQpOwogICAgICAgICAgfQogICAgICAgICAgLy8gc3RhcnQvc3RvcCBwZXJmb3JtYW5jZSBpbnNpZ2h0IGNvbGxlY3Rpb24KICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIF9pdGVyYXRvcjMuZShlcnIpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBfaXRlcmF0b3IzLmYoKTsKICAgICAgICB9CiAgICAgICAgKF9hID0gdGhpcy5fcGVyZk1vbikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnN0YXJ0KHRoaXMuX2RlbGl2ZXJ5UXVldWUuc2l6ZSk7CiAgICAgICAgdGhpcy5fZGVsaXZlcnlRdWV1ZS5kZWxpdmVyKCk7CiAgICAgICAgKF9iID0gdGhpcy5fcGVyZk1vbikgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnN0b3AoKTsKICAgICAgfQogICAgfQogIH1dKTsKICByZXR1cm4gRW1pdHRlcjsKfSgpOwpleHBvcnQgdmFyIEV2ZW50RGVsaXZlcnlRdWV1ZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gRXZlbnREZWxpdmVyeVF1ZXVlKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEV2ZW50RGVsaXZlcnlRdWV1ZSk7CiAgICB0aGlzLl9xdWV1ZSA9IG5ldyBMaW5rZWRMaXN0KCk7CiAgfQogIF9jcmVhdGVDbGFzcyhFdmVudERlbGl2ZXJ5UXVldWUsIFt7CiAgICBrZXk6ICJzaXplIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5fcXVldWUuc2l6ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJwdXNoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBwdXNoKGVtaXR0ZXIsIGxpc3RlbmVyLCBldmVudCkgewogICAgICB0aGlzLl9xdWV1ZS5wdXNoKG5ldyBFdmVudERlbGl2ZXJ5UXVldWVFbGVtZW50KGVtaXR0ZXIsIGxpc3RlbmVyLCBldmVudCkpOwogICAgfQogIH0sIHsKICAgIGtleTogImNsZWFyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhcihlbWl0dGVyKSB7CiAgICAgIHZhciBuZXdRdWV1ZSA9IG5ldyBMaW5rZWRMaXN0KCk7CiAgICAgIHZhciBfaXRlcmF0b3I0ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodGhpcy5fcXVldWUpLAogICAgICAgIF9zdGVwNDsKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjQucygpOyAhKF9zdGVwNCA9IF9pdGVyYXRvcjQubigpKS5kb25lOykgewogICAgICAgICAgdmFyIGVsZW1lbnQgPSBfc3RlcDQudmFsdWU7CiAgICAgICAgICBpZiAoZWxlbWVudC5lbWl0dGVyICE9PSBlbWl0dGVyKSB7CiAgICAgICAgICAgIG5ld1F1ZXVlLnB1c2goZWxlbWVudCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3I0LmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3I0LmYoKTsKICAgICAgfQogICAgICB0aGlzLl9xdWV1ZSA9IG5ld1F1ZXVlOwogICAgfQogIH0sIHsKICAgIGtleTogImRlbGl2ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRlbGl2ZXIoKSB7CiAgICAgIHdoaWxlICh0aGlzLl9xdWV1ZS5zaXplID4gMCkgewogICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5fcXVldWUuc2hpZnQoKTsKICAgICAgICB0cnkgewogICAgICAgICAgZWxlbWVudC5saXN0ZW5lci5pbnZva2UoZWxlbWVudC5ldmVudCk7CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgb25VbmV4cGVjdGVkRXJyb3IoZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfV0pOwogIHJldHVybiBFdmVudERlbGl2ZXJ5UXVldWU7Cn0oKTsKLyoqCiAqIEFuIGBFdmVudERlbGl2ZXJ5UXVldWVgIHRoYXQgaXMgZ3VhcmFudGVlZCB0byBiZSB1c2VkIGJ5IGEgc2luZ2xlIGBFbWl0dGVyYC4KICovCnZhciBQcml2YXRlRXZlbnREZWxpdmVyeVF1ZXVlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfRXZlbnREZWxpdmVyeVF1ZXVlKSB7CiAgX2luaGVyaXRzKFByaXZhdGVFdmVudERlbGl2ZXJ5UXVldWUsIF9FdmVudERlbGl2ZXJ5UXVldWUpOwogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoUHJpdmF0ZUV2ZW50RGVsaXZlcnlRdWV1ZSk7CiAgZnVuY3Rpb24gUHJpdmF0ZUV2ZW50RGVsaXZlcnlRdWV1ZSgpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQcml2YXRlRXZlbnREZWxpdmVyeVF1ZXVlKTsKICAgIHJldHVybiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9CiAgX2NyZWF0ZUNsYXNzKFByaXZhdGVFdmVudERlbGl2ZXJ5UXVldWUsIFt7CiAgICBrZXk6ICJjbGVhciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xlYXIoZW1pdHRlcikgewogICAgICAvLyBIZXJlIHdlIGNhbiBqdXN0IGNsZWFyIHRoZSBlbnRpcmUgbGlua2VkIGxpc3QgYmVjYXVzZQogICAgICAvLyBhbGwgZWxlbWVudHMgYXJlIGd1YXJhbnRlZWQgdG8gYmVsb25nIHRvIHRoaXMgZW1pdHRlcgogICAgICB0aGlzLl9xdWV1ZS5jbGVhcigpOwogICAgfQogIH1dKTsKICByZXR1cm4gUHJpdmF0ZUV2ZW50RGVsaXZlcnlRdWV1ZTsKfShFdmVudERlbGl2ZXJ5UXVldWUpOwp2YXIgRXZlbnREZWxpdmVyeVF1ZXVlRWxlbWVudCA9IC8qI19fUFVSRV9fKi9fY3JlYXRlQ2xhc3MoZnVuY3Rpb24gRXZlbnREZWxpdmVyeVF1ZXVlRWxlbWVudChlbWl0dGVyLCBsaXN0ZW5lciwgZXZlbnQpIHsKICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRXZlbnREZWxpdmVyeVF1ZXVlRWxlbWVudCk7CiAgdGhpcy5lbWl0dGVyID0gZW1pdHRlcjsKICB0aGlzLmxpc3RlbmVyID0gbGlzdGVuZXI7CiAgdGhpcy5ldmVudCA9IGV2ZW50Owp9KTsKZXhwb3J0IHZhciBQYXVzZWFibGVFbWl0dGVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfRW1pdHRlcikgewogIF9pbmhlcml0cyhQYXVzZWFibGVFbWl0dGVyLCBfRW1pdHRlcik7CiAgdmFyIF9zdXBlcjIgPSBfY3JlYXRlU3VwZXIoUGF1c2VhYmxlRW1pdHRlcik7CiAgZnVuY3Rpb24gUGF1c2VhYmxlRW1pdHRlcihvcHRpb25zKSB7CiAgICB2YXIgX3RoaXM0OwogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBhdXNlYWJsZUVtaXR0ZXIpOwogICAgX3RoaXM0ID0gX3N1cGVyMi5jYWxsKHRoaXMsIG9wdGlvbnMpOwogICAgX3RoaXM0Ll9pc1BhdXNlZCA9IDA7CiAgICBfdGhpczQuX2V2ZW50UXVldWUgPSBuZXcgTGlua2VkTGlzdCgpOwogICAgX3RoaXM0Ll9tZXJnZUZuID0gb3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLm1lcmdlOwogICAgcmV0dXJuIF90aGlzNDsKICB9CiAgX2NyZWF0ZUNsYXNzKFBhdXNlYWJsZUVtaXR0ZXIsIFt7CiAgICBrZXk6ICJwYXVzZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcGF1c2UoKSB7CiAgICAgIHRoaXMuX2lzUGF1c2VkKys7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVzdW1lIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWUoKSB7CiAgICAgIGlmICh0aGlzLl9pc1BhdXNlZCAhPT0gMCAmJiAtLXRoaXMuX2lzUGF1c2VkID09PSAwKSB7CiAgICAgICAgaWYgKHRoaXMuX21lcmdlRm4pIHsKICAgICAgICAgIC8vIHVzZSB0aGUgbWVyZ2UgZnVuY3Rpb24gdG8gY3JlYXRlIGEgc2luZ2xlIGNvbXBvc2l0ZQogICAgICAgICAgLy8gZXZlbnQuIG1ha2UgYSBjb3B5IGluIGNhc2UgZmlyaW5nIHBhdXNlcyB0aGlzIGVtaXR0ZXIKICAgICAgICAgIHZhciBldmVudHMgPSBBcnJheS5mcm9tKHRoaXMuX2V2ZW50UXVldWUpOwogICAgICAgICAgdGhpcy5fZXZlbnRRdWV1ZS5jbGVhcigpOwogICAgICAgICAgX2dldChfZ2V0UHJvdG90eXBlT2YoUGF1c2VhYmxlRW1pdHRlci5wcm90b3R5cGUpLCAiZmlyZSIsIHRoaXMpLmNhbGwodGhpcywgdGhpcy5fbWVyZ2VGbihldmVudHMpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gbm8gbWVyZ2luZywgZmlyZSBlYWNoIGV2ZW50IGluZGl2aWR1YWxseSBhbmQgdGVzdAogICAgICAgICAgLy8gdGhhdCB0aGlzIGVtaXR0ZXIgaXNuJ3QgcGF1c2VkIGhhbGZ3YXkgdGhyb3VnaAogICAgICAgICAgd2hpbGUgKCF0aGlzLl9pc1BhdXNlZCAmJiB0aGlzLl9ldmVudFF1ZXVlLnNpemUgIT09IDApIHsKICAgICAgICAgICAgX2dldChfZ2V0UHJvdG90eXBlT2YoUGF1c2VhYmxlRW1pdHRlci5wcm90b3R5cGUpLCAiZmlyZSIsIHRoaXMpLmNhbGwodGhpcywgdGhpcy5fZXZlbnRRdWV1ZS5zaGlmdCgpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJmaXJlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmaXJlKGV2ZW50KSB7CiAgICAgIGlmICh0aGlzLl9saXN0ZW5lcnMpIHsKICAgICAgICBpZiAodGhpcy5faXNQYXVzZWQgIT09IDApIHsKICAgICAgICAgIHRoaXMuX2V2ZW50UXVldWUucHVzaChldmVudCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF9nZXQoX2dldFByb3RvdHlwZU9mKFBhdXNlYWJsZUVtaXR0ZXIucHJvdG90eXBlKSwgImZpcmUiLCB0aGlzKS5jYWxsKHRoaXMsIGV2ZW50KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9XSk7CiAgcmV0dXJuIFBhdXNlYWJsZUVtaXR0ZXI7Cn0oRW1pdHRlcik7CmV4cG9ydCB2YXIgRGVib3VuY2VFbWl0dGVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfUGF1c2VhYmxlRW1pdHRlcikgewogIF9pbmhlcml0cyhEZWJvdW5jZUVtaXR0ZXIsIF9QYXVzZWFibGVFbWl0dGVyKTsKICB2YXIgX3N1cGVyMyA9IF9jcmVhdGVTdXBlcihEZWJvdW5jZUVtaXR0ZXIpOwogIGZ1bmN0aW9uIERlYm91bmNlRW1pdHRlcihvcHRpb25zKSB7CiAgICB2YXIgX3RoaXM1OwogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIERlYm91bmNlRW1pdHRlcik7CiAgICB2YXIgX2E7CiAgICBfdGhpczUgPSBfc3VwZXIzLmNhbGwodGhpcywgb3B0aW9ucyk7CiAgICBfdGhpczUuX2RlbGF5ID0gKF9hID0gb3B0aW9ucy5kZWxheSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogMTAwOwogICAgcmV0dXJuIF90aGlzNTsKICB9CiAgX2NyZWF0ZUNsYXNzKERlYm91bmNlRW1pdHRlciwgW3sKICAgIGtleTogImZpcmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpcmUoZXZlbnQpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CiAgICAgIGlmICghdGhpcy5faGFuZGxlKSB7CiAgICAgICAgdGhpcy5wYXVzZSgpOwogICAgICAgIHRoaXMuX2hhbmRsZSA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXM2Ll9oYW5kbGUgPSB1bmRlZmluZWQ7CiAgICAgICAgICBfdGhpczYucmVzdW1lKCk7CiAgICAgICAgfSwgdGhpcy5fZGVsYXkpOwogICAgICB9CiAgICAgIF9nZXQoX2dldFByb3RvdHlwZU9mKERlYm91bmNlRW1pdHRlci5wcm90b3R5cGUpLCAiZmlyZSIsIHRoaXMpLmNhbGwodGhpcywgZXZlbnQpOwogICAgfQogIH1dKTsKICByZXR1cm4gRGVib3VuY2VFbWl0dGVyOwp9KFBhdXNlYWJsZUVtaXR0ZXIpOwovKioKICogVGhlIEV2ZW50QnVmZmVyZXIgaXMgdXNlZnVsIGluIHNpdHVhdGlvbnMgaW4gd2hpY2ggeW91IHdhbnQKICogdG8gZGVsYXkgZmlyaW5nIHlvdXIgZXZlbnRzIGR1cmluZyBzb21lIGNvZGUuCiAqIFlvdSBjYW4gd3JhcCB0aGF0IGNvZGUgYW5kIGJlIHN1cmUgdGhhdCB0aGUgZXZlbnQgd2lsbCBub3QKICogYmUgZmlyZWQgZHVyaW5nIHRoYXQgd3JhcC4KICoKICogYGBgCiAqIGNvbnN0IGVtaXR0ZXI6IEVtaXR0ZXI7CiAqIGNvbnN0IGRlbGF5ZXIgPSBuZXcgRXZlbnREZWxheWVyKCk7CiAqIGNvbnN0IGRlbGF5ZWRFdmVudCA9IGRlbGF5ZXIud3JhcEV2ZW50KGVtaXR0ZXIuZXZlbnQpOwogKgogKiBkZWxheWVkRXZlbnQoY29uc29sZS5sb2cpOwogKgogKiBkZWxheWVyLmJ1ZmZlckV2ZW50cygoKSA9PiB7CiAqICAgZW1pdHRlci5maXJlKCk7IC8vIGV2ZW50IHdpbGwgbm90IGJlIGZpcmVkIHlldAogKiB9KTsKICoKICogLy8gZXZlbnQgd2lsbCBvbmx5IGJlIGZpcmVkIGF0IHRoaXMgcG9pbnQKICogYGBgCiAqLwpleHBvcnQgdmFyIEV2ZW50QnVmZmVyZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEV2ZW50QnVmZmVyZXIoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRXZlbnRCdWZmZXJlcik7CiAgICB0aGlzLmJ1ZmZlcnMgPSBbXTsKICB9CiAgX2NyZWF0ZUNsYXNzKEV2ZW50QnVmZmVyZXIsIFt7CiAgICBrZXk6ICJ3cmFwRXZlbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHdyYXBFdmVudChldmVudCkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKICAgICAgcmV0dXJuIGZ1bmN0aW9uIChsaXN0ZW5lciwgdGhpc0FyZ3MsIGRpc3Bvc2FibGVzKSB7CiAgICAgICAgcmV0dXJuIGV2ZW50KGZ1bmN0aW9uIChpKSB7CiAgICAgICAgICB2YXIgYnVmZmVyID0gX3RoaXM3LmJ1ZmZlcnNbX3RoaXM3LmJ1ZmZlcnMubGVuZ3RoIC0gMV07CiAgICAgICAgICBpZiAoYnVmZmVyKSB7CiAgICAgICAgICAgIGJ1ZmZlci5wdXNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4gbGlzdGVuZXIuY2FsbCh0aGlzQXJncywgaSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbGlzdGVuZXIuY2FsbCh0aGlzQXJncywgaSk7CiAgICAgICAgICB9CiAgICAgICAgfSwgdW5kZWZpbmVkLCBkaXNwb3NhYmxlcyk7CiAgICAgIH07CiAgICB9CiAgfSwgewogICAga2V5OiAiYnVmZmVyRXZlbnRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBidWZmZXJFdmVudHMoZm4pIHsKICAgICAgdmFyIGJ1ZmZlciA9IFtdOwogICAgICB0aGlzLmJ1ZmZlcnMucHVzaChidWZmZXIpOwogICAgICB2YXIgciA9IGZuKCk7CiAgICAgIHRoaXMuYnVmZmVycy5wb3AoKTsKICAgICAgYnVmZmVyLmZvckVhY2goZnVuY3Rpb24gKGZsdXNoKSB7CiAgICAgICAgcmV0dXJuIGZsdXNoKCk7CiAgICAgIH0pOwogICAgICByZXR1cm4gcjsKICAgIH0KICB9XSk7CiAgcmV0dXJuIEV2ZW50QnVmZmVyZXI7Cn0oKTsKLyoqCiAqIEEgUmVsYXkgaXMgYW4gZXZlbnQgZm9yd2FyZGVyIHdoaWNoIGZ1bmN0aW9ucyBhcyBhIHJlcGx1Z2FiYmxlIGV2ZW50IHBpcGUuCiAqIE9uY2UgY3JlYXRlZCwgeW91IGNhbiBjb25uZWN0IGFuIGlucHV0IGV2ZW50IHRvIGl0IGFuZCBpdCB3aWxsIHNpbXBseSBmb3J3YXJkCiAqIGV2ZW50cyBmcm9tIHRoYXQgaW5wdXQgZXZlbnQgdGhyb3VnaCBpdHMgb3duIGBldmVudGAgcHJvcGVydHkuIFRoZSBgaW5wdXRgCiAqIGNhbiBiZSBjaGFuZ2VkIGF0IGFueSBwb2ludCBpbiB0aW1lLgogKi8KZXhwb3J0IHZhciBSZWxheSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gUmVsYXkoKSB7CiAgICB2YXIgX3RoaXM4ID0gdGhpczsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBSZWxheSk7CiAgICB0aGlzLmxpc3RlbmluZyA9IGZhbHNlOwogICAgdGhpcy5pbnB1dEV2ZW50ID0gRXZlbnQuTm9uZTsKICAgIHRoaXMuaW5wdXRFdmVudExpc3RlbmVyID0gRGlzcG9zYWJsZS5Ob25lOwogICAgdGhpcy5lbWl0dGVyID0gbmV3IEVtaXR0ZXIoewogICAgICBvbkZpcnN0TGlzdGVuZXJEaWRBZGQ6IGZ1bmN0aW9uIG9uRmlyc3RMaXN0ZW5lckRpZEFkZCgpIHsKICAgICAgICBfdGhpczgubGlzdGVuaW5nID0gdHJ1ZTsKICAgICAgICBfdGhpczguaW5wdXRFdmVudExpc3RlbmVyID0gX3RoaXM4LmlucHV0RXZlbnQoX3RoaXM4LmVtaXR0ZXIuZmlyZSwgX3RoaXM4LmVtaXR0ZXIpOwogICAgICB9LAogICAgICBvbkxhc3RMaXN0ZW5lclJlbW92ZTogZnVuY3Rpb24gb25MYXN0TGlzdGVuZXJSZW1vdmUoKSB7CiAgICAgICAgX3RoaXM4Lmxpc3RlbmluZyA9IGZhbHNlOwogICAgICAgIF90aGlzOC5pbnB1dEV2ZW50TGlzdGVuZXIuZGlzcG9zZSgpOwogICAgICB9CiAgICB9KTsKICAgIHRoaXMuZXZlbnQgPSB0aGlzLmVtaXR0ZXIuZXZlbnQ7CiAgfQogIF9jcmVhdGVDbGFzcyhSZWxheSwgW3sKICAgIGtleTogImlucHV0IiwKICAgIHNldDogZnVuY3Rpb24gc2V0KGV2ZW50KSB7CiAgICAgIHRoaXMuaW5wdXRFdmVudCA9IGV2ZW50OwogICAgICBpZiAodGhpcy5saXN0ZW5pbmcpIHsKICAgICAgICB0aGlzLmlucHV0RXZlbnRMaXN0ZW5lci5kaXNwb3NlKCk7CiAgICAgICAgdGhpcy5pbnB1dEV2ZW50TGlzdGVuZXIgPSBldmVudCh0aGlzLmVtaXR0ZXIuZmlyZSwgdGhpcy5lbWl0dGVyKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImRpc3Bvc2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7CiAgICAgIHRoaXMuaW5wdXRFdmVudExpc3RlbmVyLmRpc3Bvc2UoKTsKICAgICAgdGhpcy5lbWl0dGVyLmRpc3Bvc2UoKTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIFJlbGF5Owp9KCk7"},{"version":3,"names":["onUnexpectedError","combinedDisposable","Disposable","DisposableStore","SafeDisposable","toDisposable","LinkedList","StopWatch","_enableDisposeWithListenerWarning","_enableSnapshotPotentialLeakWarning","Event","None","_addLeakageTraceLogic","options","origListenerDidAdd","onListenerDidAdd","stack","Stacktrace","create","count","console","warn","print","once","event","listener","thisArgs","disposables","didFire","result","undefined","e","dispose","call","map","disposable","snapshot","i","forEach","each","filter","signal","any","events","reduce","merge","initial","output","onFirstListenerAdd","emitter","fire","onLastListenerRemove","Emitter","add","debounce","delay","leading","leakWarningThreshold","subscription","handle","numDebouncedCalls","cur","clearTimeout","setTimeout","_output","latch","equals","a","b","firstCall","cache","value","shouldEmit","split","isT","buffer","flushAfterTimeout","_buffer","slice","push","flush","onFirstListenerDidAdd","ChainableEvent","fn","chain","fromNodeEventEmitter","eventName","id","on","removeListener","fromDOMEventEmitter","addEventListener","removeEventListener","toPromise","Promise","resolve","runAndSubscribe","handler","runAndSubscribeWithStore","store","run","EmitterObserver","obs","_counter","_hasChanged","addObserver","removeObserver","_observable","_change","get","fromObservable","observer","EventProfiling","name","_listenerCount","_invocationCount","_elapsedOverall","_name","_idPool","listenerCount","_stopWatch","elapsed","info","toFixed","_globalLeakWarningThreshold","LeakageMonitor","customThreshold","Math","random","toString","_warnCountdown","_stacks","clear","threshold","Map","set","topStack","topCount","join","_a","Error","Listener","callback","callbackThis","_b","_disposed","_options","_leakageMon","_perfMon","_profName","_deliveryQueue","deliveryQueue","_c","_d","_listeners","listeners","Array","from","queueMicrotask","isset","unset","_event","firstListener","isEmpty","removeMonitor","size","check","hasListeners","isArray","PrivateEventDeliveryQueue","start","deliver","stop","EventDeliveryQueue","_queue","EventDeliveryQueueElement","newQueue","element","shift","invoke","PauseableEmitter","_isPaused","_eventQueue","_mergeFn","DebounceEmitter","_delay","_handle","pause","resume","EventBufferer","buffers","length","r","pop","Relay","listening","inputEvent","inputEventListener"],"sources":["/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/base/common/event.js"],"sourcesContent":["import { onUnexpectedError } from './errors.js';\nimport { combinedDisposable, Disposable, DisposableStore, SafeDisposable, toDisposable } from './lifecycle.js';\nimport { LinkedList } from './linkedList.js';\nimport { StopWatch } from './stopwatch.js';\n// -----------------------------------------------------------------------------------------------------------------------\n// Uncomment the next line to print warnings whenever an emitter with listeners is disposed. That is a sign of code smell.\n// -----------------------------------------------------------------------------------------------------------------------\nconst _enableDisposeWithListenerWarning = false;\n// _enableDisposeWithListenerWarning = Boolean(\"TRUE\"); // causes a linter warning so that it cannot be pushed\n// -----------------------------------------------------------------------------------------------------------------------\n// Uncomment the next line to print warnings whenever a snapshotted event is used repeatedly without cleanup.\n// See https://github.com/microsoft/vscode/issues/142851\n// -----------------------------------------------------------------------------------------------------------------------\nconst _enableSnapshotPotentialLeakWarning = false;\nexport var Event;\n(function (Event) {\n    Event.None = () => Disposable.None;\n    function _addLeakageTraceLogic(options) {\n        if (_enableSnapshotPotentialLeakWarning) {\n            const { onListenerDidAdd: origListenerDidAdd } = options;\n            const stack = Stacktrace.create();\n            let count = 0;\n            options.onListenerDidAdd = () => {\n                if (++count === 2) {\n                    console.warn('snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here');\n                    stack.print();\n                }\n                origListenerDidAdd === null || origListenerDidAdd === void 0 ? void 0 : origListenerDidAdd();\n            };\n        }\n    }\n    /**\n     * Given an event, returns another event which only fires once.\n     */\n    function once(event) {\n        return (listener, thisArgs = null, disposables) => {\n            // we need this, in case the event fires during the listener call\n            let didFire = false;\n            let result = undefined;\n            result = event(e => {\n                if (didFire) {\n                    return;\n                }\n                else if (result) {\n                    result.dispose();\n                }\n                else {\n                    didFire = true;\n                }\n                return listener.call(thisArgs, e);\n            }, null, disposables);\n            if (didFire) {\n                result.dispose();\n            }\n            return result;\n        };\n    }\n    Event.once = once;\n    /**\n     * *NOTE* that this function returns an `Event` and it MUST be called with a `DisposableStore` whenever the returned\n     * event is accessible to \"third parties\", e.g the event is a public property. Otherwise a leaked listener on the\n     * returned event causes this utility to leak a listener on the original event.\n     */\n    function map(event, map, disposable) {\n        return snapshot((listener, thisArgs = null, disposables) => event(i => listener.call(thisArgs, map(i)), null, disposables), disposable);\n    }\n    Event.map = map;\n    /**\n     * *NOTE* that this function returns an `Event` and it MUST be called with a `DisposableStore` whenever the returned\n     * event is accessible to \"third parties\", e.g the event is a public property. Otherwise a leaked listener on the\n     * returned event causes this utility to leak a listener on the original event.\n     */\n    function forEach(event, each, disposable) {\n        return snapshot((listener, thisArgs = null, disposables) => event(i => { each(i); listener.call(thisArgs, i); }, null, disposables), disposable);\n    }\n    Event.forEach = forEach;\n    function filter(event, filter, disposable) {\n        return snapshot((listener, thisArgs = null, disposables) => event(e => filter(e) && listener.call(thisArgs, e), null, disposables), disposable);\n    }\n    Event.filter = filter;\n    /**\n     * Given an event, returns the same event but typed as `Event<void>`.\n     */\n    function signal(event) {\n        return event;\n    }\n    Event.signal = signal;\n    function any(...events) {\n        return (listener, thisArgs = null, disposables) => combinedDisposable(...events.map(event => event(e => listener.call(thisArgs, e), null, disposables)));\n    }\n    Event.any = any;\n    /**\n     * *NOTE* that this function returns an `Event` and it MUST be called with a `DisposableStore` whenever the returned\n     * event is accessible to \"third parties\", e.g the event is a public property. Otherwise a leaked listener on the\n     * returned event causes this utility to leak a listener on the original event.\n     */\n    function reduce(event, merge, initial, disposable) {\n        let output = initial;\n        return map(event, e => {\n            output = merge(output, e);\n            return output;\n        }, disposable);\n    }\n    Event.reduce = reduce;\n    function snapshot(event, disposable) {\n        let listener;\n        const options = {\n            onFirstListenerAdd() {\n                listener = event(emitter.fire, emitter);\n            },\n            onLastListenerRemove() {\n                listener === null || listener === void 0 ? void 0 : listener.dispose();\n            }\n        };\n        if (!disposable) {\n            _addLeakageTraceLogic(options);\n        }\n        const emitter = new Emitter(options);\n        disposable === null || disposable === void 0 ? void 0 : disposable.add(emitter);\n        return emitter.event;\n    }\n    function debounce(event, merge, delay = 100, leading = false, leakWarningThreshold, disposable) {\n        let subscription;\n        let output = undefined;\n        let handle = undefined;\n        let numDebouncedCalls = 0;\n        const options = {\n            leakWarningThreshold,\n            onFirstListenerAdd() {\n                subscription = event(cur => {\n                    numDebouncedCalls++;\n                    output = merge(output, cur);\n                    if (leading && !handle) {\n                        emitter.fire(output);\n                        output = undefined;\n                    }\n                    clearTimeout(handle);\n                    handle = setTimeout(() => {\n                        const _output = output;\n                        output = undefined;\n                        handle = undefined;\n                        if (!leading || numDebouncedCalls > 1) {\n                            emitter.fire(_output);\n                        }\n                        numDebouncedCalls = 0;\n                    }, delay);\n                });\n            },\n            onLastListenerRemove() {\n                subscription.dispose();\n            }\n        };\n        if (!disposable) {\n            _addLeakageTraceLogic(options);\n        }\n        const emitter = new Emitter(options);\n        disposable === null || disposable === void 0 ? void 0 : disposable.add(emitter);\n        return emitter.event;\n    }\n    Event.debounce = debounce;\n    /**\n     * *NOTE* that this function returns an `Event` and it MUST be called with a `DisposableStore` whenever the returned\n     * event is accessible to \"third parties\", e.g the event is a public property. Otherwise a leaked listener on the\n     * returned event causes this utility to leak a listener on the original event.\n     */\n    function latch(event, equals = (a, b) => a === b, disposable) {\n        let firstCall = true;\n        let cache;\n        return filter(event, value => {\n            const shouldEmit = firstCall || !equals(value, cache);\n            firstCall = false;\n            cache = value;\n            return shouldEmit;\n        }, disposable);\n    }\n    Event.latch = latch;\n    /**\n     * *NOTE* that this function returns an `Event` and it MUST be called with a `DisposableStore` whenever the returned\n     * event is accessible to \"third parties\", e.g the event is a public property. Otherwise a leaked listener on the\n     * returned event causes this utility to leak a listener on the original event.\n     */\n    function split(event, isT, disposable) {\n        return [\n            Event.filter(event, isT, disposable),\n            Event.filter(event, e => !isT(e), disposable),\n        ];\n    }\n    Event.split = split;\n    /**\n     * *NOTE* that this function returns an `Event` and it MUST be called with a `DisposableStore` whenever the returned\n     * event is accessible to \"third parties\", e.g the event is a public property. Otherwise a leaked listener on the\n     * returned event causes this utility to leak a listener on the original event.\n     */\n    function buffer(event, flushAfterTimeout = false, _buffer = []) {\n        let buffer = _buffer.slice();\n        let listener = event(e => {\n            if (buffer) {\n                buffer.push(e);\n            }\n            else {\n                emitter.fire(e);\n            }\n        });\n        const flush = () => {\n            buffer === null || buffer === void 0 ? void 0 : buffer.forEach(e => emitter.fire(e));\n            buffer = null;\n        };\n        const emitter = new Emitter({\n            onFirstListenerAdd() {\n                if (!listener) {\n                    listener = event(e => emitter.fire(e));\n                }\n            },\n            onFirstListenerDidAdd() {\n                if (buffer) {\n                    if (flushAfterTimeout) {\n                        setTimeout(flush);\n                    }\n                    else {\n                        flush();\n                    }\n                }\n            },\n            onLastListenerRemove() {\n                if (listener) {\n                    listener.dispose();\n                }\n                listener = null;\n            }\n        });\n        return emitter.event;\n    }\n    Event.buffer = buffer;\n    class ChainableEvent {\n        constructor(event) {\n            this.event = event;\n            this.disposables = new DisposableStore();\n        }\n        map(fn) {\n            return new ChainableEvent(map(this.event, fn, this.disposables));\n        }\n        forEach(fn) {\n            return new ChainableEvent(forEach(this.event, fn, this.disposables));\n        }\n        filter(fn) {\n            return new ChainableEvent(filter(this.event, fn, this.disposables));\n        }\n        reduce(merge, initial) {\n            return new ChainableEvent(reduce(this.event, merge, initial, this.disposables));\n        }\n        latch() {\n            return new ChainableEvent(latch(this.event, undefined, this.disposables));\n        }\n        debounce(merge, delay = 100, leading = false, leakWarningThreshold) {\n            return new ChainableEvent(debounce(this.event, merge, delay, leading, leakWarningThreshold, this.disposables));\n        }\n        on(listener, thisArgs, disposables) {\n            return this.event(listener, thisArgs, disposables);\n        }\n        once(listener, thisArgs, disposables) {\n            return once(this.event)(listener, thisArgs, disposables);\n        }\n        dispose() {\n            this.disposables.dispose();\n        }\n    }\n    function chain(event) {\n        return new ChainableEvent(event);\n    }\n    Event.chain = chain;\n    function fromNodeEventEmitter(emitter, eventName, map = id => id) {\n        const fn = (...args) => result.fire(map(...args));\n        const onFirstListenerAdd = () => emitter.on(eventName, fn);\n        const onLastListenerRemove = () => emitter.removeListener(eventName, fn);\n        const result = new Emitter({ onFirstListenerAdd, onLastListenerRemove });\n        return result.event;\n    }\n    Event.fromNodeEventEmitter = fromNodeEventEmitter;\n    function fromDOMEventEmitter(emitter, eventName, map = id => id) {\n        const fn = (...args) => result.fire(map(...args));\n        const onFirstListenerAdd = () => emitter.addEventListener(eventName, fn);\n        const onLastListenerRemove = () => emitter.removeEventListener(eventName, fn);\n        const result = new Emitter({ onFirstListenerAdd, onLastListenerRemove });\n        return result.event;\n    }\n    Event.fromDOMEventEmitter = fromDOMEventEmitter;\n    function toPromise(event) {\n        return new Promise(resolve => once(event)(resolve));\n    }\n    Event.toPromise = toPromise;\n    function runAndSubscribe(event, handler) {\n        handler(undefined);\n        return event(e => handler(e));\n    }\n    Event.runAndSubscribe = runAndSubscribe;\n    function runAndSubscribeWithStore(event, handler) {\n        let store = null;\n        function run(e) {\n            store === null || store === void 0 ? void 0 : store.dispose();\n            store = new DisposableStore();\n            handler(e, store);\n        }\n        run(undefined);\n        const disposable = event(e => run(e));\n        return toDisposable(() => {\n            disposable.dispose();\n            store === null || store === void 0 ? void 0 : store.dispose();\n        });\n    }\n    Event.runAndSubscribeWithStore = runAndSubscribeWithStore;\n    class EmitterObserver {\n        constructor(obs, store) {\n            this.obs = obs;\n            this._counter = 0;\n            this._hasChanged = false;\n            const options = {\n                onFirstListenerAdd: () => {\n                    obs.addObserver(this);\n                },\n                onLastListenerRemove: () => {\n                    obs.removeObserver(this);\n                }\n            };\n            if (!store) {\n                _addLeakageTraceLogic(options);\n            }\n            this.emitter = new Emitter(options);\n            if (store) {\n                store.add(this.emitter);\n            }\n        }\n        beginUpdate(_observable) {\n            // console.assert(_observable === this.obs);\n            this._counter++;\n        }\n        handleChange(_observable, _change) {\n            this._hasChanged = true;\n        }\n        endUpdate(_observable) {\n            if (--this._counter === 0) {\n                if (this._hasChanged) {\n                    this._hasChanged = false;\n                    this.emitter.fire(this.obs.get());\n                }\n            }\n        }\n    }\n    function fromObservable(obs, store) {\n        const observer = new EmitterObserver(obs, store);\n        return observer.emitter.event;\n    }\n    Event.fromObservable = fromObservable;\n})(Event || (Event = {}));\nclass EventProfiling {\n    constructor(name) {\n        this._listenerCount = 0;\n        this._invocationCount = 0;\n        this._elapsedOverall = 0;\n        this._name = `${name}_${EventProfiling._idPool++}`;\n    }\n    start(listenerCount) {\n        this._stopWatch = new StopWatch(true);\n        this._listenerCount = listenerCount;\n    }\n    stop() {\n        if (this._stopWatch) {\n            const elapsed = this._stopWatch.elapsed();\n            this._elapsedOverall += elapsed;\n            this._invocationCount += 1;\n            console.info(`did FIRE ${this._name}: elapsed_ms: ${elapsed.toFixed(5)}, listener: ${this._listenerCount} (elapsed_overall: ${this._elapsedOverall.toFixed(2)}, invocations: ${this._invocationCount})`);\n            this._stopWatch = undefined;\n        }\n    }\n}\nEventProfiling._idPool = 0;\nlet _globalLeakWarningThreshold = -1;\nclass LeakageMonitor {\n    constructor(customThreshold, name = Math.random().toString(18).slice(2, 5)) {\n        this.customThreshold = customThreshold;\n        this.name = name;\n        this._warnCountdown = 0;\n    }\n    dispose() {\n        if (this._stacks) {\n            this._stacks.clear();\n        }\n    }\n    check(stack, listenerCount) {\n        let threshold = _globalLeakWarningThreshold;\n        if (typeof this.customThreshold === 'number') {\n            threshold = this.customThreshold;\n        }\n        if (threshold <= 0 || listenerCount < threshold) {\n            return undefined;\n        }\n        if (!this._stacks) {\n            this._stacks = new Map();\n        }\n        const count = (this._stacks.get(stack.value) || 0);\n        this._stacks.set(stack.value, count + 1);\n        this._warnCountdown -= 1;\n        if (this._warnCountdown <= 0) {\n            // only warn on first exceed and then every time the limit\n            // is exceeded by 50% again\n            this._warnCountdown = threshold * 0.5;\n            // find most frequent listener and print warning\n            let topStack;\n            let topCount = 0;\n            for (const [stack, count] of this._stacks) {\n                if (!topStack || topCount < count) {\n                    topStack = stack;\n                    topCount = count;\n                }\n            }\n            console.warn(`[${this.name}] potential listener LEAK detected, having ${listenerCount} listeners already. MOST frequent listener (${topCount}):`);\n            console.warn(topStack);\n        }\n        return () => {\n            const count = (this._stacks.get(stack.value) || 0);\n            this._stacks.set(stack.value, count - 1);\n        };\n    }\n}\nclass Stacktrace {\n    constructor(value) {\n        this.value = value;\n    }\n    static create() {\n        var _a;\n        return new Stacktrace((_a = new Error().stack) !== null && _a !== void 0 ? _a : '');\n    }\n    print() {\n        console.warn(this.value.split('\\n').slice(2).join('\\n'));\n    }\n}\nclass Listener {\n    constructor(callback, callbackThis, stack) {\n        this.callback = callback;\n        this.callbackThis = callbackThis;\n        this.stack = stack;\n        this.subscription = new SafeDisposable();\n    }\n    invoke(e) {\n        this.callback.call(this.callbackThis, e);\n    }\n}\n/**\n * The Emitter can be used to expose an Event to the public\n * to fire it from the insides.\n * Sample:\n    class Document {\n\n        private readonly _onDidChange = new Emitter<(value:string)=>any>();\n\n        public onDidChange = this._onDidChange.event;\n\n        // getter-style\n        // get onDidChange(): Event<(value:string)=>any> {\n        // \treturn this._onDidChange.event;\n        // }\n\n        private _doIt() {\n            //...\n            this._onDidChange.fire(value);\n        }\n    }\n */\nexport class Emitter {\n    constructor(options) {\n        var _a, _b;\n        this._disposed = false;\n        this._options = options;\n        this._leakageMon = _globalLeakWarningThreshold > 0 ? new LeakageMonitor(this._options && this._options.leakWarningThreshold) : undefined;\n        this._perfMon = ((_a = this._options) === null || _a === void 0 ? void 0 : _a._profName) ? new EventProfiling(this._options._profName) : undefined;\n        this._deliveryQueue = (_b = this._options) === null || _b === void 0 ? void 0 : _b.deliveryQueue;\n    }\n    dispose() {\n        var _a, _b, _c, _d;\n        if (!this._disposed) {\n            this._disposed = true;\n            // It is bad to have listeners at the time of disposing an emitter, it is worst to have listeners keep the emitter\n            // alive via the reference that's embedded in their disposables. Therefore we loop over all remaining listeners and\n            // unset their subscriptions/disposables. Looping and blaming remaining listeners is done on next tick because the\n            // the following programming pattern is very popular:\n            //\n            // const someModel = this._disposables.add(new ModelObject()); // (1) create and register model\n            // this._disposables.add(someModel.onDidChange(() => { ... }); // (2) subscribe and register model-event listener\n            // ...later...\n            // this._disposables.dispose(); disposes (1) then (2): don't warn after (1) but after the \"overall dispose\" is done\n            if (this._listeners) {\n                if (_enableDisposeWithListenerWarning) {\n                    const listeners = Array.from(this._listeners);\n                    queueMicrotask(() => {\n                        var _a;\n                        for (const listener of listeners) {\n                            if (listener.subscription.isset()) {\n                                listener.subscription.unset();\n                                (_a = listener.stack) === null || _a === void 0 ? void 0 : _a.print();\n                            }\n                        }\n                    });\n                }\n                this._listeners.clear();\n            }\n            (_a = this._deliveryQueue) === null || _a === void 0 ? void 0 : _a.clear(this);\n            (_c = (_b = this._options) === null || _b === void 0 ? void 0 : _b.onLastListenerRemove) === null || _c === void 0 ? void 0 : _c.call(_b);\n            (_d = this._leakageMon) === null || _d === void 0 ? void 0 : _d.dispose();\n        }\n    }\n    /**\n     * For the public to allow to subscribe\n     * to events from this Emitter\n     */\n    get event() {\n        if (!this._event) {\n            this._event = (callback, thisArgs, disposables) => {\n                var _a, _b, _c;\n                if (!this._listeners) {\n                    this._listeners = new LinkedList();\n                }\n                const firstListener = this._listeners.isEmpty();\n                if (firstListener && ((_a = this._options) === null || _a === void 0 ? void 0 : _a.onFirstListenerAdd)) {\n                    this._options.onFirstListenerAdd(this);\n                }\n                let removeMonitor;\n                let stack;\n                if (this._leakageMon && this._listeners.size >= 30) {\n                    // check and record this emitter for potential leakage\n                    stack = Stacktrace.create();\n                    removeMonitor = this._leakageMon.check(stack, this._listeners.size + 1);\n                }\n                if (_enableDisposeWithListenerWarning) {\n                    stack = stack !== null && stack !== void 0 ? stack : Stacktrace.create();\n                }\n                const listener = new Listener(callback, thisArgs, stack);\n                const removeListener = this._listeners.push(listener);\n                if (firstListener && ((_b = this._options) === null || _b === void 0 ? void 0 : _b.onFirstListenerDidAdd)) {\n                    this._options.onFirstListenerDidAdd(this);\n                }\n                if ((_c = this._options) === null || _c === void 0 ? void 0 : _c.onListenerDidAdd) {\n                    this._options.onListenerDidAdd(this, callback, thisArgs);\n                }\n                const result = listener.subscription.set(() => {\n                    removeMonitor === null || removeMonitor === void 0 ? void 0 : removeMonitor();\n                    if (!this._disposed) {\n                        removeListener();\n                        if (this._options && this._options.onLastListenerRemove) {\n                            const hasListeners = (this._listeners && !this._listeners.isEmpty());\n                            if (!hasListeners) {\n                                this._options.onLastListenerRemove(this);\n                            }\n                        }\n                    }\n                });\n                if (disposables instanceof DisposableStore) {\n                    disposables.add(result);\n                }\n                else if (Array.isArray(disposables)) {\n                    disposables.push(result);\n                }\n                return result;\n            };\n        }\n        return this._event;\n    }\n    /**\n     * To be kept private to fire an event to\n     * subscribers\n     */\n    fire(event) {\n        var _a, _b;\n        if (this._listeners) {\n            // put all [listener,event]-pairs into delivery queue\n            // then emit all event. an inner/nested event might be\n            // the driver of this\n            if (!this._deliveryQueue) {\n                this._deliveryQueue = new PrivateEventDeliveryQueue();\n            }\n            for (const listener of this._listeners) {\n                this._deliveryQueue.push(this, listener, event);\n            }\n            // start/stop performance insight collection\n            (_a = this._perfMon) === null || _a === void 0 ? void 0 : _a.start(this._deliveryQueue.size);\n            this._deliveryQueue.deliver();\n            (_b = this._perfMon) === null || _b === void 0 ? void 0 : _b.stop();\n        }\n    }\n}\nexport class EventDeliveryQueue {\n    constructor() {\n        this._queue = new LinkedList();\n    }\n    get size() {\n        return this._queue.size;\n    }\n    push(emitter, listener, event) {\n        this._queue.push(new EventDeliveryQueueElement(emitter, listener, event));\n    }\n    clear(emitter) {\n        const newQueue = new LinkedList();\n        for (const element of this._queue) {\n            if (element.emitter !== emitter) {\n                newQueue.push(element);\n            }\n        }\n        this._queue = newQueue;\n    }\n    deliver() {\n        while (this._queue.size > 0) {\n            const element = this._queue.shift();\n            try {\n                element.listener.invoke(element.event);\n            }\n            catch (e) {\n                onUnexpectedError(e);\n            }\n        }\n    }\n}\n/**\n * An `EventDeliveryQueue` that is guaranteed to be used by a single `Emitter`.\n */\nclass PrivateEventDeliveryQueue extends EventDeliveryQueue {\n    clear(emitter) {\n        // Here we can just clear the entire linked list because\n        // all elements are guaranteed to belong to this emitter\n        this._queue.clear();\n    }\n}\nclass EventDeliveryQueueElement {\n    constructor(emitter, listener, event) {\n        this.emitter = emitter;\n        this.listener = listener;\n        this.event = event;\n    }\n}\nexport class PauseableEmitter extends Emitter {\n    constructor(options) {\n        super(options);\n        this._isPaused = 0;\n        this._eventQueue = new LinkedList();\n        this._mergeFn = options === null || options === void 0 ? void 0 : options.merge;\n    }\n    pause() {\n        this._isPaused++;\n    }\n    resume() {\n        if (this._isPaused !== 0 && --this._isPaused === 0) {\n            if (this._mergeFn) {\n                // use the merge function to create a single composite\n                // event. make a copy in case firing pauses this emitter\n                const events = Array.from(this._eventQueue);\n                this._eventQueue.clear();\n                super.fire(this._mergeFn(events));\n            }\n            else {\n                // no merging, fire each event individually and test\n                // that this emitter isn't paused halfway through\n                while (!this._isPaused && this._eventQueue.size !== 0) {\n                    super.fire(this._eventQueue.shift());\n                }\n            }\n        }\n    }\n    fire(event) {\n        if (this._listeners) {\n            if (this._isPaused !== 0) {\n                this._eventQueue.push(event);\n            }\n            else {\n                super.fire(event);\n            }\n        }\n    }\n}\nexport class DebounceEmitter extends PauseableEmitter {\n    constructor(options) {\n        var _a;\n        super(options);\n        this._delay = (_a = options.delay) !== null && _a !== void 0 ? _a : 100;\n    }\n    fire(event) {\n        if (!this._handle) {\n            this.pause();\n            this._handle = setTimeout(() => {\n                this._handle = undefined;\n                this.resume();\n            }, this._delay);\n        }\n        super.fire(event);\n    }\n}\n/**\n * The EventBufferer is useful in situations in which you want\n * to delay firing your events during some code.\n * You can wrap that code and be sure that the event will not\n * be fired during that wrap.\n *\n * ```\n * const emitter: Emitter;\n * const delayer = new EventDelayer();\n * const delayedEvent = delayer.wrapEvent(emitter.event);\n *\n * delayedEvent(console.log);\n *\n * delayer.bufferEvents(() => {\n *   emitter.fire(); // event will not be fired yet\n * });\n *\n * // event will only be fired at this point\n * ```\n */\nexport class EventBufferer {\n    constructor() {\n        this.buffers = [];\n    }\n    wrapEvent(event) {\n        return (listener, thisArgs, disposables) => {\n            return event(i => {\n                const buffer = this.buffers[this.buffers.length - 1];\n                if (buffer) {\n                    buffer.push(() => listener.call(thisArgs, i));\n                }\n                else {\n                    listener.call(thisArgs, i);\n                }\n            }, undefined, disposables);\n        };\n    }\n    bufferEvents(fn) {\n        const buffer = [];\n        this.buffers.push(buffer);\n        const r = fn();\n        this.buffers.pop();\n        buffer.forEach(flush => flush());\n        return r;\n    }\n}\n/**\n * A Relay is an event forwarder which functions as a replugabble event pipe.\n * Once created, you can connect an input event to it and it will simply forward\n * events from that input event through its own `event` property. The `input`\n * can be changed at any point in time.\n */\nexport class Relay {\n    constructor() {\n        this.listening = false;\n        this.inputEvent = Event.None;\n        this.inputEventListener = Disposable.None;\n        this.emitter = new Emitter({\n            onFirstListenerDidAdd: () => {\n                this.listening = true;\n                this.inputEventListener = this.inputEvent(this.emitter.fire, this.emitter);\n            },\n            onLastListenerRemove: () => {\n                this.listening = false;\n                this.inputEventListener.dispose();\n            }\n        });\n        this.event = this.emitter.event;\n    }\n    set input(event) {\n        this.inputEvent = event;\n        if (this.listening) {\n            this.inputEventListener.dispose();\n            this.inputEventListener = event(this.emitter.fire, this.emitter);\n        }\n    }\n    dispose() {\n        this.inputEventListener.dispose();\n        this.emitter.dispose();\n    }\n}\n"],"mappings":"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"}]}