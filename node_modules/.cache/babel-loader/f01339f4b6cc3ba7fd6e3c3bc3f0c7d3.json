{"remainingRequest":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js!/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/base/browser/ui/tree/asyncDataTree.js","dependencies":[{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/base/browser/ui/tree/asyncDataTree.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/babel.config.js","mtime":1668271197000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9nZXQgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9nZXQuanMiOwppbXBvcnQgX2dldFByb3RvdHlwZU9mIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZ2V0UHJvdG90eXBlT2YuanMiOwppbXBvcnQgX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyLmpzIjsKaW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiL1VzZXJzL3lhbmppYWppYS9EZXNrdG9wL3dvcmtzcGFjZS9hdnVlLWRhdGEtbmV3L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9yZWdlbmVyYXRvclJ1bnRpbWUuanMiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vaW5oZXJpdHMuanMiOwppbXBvcnQgX2NyZWF0ZVN1cGVyIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlU3VwZXIuanMiOwppbXBvcnQgX3RvQ29uc3VtYWJsZUFycmF5IGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkuanMiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2suanMiOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIi9Vc2Vycy95YW5qaWFqaWEvRGVza3RvcC93b3Jrc3BhY2UvYXZ1ZS1kYXRhLW5ldy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNvcnQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zZXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5lcnJvci5jYXVzZS5qcyI7Ci8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAqICBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uCiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwp2YXIgX19hd2FpdGVyID0gdGhpcyAmJiB0aGlzLl9fYXdhaXRlciB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7CiAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsKICAgIHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgIHJlc29sdmUodmFsdWUpOwogICAgfSk7CiAgfQogIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7CiAgICAgIHRyeSB7CiAgICAgICAgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgcmVqZWN0KGUpOwogICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgewogICAgICB0cnkgewogICAgICAgIHN0ZXAoZ2VuZXJhdG9yWyJ0aHJvdyJdKHZhbHVlKSk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICByZWplY3QoZSk7CiAgICAgIH0KICAgIH0KICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7CiAgICAgIHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOwogICAgfQogICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpOwogIH0pOwp9OwppbXBvcnQgeyBFbGVtZW50c0RyYWdBbmREcm9wRGF0YSB9IGZyb20gJy4uL2xpc3QvbGlzdFZpZXcuanMnOwppbXBvcnQgeyBDb21wb3NlZFRyZWVEZWxlZ2F0ZSB9IGZyb20gJy4vYWJzdHJhY3RUcmVlLmpzJzsKaW1wb3J0IHsgZ2V0VmlzaWJsZVN0YXRlLCBpc0ZpbHRlclJlc3VsdCB9IGZyb20gJy4vaW5kZXhUcmVlTW9kZWwuanMnOwppbXBvcnQgeyBDb21wcmVzc2libGVPYmplY3RUcmVlLCBPYmplY3RUcmVlIH0gZnJvbSAnLi9vYmplY3RUcmVlLmpzJzsKaW1wb3J0IHsgVHJlZUVycm9yLCBXZWFrTWFwcGVyIH0gZnJvbSAnLi90cmVlLmpzJzsKaW1wb3J0IHsgY3JlYXRlQ2FuY2VsYWJsZVByb21pc2UsIFByb21pc2VzLCB0aW1lb3V0IH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL2FzeW5jLmpzJzsKaW1wb3J0IHsgQ29kaWNvbiB9IGZyb20gJy4uLy4uLy4uL2NvbW1vbi9jb2RpY29ucy5qcyc7CmltcG9ydCB7IGlzQ2FuY2VsbGF0aW9uRXJyb3IsIG9uVW5leHBlY3RlZEVycm9yIH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL2Vycm9ycy5qcyc7CmltcG9ydCB7IEVtaXR0ZXIsIEV2ZW50IH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL2V2ZW50LmpzJzsKaW1wb3J0IHsgSXRlcmFibGUgfSBmcm9tICcuLi8uLi8uLi9jb21tb24vaXRlcmF0b3IuanMnOwppbXBvcnQgeyBEaXNwb3NhYmxlU3RvcmUsIGRpc3Bvc2UgYXMgX2Rpc3Bvc2UgfSBmcm9tICcuLi8uLi8uLi9jb21tb24vbGlmZWN5Y2xlLmpzJzsKaW1wb3J0IHsgaXNJdGVyYWJsZSB9IGZyb20gJy4uLy4uLy4uL2NvbW1vbi90eXBlcy5qcyc7CmZ1bmN0aW9uIGNyZWF0ZUFzeW5jRGF0YVRyZWVOb2RlKHByb3BzKSB7CiAgcmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgcHJvcHMpLCB7CiAgICBjaGlsZHJlbjogW10sCiAgICByZWZyZXNoUHJvbWlzZTogdW5kZWZpbmVkLAogICAgc3RhbGU6IHRydWUsCiAgICBzbG93OiBmYWxzZSwKICAgIGNvbGxhcHNlZEJ5RGVmYXVsdDogdW5kZWZpbmVkCiAgfSk7Cn0KZnVuY3Rpb24gaXNBbmNlc3RvcihhbmNlc3RvciwgZGVzY2VuZGFudCkgewogIGlmICghZGVzY2VuZGFudC5wYXJlbnQpIHsKICAgIHJldHVybiBmYWxzZTsKICB9IGVsc2UgaWYgKGRlc2NlbmRhbnQucGFyZW50ID09PSBhbmNlc3RvcikgewogICAgcmV0dXJuIHRydWU7CiAgfSBlbHNlIHsKICAgIHJldHVybiBpc0FuY2VzdG9yKGFuY2VzdG9yLCBkZXNjZW5kYW50LnBhcmVudCk7CiAgfQp9CmZ1bmN0aW9uIGludGVyc2VjdHMobm9kZSwgb3RoZXIpIHsKICByZXR1cm4gbm9kZSA9PT0gb3RoZXIgfHwgaXNBbmNlc3Rvcihub2RlLCBvdGhlcikgfHwgaXNBbmNlc3RvcihvdGhlciwgbm9kZSk7Cn0KdmFyIEFzeW5jRGF0YVRyZWVOb2RlV3JhcHBlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQXN5bmNEYXRhVHJlZU5vZGVXcmFwcGVyKG5vZGUpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBc3luY0RhdGFUcmVlTm9kZVdyYXBwZXIpOwogICAgdGhpcy5ub2RlID0gbm9kZTsKICB9CiAgX2NyZWF0ZUNsYXNzKEFzeW5jRGF0YVRyZWVOb2RlV3JhcHBlciwgW3sKICAgIGtleTogImVsZW1lbnQiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLm5vZGUuZWxlbWVudC5lbGVtZW50OwogICAgfQogIH0sIHsKICAgIGtleTogImNoaWxkcmVuIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5ub2RlLmNoaWxkcmVuLm1hcChmdW5jdGlvbiAobm9kZSkgewogICAgICAgIHJldHVybiBuZXcgQXN5bmNEYXRhVHJlZU5vZGVXcmFwcGVyKG5vZGUpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkZXB0aCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMubm9kZS5kZXB0aDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ2aXNpYmxlQ2hpbGRyZW5Db3VudCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMubm9kZS52aXNpYmxlQ2hpbGRyZW5Db3VudDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ2aXNpYmxlQ2hpbGRJbmRleCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMubm9kZS52aXNpYmxlQ2hpbGRJbmRleDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb2xsYXBzaWJsZSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMubm9kZS5jb2xsYXBzaWJsZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb2xsYXBzZWQiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLm5vZGUuY29sbGFwc2VkOwogICAgfQogIH0sIHsKICAgIGtleTogInZpc2libGUiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLm5vZGUudmlzaWJsZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJmaWx0ZXJEYXRhIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5ub2RlLmZpbHRlckRhdGE7CiAgICB9CiAgfV0pOwogIHJldHVybiBBc3luY0RhdGFUcmVlTm9kZVdyYXBwZXI7Cn0oKTsKdmFyIEFzeW5jRGF0YVRyZWVSZW5kZXJlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQXN5bmNEYXRhVHJlZVJlbmRlcmVyKHJlbmRlcmVyLCBub2RlTWFwcGVyLCBvbkRpZENoYW5nZVR3aXN0aWVTdGF0ZSkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFzeW5jRGF0YVRyZWVSZW5kZXJlcik7CiAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7CiAgICB0aGlzLm5vZGVNYXBwZXIgPSBub2RlTWFwcGVyOwogICAgdGhpcy5vbkRpZENoYW5nZVR3aXN0aWVTdGF0ZSA9IG9uRGlkQ2hhbmdlVHdpc3RpZVN0YXRlOwogICAgdGhpcy5yZW5kZXJlZE5vZGVzID0gbmV3IE1hcCgpOwogICAgdGhpcy50ZW1wbGF0ZUlkID0gcmVuZGVyZXIudGVtcGxhdGVJZDsKICB9CiAgX2NyZWF0ZUNsYXNzKEFzeW5jRGF0YVRyZWVSZW5kZXJlciwgW3sKICAgIGtleTogInJlbmRlclRlbXBsYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJUZW1wbGF0ZShjb250YWluZXIpIHsKICAgICAgdmFyIHRlbXBsYXRlRGF0YSA9IHRoaXMucmVuZGVyZXIucmVuZGVyVGVtcGxhdGUoY29udGFpbmVyKTsKICAgICAgcmV0dXJuIHsKICAgICAgICB0ZW1wbGF0ZURhdGE6IHRlbXBsYXRlRGF0YQogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlckVsZW1lbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlckVsZW1lbnQobm9kZSwgaW5kZXgsIHRlbXBsYXRlRGF0YSwgaGVpZ2h0KSB7CiAgICAgIHRoaXMucmVuZGVyZXIucmVuZGVyRWxlbWVudCh0aGlzLm5vZGVNYXBwZXIubWFwKG5vZGUpLCBpbmRleCwgdGVtcGxhdGVEYXRhLnRlbXBsYXRlRGF0YSwgaGVpZ2h0KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXJUd2lzdGllIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJUd2lzdGllKGVsZW1lbnQsIHR3aXN0aWVFbGVtZW50KSB7CiAgICAgIGlmIChlbGVtZW50LnNsb3cpIHsKICAgICAgICB2YXIgX3R3aXN0aWVFbGVtZW50JGNsYXNzOwogICAgICAgIChfdHdpc3RpZUVsZW1lbnQkY2xhc3MgPSB0d2lzdGllRWxlbWVudC5jbGFzc0xpc3QpLmFkZC5hcHBseShfdHdpc3RpZUVsZW1lbnQkY2xhc3MsIF90b0NvbnN1bWFibGVBcnJheShDb2RpY29uLnRyZWVJdGVtTG9hZGluZy5jbGFzc05hbWVzQXJyYXkpKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgX3R3aXN0aWVFbGVtZW50JGNsYXNzMjsKICAgICAgICAoX3R3aXN0aWVFbGVtZW50JGNsYXNzMiA9IHR3aXN0aWVFbGVtZW50LmNsYXNzTGlzdCkucmVtb3ZlLmFwcGx5KF90d2lzdGllRWxlbWVudCRjbGFzczIsIF90b0NvbnN1bWFibGVBcnJheShDb2RpY29uLnRyZWVJdGVtTG9hZGluZy5jbGFzc05hbWVzQXJyYXkpKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJkaXNwb3NlRWxlbWVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzcG9zZUVsZW1lbnQobm9kZSwgaW5kZXgsIHRlbXBsYXRlRGF0YSwgaGVpZ2h0KSB7CiAgICAgIHZhciBfYSwgX2I7CiAgICAgIChfYiA9IChfYSA9IHRoaXMucmVuZGVyZXIpLmRpc3Bvc2VFbGVtZW50KSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuY2FsbChfYSwgdGhpcy5ub2RlTWFwcGVyLm1hcChub2RlKSwgaW5kZXgsIHRlbXBsYXRlRGF0YS50ZW1wbGF0ZURhdGEsIGhlaWdodCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGlzcG9zZVRlbXBsYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNwb3NlVGVtcGxhdGUodGVtcGxhdGVEYXRhKSB7CiAgICAgIHRoaXMucmVuZGVyZXIuZGlzcG9zZVRlbXBsYXRlKHRlbXBsYXRlRGF0YS50ZW1wbGF0ZURhdGEpOwogICAgfQogIH0sIHsKICAgIGtleTogImRpc3Bvc2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7CiAgICAgIHRoaXMucmVuZGVyZWROb2Rlcy5jbGVhcigpOwogICAgfQogIH1dKTsKICByZXR1cm4gQXN5bmNEYXRhVHJlZVJlbmRlcmVyOwp9KCk7CmZ1bmN0aW9uIGFzVHJlZUV2ZW50KGUpIHsKICByZXR1cm4gewogICAgYnJvd3NlckV2ZW50OiBlLmJyb3dzZXJFdmVudCwKICAgIGVsZW1lbnRzOiBlLmVsZW1lbnRzLm1hcChmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gZS5lbGVtZW50OwogICAgfSkKICB9Owp9CmZ1bmN0aW9uIGFzVHJlZU1vdXNlRXZlbnQoZSkgewogIHJldHVybiB7CiAgICBicm93c2VyRXZlbnQ6IGUuYnJvd3NlckV2ZW50LAogICAgZWxlbWVudDogZS5lbGVtZW50ICYmIGUuZWxlbWVudC5lbGVtZW50LAogICAgdGFyZ2V0OiBlLnRhcmdldAogIH07Cn0KdmFyIEFzeW5jRGF0YVRyZWVFbGVtZW50c0RyYWdBbmREcm9wRGF0YSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0VsZW1lbnRzRHJhZ0FuZERyb3BEKSB7CiAgX2luaGVyaXRzKEFzeW5jRGF0YVRyZWVFbGVtZW50c0RyYWdBbmREcm9wRGF0YSwgX0VsZW1lbnRzRHJhZ0FuZERyb3BEKTsKICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKEFzeW5jRGF0YVRyZWVFbGVtZW50c0RyYWdBbmREcm9wRGF0YSk7CiAgZnVuY3Rpb24gQXN5bmNEYXRhVHJlZUVsZW1lbnRzRHJhZ0FuZERyb3BEYXRhKGRhdGEpIHsKICAgIHZhciBfdGhpczsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBc3luY0RhdGFUcmVlRWxlbWVudHNEcmFnQW5kRHJvcERhdGEpOwogICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkYXRhLmVsZW1lbnRzLm1hcChmdW5jdGlvbiAobm9kZSkgewogICAgICByZXR1cm4gbm9kZS5lbGVtZW50OwogICAgfSkpOwogICAgX3RoaXMuZGF0YSA9IGRhdGE7CiAgICByZXR1cm4gX3RoaXM7CiAgfQogIHJldHVybiBfY3JlYXRlQ2xhc3MoQXN5bmNEYXRhVHJlZUVsZW1lbnRzRHJhZ0FuZERyb3BEYXRhKTsKfShFbGVtZW50c0RyYWdBbmREcm9wRGF0YSk7CmZ1bmN0aW9uIGFzQXN5bmNEYXRhVHJlZURyYWdBbmREcm9wRGF0YShkYXRhKSB7CiAgaWYgKGRhdGEgaW5zdGFuY2VvZiBFbGVtZW50c0RyYWdBbmREcm9wRGF0YSkgewogICAgcmV0dXJuIG5ldyBBc3luY0RhdGFUcmVlRWxlbWVudHNEcmFnQW5kRHJvcERhdGEoZGF0YSk7CiAgfQogIHJldHVybiBkYXRhOwp9CnZhciBBc3luY0RhdGFUcmVlTm9kZUxpc3REcmFnQW5kRHJvcCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQXN5bmNEYXRhVHJlZU5vZGVMaXN0RHJhZ0FuZERyb3AoZG5kKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQXN5bmNEYXRhVHJlZU5vZGVMaXN0RHJhZ0FuZERyb3ApOwogICAgdGhpcy5kbmQgPSBkbmQ7CiAgfQogIF9jcmVhdGVDbGFzcyhBc3luY0RhdGFUcmVlTm9kZUxpc3REcmFnQW5kRHJvcCwgW3sKICAgIGtleTogImdldERyYWdVUkkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldERyYWdVUkkobm9kZSkgewogICAgICByZXR1cm4gdGhpcy5kbmQuZ2V0RHJhZ1VSSShub2RlLmVsZW1lbnQpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldERyYWdMYWJlbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RHJhZ0xhYmVsKG5vZGVzLCBvcmlnaW5hbEV2ZW50KSB7CiAgICAgIGlmICh0aGlzLmRuZC5nZXREcmFnTGFiZWwpIHsKICAgICAgICByZXR1cm4gdGhpcy5kbmQuZ2V0RHJhZ0xhYmVsKG5vZGVzLm1hcChmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgcmV0dXJuIG5vZGUuZWxlbWVudDsKICAgICAgICB9KSwgb3JpZ2luYWxFdmVudCk7CiAgICAgIH0KICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvbkRyYWdTdGFydCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25EcmFnU3RhcnQoZGF0YSwgb3JpZ2luYWxFdmVudCkgewogICAgICB2YXIgX2EsIF9iOwogICAgICAoX2IgPSAoX2EgPSB0aGlzLmRuZCkub25EcmFnU3RhcnQpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5jYWxsKF9hLCBhc0FzeW5jRGF0YVRyZWVEcmFnQW5kRHJvcERhdGEoZGF0YSksIG9yaWdpbmFsRXZlbnQpOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uRHJhZ092ZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uRHJhZ092ZXIoZGF0YSwgdGFyZ2V0Tm9kZSwgdGFyZ2V0SW5kZXgsIG9yaWdpbmFsRXZlbnQpIHsKICAgICAgdmFyIHJhdyA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ICYmIGFyZ3VtZW50c1s0XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzRdIDogdHJ1ZTsKICAgICAgcmV0dXJuIHRoaXMuZG5kLm9uRHJhZ092ZXIoYXNBc3luY0RhdGFUcmVlRHJhZ0FuZERyb3BEYXRhKGRhdGEpLCB0YXJnZXROb2RlICYmIHRhcmdldE5vZGUuZWxlbWVudCwgdGFyZ2V0SW5kZXgsIG9yaWdpbmFsRXZlbnQpOwogICAgfQogIH0sIHsKICAgIGtleTogImRyb3AiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRyb3AoZGF0YSwgdGFyZ2V0Tm9kZSwgdGFyZ2V0SW5kZXgsIG9yaWdpbmFsRXZlbnQpIHsKICAgICAgdGhpcy5kbmQuZHJvcChhc0FzeW5jRGF0YVRyZWVEcmFnQW5kRHJvcERhdGEoZGF0YSksIHRhcmdldE5vZGUgJiYgdGFyZ2V0Tm9kZS5lbGVtZW50LCB0YXJnZXRJbmRleCwgb3JpZ2luYWxFdmVudCk7CiAgICB9CiAgfSwgewogICAga2V5OiAib25EcmFnRW5kIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkRyYWdFbmQob3JpZ2luYWxFdmVudCkgewogICAgICB2YXIgX2EsIF9iOwogICAgICAoX2IgPSAoX2EgPSB0aGlzLmRuZCkub25EcmFnRW5kKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuY2FsbChfYSwgb3JpZ2luYWxFdmVudCk7CiAgICB9CiAgfV0pOwogIHJldHVybiBBc3luY0RhdGFUcmVlTm9kZUxpc3REcmFnQW5kRHJvcDsKfSgpOwpmdW5jdGlvbiBhc09iamVjdFRyZWVPcHRpb25zKG9wdGlvbnMpIHsKICByZXR1cm4gb3B0aW9ucyAmJiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMpLCB7CiAgICBjb2xsYXBzZUJ5RGVmYXVsdDogdHJ1ZSwKICAgIGlkZW50aXR5UHJvdmlkZXI6IG9wdGlvbnMuaWRlbnRpdHlQcm92aWRlciAmJiB7CiAgICAgIGdldElkOiBmdW5jdGlvbiBnZXRJZChlbCkgewogICAgICAgIHJldHVybiBvcHRpb25zLmlkZW50aXR5UHJvdmlkZXIuZ2V0SWQoZWwuZWxlbWVudCk7CiAgICAgIH0KICAgIH0sCiAgICBkbmQ6IG9wdGlvbnMuZG5kICYmIG5ldyBBc3luY0RhdGFUcmVlTm9kZUxpc3REcmFnQW5kRHJvcChvcHRpb25zLmRuZCksCiAgICBtdWx0aXBsZVNlbGVjdGlvbkNvbnRyb2xsZXI6IG9wdGlvbnMubXVsdGlwbGVTZWxlY3Rpb25Db250cm9sbGVyICYmIHsKICAgICAgaXNTZWxlY3Rpb25TaW5nbGVDaGFuZ2VFdmVudDogZnVuY3Rpb24gaXNTZWxlY3Rpb25TaW5nbGVDaGFuZ2VFdmVudChlKSB7CiAgICAgICAgcmV0dXJuIG9wdGlvbnMubXVsdGlwbGVTZWxlY3Rpb25Db250cm9sbGVyLmlzU2VsZWN0aW9uU2luZ2xlQ2hhbmdlRXZlbnQoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBlKSwgewogICAgICAgICAgZWxlbWVudDogZS5lbGVtZW50CiAgICAgICAgfSkpOwogICAgICB9LAogICAgICBpc1NlbGVjdGlvblJhbmdlQ2hhbmdlRXZlbnQ6IGZ1bmN0aW9uIGlzU2VsZWN0aW9uUmFuZ2VDaGFuZ2VFdmVudChlKSB7CiAgICAgICAgcmV0dXJuIG9wdGlvbnMubXVsdGlwbGVTZWxlY3Rpb25Db250cm9sbGVyLmlzU2VsZWN0aW9uUmFuZ2VDaGFuZ2VFdmVudChPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIGUpLCB7CiAgICAgICAgICBlbGVtZW50OiBlLmVsZW1lbnQKICAgICAgICB9KSk7CiAgICAgIH0KICAgIH0sCiAgICBhY2Nlc3NpYmlsaXR5UHJvdmlkZXI6IG9wdGlvbnMuYWNjZXNzaWJpbGl0eVByb3ZpZGVyICYmIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgb3B0aW9ucy5hY2Nlc3NpYmlsaXR5UHJvdmlkZXIpLCB7CiAgICAgIGdldFBvc0luU2V0OiB1bmRlZmluZWQsCiAgICAgIGdldFNldFNpemU6IHVuZGVmaW5lZCwKICAgICAgZ2V0Um9sZTogb3B0aW9ucy5hY2Nlc3NpYmlsaXR5UHJvdmlkZXIuZ2V0Um9sZSA/IGZ1bmN0aW9uIChlbCkgewogICAgICAgIHJldHVybiBvcHRpb25zLmFjY2Vzc2liaWxpdHlQcm92aWRlci5nZXRSb2xlKGVsLmVsZW1lbnQpOwogICAgICB9IDogZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiAndHJlZWl0ZW0nOwogICAgICB9LAogICAgICBpc0NoZWNrZWQ6IG9wdGlvbnMuYWNjZXNzaWJpbGl0eVByb3ZpZGVyLmlzQ2hlY2tlZCA/IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgdmFyIF9hOwogICAgICAgIHJldHVybiAhISgoX2EgPSBvcHRpb25zLmFjY2Vzc2liaWxpdHlQcm92aWRlcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmlzQ2hlY2tlZChlLmVsZW1lbnQpKTsKICAgICAgfSA6IHVuZGVmaW5lZCwKICAgICAgZ2V0QXJpYUxhYmVsOiBmdW5jdGlvbiBnZXRBcmlhTGFiZWwoZSkgewogICAgICAgIHJldHVybiBvcHRpb25zLmFjY2Vzc2liaWxpdHlQcm92aWRlci5nZXRBcmlhTGFiZWwoZS5lbGVtZW50KTsKICAgICAgfSwKICAgICAgZ2V0V2lkZ2V0QXJpYUxhYmVsOiBmdW5jdGlvbiBnZXRXaWRnZXRBcmlhTGFiZWwoKSB7CiAgICAgICAgcmV0dXJuIG9wdGlvbnMuYWNjZXNzaWJpbGl0eVByb3ZpZGVyLmdldFdpZGdldEFyaWFMYWJlbCgpOwogICAgICB9LAogICAgICBnZXRXaWRnZXRSb2xlOiBvcHRpb25zLmFjY2Vzc2liaWxpdHlQcm92aWRlci5nZXRXaWRnZXRSb2xlID8gZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBvcHRpb25zLmFjY2Vzc2liaWxpdHlQcm92aWRlci5nZXRXaWRnZXRSb2xlKCk7CiAgICAgIH0gOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuICd0cmVlJzsKICAgICAgfSwKICAgICAgZ2V0QXJpYUxldmVsOiBvcHRpb25zLmFjY2Vzc2liaWxpdHlQcm92aWRlci5nZXRBcmlhTGV2ZWwgJiYgZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICByZXR1cm4gb3B0aW9ucy5hY2Nlc3NpYmlsaXR5UHJvdmlkZXIuZ2V0QXJpYUxldmVsKG5vZGUuZWxlbWVudCk7CiAgICAgIH0sCiAgICAgIGdldEFjdGl2ZURlc2NlbmRhbnRJZDogb3B0aW9ucy5hY2Nlc3NpYmlsaXR5UHJvdmlkZXIuZ2V0QWN0aXZlRGVzY2VuZGFudElkICYmIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgcmV0dXJuIG9wdGlvbnMuYWNjZXNzaWJpbGl0eVByb3ZpZGVyLmdldEFjdGl2ZURlc2NlbmRhbnRJZChub2RlLmVsZW1lbnQpOwogICAgICB9CiAgICB9KSwKICAgIGZpbHRlcjogb3B0aW9ucy5maWx0ZXIgJiYgewogICAgICBmaWx0ZXI6IGZ1bmN0aW9uIGZpbHRlcihlLCBwYXJlbnRWaXNpYmlsaXR5KSB7CiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZmlsdGVyLmZpbHRlcihlLmVsZW1lbnQsIHBhcmVudFZpc2liaWxpdHkpOwogICAgICB9CiAgICB9LAogICAga2V5Ym9hcmROYXZpZ2F0aW9uTGFiZWxQcm92aWRlcjogb3B0aW9ucy5rZXlib2FyZE5hdmlnYXRpb25MYWJlbFByb3ZpZGVyICYmIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgb3B0aW9ucy5rZXlib2FyZE5hdmlnYXRpb25MYWJlbFByb3ZpZGVyKSwgewogICAgICBnZXRLZXlib2FyZE5hdmlnYXRpb25MYWJlbDogZnVuY3Rpb24gZ2V0S2V5Ym9hcmROYXZpZ2F0aW9uTGFiZWwoZSkgewogICAgICAgIHJldHVybiBvcHRpb25zLmtleWJvYXJkTmF2aWdhdGlvbkxhYmVsUHJvdmlkZXIuZ2V0S2V5Ym9hcmROYXZpZ2F0aW9uTGFiZWwoZS5lbGVtZW50KTsKICAgICAgfQogICAgfSksCiAgICBzb3J0ZXI6IHVuZGVmaW5lZCwKICAgIGV4cGFuZE9ubHlPblR3aXN0aWVDbGljazogdHlwZW9mIG9wdGlvbnMuZXhwYW5kT25seU9uVHdpc3RpZUNsaWNrID09PSAndW5kZWZpbmVkJyA/IHVuZGVmaW5lZCA6IHR5cGVvZiBvcHRpb25zLmV4cGFuZE9ubHlPblR3aXN0aWVDbGljayAhPT0gJ2Z1bmN0aW9uJyA/IG9wdGlvbnMuZXhwYW5kT25seU9uVHdpc3RpZUNsaWNrIDogZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuIG9wdGlvbnMuZXhwYW5kT25seU9uVHdpc3RpZUNsaWNrKGUuZWxlbWVudCk7CiAgICB9LAogICAgYWRkaXRpb25hbFNjcm9sbEhlaWdodDogb3B0aW9ucy5hZGRpdGlvbmFsU2Nyb2xsSGVpZ2h0CiAgfSk7Cn0KZnVuY3Rpb24gZGZzKG5vZGUsIGZuKSB7CiAgZm4obm9kZSk7CiAgbm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkgewogICAgcmV0dXJuIGRmcyhjaGlsZCwgZm4pOwogIH0pOwp9CmV4cG9ydCB2YXIgQXN5bmNEYXRhVHJlZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQXN5bmNEYXRhVHJlZSh1c2VyLCBjb250YWluZXIsIGRlbGVnYXRlLCByZW5kZXJlcnMsIGRhdGFTb3VyY2UpIHsKICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDUgJiYgYXJndW1lbnRzWzVdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbNV0gOiB7fTsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBc3luY0RhdGFUcmVlKTsKICAgIHRoaXMudXNlciA9IHVzZXI7CiAgICB0aGlzLmRhdGFTb3VyY2UgPSBkYXRhU291cmNlOwogICAgdGhpcy5ub2RlcyA9IG5ldyBNYXAoKTsKICAgIHRoaXMuc3ViVHJlZVJlZnJlc2hQcm9taXNlcyA9IG5ldyBNYXAoKTsKICAgIHRoaXMucmVmcmVzaFByb21pc2VzID0gbmV3IE1hcCgpOwogICAgdGhpcy5fb25EaWRSZW5kZXIgPSBuZXcgRW1pdHRlcigpOwogICAgdGhpcy5fb25EaWRDaGFuZ2VOb2RlU2xvd1N0YXRlID0gbmV3IEVtaXR0ZXIoKTsKICAgIHRoaXMubm9kZU1hcHBlciA9IG5ldyBXZWFrTWFwcGVyKGZ1bmN0aW9uIChub2RlKSB7CiAgICAgIHJldHVybiBuZXcgQXN5bmNEYXRhVHJlZU5vZGVXcmFwcGVyKG5vZGUpOwogICAgfSk7CiAgICB0aGlzLmRpc3Bvc2FibGVzID0gbmV3IERpc3Bvc2FibGVTdG9yZSgpOwogICAgdGhpcy5pZGVudGl0eVByb3ZpZGVyID0gb3B0aW9ucy5pZGVudGl0eVByb3ZpZGVyOwogICAgdGhpcy5hdXRvRXhwYW5kU2luZ2xlQ2hpbGRyZW4gPSB0eXBlb2Ygb3B0aW9ucy5hdXRvRXhwYW5kU2luZ2xlQ2hpbGRyZW4gPT09ICd1bmRlZmluZWQnID8gZmFsc2UgOiBvcHRpb25zLmF1dG9FeHBhbmRTaW5nbGVDaGlsZHJlbjsKICAgIHRoaXMuc29ydGVyID0gb3B0aW9ucy5zb3J0ZXI7CiAgICB0aGlzLmNvbGxhcHNlQnlEZWZhdWx0ID0gb3B0aW9ucy5jb2xsYXBzZUJ5RGVmYXVsdDsKICAgIHRoaXMudHJlZSA9IHRoaXMuY3JlYXRlVHJlZSh1c2VyLCBjb250YWluZXIsIGRlbGVnYXRlLCByZW5kZXJlcnMsIG9wdGlvbnMpOwogICAgdGhpcy5vbkRpZENoYW5nZUZpbmRNb2RlID0gdGhpcy50cmVlLm9uRGlkQ2hhbmdlRmluZE1vZGU7CiAgICB0aGlzLnJvb3QgPSBjcmVhdGVBc3luY0RhdGFUcmVlTm9kZSh7CiAgICAgIGVsZW1lbnQ6IHVuZGVmaW5lZCwKICAgICAgcGFyZW50OiBudWxsLAogICAgICBoYXNDaGlsZHJlbjogdHJ1ZQogICAgfSk7CiAgICBpZiAodGhpcy5pZGVudGl0eVByb3ZpZGVyKSB7CiAgICAgIHRoaXMucm9vdCA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5yb290KSwgewogICAgICAgIGlkOiBudWxsCiAgICAgIH0pOwogICAgfQogICAgdGhpcy5ub2Rlcy5zZXQobnVsbCwgdGhpcy5yb290KTsKICAgIHRoaXMudHJlZS5vbkRpZENoYW5nZUNvbGxhcHNlU3RhdGUodGhpcy5fb25EaWRDaGFuZ2VDb2xsYXBzZVN0YXRlLCB0aGlzLCB0aGlzLmRpc3Bvc2FibGVzKTsKICB9CiAgX2NyZWF0ZUNsYXNzKEFzeW5jRGF0YVRyZWUsIFt7CiAgICBrZXk6ICJvbkRpZENoYW5nZUZvY3VzIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gRXZlbnQubWFwKHRoaXMudHJlZS5vbkRpZENoYW5nZUZvY3VzLCBhc1RyZWVFdmVudCk7CiAgICB9CiAgfSwgewogICAga2V5OiAib25EaWRDaGFuZ2VTZWxlY3Rpb24iLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiBFdmVudC5tYXAodGhpcy50cmVlLm9uRGlkQ2hhbmdlU2VsZWN0aW9uLCBhc1RyZWVFdmVudCk7CiAgICB9CiAgfSwgewogICAga2V5OiAib25Nb3VzZURibENsaWNrIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gRXZlbnQubWFwKHRoaXMudHJlZS5vbk1vdXNlRGJsQ2xpY2ssIGFzVHJlZU1vdXNlRXZlbnQpOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uUG9pbnRlciIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIEV2ZW50Lm1hcCh0aGlzLnRyZWUub25Qb2ludGVyLCBhc1RyZWVNb3VzZUV2ZW50KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvbkRpZEZvY3VzIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy50cmVlLm9uRGlkRm9jdXM7CiAgICB9CiAgfSwgewogICAga2V5OiAib25EaWRDaGFuZ2VNb2RlbCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMudHJlZS5vbkRpZENoYW5nZU1vZGVsOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uRGlkQ2hhbmdlQ29sbGFwc2VTdGF0ZSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMudHJlZS5vbkRpZENoYW5nZUNvbGxhcHNlU3RhdGU7CiAgICB9CiAgfSwgewogICAga2V5OiAib25EaWRDaGFuZ2VGaW5kT3BlblN0YXRlIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy50cmVlLm9uRGlkQ2hhbmdlRmluZE9wZW5TdGF0ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvbkRpZERpc3Bvc2UiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLnRyZWUub25EaWREaXNwb3NlOwogICAgfQogIH0sIHsKICAgIGtleTogImNyZWF0ZVRyZWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZVRyZWUodXNlciwgY29udGFpbmVyLCBkZWxlZ2F0ZSwgcmVuZGVyZXJzLCBvcHRpb25zKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwogICAgICB2YXIgb2JqZWN0VHJlZURlbGVnYXRlID0gbmV3IENvbXBvc2VkVHJlZURlbGVnYXRlKGRlbGVnYXRlKTsKICAgICAgdmFyIG9iamVjdFRyZWVSZW5kZXJlcnMgPSByZW5kZXJlcnMubWFwKGZ1bmN0aW9uIChyKSB7CiAgICAgICAgcmV0dXJuIG5ldyBBc3luY0RhdGFUcmVlUmVuZGVyZXIociwgX3RoaXMyLm5vZGVNYXBwZXIsIF90aGlzMi5fb25EaWRDaGFuZ2VOb2RlU2xvd1N0YXRlLmV2ZW50KTsKICAgICAgfSk7CiAgICAgIHZhciBvYmplY3RUcmVlT3B0aW9ucyA9IGFzT2JqZWN0VHJlZU9wdGlvbnMob3B0aW9ucykgfHwge307CiAgICAgIHJldHVybiBuZXcgT2JqZWN0VHJlZSh1c2VyLCBjb250YWluZXIsIG9iamVjdFRyZWVEZWxlZ2F0ZSwgb2JqZWN0VHJlZVJlbmRlcmVycywgb2JqZWN0VHJlZU9wdGlvbnMpOwogICAgfQogIH0sIHsKICAgIGtleTogInVwZGF0ZU9wdGlvbnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZU9wdGlvbnMoKSB7CiAgICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTsKICAgICAgdGhpcy50cmVlLnVwZGF0ZU9wdGlvbnMob3B0aW9ucyk7CiAgICB9CiAgICAvLyBXaWRnZXQKICB9LCB7CiAgICBrZXk6ICJnZXRIVE1MRWxlbWVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0SFRNTEVsZW1lbnQoKSB7CiAgICAgIHJldHVybiB0aGlzLnRyZWUuZ2V0SFRNTEVsZW1lbnQoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzY3JvbGxUb3AiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLnRyZWUuc2Nyb2xsVG9wOwogICAgfSwKICAgIHNldDogZnVuY3Rpb24gc2V0KHNjcm9sbFRvcCkgewogICAgICB0aGlzLnRyZWUuc2Nyb2xsVG9wID0gc2Nyb2xsVG9wOwogICAgfQogIH0sIHsKICAgIGtleTogImRvbUZvY3VzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkb21Gb2N1cygpIHsKICAgICAgdGhpcy50cmVlLmRvbUZvY3VzKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAibGF5b3V0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBsYXlvdXQoaGVpZ2h0LCB3aWR0aCkgewogICAgICB0aGlzLnRyZWUubGF5b3V0KGhlaWdodCwgd2lkdGgpOwogICAgfQogIH0sIHsKICAgIGtleTogInN0eWxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzdHlsZShzdHlsZXMpIHsKICAgICAgdGhpcy50cmVlLnN0eWxlKHN0eWxlcyk7CiAgICB9CiAgICAvLyBNb2RlbAogIH0sIHsKICAgIGtleTogImdldElucHV0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRJbnB1dCgpIHsKICAgICAgcmV0dXJuIHRoaXMucm9vdC5lbGVtZW50OwogICAgfQogIH0sIHsKICAgIGtleTogInNldElucHV0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRJbnB1dChpbnB1dCwgdmlld1N0YXRlKSB7CiAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciB2aWV3U3RhdGVDb250ZXh0OwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaFByb21pc2VzLmZvckVhY2goZnVuY3Rpb24gKHByb21pc2UpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2UuY2FuY2VsKCk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaFByb21pc2VzLmNsZWFyKCk7CiAgICAgICAgICAgICAgICB0aGlzLnJvb3QuZWxlbWVudCA9IGlucHV0OwogICAgICAgICAgICAgICAgdmlld1N0YXRlQ29udGV4dCA9IHZpZXdTdGF0ZSAmJiB7CiAgICAgICAgICAgICAgICAgIHZpZXdTdGF0ZTogdmlld1N0YXRlLAogICAgICAgICAgICAgICAgICBmb2N1czogW10sCiAgICAgICAgICAgICAgICAgIHNlbGVjdGlvbjogW10KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNjsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl91cGRhdGVDaGlsZHJlbihpbnB1dCwgdHJ1ZSwgZmFsc2UsIHZpZXdTdGF0ZUNvbnRleHQpOwogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIGlmICh2aWV3U3RhdGVDb250ZXh0KSB7CiAgICAgICAgICAgICAgICAgIHRoaXMudHJlZS5zZXRGb2N1cyh2aWV3U3RhdGVDb250ZXh0LmZvY3VzKTsKICAgICAgICAgICAgICAgICAgdGhpcy50cmVlLnNldFNlbGVjdGlvbih2aWV3U3RhdGVDb250ZXh0LnNlbGVjdGlvbik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAodmlld1N0YXRlICYmIHR5cGVvZiB2aWV3U3RhdGUuc2Nyb2xsVG9wID09PSAnbnVtYmVyJykgewogICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbFRvcCA9IHZpZXdTdGF0ZS5zY3JvbGxUb3A7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7CiAgICAgIH0pKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfdXBkYXRlQ2hpbGRyZW4iLAogICAgdmFsdWU6IGZ1bmN0aW9uIF91cGRhdGVDaGlsZHJlbigpIHsKICAgICAgdmFyIGVsZW1lbnQgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHRoaXMucm9vdC5lbGVtZW50OwogICAgICB2YXIgcmVjdXJzaXZlID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB0cnVlOwogICAgICB2YXIgcmVyZW5kZXIgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IGZhbHNlOwogICAgICB2YXIgdmlld1N0YXRlQ29udGV4dCA9IGFyZ3VtZW50cy5sZW5ndGggPiAzID8gYXJndW1lbnRzWzNdIDogdW5kZWZpbmVkOwogICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ID8gYXJndW1lbnRzWzRdIDogdW5kZWZpbmVkOwogICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgdmFyIG5vZGU7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGlmICghKHR5cGVvZiB0aGlzLnJvb3QuZWxlbWVudCA9PT0gJ3VuZGVmaW5lZCcpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHJlZUVycm9yKHRoaXMudXNlciwgJ1RyZWUgaW5wdXQgbm90IHNldCcpOwogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIGlmICghdGhpcy5yb290LnJlZnJlc2hQcm9taXNlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDU7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yb290LnJlZnJlc2hQcm9taXNlOwogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNzsKICAgICAgICAgICAgICAgIHJldHVybiBFdmVudC50b1Byb21pc2UodGhpcy5fb25EaWRSZW5kZXIuZXZlbnQpOwogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIG5vZGUgPSB0aGlzLmdldERhdGFOb2RlKGVsZW1lbnQpOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMDsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlZnJlc2hBbmRSZW5kZXJOb2RlKG5vZGUsIHJlY3Vyc2l2ZSwgdmlld1N0YXRlQ29udGV4dCwgb3B0aW9ucyk7CiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgIGlmIChyZXJlbmRlcikgewogICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHRoaXMudHJlZS5yZXJlbmRlcihub2RlKTsKICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoX2EpIHsKICAgICAgICAgICAgICAgICAgICAvLyBtaXNzaW5nIG5vZGVzIGFyZSBmaW5lLCB0aGlzIGNvdWxkJ3ZlIHJlc3VsdGVkIGZyb20KICAgICAgICAgICAgICAgICAgICAvLyBwYXJhbGxlbCByZWZyZXNoIGNhbGxzLCByZW1vdmluZyBgbm9kZWAgYWx0b2dldGhlcgogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMiwgdGhpcyk7CiAgICAgIH0pKTsKICAgIH0KICAgIC8vIFZpZXcKICB9LCB7CiAgICBrZXk6ICJyZXJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVyZW5kZXIoZWxlbWVudCkgewogICAgICBpZiAoZWxlbWVudCA9PT0gdW5kZWZpbmVkIHx8IGVsZW1lbnQgPT09IHRoaXMucm9vdC5lbGVtZW50KSB7CiAgICAgICAgdGhpcy50cmVlLnJlcmVuZGVyKCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHZhciBub2RlID0gdGhpcy5nZXREYXRhTm9kZShlbGVtZW50KTsKICAgICAgdGhpcy50cmVlLnJlcmVuZGVyKG5vZGUpOwogICAgfQogICAgLy8gVHJlZQogIH0sIHsKICAgIGtleTogImdldE5vZGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldE5vZGUoKSB7CiAgICAgIHZhciBlbGVtZW50ID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB0aGlzLnJvb3QuZWxlbWVudDsKICAgICAgdmFyIGRhdGFOb2RlID0gdGhpcy5nZXREYXRhTm9kZShlbGVtZW50KTsKICAgICAgdmFyIG5vZGUgPSB0aGlzLnRyZWUuZ2V0Tm9kZShkYXRhTm9kZSA9PT0gdGhpcy5yb290ID8gbnVsbCA6IGRhdGFOb2RlKTsKICAgICAgcmV0dXJuIHRoaXMubm9kZU1hcHBlci5tYXAobm9kZSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29sbGFwc2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbGxhcHNlKGVsZW1lbnQpIHsKICAgICAgdmFyIHJlY3Vyc2l2ZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CiAgICAgIHZhciBub2RlID0gdGhpcy5nZXREYXRhTm9kZShlbGVtZW50KTsKICAgICAgcmV0dXJuIHRoaXMudHJlZS5jb2xsYXBzZShub2RlID09PSB0aGlzLnJvb3QgPyBudWxsIDogbm9kZSwgcmVjdXJzaXZlKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJleHBhbmQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGV4cGFuZChlbGVtZW50KSB7CiAgICAgIHZhciByZWN1cnNpdmUgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlOwogICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgICAgdmFyIG5vZGUsIHJlc3VsdDsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaWYgKCEodHlwZW9mIHRoaXMucm9vdC5lbGVtZW50ID09PSAndW5kZWZpbmVkJykpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRocm93IG5ldyBUcmVlRXJyb3IodGhpcy51c2VyLCAnVHJlZSBpbnB1dCBub3Qgc2V0Jyk7CiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgaWYgKCF0aGlzLnJvb3QucmVmcmVzaFByb21pc2UpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJvb3QucmVmcmVzaFByb21pc2U7CiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA3OwogICAgICAgICAgICAgICAgcmV0dXJuIEV2ZW50LnRvUHJvbWlzZSh0aGlzLl9vbkRpZFJlbmRlci5ldmVudCk7CiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgbm9kZSA9IHRoaXMuZ2V0RGF0YU5vZGUoZWxlbWVudCk7CiAgICAgICAgICAgICAgICBpZiAoISh0aGlzLnRyZWUuaGFzRWxlbWVudChub2RlKSAmJiAhdGhpcy50cmVlLmlzQ29sbGFwc2libGUobm9kZSkpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIGZhbHNlKTsKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgaWYgKCFub2RlLnJlZnJlc2hQcm9taXNlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAxMzsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJvb3QucmVmcmVzaFByb21pc2U7CiAgICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgICByZXR1cm4gRXZlbnQudG9Qcm9taXNlKHRoaXMuX29uRGlkUmVuZGVyLmV2ZW50KTsKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgICAgaWYgKCEobm9kZSAhPT0gdGhpcy5yb290ICYmICFub2RlLnJlZnJlc2hQcm9taXNlICYmICF0aGlzLnRyZWUuaXNDb2xsYXBzZWQobm9kZSkpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIGZhbHNlKTsKICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy50cmVlLmV4cGFuZChub2RlID09PSB0aGlzLnJvb3QgPyBudWxsIDogbm9kZSwgcmVjdXJzaXZlKTsKICAgICAgICAgICAgICAgIGlmICghbm9kZS5yZWZyZXNoUHJvbWlzZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDIzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMjE7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yb290LnJlZnJlc2hQcm9taXNlOwogICAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDIzOwogICAgICAgICAgICAgICAgcmV0dXJuIEV2ZW50LnRvUHJvbWlzZSh0aGlzLl9vbkRpZFJlbmRlci5ldmVudCk7CiAgICAgICAgICAgICAgY2FzZSAyMzoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iLCByZXN1bHQpOwogICAgICAgICAgICAgIGNhc2UgMjQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMsIHRoaXMpOwogICAgICB9KSk7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0U2VsZWN0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRTZWxlY3Rpb24oZWxlbWVudHMsIGJyb3dzZXJFdmVudCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKICAgICAgdmFyIG5vZGVzID0gZWxlbWVudHMubWFwKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMy5nZXREYXRhTm9kZShlKTsKICAgICAgfSk7CiAgICAgIHRoaXMudHJlZS5zZXRTZWxlY3Rpb24obm9kZXMsIGJyb3dzZXJFdmVudCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0U2VsZWN0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTZWxlY3Rpb24oKSB7CiAgICAgIHZhciBub2RlcyA9IHRoaXMudHJlZS5nZXRTZWxlY3Rpb24oKTsKICAgICAgcmV0dXJuIG5vZGVzLm1hcChmdW5jdGlvbiAobikgewogICAgICAgIHJldHVybiBuLmVsZW1lbnQ7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInNldEZvY3VzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRGb2N1cyhlbGVtZW50cywgYnJvd3NlckV2ZW50KSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwogICAgICB2YXIgbm9kZXMgPSBlbGVtZW50cy5tYXAoZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gX3RoaXM0LmdldERhdGFOb2RlKGUpOwogICAgICB9KTsKICAgICAgdGhpcy50cmVlLnNldEZvY3VzKG5vZGVzLCBicm93c2VyRXZlbnQpOwogICAgfQogIH0sIHsKICAgIGtleTogImdldEZvY3VzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRGb2N1cygpIHsKICAgICAgdmFyIG5vZGVzID0gdGhpcy50cmVlLmdldEZvY3VzKCk7CiAgICAgIHJldHVybiBub2Rlcy5tYXAoZnVuY3Rpb24gKG4pIHsKICAgICAgICByZXR1cm4gbi5lbGVtZW50OwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZXZlYWwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJldmVhbChlbGVtZW50LCByZWxhdGl2ZVRvcCkgewogICAgICB0aGlzLnRyZWUucmV2ZWFsKHRoaXMuZ2V0RGF0YU5vZGUoZWxlbWVudCksIHJlbGF0aXZlVG9wKTsKICAgIH0KICAgIC8vIFRyZWUgbmF2aWdhdGlvbgogIH0sIHsKICAgIGtleTogImdldFBhcmVudEVsZW1lbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFBhcmVudEVsZW1lbnQoZWxlbWVudCkgewogICAgICB2YXIgbm9kZSA9IHRoaXMudHJlZS5nZXRQYXJlbnRFbGVtZW50KHRoaXMuZ2V0RGF0YU5vZGUoZWxlbWVudCkpOwogICAgICByZXR1cm4gbm9kZSAmJiBub2RlLmVsZW1lbnQ7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0Rmlyc3RFbGVtZW50Q2hpbGQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEZpcnN0RWxlbWVudENoaWxkKCkgewogICAgICB2YXIgZWxlbWVudCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogdGhpcy5yb290LmVsZW1lbnQ7CiAgICAgIHZhciBkYXRhTm9kZSA9IHRoaXMuZ2V0RGF0YU5vZGUoZWxlbWVudCk7CiAgICAgIHZhciBub2RlID0gdGhpcy50cmVlLmdldEZpcnN0RWxlbWVudENoaWxkKGRhdGFOb2RlID09PSB0aGlzLnJvb3QgPyBudWxsIDogZGF0YU5vZGUpOwogICAgICByZXR1cm4gbm9kZSAmJiBub2RlLmVsZW1lbnQ7CiAgICB9CiAgICAvLyBJbXBsZW1lbnRhdGlvbgogIH0sIHsKICAgIGtleTogImdldERhdGFOb2RlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXREYXRhTm9kZShlbGVtZW50KSB7CiAgICAgIHZhciBub2RlID0gdGhpcy5ub2Rlcy5nZXQoZWxlbWVudCA9PT0gdGhpcy5yb290LmVsZW1lbnQgPyBudWxsIDogZWxlbWVudCk7CiAgICAgIGlmICghbm9kZSkgewogICAgICAgIHRocm93IG5ldyBUcmVlRXJyb3IodGhpcy51c2VyLCAiRGF0YSB0cmVlIG5vZGUgbm90IGZvdW5kOiAiLmNvbmNhdChlbGVtZW50KSk7CiAgICAgIH0KICAgICAgcmV0dXJuIG5vZGU7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVmcmVzaEFuZFJlbmRlck5vZGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlZnJlc2hBbmRSZW5kZXJOb2RlKG5vZGUsIHJlY3Vyc2l2ZSwgdmlld1N0YXRlQ29udGV4dCwgb3B0aW9ucykgewogICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlZnJlc2hOb2RlKG5vZGUsIHJlY3Vyc2l2ZSwgdmlld1N0YXRlQ29udGV4dCk7CiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIobm9kZSwgdmlld1N0YXRlQ29udGV4dCwgb3B0aW9ucyk7CiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU0LCB0aGlzKTsKICAgICAgfSkpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlZnJlc2hOb2RlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZWZyZXNoTm9kZShub2RlLCByZWN1cnNpdmUsIHZpZXdTdGF0ZUNvbnRleHQpIHsKICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KCkgewogICAgICAgIHZhciBfdGhpczUgPSB0aGlzOwogICAgICAgIHZhciByZXN1bHQsIHRyZWVOb2RlOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICB0aGlzLnN1YlRyZWVSZWZyZXNoUHJvbWlzZXMuZm9yRWFjaChmdW5jdGlvbiAocmVmcmVzaFByb21pc2UsIHJlZnJlc2hOb2RlKSB7CiAgICAgICAgICAgICAgICAgIGlmICghcmVzdWx0ICYmIGludGVyc2VjdHMocmVmcmVzaE5vZGUsIG5vZGUpKSB7CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVmcmVzaFByb21pc2UudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM1LnJlZnJlc2hOb2RlKG5vZGUsIHJlY3Vyc2l2ZSwgdmlld1N0YXRlQ29udGV4dCk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgaWYgKCFyZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iLCByZXN1bHQpOwogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIGlmICghKG5vZGUgIT09IHRoaXMucm9vdCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRyZWVOb2RlID0gdGhpcy50cmVlLmdldE5vZGUobm9kZSk7CiAgICAgICAgICAgICAgICBpZiAoIXRyZWVOb2RlLmNvbGxhcHNlZCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDk7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbm9kZS5oYXNDaGlsZHJlbiA9ICEhdGhpcy5kYXRhU291cmNlLmhhc0NoaWxkcmVuKG5vZGUuZWxlbWVudCk7CiAgICAgICAgICAgICAgICBub2RlLnN0YWxlID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iKTsKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdCgicmV0dXJuIiwgdGhpcy5kb1JlZnJlc2hTdWJUcmVlKG5vZGUsIHJlY3Vyc2l2ZSwgdmlld1N0YXRlQ29udGV4dCkpOwogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTUsIHRoaXMpOwogICAgICB9KSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZG9SZWZyZXNoU3ViVHJlZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZG9SZWZyZXNoU3ViVHJlZShub2RlLCByZWN1cnNpdmUsIHZpZXdTdGF0ZUNvbnRleHQpIHsKICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KCkgewogICAgICAgIHZhciBfdGhpczYgPSB0aGlzOwogICAgICAgIHZhciBkb25lLCBjaGlsZHJlblRvUmVmcmVzaDsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0NikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgbm9kZS5yZWZyZXNoUHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChjKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBkb25lID0gYzsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgdGhpcy5zdWJUcmVlUmVmcmVzaFByb21pc2VzLnNldChub2RlLCBub2RlLnJlZnJlc2hQcm9taXNlKTsKICAgICAgICAgICAgICAgIG5vZGUucmVmcmVzaFByb21pc2UuZmluYWxseShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIG5vZGUucmVmcmVzaFByb21pc2UgPSB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICAgIF90aGlzNi5zdWJUcmVlUmVmcmVzaFByb21pc2VzLmRlbGV0ZShub2RlKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgX2NvbnRleHQ2LnByZXYgPSAzOwogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZG9SZWZyZXNoTm9kZShub2RlLCByZWN1cnNpdmUsIHZpZXdTdGF0ZUNvbnRleHQpOwogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIGNoaWxkcmVuVG9SZWZyZXNoID0gX2NvbnRleHQ2LnNlbnQ7CiAgICAgICAgICAgICAgICBub2RlLnN0YWxlID0gZmFsc2U7CiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2VzLnNldHRsZWQoY2hpbGRyZW5Ub1JlZnJlc2gubWFwKGZ1bmN0aW9uIChjaGlsZCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM2LmRvUmVmcmVzaFN1YlRyZWUoY2hpbGQsIHJlY3Vyc2l2ZSwgdmlld1N0YXRlQ29udGV4dCk7CiAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5wcmV2ID0gMTA7CiAgICAgICAgICAgICAgICBkb25lKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmZpbmlzaCgxMCk7CiAgICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNiwgdGhpcywgW1szLCwgMTAsIDEzXV0pOwogICAgICB9KSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZG9SZWZyZXNoTm9kZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZG9SZWZyZXNoTm9kZShub2RlLCByZWN1cnNpdmUsIHZpZXdTdGF0ZUNvbnRleHQpIHsKICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU3KCkgewogICAgICAgIHZhciBfdGhpczcgPSB0aGlzOwogICAgICAgIHZhciBjaGlsZHJlblByb21pc2UsIGNoaWxkcmVuLCBzbG93VGltZW91dCwgX2NoaWxkcmVuOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlNyQoX2NvbnRleHQ3KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ny5wcmV2ID0gX2NvbnRleHQ3Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBub2RlLmhhc0NoaWxkcmVuID0gISF0aGlzLmRhdGFTb3VyY2UuaGFzQ2hpbGRyZW4obm9kZS5lbGVtZW50KTsKICAgICAgICAgICAgICAgIGlmICghbm9kZS5oYXNDaGlsZHJlbikgewogICAgICAgICAgICAgICAgICBjaGlsZHJlblByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoSXRlcmFibGUuZW1wdHkoKSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBjaGlsZHJlbiA9IHRoaXMuZG9HZXRDaGlsZHJlbihub2RlKTsKICAgICAgICAgICAgICAgICAgaWYgKGlzSXRlcmFibGUoY2hpbGRyZW4pKSB7CiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW5Qcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKGNoaWxkcmVuKTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBzbG93VGltZW91dCA9IHRpbWVvdXQoODAwKTsKICAgICAgICAgICAgICAgICAgICBzbG93VGltZW91dC50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgIG5vZGUuc2xvdyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICBfdGhpczcuX29uRGlkQ2hhbmdlTm9kZVNsb3dTdGF0ZS5maXJlKG5vZGUpOwogICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChfKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICBjaGlsZHJlblByb21pc2UgPSBjaGlsZHJlbi5maW5hbGx5KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzbG93VGltZW91dC5jYW5jZWwoKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgX2NvbnRleHQ3LnByZXYgPSAyOwogICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkcmVuUHJvbWlzZTsKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBfY2hpbGRyZW4gPSBfY29udGV4dDcuc2VudDsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KCJyZXR1cm4iLCB0aGlzLnNldENoaWxkcmVuKG5vZGUsIF9jaGlsZHJlbiwgcmVjdXJzaXZlLCB2aWV3U3RhdGVDb250ZXh0KSk7CiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgX2NvbnRleHQ3LnByZXYgPSA5OwogICAgICAgICAgICAgICAgX2NvbnRleHQ3LnQwID0gX2NvbnRleHQ3WyJjYXRjaCJdKDIpOwogICAgICAgICAgICAgICAgaWYgKG5vZGUgIT09IHRoaXMucm9vdCAmJiB0aGlzLnRyZWUuaGFzRWxlbWVudChub2RlKSkgewogICAgICAgICAgICAgICAgICB0aGlzLnRyZWUuY29sbGFwc2Uobm9kZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoIWlzQ2FuY2VsbGF0aW9uRXJyb3IoX2NvbnRleHQ3LnQwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KCJyZXR1cm4iLCBbXSk7CiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgIHRocm93IF9jb250ZXh0Ny50MDsKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgICAgX2NvbnRleHQ3LnByZXYgPSAxNTsKICAgICAgICAgICAgICAgIGlmIChub2RlLnNsb3cpIHsKICAgICAgICAgICAgICAgICAgbm9kZS5zbG93ID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgIHRoaXMuX29uRGlkQ2hhbmdlTm9kZVNsb3dTdGF0ZS5maXJlKG5vZGUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5maW5pc2goMTUpOwogICAgICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTcsIHRoaXMsIFtbMiwgOSwgMTUsIDE4XV0pOwogICAgICB9KSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZG9HZXRDaGlsZHJlbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZG9HZXRDaGlsZHJlbihub2RlKSB7CiAgICAgIHZhciBfdGhpczggPSB0aGlzOwogICAgICB2YXIgcmVzdWx0ID0gdGhpcy5yZWZyZXNoUHJvbWlzZXMuZ2V0KG5vZGUpOwogICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgfQogICAgICB2YXIgY2hpbGRyZW4gPSB0aGlzLmRhdGFTb3VyY2UuZ2V0Q2hpbGRyZW4obm9kZS5lbGVtZW50KTsKICAgICAgaWYgKGlzSXRlcmFibGUoY2hpbGRyZW4pKSB7CiAgICAgICAgcmV0dXJuIHRoaXMucHJvY2Vzc0NoaWxkcmVuKGNoaWxkcmVuKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXN1bHQgPSBjcmVhdGVDYW5jZWxhYmxlUHJvbWlzZShmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gX19hd2FpdGVyKF90aGlzOCwgdm9pZCAwLCB2b2lkIDAsIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlOCgpIHsKICAgICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU4JChfY29udGV4dDgpIHsKICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBfY29udGV4dDgudDAgPSB0aGlzOwogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGRyZW47CiAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICBfY29udGV4dDgudDEgPSBfY29udGV4dDguc2VudDsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LmFicnVwdCgicmV0dXJuIiwgX2NvbnRleHQ4LnQwLnByb2Nlc3NDaGlsZHJlbi5jYWxsKF9jb250ZXh0OC50MCwgX2NvbnRleHQ4LnQxKSk7CiAgICAgICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIF9jYWxsZWU4LCB0aGlzKTsKICAgICAgICAgIH0pKTsKICAgICAgICB9KTsKICAgICAgICB0aGlzLnJlZnJlc2hQcm9taXNlcy5zZXQobm9kZSwgcmVzdWx0KTsKICAgICAgICByZXR1cm4gcmVzdWx0LmZpbmFsbHkoZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXM4LnJlZnJlc2hQcm9taXNlcy5kZWxldGUobm9kZSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJfb25EaWRDaGFuZ2VDb2xsYXBzZVN0YXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25EaWRDaGFuZ2VDb2xsYXBzZVN0YXRlKF9yZWYpIHsKICAgICAgdmFyIG5vZGUgPSBfcmVmLm5vZGUsCiAgICAgICAgZGVlcCA9IF9yZWYuZGVlcDsKICAgICAgaWYgKG5vZGUuZWxlbWVudCA9PT0gbnVsbCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoIW5vZGUuY29sbGFwc2VkICYmIG5vZGUuZWxlbWVudC5zdGFsZSkgewogICAgICAgIGlmIChkZWVwKSB7CiAgICAgICAgICB0aGlzLmNvbGxhcHNlKG5vZGUuZWxlbWVudC5lbGVtZW50KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5yZWZyZXNoQW5kUmVuZGVyTm9kZShub2RlLmVsZW1lbnQsIGZhbHNlKS5jYXRjaChvblVuZXhwZWN0ZWRFcnJvcik7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0Q2hpbGRyZW4iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldENoaWxkcmVuKG5vZGUsIGNoaWxkcmVuRWxlbWVudHNJdGVyYWJsZSwgcmVjdXJzaXZlLCB2aWV3U3RhdGVDb250ZXh0KSB7CiAgICAgIHZhciBfdGhpczkgPSB0aGlzLAogICAgICAgIF9ub2RlJGNoaWxkcmVuOwogICAgICB2YXIgY2hpbGRyZW5FbGVtZW50cyA9IF90b0NvbnN1bWFibGVBcnJheShjaGlsZHJlbkVsZW1lbnRzSXRlcmFibGUpOwogICAgICAvLyBwZXJmOiBpZiB0aGUgbm9kZSB3YXMgYW5kIHN0aWxsIGlzIGEgbGVhZiwgYXZvaWQgYWxsIHRoaXMgaGFzc2xlCiAgICAgIGlmIChub2RlLmNoaWxkcmVuLmxlbmd0aCA9PT0gMCAmJiBjaGlsZHJlbkVsZW1lbnRzLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybiBbXTsKICAgICAgfQogICAgICB2YXIgbm9kZXNUb0ZvcmdldCA9IG5ldyBNYXAoKTsKICAgICAgdmFyIGNoaWxkcmVuVHJlZU5vZGVzQnlJZCA9IG5ldyBNYXAoKTsKICAgICAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKG5vZGUuY2hpbGRyZW4pLAogICAgICAgIF9zdGVwOwogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgY2hpbGQgPSBfc3RlcC52YWx1ZTsKICAgICAgICAgIG5vZGVzVG9Gb3JnZXQuc2V0KGNoaWxkLmVsZW1lbnQsIGNoaWxkKTsKICAgICAgICAgIGlmICh0aGlzLmlkZW50aXR5UHJvdmlkZXIpIHsKICAgICAgICAgICAgdmFyIGNvbGxhcHNlZCA9IHRoaXMudHJlZS5pc0NvbGxhcHNlZChjaGlsZCk7CiAgICAgICAgICAgIGNoaWxkcmVuVHJlZU5vZGVzQnlJZC5zZXQoY2hpbGQuaWQsIHsKICAgICAgICAgICAgICBub2RlOiBjaGlsZCwKICAgICAgICAgICAgICBjb2xsYXBzZWQ6IGNvbGxhcHNlZAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvci5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yLmYoKTsKICAgICAgfQogICAgICB2YXIgY2hpbGRyZW5Ub1JlZnJlc2ggPSBbXTsKICAgICAgdmFyIGNoaWxkcmVuID0gY2hpbGRyZW5FbGVtZW50cy5tYXAoZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICB2YXIgaGFzQ2hpbGRyZW4gPSAhIV90aGlzOS5kYXRhU291cmNlLmhhc0NoaWxkcmVuKGVsZW1lbnQpOwogICAgICAgIGlmICghX3RoaXM5LmlkZW50aXR5UHJvdmlkZXIpIHsKICAgICAgICAgIHZhciBhc3luY0RhdGFUcmVlTm9kZSA9IGNyZWF0ZUFzeW5jRGF0YVRyZWVOb2RlKHsKICAgICAgICAgICAgZWxlbWVudDogZWxlbWVudCwKICAgICAgICAgICAgcGFyZW50OiBub2RlLAogICAgICAgICAgICBoYXNDaGlsZHJlbjogaGFzQ2hpbGRyZW4KICAgICAgICAgIH0pOwogICAgICAgICAgaWYgKGhhc0NoaWxkcmVuICYmIF90aGlzOS5jb2xsYXBzZUJ5RGVmYXVsdCAmJiAhX3RoaXM5LmNvbGxhcHNlQnlEZWZhdWx0KGVsZW1lbnQpKSB7CiAgICAgICAgICAgIGFzeW5jRGF0YVRyZWVOb2RlLmNvbGxhcHNlZEJ5RGVmYXVsdCA9IGZhbHNlOwogICAgICAgICAgICBjaGlsZHJlblRvUmVmcmVzaC5wdXNoKGFzeW5jRGF0YVRyZWVOb2RlKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBhc3luY0RhdGFUcmVlTm9kZTsKICAgICAgICB9CiAgICAgICAgdmFyIGlkID0gX3RoaXM5LmlkZW50aXR5UHJvdmlkZXIuZ2V0SWQoZWxlbWVudCkudG9TdHJpbmcoKTsKICAgICAgICB2YXIgcmVzdWx0ID0gY2hpbGRyZW5UcmVlTm9kZXNCeUlkLmdldChpZCk7CiAgICAgICAgaWYgKHJlc3VsdCkgewogICAgICAgICAgdmFyIF9hc3luY0RhdGFUcmVlTm9kZSA9IHJlc3VsdC5ub2RlOwogICAgICAgICAgbm9kZXNUb0ZvcmdldC5kZWxldGUoX2FzeW5jRGF0YVRyZWVOb2RlLmVsZW1lbnQpOwogICAgICAgICAgX3RoaXM5Lm5vZGVzLmRlbGV0ZShfYXN5bmNEYXRhVHJlZU5vZGUuZWxlbWVudCk7CiAgICAgICAgICBfdGhpczkubm9kZXMuc2V0KGVsZW1lbnQsIF9hc3luY0RhdGFUcmVlTm9kZSk7CiAgICAgICAgICBfYXN5bmNEYXRhVHJlZU5vZGUuZWxlbWVudCA9IGVsZW1lbnQ7CiAgICAgICAgICBfYXN5bmNEYXRhVHJlZU5vZGUuaGFzQ2hpbGRyZW4gPSBoYXNDaGlsZHJlbjsKICAgICAgICAgIGlmIChyZWN1cnNpdmUpIHsKICAgICAgICAgICAgaWYgKHJlc3VsdC5jb2xsYXBzZWQpIHsKICAgICAgICAgICAgICBfYXN5bmNEYXRhVHJlZU5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGRmcyhub2RlLCBmdW5jdGlvbiAobm9kZSkgewogICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM5Lm5vZGVzLmRlbGV0ZShub2RlLmVsZW1lbnQpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgX2FzeW5jRGF0YVRyZWVOb2RlLmNoaWxkcmVuLnNwbGljZSgwLCBfYXN5bmNEYXRhVHJlZU5vZGUuY2hpbGRyZW4ubGVuZ3RoKTsKICAgICAgICAgICAgICBfYXN5bmNEYXRhVHJlZU5vZGUuc3RhbGUgPSB0cnVlOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNoaWxkcmVuVG9SZWZyZXNoLnB1c2goX2FzeW5jRGF0YVRyZWVOb2RlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChoYXNDaGlsZHJlbiAmJiBfdGhpczkuY29sbGFwc2VCeURlZmF1bHQgJiYgIV90aGlzOS5jb2xsYXBzZUJ5RGVmYXVsdChlbGVtZW50KSkgewogICAgICAgICAgICBfYXN5bmNEYXRhVHJlZU5vZGUuY29sbGFwc2VkQnlEZWZhdWx0ID0gZmFsc2U7CiAgICAgICAgICAgIGNoaWxkcmVuVG9SZWZyZXNoLnB1c2goX2FzeW5jRGF0YVRyZWVOb2RlKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBfYXN5bmNEYXRhVHJlZU5vZGU7CiAgICAgICAgfQogICAgICAgIHZhciBjaGlsZEFzeW5jRGF0YVRyZWVOb2RlID0gY3JlYXRlQXN5bmNEYXRhVHJlZU5vZGUoewogICAgICAgICAgZWxlbWVudDogZWxlbWVudCwKICAgICAgICAgIHBhcmVudDogbm9kZSwKICAgICAgICAgIGlkOiBpZCwKICAgICAgICAgIGhhc0NoaWxkcmVuOiBoYXNDaGlsZHJlbgogICAgICAgIH0pOwogICAgICAgIGlmICh2aWV3U3RhdGVDb250ZXh0ICYmIHZpZXdTdGF0ZUNvbnRleHQudmlld1N0YXRlLmZvY3VzICYmIHZpZXdTdGF0ZUNvbnRleHQudmlld1N0YXRlLmZvY3VzLmluZGV4T2YoaWQpID4gLTEpIHsKICAgICAgICAgIHZpZXdTdGF0ZUNvbnRleHQuZm9jdXMucHVzaChjaGlsZEFzeW5jRGF0YVRyZWVOb2RlKTsKICAgICAgICB9CiAgICAgICAgaWYgKHZpZXdTdGF0ZUNvbnRleHQgJiYgdmlld1N0YXRlQ29udGV4dC52aWV3U3RhdGUuc2VsZWN0aW9uICYmIHZpZXdTdGF0ZUNvbnRleHQudmlld1N0YXRlLnNlbGVjdGlvbi5pbmRleE9mKGlkKSA+IC0xKSB7CiAgICAgICAgICB2aWV3U3RhdGVDb250ZXh0LnNlbGVjdGlvbi5wdXNoKGNoaWxkQXN5bmNEYXRhVHJlZU5vZGUpOwogICAgICAgIH0KICAgICAgICBpZiAodmlld1N0YXRlQ29udGV4dCAmJiB2aWV3U3RhdGVDb250ZXh0LnZpZXdTdGF0ZS5leHBhbmRlZCAmJiB2aWV3U3RhdGVDb250ZXh0LnZpZXdTdGF0ZS5leHBhbmRlZC5pbmRleE9mKGlkKSA+IC0xKSB7CiAgICAgICAgICBjaGlsZHJlblRvUmVmcmVzaC5wdXNoKGNoaWxkQXN5bmNEYXRhVHJlZU5vZGUpOwogICAgICAgIH0gZWxzZSBpZiAoaGFzQ2hpbGRyZW4gJiYgX3RoaXM5LmNvbGxhcHNlQnlEZWZhdWx0ICYmICFfdGhpczkuY29sbGFwc2VCeURlZmF1bHQoZWxlbWVudCkpIHsKICAgICAgICAgIGNoaWxkQXN5bmNEYXRhVHJlZU5vZGUuY29sbGFwc2VkQnlEZWZhdWx0ID0gZmFsc2U7CiAgICAgICAgICBjaGlsZHJlblRvUmVmcmVzaC5wdXNoKGNoaWxkQXN5bmNEYXRhVHJlZU5vZGUpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gY2hpbGRBc3luY0RhdGFUcmVlTm9kZTsKICAgICAgfSk7CiAgICAgIHZhciBfaXRlcmF0b3IyID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIobm9kZXNUb0ZvcmdldC52YWx1ZXMoKSksCiAgICAgICAgX3N0ZXAyOwogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yMi5zKCk7ICEoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgX25vZGUgPSBfc3RlcDIudmFsdWU7CiAgICAgICAgICBkZnMoX25vZGUsIGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgICAgIHJldHVybiBfdGhpczkubm9kZXMuZGVsZXRlKG5vZGUuZWxlbWVudCk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvcjIuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvcjIuZigpOwogICAgICB9CiAgICAgIHZhciBfaXRlcmF0b3IzID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoY2hpbGRyZW4pLAogICAgICAgIF9zdGVwMzsKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjMucygpOyAhKF9zdGVwMyA9IF9pdGVyYXRvcjMubigpKS5kb25lOykgewogICAgICAgICAgdmFyIF9jaGlsZCA9IF9zdGVwMy52YWx1ZTsKICAgICAgICAgIHRoaXMubm9kZXMuc2V0KF9jaGlsZC5lbGVtZW50LCBfY2hpbGQpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yMy5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yMy5mKCk7CiAgICAgIH0KICAgICAgKF9ub2RlJGNoaWxkcmVuID0gbm9kZS5jaGlsZHJlbikuc3BsaWNlLmFwcGx5KF9ub2RlJGNoaWxkcmVuLCBbMCwgbm9kZS5jaGlsZHJlbi5sZW5ndGhdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoY2hpbGRyZW4pKSk7CiAgICAgIC8vIFRPRE9Aam9hbyB0aGlzIGRvZXNuJ3QgdGFrZSBmaWx0ZXIgaW50byBhY2NvdW50CiAgICAgIGlmIChub2RlICE9PSB0aGlzLnJvb3QgJiYgdGhpcy5hdXRvRXhwYW5kU2luZ2xlQ2hpbGRyZW4gJiYgY2hpbGRyZW4ubGVuZ3RoID09PSAxICYmIGNoaWxkcmVuVG9SZWZyZXNoLmxlbmd0aCA9PT0gMCkgewogICAgICAgIGNoaWxkcmVuWzBdLmNvbGxhcHNlZEJ5RGVmYXVsdCA9IGZhbHNlOwogICAgICAgIGNoaWxkcmVuVG9SZWZyZXNoLnB1c2goY2hpbGRyZW5bMF0pOwogICAgICB9CiAgICAgIHJldHVybiBjaGlsZHJlblRvUmVmcmVzaDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcihub2RlLCB2aWV3U3RhdGVDb250ZXh0LCBvcHRpb25zKSB7CiAgICAgIHZhciBfdGhpczEwID0gdGhpczsKICAgICAgdmFyIGNoaWxkcmVuID0gbm9kZS5jaGlsZHJlbi5tYXAoZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICByZXR1cm4gX3RoaXMxMC5hc1RyZWVFbGVtZW50KG5vZGUsIHZpZXdTdGF0ZUNvbnRleHQpOwogICAgICB9KTsKICAgICAgdmFyIG9iamVjdFRyZWVPcHRpb25zID0gb3B0aW9ucyAmJiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMpLCB7CiAgICAgICAgZGlmZklkZW50aXR5UHJvdmlkZXI6IG9wdGlvbnMuZGlmZklkZW50aXR5UHJvdmlkZXIgJiYgewogICAgICAgICAgZ2V0SWQ6IGZ1bmN0aW9uIGdldElkKG5vZGUpIHsKICAgICAgICAgICAgcmV0dXJuIG9wdGlvbnMuZGlmZklkZW50aXR5UHJvdmlkZXIuZ2V0SWQobm9kZS5lbGVtZW50KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgICB0aGlzLnRyZWUuc2V0Q2hpbGRyZW4obm9kZSA9PT0gdGhpcy5yb290ID8gbnVsbCA6IG5vZGUsIGNoaWxkcmVuLCBvYmplY3RUcmVlT3B0aW9ucyk7CiAgICAgIGlmIChub2RlICE9PSB0aGlzLnJvb3QpIHsKICAgICAgICB0aGlzLnRyZWUuc2V0Q29sbGFwc2libGUobm9kZSwgbm9kZS5oYXNDaGlsZHJlbik7CiAgICAgIH0KICAgICAgdGhpcy5fb25EaWRSZW5kZXIuZmlyZSgpOwogICAgfQogIH0sIHsKICAgIGtleTogImFzVHJlZUVsZW1lbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFzVHJlZUVsZW1lbnQobm9kZSwgdmlld1N0YXRlQ29udGV4dCkgewogICAgICB2YXIgX3RoaXMxMSA9IHRoaXM7CiAgICAgIGlmIChub2RlLnN0YWxlKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGVsZW1lbnQ6IG5vZGUsCiAgICAgICAgICBjb2xsYXBzaWJsZTogbm9kZS5oYXNDaGlsZHJlbiwKICAgICAgICAgIGNvbGxhcHNlZDogdHJ1ZQogICAgICAgIH07CiAgICAgIH0KICAgICAgdmFyIGNvbGxhcHNlZDsKICAgICAgaWYgKHZpZXdTdGF0ZUNvbnRleHQgJiYgdmlld1N0YXRlQ29udGV4dC52aWV3U3RhdGUuZXhwYW5kZWQgJiYgbm9kZS5pZCAmJiB2aWV3U3RhdGVDb250ZXh0LnZpZXdTdGF0ZS5leHBhbmRlZC5pbmRleE9mKG5vZGUuaWQpID4gLTEpIHsKICAgICAgICBjb2xsYXBzZWQgPSBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb2xsYXBzZWQgPSBub2RlLmNvbGxhcHNlZEJ5RGVmYXVsdDsKICAgICAgfQogICAgICBub2RlLmNvbGxhcHNlZEJ5RGVmYXVsdCA9IHVuZGVmaW5lZDsKICAgICAgcmV0dXJuIHsKICAgICAgICBlbGVtZW50OiBub2RlLAogICAgICAgIGNoaWxkcmVuOiBub2RlLmhhc0NoaWxkcmVuID8gSXRlcmFibGUubWFwKG5vZGUuY2hpbGRyZW4sIGZ1bmN0aW9uIChjaGlsZCkgewogICAgICAgICAgcmV0dXJuIF90aGlzMTEuYXNUcmVlRWxlbWVudChjaGlsZCwgdmlld1N0YXRlQ29udGV4dCk7CiAgICAgICAgfSkgOiBbXSwKICAgICAgICBjb2xsYXBzaWJsZTogbm9kZS5oYXNDaGlsZHJlbiwKICAgICAgICBjb2xsYXBzZWQ6IGNvbGxhcHNlZAogICAgICB9OwogICAgfQogIH0sIHsKICAgIGtleTogInByb2Nlc3NDaGlsZHJlbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcHJvY2Vzc0NoaWxkcmVuKGNoaWxkcmVuKSB7CiAgICAgIGlmICh0aGlzLnNvcnRlcikgewogICAgICAgIGNoaWxkcmVuID0gX3RvQ29uc3VtYWJsZUFycmF5KGNoaWxkcmVuKS5zb3J0KHRoaXMuc29ydGVyLmNvbXBhcmUuYmluZCh0aGlzLnNvcnRlcikpOwogICAgICB9CiAgICAgIHJldHVybiBjaGlsZHJlbjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkaXNwb3NlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNwb3NlKCkgewogICAgICB0aGlzLmRpc3Bvc2FibGVzLmRpc3Bvc2UoKTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIEFzeW5jRGF0YVRyZWU7Cn0oKTsKdmFyIENvbXByZXNzaWJsZUFzeW5jRGF0YVRyZWVOb2RlV3JhcHBlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQ29tcHJlc3NpYmxlQXN5bmNEYXRhVHJlZU5vZGVXcmFwcGVyKG5vZGUpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDb21wcmVzc2libGVBc3luY0RhdGFUcmVlTm9kZVdyYXBwZXIpOwogICAgdGhpcy5ub2RlID0gbm9kZTsKICB9CiAgX2NyZWF0ZUNsYXNzKENvbXByZXNzaWJsZUFzeW5jRGF0YVRyZWVOb2RlV3JhcHBlciwgW3sKICAgIGtleTogImVsZW1lbnQiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgZWxlbWVudHM6IHRoaXMubm9kZS5lbGVtZW50LmVsZW1lbnRzLm1hcChmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuIGUuZWxlbWVudDsKICAgICAgICB9KSwKICAgICAgICBpbmNvbXByZXNzaWJsZTogdGhpcy5ub2RlLmVsZW1lbnQuaW5jb21wcmVzc2libGUKICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjaGlsZHJlbiIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMubm9kZS5jaGlsZHJlbi5tYXAoZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICByZXR1cm4gbmV3IENvbXByZXNzaWJsZUFzeW5jRGF0YVRyZWVOb2RlV3JhcHBlcihub2RlKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGVwdGgiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLm5vZGUuZGVwdGg7CiAgICB9CiAgfSwgewogICAga2V5OiAidmlzaWJsZUNoaWxkcmVuQ291bnQiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLm5vZGUudmlzaWJsZUNoaWxkcmVuQ291bnQ7CiAgICB9CiAgfSwgewogICAga2V5OiAidmlzaWJsZUNoaWxkSW5kZXgiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLm5vZGUudmlzaWJsZUNoaWxkSW5kZXg7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29sbGFwc2libGUiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLm5vZGUuY29sbGFwc2libGU7CiAgICB9CiAgfSwgewogICAga2V5OiAiY29sbGFwc2VkIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5ub2RlLmNvbGxhcHNlZDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ2aXNpYmxlIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5ub2RlLnZpc2libGU7CiAgICB9CiAgfSwgewogICAga2V5OiAiZmlsdGVyRGF0YSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMubm9kZS5maWx0ZXJEYXRhOwogICAgfQogIH1dKTsKICByZXR1cm4gQ29tcHJlc3NpYmxlQXN5bmNEYXRhVHJlZU5vZGVXcmFwcGVyOwp9KCk7CnZhciBDb21wcmVzc2libGVBc3luY0RhdGFUcmVlUmVuZGVyZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIENvbXByZXNzaWJsZUFzeW5jRGF0YVRyZWVSZW5kZXJlcihyZW5kZXJlciwgbm9kZU1hcHBlciwgY29tcHJlc3NpYmxlTm9kZU1hcHBlclByb3ZpZGVyLCBvbkRpZENoYW5nZVR3aXN0aWVTdGF0ZSkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENvbXByZXNzaWJsZUFzeW5jRGF0YVRyZWVSZW5kZXJlcik7CiAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7CiAgICB0aGlzLm5vZGVNYXBwZXIgPSBub2RlTWFwcGVyOwogICAgdGhpcy5jb21wcmVzc2libGVOb2RlTWFwcGVyUHJvdmlkZXIgPSBjb21wcmVzc2libGVOb2RlTWFwcGVyUHJvdmlkZXI7CiAgICB0aGlzLm9uRGlkQ2hhbmdlVHdpc3RpZVN0YXRlID0gb25EaWRDaGFuZ2VUd2lzdGllU3RhdGU7CiAgICB0aGlzLnJlbmRlcmVkTm9kZXMgPSBuZXcgTWFwKCk7CiAgICB0aGlzLmRpc3Bvc2FibGVzID0gW107CiAgICB0aGlzLnRlbXBsYXRlSWQgPSByZW5kZXJlci50ZW1wbGF0ZUlkOwogIH0KICBfY3JlYXRlQ2xhc3MoQ29tcHJlc3NpYmxlQXN5bmNEYXRhVHJlZVJlbmRlcmVyLCBbewogICAga2V5OiAicmVuZGVyVGVtcGxhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlclRlbXBsYXRlKGNvbnRhaW5lcikgewogICAgICB2YXIgdGVtcGxhdGVEYXRhID0gdGhpcy5yZW5kZXJlci5yZW5kZXJUZW1wbGF0ZShjb250YWluZXIpOwogICAgICByZXR1cm4gewogICAgICAgIHRlbXBsYXRlRGF0YTogdGVtcGxhdGVEYXRhCiAgICAgIH07CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyRWxlbWVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyRWxlbWVudChub2RlLCBpbmRleCwgdGVtcGxhdGVEYXRhLCBoZWlnaHQpIHsKICAgICAgdGhpcy5yZW5kZXJlci5yZW5kZXJFbGVtZW50KHRoaXMubm9kZU1hcHBlci5tYXAobm9kZSksIGluZGV4LCB0ZW1wbGF0ZURhdGEudGVtcGxhdGVEYXRhLCBoZWlnaHQpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlckNvbXByZXNzZWRFbGVtZW50cyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyQ29tcHJlc3NlZEVsZW1lbnRzKG5vZGUsIGluZGV4LCB0ZW1wbGF0ZURhdGEsIGhlaWdodCkgewogICAgICB0aGlzLnJlbmRlcmVyLnJlbmRlckNvbXByZXNzZWRFbGVtZW50cyh0aGlzLmNvbXByZXNzaWJsZU5vZGVNYXBwZXJQcm92aWRlcigpLm1hcChub2RlKSwgaW5kZXgsIHRlbXBsYXRlRGF0YS50ZW1wbGF0ZURhdGEsIGhlaWdodCk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVuZGVyVHdpc3RpZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyVHdpc3RpZShlbGVtZW50LCB0d2lzdGllRWxlbWVudCkgewogICAgICBpZiAoZWxlbWVudC5zbG93KSB7CiAgICAgICAgdmFyIF90d2lzdGllRWxlbWVudCRjbGFzczM7CiAgICAgICAgKF90d2lzdGllRWxlbWVudCRjbGFzczMgPSB0d2lzdGllRWxlbWVudC5jbGFzc0xpc3QpLmFkZC5hcHBseShfdHdpc3RpZUVsZW1lbnQkY2xhc3MzLCBfdG9Db25zdW1hYmxlQXJyYXkoQ29kaWNvbi50cmVlSXRlbUxvYWRpbmcuY2xhc3NOYW1lc0FycmF5KSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIF90d2lzdGllRWxlbWVudCRjbGFzczQ7CiAgICAgICAgKF90d2lzdGllRWxlbWVudCRjbGFzczQgPSB0d2lzdGllRWxlbWVudC5jbGFzc0xpc3QpLnJlbW92ZS5hcHBseShfdHdpc3RpZUVsZW1lbnQkY2xhc3M0LCBfdG9Db25zdW1hYmxlQXJyYXkoQ29kaWNvbi50cmVlSXRlbUxvYWRpbmcuY2xhc3NOYW1lc0FycmF5KSk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiZGlzcG9zZUVsZW1lbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3Bvc2VFbGVtZW50KG5vZGUsIGluZGV4LCB0ZW1wbGF0ZURhdGEsIGhlaWdodCkgewogICAgICB2YXIgX2EsIF9iOwogICAgICAoX2IgPSAoX2EgPSB0aGlzLnJlbmRlcmVyKS5kaXNwb3NlRWxlbWVudCkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmNhbGwoX2EsIHRoaXMubm9kZU1hcHBlci5tYXAobm9kZSksIGluZGV4LCB0ZW1wbGF0ZURhdGEudGVtcGxhdGVEYXRhLCBoZWlnaHQpOwogICAgfQogIH0sIHsKICAgIGtleTogImRpc3Bvc2VDb21wcmVzc2VkRWxlbWVudHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3Bvc2VDb21wcmVzc2VkRWxlbWVudHMobm9kZSwgaW5kZXgsIHRlbXBsYXRlRGF0YSwgaGVpZ2h0KSB7CiAgICAgIHZhciBfYSwgX2I7CiAgICAgIChfYiA9IChfYSA9IHRoaXMucmVuZGVyZXIpLmRpc3Bvc2VDb21wcmVzc2VkRWxlbWVudHMpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5jYWxsKF9hLCB0aGlzLmNvbXByZXNzaWJsZU5vZGVNYXBwZXJQcm92aWRlcigpLm1hcChub2RlKSwgaW5kZXgsIHRlbXBsYXRlRGF0YS50ZW1wbGF0ZURhdGEsIGhlaWdodCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGlzcG9zZVRlbXBsYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNwb3NlVGVtcGxhdGUodGVtcGxhdGVEYXRhKSB7CiAgICAgIHRoaXMucmVuZGVyZXIuZGlzcG9zZVRlbXBsYXRlKHRlbXBsYXRlRGF0YS50ZW1wbGF0ZURhdGEpOwogICAgfQogIH0sIHsKICAgIGtleTogImRpc3Bvc2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7CiAgICAgIHRoaXMucmVuZGVyZWROb2Rlcy5jbGVhcigpOwogICAgICB0aGlzLmRpc3Bvc2FibGVzID0gX2Rpc3Bvc2UodGhpcy5kaXNwb3NhYmxlcyk7CiAgICB9CiAgfV0pOwogIHJldHVybiBDb21wcmVzc2libGVBc3luY0RhdGFUcmVlUmVuZGVyZXI7Cn0oKTsKZnVuY3Rpb24gYXNDb21wcmVzc2libGVPYmplY3RUcmVlT3B0aW9ucyhvcHRpb25zKSB7CiAgdmFyIG9iamVjdFRyZWVPcHRpb25zID0gb3B0aW9ucyAmJiBhc09iamVjdFRyZWVPcHRpb25zKG9wdGlvbnMpOwogIHJldHVybiBvYmplY3RUcmVlT3B0aW9ucyAmJiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIG9iamVjdFRyZWVPcHRpb25zKSwgewogICAga2V5Ym9hcmROYXZpZ2F0aW9uTGFiZWxQcm92aWRlcjogb2JqZWN0VHJlZU9wdGlvbnMua2V5Ym9hcmROYXZpZ2F0aW9uTGFiZWxQcm92aWRlciAmJiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIG9iamVjdFRyZWVPcHRpb25zLmtleWJvYXJkTmF2aWdhdGlvbkxhYmVsUHJvdmlkZXIpLCB7CiAgICAgIGdldENvbXByZXNzZWROb2RlS2V5Ym9hcmROYXZpZ2F0aW9uTGFiZWw6IGZ1bmN0aW9uIGdldENvbXByZXNzZWROb2RlS2V5Ym9hcmROYXZpZ2F0aW9uTGFiZWwoZWxzKSB7CiAgICAgICAgcmV0dXJuIG9wdGlvbnMua2V5Ym9hcmROYXZpZ2F0aW9uTGFiZWxQcm92aWRlci5nZXRDb21wcmVzc2VkTm9kZUtleWJvYXJkTmF2aWdhdGlvbkxhYmVsKGVscy5tYXAoZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiBlLmVsZW1lbnQ7CiAgICAgICAgfSkpOwogICAgICB9CiAgICB9KQogIH0pOwp9CmV4cG9ydCB2YXIgQ29tcHJlc3NpYmxlQXN5bmNEYXRhVHJlZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX0FzeW5jRGF0YVRyZWUpIHsKICBfaW5oZXJpdHMoQ29tcHJlc3NpYmxlQXN5bmNEYXRhVHJlZSwgX0FzeW5jRGF0YVRyZWUpOwogIHZhciBfc3VwZXIyID0gX2NyZWF0ZVN1cGVyKENvbXByZXNzaWJsZUFzeW5jRGF0YVRyZWUpOwogIGZ1bmN0aW9uIENvbXByZXNzaWJsZUFzeW5jRGF0YVRyZWUodXNlciwgY29udGFpbmVyLCB2aXJ0dWFsRGVsZWdhdGUsIGNvbXByZXNzaW9uRGVsZWdhdGUsIHJlbmRlcmVycywgZGF0YVNvdXJjZSkgewogICAgdmFyIF90aGlzMTI7CiAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiA2ICYmIGFyZ3VtZW50c1s2XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzZdIDoge307CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ29tcHJlc3NpYmxlQXN5bmNEYXRhVHJlZSk7CiAgICBfdGhpczEyID0gX3N1cGVyMi5jYWxsKHRoaXMsIHVzZXIsIGNvbnRhaW5lciwgdmlydHVhbERlbGVnYXRlLCByZW5kZXJlcnMsIGRhdGFTb3VyY2UsIG9wdGlvbnMpOwogICAgX3RoaXMxMi5jb21wcmVzc2lvbkRlbGVnYXRlID0gY29tcHJlc3Npb25EZWxlZ2F0ZTsKICAgIF90aGlzMTIuY29tcHJlc3NpYmxlTm9kZU1hcHBlciA9IG5ldyBXZWFrTWFwcGVyKGZ1bmN0aW9uIChub2RlKSB7CiAgICAgIHJldHVybiBuZXcgQ29tcHJlc3NpYmxlQXN5bmNEYXRhVHJlZU5vZGVXcmFwcGVyKG5vZGUpOwogICAgfSk7CiAgICBfdGhpczEyLmZpbHRlciA9IG9wdGlvbnMuZmlsdGVyOwogICAgcmV0dXJuIF90aGlzMTI7CiAgfQogIF9jcmVhdGVDbGFzcyhDb21wcmVzc2libGVBc3luY0RhdGFUcmVlLCBbewogICAga2V5OiAiY3JlYXRlVHJlZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlVHJlZSh1c2VyLCBjb250YWluZXIsIGRlbGVnYXRlLCByZW5kZXJlcnMsIG9wdGlvbnMpIHsKICAgICAgdmFyIF90aGlzMTMgPSB0aGlzOwogICAgICB2YXIgb2JqZWN0VHJlZURlbGVnYXRlID0gbmV3IENvbXBvc2VkVHJlZURlbGVnYXRlKGRlbGVnYXRlKTsKICAgICAgdmFyIG9iamVjdFRyZWVSZW5kZXJlcnMgPSByZW5kZXJlcnMubWFwKGZ1bmN0aW9uIChyKSB7CiAgICAgICAgcmV0dXJuIG5ldyBDb21wcmVzc2libGVBc3luY0RhdGFUcmVlUmVuZGVyZXIociwgX3RoaXMxMy5ub2RlTWFwcGVyLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMxMy5jb21wcmVzc2libGVOb2RlTWFwcGVyOwogICAgICAgIH0sIF90aGlzMTMuX29uRGlkQ2hhbmdlTm9kZVNsb3dTdGF0ZS5ldmVudCk7CiAgICAgIH0pOwogICAgICB2YXIgb2JqZWN0VHJlZU9wdGlvbnMgPSBhc0NvbXByZXNzaWJsZU9iamVjdFRyZWVPcHRpb25zKG9wdGlvbnMpIHx8IHt9OwogICAgICByZXR1cm4gbmV3IENvbXByZXNzaWJsZU9iamVjdFRyZWUodXNlciwgY29udGFpbmVyLCBvYmplY3RUcmVlRGVsZWdhdGUsIG9iamVjdFRyZWVSZW5kZXJlcnMsIG9iamVjdFRyZWVPcHRpb25zKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhc1RyZWVFbGVtZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhc1RyZWVFbGVtZW50KG5vZGUsIHZpZXdTdGF0ZUNvbnRleHQpIHsKICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oewogICAgICAgIGluY29tcHJlc3NpYmxlOiB0aGlzLmNvbXByZXNzaW9uRGVsZWdhdGUuaXNJbmNvbXByZXNzaWJsZShub2RlLmVsZW1lbnQpCiAgICAgIH0sIF9nZXQoX2dldFByb3RvdHlwZU9mKENvbXByZXNzaWJsZUFzeW5jRGF0YVRyZWUucHJvdG90eXBlKSwgImFzVHJlZUVsZW1lbnQiLCB0aGlzKS5jYWxsKHRoaXMsIG5vZGUsIHZpZXdTdGF0ZUNvbnRleHQpKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ1cGRhdGVPcHRpb25zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVPcHRpb25zKCkgewogICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CiAgICAgIHRoaXMudHJlZS51cGRhdGVPcHRpb25zKG9wdGlvbnMpOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmRlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKG5vZGUsIHZpZXdTdGF0ZUNvbnRleHQpIHsKICAgICAgdmFyIF90aGlzMTQgPSB0aGlzOwogICAgICBpZiAoIXRoaXMuaWRlbnRpdHlQcm92aWRlcikgewogICAgICAgIHJldHVybiBfZ2V0KF9nZXRQcm90b3R5cGVPZihDb21wcmVzc2libGVBc3luY0RhdGFUcmVlLnByb3RvdHlwZSksICJyZW5kZXIiLCB0aGlzKS5jYWxsKHRoaXMsIG5vZGUsIHZpZXdTdGF0ZUNvbnRleHQpOwogICAgICB9CiAgICAgIC8vIFByZXNlcnZlIHRyYWl0cyBhY3Jvc3MgY29tcHJlc3Npb25zLiBIYWNreSBidXQgZG9lcyB0aGUgdHJpY2suCiAgICAgIC8vIFRoaXMgaXMgaGFyZCB0byBmaXggcHJvcGVybHkgc2luY2UgaXQgcmVxdWlyZXMgcmV3cml0aW5nIHRoZSB0cmFpdHMKICAgICAgLy8gYWNyb3NzIHRyZWVzIGFuZCBsaXN0cy4gTGV0J3MganVzdCBrZWVwIGl0IHRoaXMgd2F5IGZvciBub3cuCiAgICAgIHZhciBnZXRJZCA9IGZ1bmN0aW9uIGdldElkKGVsZW1lbnQpIHsKICAgICAgICByZXR1cm4gX3RoaXMxNC5pZGVudGl0eVByb3ZpZGVyLmdldElkKGVsZW1lbnQpLnRvU3RyaW5nKCk7CiAgICAgIH07CiAgICAgIHZhciBnZXRVbmNvbXByZXNzZWRJZHMgPSBmdW5jdGlvbiBnZXRVbmNvbXByZXNzZWRJZHMobm9kZXMpIHsKICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFNldCgpOwogICAgICAgIHZhciBfaXRlcmF0b3I0ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIobm9kZXMpLAogICAgICAgICAgX3N0ZXA0OwogICAgICAgIHRyeSB7CiAgICAgICAgICBmb3IgKF9pdGVyYXRvcjQucygpOyAhKF9zdGVwNCA9IF9pdGVyYXRvcjQubigpKS5kb25lOykgewogICAgICAgICAgICB2YXIgX25vZGUyID0gX3N0ZXA0LnZhbHVlOwogICAgICAgICAgICB2YXIgY29tcHJlc3NlZE5vZGUgPSBfdGhpczE0LnRyZWUuZ2V0Q29tcHJlc3NlZFRyZWVOb2RlKF9ub2RlMiA9PT0gX3RoaXMxNC5yb290ID8gbnVsbCA6IF9ub2RlMik7CiAgICAgICAgICAgIGlmICghY29tcHJlc3NlZE5vZGUuZWxlbWVudCkgewogICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciBfaXRlcmF0b3I1ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoY29tcHJlc3NlZE5vZGUuZWxlbWVudC5lbGVtZW50cyksCiAgICAgICAgICAgICAgX3N0ZXA1OwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGZvciAoX2l0ZXJhdG9yNS5zKCk7ICEoX3N0ZXA1ID0gX2l0ZXJhdG9yNS5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgICAgICB2YXIgX25vZGUzID0gX3N0ZXA1LnZhbHVlOwogICAgICAgICAgICAgICAgcmVzdWx0LmFkZChnZXRJZChfbm9kZTMuZWxlbWVudCkpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgX2l0ZXJhdG9yNS5lKGVycik7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgX2l0ZXJhdG9yNS5mKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIF9pdGVyYXRvcjQuZShlcnIpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBfaXRlcmF0b3I0LmYoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgfTsKICAgICAgdmFyIG9sZFNlbGVjdGlvbiA9IGdldFVuY29tcHJlc3NlZElkcyh0aGlzLnRyZWUuZ2V0U2VsZWN0aW9uKCkpOwogICAgICB2YXIgb2xkRm9jdXMgPSBnZXRVbmNvbXByZXNzZWRJZHModGhpcy50cmVlLmdldEZvY3VzKCkpOwogICAgICBfZ2V0KF9nZXRQcm90b3R5cGVPZihDb21wcmVzc2libGVBc3luY0RhdGFUcmVlLnByb3RvdHlwZSksICJyZW5kZXIiLCB0aGlzKS5jYWxsKHRoaXMsIG5vZGUsIHZpZXdTdGF0ZUNvbnRleHQpOwogICAgICB2YXIgc2VsZWN0aW9uID0gdGhpcy5nZXRTZWxlY3Rpb24oKTsKICAgICAgdmFyIGRpZENoYW5nZVNlbGVjdGlvbiA9IGZhbHNlOwogICAgICB2YXIgZm9jdXMgPSB0aGlzLmdldEZvY3VzKCk7CiAgICAgIHZhciBkaWRDaGFuZ2VGb2N1cyA9IGZhbHNlOwogICAgICB2YXIgdmlzaXQgPSBmdW5jdGlvbiB2aXNpdChub2RlKSB7CiAgICAgICAgdmFyIGNvbXByZXNzZWROb2RlID0gbm9kZS5lbGVtZW50OwogICAgICAgIGlmIChjb21wcmVzc2VkTm9kZSkgewogICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb21wcmVzc2VkTm9kZS5lbGVtZW50cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB2YXIgaWQgPSBnZXRJZChjb21wcmVzc2VkTm9kZS5lbGVtZW50c1tpXS5lbGVtZW50KTsKICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBjb21wcmVzc2VkTm9kZS5lbGVtZW50c1tjb21wcmVzc2VkTm9kZS5lbGVtZW50cy5sZW5ndGggLSAxXS5lbGVtZW50OwogICAgICAgICAgICAvLyBnaXRodWIuY29tL21pY3Jvc29mdC92c2NvZGUvaXNzdWVzLzg1OTM4CiAgICAgICAgICAgIGlmIChvbGRTZWxlY3Rpb24uaGFzKGlkKSAmJiBzZWxlY3Rpb24uaW5kZXhPZihlbGVtZW50KSA9PT0gLTEpIHsKICAgICAgICAgICAgICBzZWxlY3Rpb24ucHVzaChlbGVtZW50KTsKICAgICAgICAgICAgICBkaWRDaGFuZ2VTZWxlY3Rpb24gPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChvbGRGb2N1cy5oYXMoaWQpICYmIGZvY3VzLmluZGV4T2YoZWxlbWVudCkgPT09IC0xKSB7CiAgICAgICAgICAgICAgZm9jdXMucHVzaChlbGVtZW50KTsKICAgICAgICAgICAgICBkaWRDaGFuZ2VGb2N1cyA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgbm9kZS5jaGlsZHJlbi5mb3JFYWNoKHZpc2l0KTsKICAgICAgfTsKICAgICAgdmlzaXQodGhpcy50cmVlLmdldENvbXByZXNzZWRUcmVlTm9kZShub2RlID09PSB0aGlzLnJvb3QgPyBudWxsIDogbm9kZSkpOwogICAgICBpZiAoZGlkQ2hhbmdlU2VsZWN0aW9uKSB7CiAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb24oc2VsZWN0aW9uKTsKICAgICAgfQogICAgICBpZiAoZGlkQ2hhbmdlRm9jdXMpIHsKICAgICAgICB0aGlzLnNldEZvY3VzKGZvY3VzKTsKICAgICAgfQogICAgfQogICAgLy8gRm9yIGNvbXByZXNzZWQgYXN5bmMgZGF0YSB0cmVlcywgYFRyZWVWaXNpYmlsaXR5LlJlY3Vyc2VgIGRvZXNuJ3QgY3VycmVudGx5IHdvcmsKICAgIC8vIGFuZCB3ZSBoYXZlIHRvIGZpbHRlciBldmVyeXRoaW5nIGJlZm9yZWhhbmQKICAgIC8vIFJlbGF0ZWQgdG8gIzg1MTkzIGFuZCAjODU4MzUKICB9LCB7CiAgICBrZXk6ICJwcm9jZXNzQ2hpbGRyZW4iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHByb2Nlc3NDaGlsZHJlbihjaGlsZHJlbikgewogICAgICB2YXIgX3RoaXMxNSA9IHRoaXM7CiAgICAgIGlmICh0aGlzLmZpbHRlcikgewogICAgICAgIGNoaWxkcmVuID0gSXRlcmFibGUuZmlsdGVyKGNoaWxkcmVuLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgdmFyIHJlc3VsdCA9IF90aGlzMTUuZmlsdGVyLmZpbHRlcihlLCAxIC8qIFRyZWVWaXNpYmlsaXR5LlZpc2libGUgKi8pOwogICAgICAgICAgdmFyIHZpc2liaWxpdHkgPSBnZXRWaXNpYmlsaXR5KHJlc3VsdCk7CiAgICAgICAgICBpZiAodmlzaWJpbGl0eSA9PT0gMiAvKiBUcmVlVmlzaWJpbGl0eS5SZWN1cnNlICovKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUmVjdXJzaXZlIHRyZWUgdmlzaWJpbGl0eSBub3Qgc3VwcG9ydGVkIGluIGFzeW5jIGRhdGEgY29tcHJlc3NlZCB0cmVlcycpOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIHZpc2liaWxpdHkgPT09IDEgLyogVHJlZVZpc2liaWxpdHkuVmlzaWJsZSAqLzsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIF9nZXQoX2dldFByb3RvdHlwZU9mKENvbXByZXNzaWJsZUFzeW5jRGF0YVRyZWUucHJvdG90eXBlKSwgInByb2Nlc3NDaGlsZHJlbiIsIHRoaXMpLmNhbGwodGhpcywgY2hpbGRyZW4pOwogICAgfQogIH1dKTsKICByZXR1cm4gQ29tcHJlc3NpYmxlQXN5bmNEYXRhVHJlZTsKfShBc3luY0RhdGFUcmVlKTsKZnVuY3Rpb24gZ2V0VmlzaWJpbGl0eShmaWx0ZXJSZXN1bHQpIHsKICBpZiAodHlwZW9mIGZpbHRlclJlc3VsdCA9PT0gJ2Jvb2xlYW4nKSB7CiAgICByZXR1cm4gZmlsdGVyUmVzdWx0ID8gMSAvKiBUcmVlVmlzaWJpbGl0eS5WaXNpYmxlICovIDogMCAvKiBUcmVlVmlzaWJpbGl0eS5IaWRkZW4gKi87CiAgfSBlbHNlIGlmIChpc0ZpbHRlclJlc3VsdChmaWx0ZXJSZXN1bHQpKSB7CiAgICByZXR1cm4gZ2V0VmlzaWJsZVN0YXRlKGZpbHRlclJlc3VsdC52aXNpYmlsaXR5KTsKICB9IGVsc2UgewogICAgcmV0dXJuIGdldFZpc2libGVTdGF0ZShmaWx0ZXJSZXN1bHQpOwogIH0KfQ=="},{"version":3,"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","ElementsDragAndDropData","ComposedTreeDelegate","getVisibleState","isFilterResult","CompressibleObjectTree","ObjectTree","TreeError","WeakMapper","createCancelablePromise","Promises","timeout","Codicon","isCancellationError","onUnexpectedError","Emitter","Event","Iterable","DisposableStore","dispose","isIterable","createAsyncDataTreeNode","props","Object","assign","children","refreshPromise","undefined","stale","slow","collapsedByDefault","isAncestor","ancestor","descendant","parent","intersects","node","other","AsyncDataTreeNodeWrapper","element","map","depth","visibleChildrenCount","visibleChildIndex","collapsible","collapsed","visible","filterData","AsyncDataTreeRenderer","renderer","nodeMapper","onDidChangeTwistieState","renderedNodes","Map","templateId","container","templateData","renderTemplate","index","height","renderElement","twistieElement","classList","add","treeItemLoading","classNamesArray","remove","_a","_b","disposeElement","call","disposeTemplate","clear","asTreeEvent","browserEvent","elements","asTreeMouseEvent","target","AsyncDataTreeElementsDragAndDropData","data","asAsyncDataTreeDragAndDropData","AsyncDataTreeNodeListDragAndDrop","dnd","getDragURI","nodes","originalEvent","getDragLabel","onDragStart","targetNode","targetIndex","raw","onDragOver","drop","onDragEnd","asObjectTreeOptions","options","collapseByDefault","identityProvider","getId","el","multipleSelectionController","isSelectionSingleChangeEvent","isSelectionRangeChangeEvent","accessibilityProvider","getPosInSet","getSetSize","getRole","isChecked","getAriaLabel","getWidgetAriaLabel","getWidgetRole","getAriaLevel","getActiveDescendantId","filter","parentVisibility","keyboardNavigationLabelProvider","getKeyboardNavigationLabel","sorter","expandOnlyOnTwistieClick","additionalScrollHeight","dfs","fn","forEach","child","AsyncDataTree","user","delegate","renderers","dataSource","subTreeRefreshPromises","refreshPromises","_onDidRender","_onDidChangeNodeSlowState","disposables","autoExpandSingleChildren","tree","createTree","onDidChangeFindMode","root","hasChildren","id","set","onDidChangeCollapseState","_onDidChangeCollapseState","onDidChangeFocus","onDidChangeSelection","onMouseDblClick","onPointer","onDidFocus","onDidChangeModel","onDidChangeFindOpenState","onDidDispose","objectTreeDelegate","objectTreeRenderers","r","event","objectTreeOptions","updateOptions","getHTMLElement","scrollTop","domFocus","width","layout","styles","style","input","viewState","promise","cancel","viewStateContext","focus","selection","_updateChildren","setFocus","setSelection","recursive","rerender","toPromise","getDataNode","refreshAndRenderNode","dataNode","getNode","collapse","hasElement","isCollapsible","isCollapsed","expand","getSelection","n","getFocus","relativeTop","reveal","getParentElement","getFirstElementChild","get","refreshNode","render","treeNode","doRefreshSubTree","c","finally","delete","doRefreshNode","childrenToRefresh","settled","childrenPromise","empty","doGetChildren","slowTimeout","fire","_","setChildren","getChildren","processChildren","deep","catch","childrenElementsIterable","childrenElements","length","nodesToForget","childrenTreeNodesById","asyncDataTreeNode","push","toString","splice","childAsyncDataTreeNode","indexOf","expanded","values","asTreeElement","diffIdentityProvider","setCollapsible","sort","compare","bind","CompressibleAsyncDataTreeNodeWrapper","incompressible","CompressibleAsyncDataTreeRenderer","compressibleNodeMapperProvider","renderCompressedElements","disposeCompressedElements","asCompressibleObjectTreeOptions","getCompressedNodeKeyboardNavigationLabel","els","CompressibleAsyncDataTree","virtualDelegate","compressionDelegate","compressibleNodeMapper","isIncompressible","getUncompressedIds","Set","compressedNode","getCompressedTreeNode","oldSelection","oldFocus","didChangeSelection","didChangeFocus","visit","i","has","visibility","getVisibility","Error","filterResult"],"sources":["/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/monaco-editor/esm/vs/base/browser/ui/tree/asyncDataTree.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { ElementsDragAndDropData } from '../list/listView.js';\nimport { ComposedTreeDelegate } from './abstractTree.js';\nimport { getVisibleState, isFilterResult } from './indexTreeModel.js';\nimport { CompressibleObjectTree, ObjectTree } from './objectTree.js';\nimport { TreeError, WeakMapper } from './tree.js';\nimport { createCancelablePromise, Promises, timeout } from '../../../common/async.js';\nimport { Codicon } from '../../../common/codicons.js';\nimport { isCancellationError, onUnexpectedError } from '../../../common/errors.js';\nimport { Emitter, Event } from '../../../common/event.js';\nimport { Iterable } from '../../../common/iterator.js';\nimport { DisposableStore, dispose } from '../../../common/lifecycle.js';\nimport { isIterable } from '../../../common/types.js';\nfunction createAsyncDataTreeNode(props) {\n    return Object.assign(Object.assign({}, props), { children: [], refreshPromise: undefined, stale: true, slow: false, collapsedByDefault: undefined });\n}\nfunction isAncestor(ancestor, descendant) {\n    if (!descendant.parent) {\n        return false;\n    }\n    else if (descendant.parent === ancestor) {\n        return true;\n    }\n    else {\n        return isAncestor(ancestor, descendant.parent);\n    }\n}\nfunction intersects(node, other) {\n    return node === other || isAncestor(node, other) || isAncestor(other, node);\n}\nclass AsyncDataTreeNodeWrapper {\n    constructor(node) {\n        this.node = node;\n    }\n    get element() { return this.node.element.element; }\n    get children() { return this.node.children.map(node => new AsyncDataTreeNodeWrapper(node)); }\n    get depth() { return this.node.depth; }\n    get visibleChildrenCount() { return this.node.visibleChildrenCount; }\n    get visibleChildIndex() { return this.node.visibleChildIndex; }\n    get collapsible() { return this.node.collapsible; }\n    get collapsed() { return this.node.collapsed; }\n    get visible() { return this.node.visible; }\n    get filterData() { return this.node.filterData; }\n}\nclass AsyncDataTreeRenderer {\n    constructor(renderer, nodeMapper, onDidChangeTwistieState) {\n        this.renderer = renderer;\n        this.nodeMapper = nodeMapper;\n        this.onDidChangeTwistieState = onDidChangeTwistieState;\n        this.renderedNodes = new Map();\n        this.templateId = renderer.templateId;\n    }\n    renderTemplate(container) {\n        const templateData = this.renderer.renderTemplate(container);\n        return { templateData };\n    }\n    renderElement(node, index, templateData, height) {\n        this.renderer.renderElement(this.nodeMapper.map(node), index, templateData.templateData, height);\n    }\n    renderTwistie(element, twistieElement) {\n        if (element.slow) {\n            twistieElement.classList.add(...Codicon.treeItemLoading.classNamesArray);\n            return true;\n        }\n        else {\n            twistieElement.classList.remove(...Codicon.treeItemLoading.classNamesArray);\n            return false;\n        }\n    }\n    disposeElement(node, index, templateData, height) {\n        var _a, _b;\n        (_b = (_a = this.renderer).disposeElement) === null || _b === void 0 ? void 0 : _b.call(_a, this.nodeMapper.map(node), index, templateData.templateData, height);\n    }\n    disposeTemplate(templateData) {\n        this.renderer.disposeTemplate(templateData.templateData);\n    }\n    dispose() {\n        this.renderedNodes.clear();\n    }\n}\nfunction asTreeEvent(e) {\n    return {\n        browserEvent: e.browserEvent,\n        elements: e.elements.map(e => e.element)\n    };\n}\nfunction asTreeMouseEvent(e) {\n    return {\n        browserEvent: e.browserEvent,\n        element: e.element && e.element.element,\n        target: e.target\n    };\n}\nclass AsyncDataTreeElementsDragAndDropData extends ElementsDragAndDropData {\n    constructor(data) {\n        super(data.elements.map(node => node.element));\n        this.data = data;\n    }\n}\nfunction asAsyncDataTreeDragAndDropData(data) {\n    if (data instanceof ElementsDragAndDropData) {\n        return new AsyncDataTreeElementsDragAndDropData(data);\n    }\n    return data;\n}\nclass AsyncDataTreeNodeListDragAndDrop {\n    constructor(dnd) {\n        this.dnd = dnd;\n    }\n    getDragURI(node) {\n        return this.dnd.getDragURI(node.element);\n    }\n    getDragLabel(nodes, originalEvent) {\n        if (this.dnd.getDragLabel) {\n            return this.dnd.getDragLabel(nodes.map(node => node.element), originalEvent);\n        }\n        return undefined;\n    }\n    onDragStart(data, originalEvent) {\n        var _a, _b;\n        (_b = (_a = this.dnd).onDragStart) === null || _b === void 0 ? void 0 : _b.call(_a, asAsyncDataTreeDragAndDropData(data), originalEvent);\n    }\n    onDragOver(data, targetNode, targetIndex, originalEvent, raw = true) {\n        return this.dnd.onDragOver(asAsyncDataTreeDragAndDropData(data), targetNode && targetNode.element, targetIndex, originalEvent);\n    }\n    drop(data, targetNode, targetIndex, originalEvent) {\n        this.dnd.drop(asAsyncDataTreeDragAndDropData(data), targetNode && targetNode.element, targetIndex, originalEvent);\n    }\n    onDragEnd(originalEvent) {\n        var _a, _b;\n        (_b = (_a = this.dnd).onDragEnd) === null || _b === void 0 ? void 0 : _b.call(_a, originalEvent);\n    }\n}\nfunction asObjectTreeOptions(options) {\n    return options && Object.assign(Object.assign({}, options), { collapseByDefault: true, identityProvider: options.identityProvider && {\n            getId(el) {\n                return options.identityProvider.getId(el.element);\n            }\n        }, dnd: options.dnd && new AsyncDataTreeNodeListDragAndDrop(options.dnd), multipleSelectionController: options.multipleSelectionController && {\n            isSelectionSingleChangeEvent(e) {\n                return options.multipleSelectionController.isSelectionSingleChangeEvent(Object.assign(Object.assign({}, e), { element: e.element }));\n            },\n            isSelectionRangeChangeEvent(e) {\n                return options.multipleSelectionController.isSelectionRangeChangeEvent(Object.assign(Object.assign({}, e), { element: e.element }));\n            }\n        }, accessibilityProvider: options.accessibilityProvider && Object.assign(Object.assign({}, options.accessibilityProvider), { getPosInSet: undefined, getSetSize: undefined, getRole: options.accessibilityProvider.getRole ? (el) => {\n                return options.accessibilityProvider.getRole(el.element);\n            } : () => 'treeitem', isChecked: options.accessibilityProvider.isChecked ? (e) => {\n                var _a;\n                return !!((_a = options.accessibilityProvider) === null || _a === void 0 ? void 0 : _a.isChecked(e.element));\n            } : undefined, getAriaLabel(e) {\n                return options.accessibilityProvider.getAriaLabel(e.element);\n            },\n            getWidgetAriaLabel() {\n                return options.accessibilityProvider.getWidgetAriaLabel();\n            }, getWidgetRole: options.accessibilityProvider.getWidgetRole ? () => options.accessibilityProvider.getWidgetRole() : () => 'tree', getAriaLevel: options.accessibilityProvider.getAriaLevel && (node => {\n                return options.accessibilityProvider.getAriaLevel(node.element);\n            }), getActiveDescendantId: options.accessibilityProvider.getActiveDescendantId && (node => {\n                return options.accessibilityProvider.getActiveDescendantId(node.element);\n            }) }), filter: options.filter && {\n            filter(e, parentVisibility) {\n                return options.filter.filter(e.element, parentVisibility);\n            }\n        }, keyboardNavigationLabelProvider: options.keyboardNavigationLabelProvider && Object.assign(Object.assign({}, options.keyboardNavigationLabelProvider), { getKeyboardNavigationLabel(e) {\n                return options.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e.element);\n            } }), sorter: undefined, expandOnlyOnTwistieClick: typeof options.expandOnlyOnTwistieClick === 'undefined' ? undefined : (typeof options.expandOnlyOnTwistieClick !== 'function' ? options.expandOnlyOnTwistieClick : (e => options.expandOnlyOnTwistieClick(e.element))), additionalScrollHeight: options.additionalScrollHeight });\n}\nfunction dfs(node, fn) {\n    fn(node);\n    node.children.forEach(child => dfs(child, fn));\n}\nexport class AsyncDataTree {\n    constructor(user, container, delegate, renderers, dataSource, options = {}) {\n        this.user = user;\n        this.dataSource = dataSource;\n        this.nodes = new Map();\n        this.subTreeRefreshPromises = new Map();\n        this.refreshPromises = new Map();\n        this._onDidRender = new Emitter();\n        this._onDidChangeNodeSlowState = new Emitter();\n        this.nodeMapper = new WeakMapper(node => new AsyncDataTreeNodeWrapper(node));\n        this.disposables = new DisposableStore();\n        this.identityProvider = options.identityProvider;\n        this.autoExpandSingleChildren = typeof options.autoExpandSingleChildren === 'undefined' ? false : options.autoExpandSingleChildren;\n        this.sorter = options.sorter;\n        this.collapseByDefault = options.collapseByDefault;\n        this.tree = this.createTree(user, container, delegate, renderers, options);\n        this.onDidChangeFindMode = this.tree.onDidChangeFindMode;\n        this.root = createAsyncDataTreeNode({\n            element: undefined,\n            parent: null,\n            hasChildren: true\n        });\n        if (this.identityProvider) {\n            this.root = Object.assign(Object.assign({}, this.root), { id: null });\n        }\n        this.nodes.set(null, this.root);\n        this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState, this, this.disposables);\n    }\n    get onDidChangeFocus() { return Event.map(this.tree.onDidChangeFocus, asTreeEvent); }\n    get onDidChangeSelection() { return Event.map(this.tree.onDidChangeSelection, asTreeEvent); }\n    get onMouseDblClick() { return Event.map(this.tree.onMouseDblClick, asTreeMouseEvent); }\n    get onPointer() { return Event.map(this.tree.onPointer, asTreeMouseEvent); }\n    get onDidFocus() { return this.tree.onDidFocus; }\n    get onDidChangeModel() { return this.tree.onDidChangeModel; }\n    get onDidChangeCollapseState() { return this.tree.onDidChangeCollapseState; }\n    get onDidChangeFindOpenState() { return this.tree.onDidChangeFindOpenState; }\n    get onDidDispose() { return this.tree.onDidDispose; }\n    createTree(user, container, delegate, renderers, options) {\n        const objectTreeDelegate = new ComposedTreeDelegate(delegate);\n        const objectTreeRenderers = renderers.map(r => new AsyncDataTreeRenderer(r, this.nodeMapper, this._onDidChangeNodeSlowState.event));\n        const objectTreeOptions = asObjectTreeOptions(options) || {};\n        return new ObjectTree(user, container, objectTreeDelegate, objectTreeRenderers, objectTreeOptions);\n    }\n    updateOptions(options = {}) {\n        this.tree.updateOptions(options);\n    }\n    // Widget\n    getHTMLElement() {\n        return this.tree.getHTMLElement();\n    }\n    get scrollTop() {\n        return this.tree.scrollTop;\n    }\n    set scrollTop(scrollTop) {\n        this.tree.scrollTop = scrollTop;\n    }\n    domFocus() {\n        this.tree.domFocus();\n    }\n    layout(height, width) {\n        this.tree.layout(height, width);\n    }\n    style(styles) {\n        this.tree.style(styles);\n    }\n    // Model\n    getInput() {\n        return this.root.element;\n    }\n    setInput(input, viewState) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.refreshPromises.forEach(promise => promise.cancel());\n            this.refreshPromises.clear();\n            this.root.element = input;\n            const viewStateContext = viewState && { viewState, focus: [], selection: [] };\n            yield this._updateChildren(input, true, false, viewStateContext);\n            if (viewStateContext) {\n                this.tree.setFocus(viewStateContext.focus);\n                this.tree.setSelection(viewStateContext.selection);\n            }\n            if (viewState && typeof viewState.scrollTop === 'number') {\n                this.scrollTop = viewState.scrollTop;\n            }\n        });\n    }\n    _updateChildren(element = this.root.element, recursive = true, rerender = false, viewStateContext, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (typeof this.root.element === 'undefined') {\n                throw new TreeError(this.user, 'Tree input not set');\n            }\n            if (this.root.refreshPromise) {\n                yield this.root.refreshPromise;\n                yield Event.toPromise(this._onDidRender.event);\n            }\n            const node = this.getDataNode(element);\n            yield this.refreshAndRenderNode(node, recursive, viewStateContext, options);\n            if (rerender) {\n                try {\n                    this.tree.rerender(node);\n                }\n                catch (_a) {\n                    // missing nodes are fine, this could've resulted from\n                    // parallel refresh calls, removing `node` altogether\n                }\n            }\n        });\n    }\n    // View\n    rerender(element) {\n        if (element === undefined || element === this.root.element) {\n            this.tree.rerender();\n            return;\n        }\n        const node = this.getDataNode(element);\n        this.tree.rerender(node);\n    }\n    // Tree\n    getNode(element = this.root.element) {\n        const dataNode = this.getDataNode(element);\n        const node = this.tree.getNode(dataNode === this.root ? null : dataNode);\n        return this.nodeMapper.map(node);\n    }\n    collapse(element, recursive = false) {\n        const node = this.getDataNode(element);\n        return this.tree.collapse(node === this.root ? null : node, recursive);\n    }\n    expand(element, recursive = false) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (typeof this.root.element === 'undefined') {\n                throw new TreeError(this.user, 'Tree input not set');\n            }\n            if (this.root.refreshPromise) {\n                yield this.root.refreshPromise;\n                yield Event.toPromise(this._onDidRender.event);\n            }\n            const node = this.getDataNode(element);\n            if (this.tree.hasElement(node) && !this.tree.isCollapsible(node)) {\n                return false;\n            }\n            if (node.refreshPromise) {\n                yield this.root.refreshPromise;\n                yield Event.toPromise(this._onDidRender.event);\n            }\n            if (node !== this.root && !node.refreshPromise && !this.tree.isCollapsed(node)) {\n                return false;\n            }\n            const result = this.tree.expand(node === this.root ? null : node, recursive);\n            if (node.refreshPromise) {\n                yield this.root.refreshPromise;\n                yield Event.toPromise(this._onDidRender.event);\n            }\n            return result;\n        });\n    }\n    setSelection(elements, browserEvent) {\n        const nodes = elements.map(e => this.getDataNode(e));\n        this.tree.setSelection(nodes, browserEvent);\n    }\n    getSelection() {\n        const nodes = this.tree.getSelection();\n        return nodes.map(n => n.element);\n    }\n    setFocus(elements, browserEvent) {\n        const nodes = elements.map(e => this.getDataNode(e));\n        this.tree.setFocus(nodes, browserEvent);\n    }\n    getFocus() {\n        const nodes = this.tree.getFocus();\n        return nodes.map(n => n.element);\n    }\n    reveal(element, relativeTop) {\n        this.tree.reveal(this.getDataNode(element), relativeTop);\n    }\n    // Tree navigation\n    getParentElement(element) {\n        const node = this.tree.getParentElement(this.getDataNode(element));\n        return (node && node.element);\n    }\n    getFirstElementChild(element = this.root.element) {\n        const dataNode = this.getDataNode(element);\n        const node = this.tree.getFirstElementChild(dataNode === this.root ? null : dataNode);\n        return (node && node.element);\n    }\n    // Implementation\n    getDataNode(element) {\n        const node = this.nodes.get((element === this.root.element ? null : element));\n        if (!node) {\n            throw new TreeError(this.user, `Data tree node not found: ${element}`);\n        }\n        return node;\n    }\n    refreshAndRenderNode(node, recursive, viewStateContext, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.refreshNode(node, recursive, viewStateContext);\n            this.render(node, viewStateContext, options);\n        });\n    }\n    refreshNode(node, recursive, viewStateContext) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let result;\n            this.subTreeRefreshPromises.forEach((refreshPromise, refreshNode) => {\n                if (!result && intersects(refreshNode, node)) {\n                    result = refreshPromise.then(() => this.refreshNode(node, recursive, viewStateContext));\n                }\n            });\n            if (result) {\n                return result;\n            }\n            if (node !== this.root) {\n                const treeNode = this.tree.getNode(node);\n                if (treeNode.collapsed) {\n                    node.hasChildren = !!this.dataSource.hasChildren(node.element);\n                    node.stale = true;\n                    return;\n                }\n            }\n            return this.doRefreshSubTree(node, recursive, viewStateContext);\n        });\n    }\n    doRefreshSubTree(node, recursive, viewStateContext) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let done;\n            node.refreshPromise = new Promise(c => done = c);\n            this.subTreeRefreshPromises.set(node, node.refreshPromise);\n            node.refreshPromise.finally(() => {\n                node.refreshPromise = undefined;\n                this.subTreeRefreshPromises.delete(node);\n            });\n            try {\n                const childrenToRefresh = yield this.doRefreshNode(node, recursive, viewStateContext);\n                node.stale = false;\n                yield Promises.settled(childrenToRefresh.map(child => this.doRefreshSubTree(child, recursive, viewStateContext)));\n            }\n            finally {\n                done();\n            }\n        });\n    }\n    doRefreshNode(node, recursive, viewStateContext) {\n        return __awaiter(this, void 0, void 0, function* () {\n            node.hasChildren = !!this.dataSource.hasChildren(node.element);\n            let childrenPromise;\n            if (!node.hasChildren) {\n                childrenPromise = Promise.resolve(Iterable.empty());\n            }\n            else {\n                const children = this.doGetChildren(node);\n                if (isIterable(children)) {\n                    childrenPromise = Promise.resolve(children);\n                }\n                else {\n                    const slowTimeout = timeout(800);\n                    slowTimeout.then(() => {\n                        node.slow = true;\n                        this._onDidChangeNodeSlowState.fire(node);\n                    }, _ => null);\n                    childrenPromise = children.finally(() => slowTimeout.cancel());\n                }\n            }\n            try {\n                const children = yield childrenPromise;\n                return this.setChildren(node, children, recursive, viewStateContext);\n            }\n            catch (err) {\n                if (node !== this.root && this.tree.hasElement(node)) {\n                    this.tree.collapse(node);\n                }\n                if (isCancellationError(err)) {\n                    return [];\n                }\n                throw err;\n            }\n            finally {\n                if (node.slow) {\n                    node.slow = false;\n                    this._onDidChangeNodeSlowState.fire(node);\n                }\n            }\n        });\n    }\n    doGetChildren(node) {\n        let result = this.refreshPromises.get(node);\n        if (result) {\n            return result;\n        }\n        const children = this.dataSource.getChildren(node.element);\n        if (isIterable(children)) {\n            return this.processChildren(children);\n        }\n        else {\n            result = createCancelablePromise(() => __awaiter(this, void 0, void 0, function* () { return this.processChildren(yield children); }));\n            this.refreshPromises.set(node, result);\n            return result.finally(() => { this.refreshPromises.delete(node); });\n        }\n    }\n    _onDidChangeCollapseState({ node, deep }) {\n        if (node.element === null) {\n            return;\n        }\n        if (!node.collapsed && node.element.stale) {\n            if (deep) {\n                this.collapse(node.element.element);\n            }\n            else {\n                this.refreshAndRenderNode(node.element, false)\n                    .catch(onUnexpectedError);\n            }\n        }\n    }\n    setChildren(node, childrenElementsIterable, recursive, viewStateContext) {\n        const childrenElements = [...childrenElementsIterable];\n        // perf: if the node was and still is a leaf, avoid all this hassle\n        if (node.children.length === 0 && childrenElements.length === 0) {\n            return [];\n        }\n        const nodesToForget = new Map();\n        const childrenTreeNodesById = new Map();\n        for (const child of node.children) {\n            nodesToForget.set(child.element, child);\n            if (this.identityProvider) {\n                const collapsed = this.tree.isCollapsed(child);\n                childrenTreeNodesById.set(child.id, { node: child, collapsed });\n            }\n        }\n        const childrenToRefresh = [];\n        const children = childrenElements.map(element => {\n            const hasChildren = !!this.dataSource.hasChildren(element);\n            if (!this.identityProvider) {\n                const asyncDataTreeNode = createAsyncDataTreeNode({ element, parent: node, hasChildren });\n                if (hasChildren && this.collapseByDefault && !this.collapseByDefault(element)) {\n                    asyncDataTreeNode.collapsedByDefault = false;\n                    childrenToRefresh.push(asyncDataTreeNode);\n                }\n                return asyncDataTreeNode;\n            }\n            const id = this.identityProvider.getId(element).toString();\n            const result = childrenTreeNodesById.get(id);\n            if (result) {\n                const asyncDataTreeNode = result.node;\n                nodesToForget.delete(asyncDataTreeNode.element);\n                this.nodes.delete(asyncDataTreeNode.element);\n                this.nodes.set(element, asyncDataTreeNode);\n                asyncDataTreeNode.element = element;\n                asyncDataTreeNode.hasChildren = hasChildren;\n                if (recursive) {\n                    if (result.collapsed) {\n                        asyncDataTreeNode.children.forEach(node => dfs(node, node => this.nodes.delete(node.element)));\n                        asyncDataTreeNode.children.splice(0, asyncDataTreeNode.children.length);\n                        asyncDataTreeNode.stale = true;\n                    }\n                    else {\n                        childrenToRefresh.push(asyncDataTreeNode);\n                    }\n                }\n                else if (hasChildren && this.collapseByDefault && !this.collapseByDefault(element)) {\n                    asyncDataTreeNode.collapsedByDefault = false;\n                    childrenToRefresh.push(asyncDataTreeNode);\n                }\n                return asyncDataTreeNode;\n            }\n            const childAsyncDataTreeNode = createAsyncDataTreeNode({ element, parent: node, id, hasChildren });\n            if (viewStateContext && viewStateContext.viewState.focus && viewStateContext.viewState.focus.indexOf(id) > -1) {\n                viewStateContext.focus.push(childAsyncDataTreeNode);\n            }\n            if (viewStateContext && viewStateContext.viewState.selection && viewStateContext.viewState.selection.indexOf(id) > -1) {\n                viewStateContext.selection.push(childAsyncDataTreeNode);\n            }\n            if (viewStateContext && viewStateContext.viewState.expanded && viewStateContext.viewState.expanded.indexOf(id) > -1) {\n                childrenToRefresh.push(childAsyncDataTreeNode);\n            }\n            else if (hasChildren && this.collapseByDefault && !this.collapseByDefault(element)) {\n                childAsyncDataTreeNode.collapsedByDefault = false;\n                childrenToRefresh.push(childAsyncDataTreeNode);\n            }\n            return childAsyncDataTreeNode;\n        });\n        for (const node of nodesToForget.values()) {\n            dfs(node, node => this.nodes.delete(node.element));\n        }\n        for (const child of children) {\n            this.nodes.set(child.element, child);\n        }\n        node.children.splice(0, node.children.length, ...children);\n        // TODO@joao this doesn't take filter into account\n        if (node !== this.root && this.autoExpandSingleChildren && children.length === 1 && childrenToRefresh.length === 0) {\n            children[0].collapsedByDefault = false;\n            childrenToRefresh.push(children[0]);\n        }\n        return childrenToRefresh;\n    }\n    render(node, viewStateContext, options) {\n        const children = node.children.map(node => this.asTreeElement(node, viewStateContext));\n        const objectTreeOptions = options && Object.assign(Object.assign({}, options), { diffIdentityProvider: options.diffIdentityProvider && {\n                getId(node) {\n                    return options.diffIdentityProvider.getId(node.element);\n                }\n            } });\n        this.tree.setChildren(node === this.root ? null : node, children, objectTreeOptions);\n        if (node !== this.root) {\n            this.tree.setCollapsible(node, node.hasChildren);\n        }\n        this._onDidRender.fire();\n    }\n    asTreeElement(node, viewStateContext) {\n        if (node.stale) {\n            return {\n                element: node,\n                collapsible: node.hasChildren,\n                collapsed: true\n            };\n        }\n        let collapsed;\n        if (viewStateContext && viewStateContext.viewState.expanded && node.id && viewStateContext.viewState.expanded.indexOf(node.id) > -1) {\n            collapsed = false;\n        }\n        else {\n            collapsed = node.collapsedByDefault;\n        }\n        node.collapsedByDefault = undefined;\n        return {\n            element: node,\n            children: node.hasChildren ? Iterable.map(node.children, child => this.asTreeElement(child, viewStateContext)) : [],\n            collapsible: node.hasChildren,\n            collapsed\n        };\n    }\n    processChildren(children) {\n        if (this.sorter) {\n            children = [...children].sort(this.sorter.compare.bind(this.sorter));\n        }\n        return children;\n    }\n    dispose() {\n        this.disposables.dispose();\n    }\n}\nclass CompressibleAsyncDataTreeNodeWrapper {\n    constructor(node) {\n        this.node = node;\n    }\n    get element() {\n        return {\n            elements: this.node.element.elements.map(e => e.element),\n            incompressible: this.node.element.incompressible\n        };\n    }\n    get children() { return this.node.children.map(node => new CompressibleAsyncDataTreeNodeWrapper(node)); }\n    get depth() { return this.node.depth; }\n    get visibleChildrenCount() { return this.node.visibleChildrenCount; }\n    get visibleChildIndex() { return this.node.visibleChildIndex; }\n    get collapsible() { return this.node.collapsible; }\n    get collapsed() { return this.node.collapsed; }\n    get visible() { return this.node.visible; }\n    get filterData() { return this.node.filterData; }\n}\nclass CompressibleAsyncDataTreeRenderer {\n    constructor(renderer, nodeMapper, compressibleNodeMapperProvider, onDidChangeTwistieState) {\n        this.renderer = renderer;\n        this.nodeMapper = nodeMapper;\n        this.compressibleNodeMapperProvider = compressibleNodeMapperProvider;\n        this.onDidChangeTwistieState = onDidChangeTwistieState;\n        this.renderedNodes = new Map();\n        this.disposables = [];\n        this.templateId = renderer.templateId;\n    }\n    renderTemplate(container) {\n        const templateData = this.renderer.renderTemplate(container);\n        return { templateData };\n    }\n    renderElement(node, index, templateData, height) {\n        this.renderer.renderElement(this.nodeMapper.map(node), index, templateData.templateData, height);\n    }\n    renderCompressedElements(node, index, templateData, height) {\n        this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(node), index, templateData.templateData, height);\n    }\n    renderTwistie(element, twistieElement) {\n        if (element.slow) {\n            twistieElement.classList.add(...Codicon.treeItemLoading.classNamesArray);\n            return true;\n        }\n        else {\n            twistieElement.classList.remove(...Codicon.treeItemLoading.classNamesArray);\n            return false;\n        }\n    }\n    disposeElement(node, index, templateData, height) {\n        var _a, _b;\n        (_b = (_a = this.renderer).disposeElement) === null || _b === void 0 ? void 0 : _b.call(_a, this.nodeMapper.map(node), index, templateData.templateData, height);\n    }\n    disposeCompressedElements(node, index, templateData, height) {\n        var _a, _b;\n        (_b = (_a = this.renderer).disposeCompressedElements) === null || _b === void 0 ? void 0 : _b.call(_a, this.compressibleNodeMapperProvider().map(node), index, templateData.templateData, height);\n    }\n    disposeTemplate(templateData) {\n        this.renderer.disposeTemplate(templateData.templateData);\n    }\n    dispose() {\n        this.renderedNodes.clear();\n        this.disposables = dispose(this.disposables);\n    }\n}\nfunction asCompressibleObjectTreeOptions(options) {\n    const objectTreeOptions = options && asObjectTreeOptions(options);\n    return objectTreeOptions && Object.assign(Object.assign({}, objectTreeOptions), { keyboardNavigationLabelProvider: objectTreeOptions.keyboardNavigationLabelProvider && Object.assign(Object.assign({}, objectTreeOptions.keyboardNavigationLabelProvider), { getCompressedNodeKeyboardNavigationLabel(els) {\n                return options.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(els.map(e => e.element));\n            } }) });\n}\nexport class CompressibleAsyncDataTree extends AsyncDataTree {\n    constructor(user, container, virtualDelegate, compressionDelegate, renderers, dataSource, options = {}) {\n        super(user, container, virtualDelegate, renderers, dataSource, options);\n        this.compressionDelegate = compressionDelegate;\n        this.compressibleNodeMapper = new WeakMapper(node => new CompressibleAsyncDataTreeNodeWrapper(node));\n        this.filter = options.filter;\n    }\n    createTree(user, container, delegate, renderers, options) {\n        const objectTreeDelegate = new ComposedTreeDelegate(delegate);\n        const objectTreeRenderers = renderers.map(r => new CompressibleAsyncDataTreeRenderer(r, this.nodeMapper, () => this.compressibleNodeMapper, this._onDidChangeNodeSlowState.event));\n        const objectTreeOptions = asCompressibleObjectTreeOptions(options) || {};\n        return new CompressibleObjectTree(user, container, objectTreeDelegate, objectTreeRenderers, objectTreeOptions);\n    }\n    asTreeElement(node, viewStateContext) {\n        return Object.assign({ incompressible: this.compressionDelegate.isIncompressible(node.element) }, super.asTreeElement(node, viewStateContext));\n    }\n    updateOptions(options = {}) {\n        this.tree.updateOptions(options);\n    }\n    render(node, viewStateContext) {\n        if (!this.identityProvider) {\n            return super.render(node, viewStateContext);\n        }\n        // Preserve traits across compressions. Hacky but does the trick.\n        // This is hard to fix properly since it requires rewriting the traits\n        // across trees and lists. Let's just keep it this way for now.\n        const getId = (element) => this.identityProvider.getId(element).toString();\n        const getUncompressedIds = (nodes) => {\n            const result = new Set();\n            for (const node of nodes) {\n                const compressedNode = this.tree.getCompressedTreeNode(node === this.root ? null : node);\n                if (!compressedNode.element) {\n                    continue;\n                }\n                for (const node of compressedNode.element.elements) {\n                    result.add(getId(node.element));\n                }\n            }\n            return result;\n        };\n        const oldSelection = getUncompressedIds(this.tree.getSelection());\n        const oldFocus = getUncompressedIds(this.tree.getFocus());\n        super.render(node, viewStateContext);\n        const selection = this.getSelection();\n        let didChangeSelection = false;\n        const focus = this.getFocus();\n        let didChangeFocus = false;\n        const visit = (node) => {\n            const compressedNode = node.element;\n            if (compressedNode) {\n                for (let i = 0; i < compressedNode.elements.length; i++) {\n                    const id = getId(compressedNode.elements[i].element);\n                    const element = compressedNode.elements[compressedNode.elements.length - 1].element;\n                    // github.com/microsoft/vscode/issues/85938\n                    if (oldSelection.has(id) && selection.indexOf(element) === -1) {\n                        selection.push(element);\n                        didChangeSelection = true;\n                    }\n                    if (oldFocus.has(id) && focus.indexOf(element) === -1) {\n                        focus.push(element);\n                        didChangeFocus = true;\n                    }\n                }\n            }\n            node.children.forEach(visit);\n        };\n        visit(this.tree.getCompressedTreeNode(node === this.root ? null : node));\n        if (didChangeSelection) {\n            this.setSelection(selection);\n        }\n        if (didChangeFocus) {\n            this.setFocus(focus);\n        }\n    }\n    // For compressed async data trees, `TreeVisibility.Recurse` doesn't currently work\n    // and we have to filter everything beforehand\n    // Related to #85193 and #85835\n    processChildren(children) {\n        if (this.filter) {\n            children = Iterable.filter(children, e => {\n                const result = this.filter.filter(e, 1 /* TreeVisibility.Visible */);\n                const visibility = getVisibility(result);\n                if (visibility === 2 /* TreeVisibility.Recurse */) {\n                    throw new Error('Recursive tree visibility not supported in async data compressed trees');\n                }\n                return visibility === 1 /* TreeVisibility.Visible */;\n            });\n        }\n        return super.processChildren(children);\n    }\n}\nfunction getVisibility(filterResult) {\n    if (typeof filterResult === 'boolean') {\n        return filterResult ? 1 /* TreeVisibility.Visible */ : 0 /* TreeVisibility.Hidden */;\n    }\n    else if (isFilterResult(filterResult)) {\n        return getVisibleState(filterResult.visibility);\n    }\n    else {\n        return getVisibleState(filterResult);\n    }\n}\n"],"mappings":"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"}]}