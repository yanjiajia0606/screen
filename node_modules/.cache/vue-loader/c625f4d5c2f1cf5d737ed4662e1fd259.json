{"remainingRequest":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yanjiajia/Desktop/workspace/avue-data-new/src/page/list/components.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/src/page/list/components.vue","mtime":1668271197000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js","mtime":456789000000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBBdnVlRWNoYXJ0VnVlIGZyb20gJ0AvZWNoYXJ0L3BhY2thZ2VzL3Z1ZSc7CmltcG9ydCBNb25hY29FZGl0b3IgZnJvbSAnQC9wYWdlL2NvbXBvbmVudHMvbW9uYWNvLWVkaXRvcicKaW1wb3J0IHsgZ2V0TGlzdCwgZ2V0T2JqLCBhZGRPYmosIGRlbE9iaiwgdXBkYXRlT2JqIH0gZnJvbSAnQC9hcGkvY29tcG9uZW50cycKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIEF2dWVFY2hhcnRWdWUsCiAgICBNb25hY29FZGl0b3IKICB9LAogIHByb3BzOiB7CiAgICBtZW51OiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IHRydWUKICAgIH0KICB9LAogIGRhdGEgKCkgewogICAgcmV0dXJuIHsKICAgICAgYm94OiBmYWxzZSwKICAgICAgb3B0aW9uczogewogICAgICAgIGhlaWdodDogMzAwLAogICAgICAgIGxhbmd1YWdlOiAnamF2YXNjcmlwdCcsCiAgICAgICAgZm9udFNpemU6IDEyCiAgICAgIH0sCiAgICAgIGNvbnRlbnQ6ICcnLAogICAgICBpbmRleDogLTEsCiAgICAgIGZvcm06IHt9LAogICAgICB2dWVPcHRpb246IHt9LAogICAgICBkYXRhOiBbXSwKICAgICAgb3B0aW9uOiB7CiAgICAgICAgdGlwOiBmYWxzZSwKICAgICAgICBoZWFkZXI6IHRydWUsCiAgICAgICAgbWVudTogdHJ1ZSwKICAgICAgICBzZWxlY3Rpb246IHRydWUsCiAgICAgICAgZGlhbG9nV2lkdGg6ICc3MCUnLAogICAgICAgIGxhYmVsV2lkdGg6IDEwMCwKICAgICAgICBpbmRleDogdHJ1ZSwKICAgICAgICBhbGlnbjogJ2NlbnRlcicsCiAgICAgICAgaGVhZGVyQWxpZ246ICdjZW50ZXInLAogICAgICAgIGNvbHVtbjogWwogICAgICAgICAgewogICAgICAgICAgICBsYWJlbDogJ+e7hOS7tuWQjeensCcsCiAgICAgICAgICAgIHByb3A6ICduYW1lJywKICAgICAgICAgICAgcm93OiB0cnVlLAogICAgICAgICAgICBydWxlczogW3sKICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgICAgICBtZXNzYWdlOiAi6K+36L6T5YWl57uE5Lu25ZCN56ewIiwKICAgICAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIKICAgICAgICAgICAgfV0KICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGxhYmVsOiAn57uE5Lu25pWw5o2uJywKICAgICAgICAgICAgcHJvcDogJ2NvbnRlbnQnLAogICAgICAgICAgICBzcGFuOiAyNCwKICAgICAgICAgICAgaGlkZTogdHJ1ZSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGxhYmVsOiAn57uE5Lu26aKE6KeIJywKICAgICAgICAgICAgcHJvcDogJ3ZpZXcnLAogICAgICAgICAgICBzcGFuOiAyNCwKICAgICAgICAgICAgaGlkZTogdHJ1ZSwKICAgICAgICAgIH0KICAgICAgICBdCiAgICAgIH0KICAgIH0KICB9LAogIGNyZWF0ZWQgKCkgewogICAgaWYgKHRoaXMubWVudSA9PT0gZmFsc2UpIHsKICAgICAgdGhpcy5vcHRpb24uaGVhZGVyID0gZmFsc2UKICAgICAgdGhpcy5vcHRpb24ubWVudSA9IGZhbHNlCiAgICB9CiAgICB0aGlzLmdldExpc3QoKQogIH0sCiAgbWV0aG9kczogewogICAgc2VsZWN0aW9uQ2hhbmdlICh2YWwpIHsKICAgICAgdGhpcy4kZW1pdCgnY2hhbmdlJywgdmFsWzBdKQogICAgfSwKICAgIHZhaWxkRGF0YSAoaWQpIHsKICAgICAgcmV0dXJuIFswLCAxLCAyXS5pbmNsdWRlcyhpZCkKICAgIH0sCiAgICBiZWZvcmVPcGVuIChkb25lLCB0eXBlKSB7CiAgICAgIGlmICh0eXBlID09ICdlZGl0JykgewogICAgICAgIGdldE9iaih0aGlzLmZvcm0uaWQpLnRoZW4ocmVzID0+IHsKICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXMuZGF0YS5kYXRhOwogICAgICAgICAgdGhpcy5mb3JtID0gZGF0YQogICAgICAgICAgdGhpcy5oYW5kbGVPcHRpb24oKQogICAgICAgICAgZG9uZSgpCiAgICAgICAgfSkKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmZvcm0uY29udGVudCA9ICcnCiAgICAgICAgdGhpcy5oYW5kbGVPcHRpb24oKQogICAgICAgIGRvbmUoKQogICAgICB9CgogICAgfSwKICAgIHJvd0RlbCAocm93LCBpbmRleCkgewogICAgICBpZiAodGhpcy52YWlsZERhdGEoaW5kZXgpICYmIHRoaXMuJHdlYnNpdGUuaXNEZW1vKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcih0aGlzLiR3ZWJzaXRlLmlzRGVtb1RpcCkKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgdGhpcy4kY29uZmlybSgn5q2k5pON5L2c5bCG5rC45LmF5Yig6ZmkLCDmmK/lkKbnu6fnu60/JywgJ+aPkOekuicsIHsKICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgIGRlbE9iaihyb3cuaWQpLnRoZW4oKCkgPT4gewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfliKDpmaTmiJDlip8nKTsKICAgICAgICAgIHRoaXMuZ2V0TGlzdCgpCiAgICAgICAgfSkKICAgICAgfSkKICAgIH0sCiAgICBoYW5kbGVPcHRpb24gKCkgewogICAgICB0aGlzLnZ1ZU9wdGlvbiA9IHRoaXMuZGVlcENsb25lKHRoaXMuZm9ybSkKICAgIH0sCiAgICByb3dVcGRhdGUgKHJvdywgaW5kZXgsIGRvbmUpIHsKICAgICAgaWYgKHRoaXMudmFpbGREYXRhKGluZGV4KSAmJiB0aGlzLiR3ZWJzaXRlLmlzRGVtbykgewogICAgICAgIGRvbmUoKTsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHRoaXMuJHdlYnNpdGUuaXNEZW1vVGlwKQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICB1cGRhdGVPYmoocm93KS50aGVuKCgpID0+IHsKICAgICAgICBkb25lKCk7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfkv67mlLnmiJDlip8nKTsKICAgICAgICB0aGlzLmdldExpc3QoKQoKICAgICAgfSkKICAgIH0sCiAgICByb3dTYXZlIChyb3csIGRvbmUpIHsKICAgICAgYWRkT2JqKHJvdykudGhlbigoKSA9PiB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfmlrDlop7miJDlip8nKTsKICAgICAgICB0aGlzLmdldExpc3QoKQogICAgICAgIGRvbmUoKTsKICAgICAgfSkKICAgIH0sCiAgICBoYW5kbGVWaWV3IChyb3csIGluZGV4KSB7CiAgICAgIGdldE9iaihyb3cuaWQpLnRoZW4ocmVzID0+IHsKICAgICAgICBjb25zdCBkYXRhID0gcmVzLmRhdGEuZGF0YTsKICAgICAgICB0aGlzLnZ1ZU9wdGlvbiA9IHRoaXMuZGVlcENsb25lKHsKICAgICAgICAgIGNvbnRlbnQ6IGRhdGEuY29udGVudAogICAgICAgIH0pCiAgICAgICAgdGhpcy5ib3ggPSB0cnVlCiAgICAgIH0pCiAgICB9LAogICAgZ2V0TGlzdCAoKSB7CiAgICAgIGdldExpc3QoewogICAgICAgIGN1cnJlbnQ6IDEsCiAgICAgICAgc2l6ZTogMTAwLAogICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgY29uc3QgZGF0YSA9IHJlcy5kYXRhLmRhdGE7CiAgICAgICAgdGhpcy5kYXRhID0gZGF0YS5yZWNvcmRzOwogICAgICB9KQogICAgfQogIH0KfQo="},{"version":3,"sources":["components.vue"],"names":[],"mappings":";AAkDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"components.vue","sourceRoot":"src/page/list","sourcesContent":["<template>\n  <div>\n    <avue-crud ref=\"crud\"\n               :option=\"option\"\n               v-model=\"form\"\n               @row-save=\"rowSave\"\n               @row-update=\"rowUpdate\"\n               @row-del=\"rowDel\"\n               :before-open=\"beforeOpen\"\n               @selection-change=\"selectionChange\"\n               :data=\"data\">\n      <template slot-scope=\"{size,type,row,index}\"\n                slot=\"menu\">\n        <el-button :size=\"size\"\n                   icon=\"el-icon-edit\"\n                   :type=\"type\"\n                   @click=\"handleView(row,index)\">预览</el-button>\n      </template>\n      <template slot-scope=\"{}\"\n                slot=\"contentForm\">\n        <monaco-editor v-model=\"form.content\"\n                       :language=\"options.language\"\n                       :height=\"options.height\"\n                       :options=\"options\"></monaco-editor>\n        <br />\n        <el-button v-if=\"!view\"\n                   type=\"primary\"\n                   size=\"small\"\n                   icon=\"el-icon-check\"\n                   @click=\"handleOption\">运行</el-button>\n      </template>\n      <template slot-scope=\"{}\"\n                slot=\"viewForm\">\n        <avue-echart-vue :option=\"vueOption\"\n                         width=\"100%\"\n                         height=\"100%\"></avue-echart-vue>\n      </template>\n    </avue-crud>\n    <el-dialog title=\"预览组件\"\n               :visible.sync=\"box\"\n               width=\"60%\">\n      <avue-echart-vue :option=\"vueOption\"\n                       width=\"100%\"\n                       height=\"100%\"></avue-echart-vue>\n    </el-dialog>\n\n  </div>\n</template>\n\n<script>\nimport AvueEchartVue from '@/echart/packages/vue';\nimport MonacoEditor from '@/page/components/monaco-editor'\nimport { getList, getObj, addObj, delObj, updateObj } from '@/api/components'\nexport default {\n  components: {\n    AvueEchartVue,\n    MonacoEditor\n  },\n  props: {\n    menu: {\n      type: Boolean,\n      default: true\n    }\n  },\n  data () {\n    return {\n      box: false,\n      options: {\n        height: 300,\n        language: 'javascript',\n        fontSize: 12\n      },\n      content: '',\n      index: -1,\n      form: {},\n      vueOption: {},\n      data: [],\n      option: {\n        tip: false,\n        header: true,\n        menu: true,\n        selection: true,\n        dialogWidth: '70%',\n        labelWidth: 100,\n        index: true,\n        align: 'center',\n        headerAlign: 'center',\n        column: [\n          {\n            label: '组件名称',\n            prop: 'name',\n            row: true,\n            rules: [{\n              required: true,\n              message: \"请输入组件名称\",\n              trigger: \"blur\"\n            }]\n          },\n          {\n            label: '组件数据',\n            prop: 'content',\n            span: 24,\n            hide: true,\n          },\n          {\n            label: '组件预览',\n            prop: 'view',\n            span: 24,\n            hide: true,\n          }\n        ]\n      }\n    }\n  },\n  created () {\n    if (this.menu === false) {\n      this.option.header = false\n      this.option.menu = false\n    }\n    this.getList()\n  },\n  methods: {\n    selectionChange (val) {\n      this.$emit('change', val[0])\n    },\n    vaildData (id) {\n      return [0, 1, 2].includes(id)\n    },\n    beforeOpen (done, type) {\n      if (type == 'edit') {\n        getObj(this.form.id).then(res => {\n          const data = res.data.data;\n          this.form = data\n          this.handleOption()\n          done()\n        })\n      } else {\n        this.form.content = ''\n        this.handleOption()\n        done()\n      }\n\n    },\n    rowDel (row, index) {\n      if (this.vaildData(index) && this.$website.isDemo) {\n        this.$message.error(this.$website.isDemoTip)\n        return false;\n      }\n      this.$confirm('此操作将永久删除, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        delObj(row.id).then(() => {\n          this.$message.success('删除成功');\n          this.getList()\n        })\n      })\n    },\n    handleOption () {\n      this.vueOption = this.deepClone(this.form)\n    },\n    rowUpdate (row, index, done) {\n      if (this.vaildData(index) && this.$website.isDemo) {\n        done();\n        this.$message.error(this.$website.isDemoTip)\n        return false;\n      }\n      updateObj(row).then(() => {\n        done();\n        this.$message.success('修改成功');\n        this.getList()\n\n      })\n    },\n    rowSave (row, done) {\n      addObj(row).then(() => {\n        this.$message.success('新增成功');\n        this.getList()\n        done();\n      })\n    },\n    handleView (row, index) {\n      getObj(row.id).then(res => {\n        const data = res.data.data;\n        this.vueOption = this.deepClone({\n          content: data.content\n        })\n        this.box = true\n      })\n    },\n    getList () {\n      getList({\n        current: 1,\n        size: 100,\n      }).then(res => {\n        const data = res.data.data;\n        this.data = data.records;\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.components {\n  &_content {\n    display: flex;\n    align-items: flex-end;\n    flex-direction: column;\n  }\n  &_left,\n  &_right {\n    width: 100%;\n  }\n}\n</style>"]}]}