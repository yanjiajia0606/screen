{"remainingRequest":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yanjiajia/Desktop/workspace/avue-data-new/src/page/group/code.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/src/page/group/code.vue","mtime":1668271197000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/babel-loader/lib/index.js","mtime":456789000000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanjiajia/Desktop/workspace/avue-data-new/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IHRpcCB9IGZyb20gJ0AvY29uZmlnJwppbXBvcnQgeyBmdW5FdmFsIH0gZnJvbSAnQC91dGlscy91dGlscycKaW1wb3J0IE1vbmFjb0VkaXRvciBmcm9tICdAL3BhZ2UvY29tcG9uZW50cy9lZGl0b3InCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7IE1vbmFjb0VkaXRvciB9LAogIGRhdGEgKCkgewogICAgcmV0dXJuIHsKICAgICAgY29kZTogJycsCiAgICAgIHRpcDogJycKICAgIH0KICB9LAogIHByb3BzOiB7CiAgICBydWxlczogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiB0cnVlCiAgICB9LAogICAgdGl0bGU6IFN0cmluZywKICAgIHZpc2libGU6IEJvb2xlYW4sCiAgICB0eXBlOiBTdHJpbmcsCiAgICB2YWx1ZTogW1N0cmluZywgT2JqZWN0LCBBcnJheV0KICB9LAogIHdhdGNoOiB7CiAgICB2YWx1ZTogewogICAgICBoYW5kbGVyICh2YWwpIHsKICAgICAgICBpZiAodGhpcy52YWxpZGF0ZW51bGwodmFsKSkgewogICAgICAgICAgaWYgKFsnZGF0YUZvcm1hdHRlcicsICdzdHlsZXNGb3JtYXR0ZXInXS5pbmNsdWRlcyh0aGlzLnR5cGUpICYmIHRoaXMudmFsaWRhdGVudWxsKHZhbCkpIHsKICAgICAgICAgICAgdGhpcy5jb2RlID0gYChkYXRhLHBhcmFtcyxyZWZzKT0+ewogICAgcmV0dXJuIHt9Cn1gCiAgICAgICAgICB9IGVsc2UgaWYgKFsncXVlcnknLCAnaGVhZGVyJywgJ2RhdGFRdWVyeScsICdkYXRhSGVhZGVyJ10uaW5jbHVkZXModGhpcy50eXBlKSAmJiB0aGlzLnZhbGlkYXRlbnVsbCh2YWwpKSB7CiAgICAgICAgICAgIHRoaXMuY29kZSA9IGAoZGF0YSk9PnsKICAgIHJldHVybiB7fQp9YAogICAgICAgICAgfSBlbHNlIGlmIChbJ2VjaGFydEZvcm1hdHRlciddLmluY2x1ZGVzKHRoaXMudHlwZSkgJiYgdGhpcy52YWxpZGF0ZW51bGwodmFsKSkgewogICAgICAgICAgICB0aGlzLmNvZGUgPSBgKGRhdGEpPT57CiAgICByZXR1cm4ge30KfWAKICAgICAgICAgIH0gZWxzZSBpZiAoWydjbGlja0Zvcm1hdHRlciddLmluY2x1ZGVzKHRoaXMudHlwZSkgJiYgdGhpcy52YWxpZGF0ZW51bGwodmFsKSkgewogICAgICAgICAgICB0aGlzLmNvZGUgPSBgKHBhcmFtcyxyZWZzKT0+ewogICAgY29uc29sZS5sb2cocGFyYW1zLHJlZnMpCn1gCiAgICAgICAgICB9IGVsc2UgaWYgKFsnbGFiZWxGb3JtYXR0ZXInLCAnZm9ybWF0dGVyJ10uaW5jbHVkZXModGhpcy50eXBlKSAmJiB0aGlzLnZhbGlkYXRlbnVsbCh2YWwpKSB7CiAgICAgICAgICAgIHRoaXMuY29kZSA9IGAobmFtZSxkYXRhKT0+ewogICAgY29uc29sZS5sb2cobmFtZSxkYXRhKQogICAgcmV0dXJuICcnCn1gCiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuY29kZSA9IHZhbDsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGltbWVkaWF0ZTogdHJ1ZSwKICAgICAgZGVlcDogdHJ1ZSwKICAgIH0sCiAgfSwKICBjcmVhdGVkICgpIHsKICAgIHRoaXMudGlwID0gdGlwCiAgfSwKICBtZXRob2RzOiB7CiAgICBoYW5kbGVDbG9zZSAoKSB7CiAgICAgIHRoaXMuc2V0VmlzaWJsZShmYWxzZSk7CiAgICB9LAogICAgc3VibWl0ICgpIHsKICAgICAgbGV0IHZhbHVlID0gdGhpcy5jb2RlOwogICAgICBpZiAoIXRoaXMucnVsZXMpIHsKICAgICAgICB0aGlzLiRlbWl0KCdzdWJtaXQnLCB2YWx1ZSk7CiAgICAgICAgdGhpcy5zZXRWaXNpYmxlKGZhbHNlKQogICAgICAgIHJldHVybgogICAgICB9CiAgICAgIHRyeSB7CiAgICAgICAgZnVuRXZhbCh2YWx1ZSk7CiAgICAgICAgaWYgKFsnZGF0YSddLmluY2x1ZGVzKHRoaXMudHlwZSkpIHZhbHVlID0gZnVuRXZhbCh2YWx1ZSk7CiAgICAgICAgdGhpcy4kZW1pdCgnc3VibWl0JywgdmFsdWUpOwogICAgICAgIHRoaXMuc2V0VmlzaWJsZShmYWxzZSkKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5pWw5o2u5qC85byP5pyJ6K+vJykKICAgICAgfQoKICAgIH0sCiAgICBzZXRWaXNpYmxlICh2YWwpIHsKICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOnZpc2libGUnLCB2YWwpOwogICAgfQogIH0KfQo="},{"version":3,"sources":["code.vue"],"names":[],"mappings":";AAwBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"code.vue","sourceRoot":"src/page/group","sourcesContent":["<template>\n  <el-dialog :visible.sync=\"visible\"\n             :close-on-click-modal=\"false\"\n             :before-close=\"handleClose\"\n             :title=\"title || '数据处理'\"\n             width=\"80%\">\n\n    <div class=\"content\">\n      <monaco-editor v-model=\"code\"></monaco-editor>\n      <monaco-editor v-model=\"tip\"\n                     disabled></monaco-editor>\n    </div>\n    <span slot=\"footer\"\n          class=\"dialog-footer\">\n      <el-button size=\"small\"\n                 @click=\"setVisible(false)\">取 消</el-button>\n      <el-button type=\"primary\"\n                 @click=\"submit\"\n                 size=\"small\">确 定</el-button>\n    </span>\n  </el-dialog>\n</template>\n\n<script>\nimport { tip } from '@/config'\nimport { funEval } from '@/utils/utils'\nimport MonacoEditor from '@/page/components/editor'\nexport default {\n  components: { MonacoEditor },\n  data () {\n    return {\n      code: '',\n      tip: ''\n    }\n  },\n  props: {\n    rules: {\n      type: Boolean,\n      default: true\n    },\n    title: String,\n    visible: Boolean,\n    type: String,\n    value: [String, Object, Array]\n  },\n  watch: {\n    value: {\n      handler (val) {\n        if (this.validatenull(val)) {\n          if (['dataFormatter', 'stylesFormatter'].includes(this.type) && this.validatenull(val)) {\n            this.code = `(data,params,refs)=>{\n    return {}\n}`\n          } else if (['query', 'header', 'dataQuery', 'dataHeader'].includes(this.type) && this.validatenull(val)) {\n            this.code = `(data)=>{\n    return {}\n}`\n          } else if (['echartFormatter'].includes(this.type) && this.validatenull(val)) {\n            this.code = `(data)=>{\n    return {}\n}`\n          } else if (['clickFormatter'].includes(this.type) && this.validatenull(val)) {\n            this.code = `(params,refs)=>{\n    console.log(params,refs)\n}`\n          } else if (['labelFormatter', 'formatter'].includes(this.type) && this.validatenull(val)) {\n            this.code = `(name,data)=>{\n    console.log(name,data)\n    return ''\n}`\n          }\n        } else {\n          this.code = val;\n        }\n      },\n      immediate: true,\n      deep: true,\n    },\n  },\n  created () {\n    this.tip = tip\n  },\n  methods: {\n    handleClose () {\n      this.setVisible(false);\n    },\n    submit () {\n      let value = this.code;\n      if (!this.rules) {\n        this.$emit('submit', value);\n        this.setVisible(false)\n        return\n      }\n      try {\n        funEval(value);\n        if (['data'].includes(this.type)) value = funEval(value);\n        this.$emit('submit', value);\n        this.setVisible(false)\n      } catch (error) {\n        console.log(error);\n        this.$message.error('数据格式有误')\n      }\n\n    },\n    setVisible (val) {\n      this.$emit('update:visible', val);\n    }\n  }\n}\n</script>\n<style lang=\"scss\" scoped>\n.content {\n  display: flex;\n  .monaco_editor_container {\n    flex: 1;\n    &:first-child {\n      flex: 2;\n    }\n  }\n}\n</style>\n"]}]}